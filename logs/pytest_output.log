
===== pytest run 2025-12-16 16:04:01 args=['tests/test_context_menu_effect_invalidation.py', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup 
FAILED                               [100%]




================================================================== FAILURES ==================================================================

_____________________________________________ test_context_menu_invalidates_effects_before_popup _____________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1645f1882e0) at 0x000001647E716080>, qtbot = <pytestqt.qtbot.QtBot object at 0x000001647E7163D0>

settings_manager = <core.settings.settings_manager.SettingsManager(0x1645f18a4e0) at 0x000001647E716780>

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000001647E728650>



    @pytest.mark.qt

    def test_context_menu_invalidates_effects_before_popup(qt_app, qtbot, settings_manager, monkeypatch):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        qtbot.addWidget(widget)

        widget.resize(640, 360)

    

        dummy = QWidget(widget)

        dummy.resize(20, 20)

        dummy.show()

    

        eff = QGraphicsDropShadowEffect(dummy)

        dummy.setGraphicsEffect(eff)

    

        events: List[Tuple[str, object]] = []

    

>       orig_invalidate = widget._invalidate_overlay_effects  # type: ignore[attr-defined]

                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'DisplayWidget' object has no attribute '_invalidate_overlay_effects'



tests\test_context_menu_effect_invalidation.py:29: AttributeError

----------------------------------------------------------- Captured log teardown ------------------------------------------------------------

WARNING  SettingsManager:settings_manager.py:842 All settings cleared

========================================================== short test summary info ===========================================================

FAILED tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup - AttributeError: 'DisplayWidget' object has no attribute '_invalidate_overlay_effects'

============================================================= 1 failed in 0.70s ==============================================================


===== pytest run 2025-12-16 16:14:29 args=['tests/test_spotify_visualizer_widget.py', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items



tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_tick_consumes_engine_smoothed_bars 
PASSED                              [ 16%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_compute_bars_reasonable_runtime 
PASSED                                 [ 33%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_widgets_share_audio_engine 
PASSED                                      [ 50%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_emits_perf_metrics 
PASSED                                              [ 66%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top 
PASSED                                           [ 83%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals 
PASSED                         [100%]




============================================================= 6 passed in 0.46s ==============================================================


===== pytest run 2025-12-16 16:40:41 args=['tests/test_spotify_visualizer_widget.py', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items



tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_tick_consumes_engine_smoothed_bars 
PASSED                              [ 16%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_compute_bars_reasonable_runtime 
PASSED                                 [ 33%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_widgets_share_audio_engine 
PASSED                                      [ 50%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_emits_perf_metrics 
PASSED                                              [ 66%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top 
FAILED                                           [ 83%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals 
FAILED                         [100%]




================================================================== FAILURES ==================================================================

_______________________________________________ test_spotify_visualizer_bars_not_stuck_at_top ________________________________________________



    def test_spotify_visualizer_bars_not_stuck_at_top():

        try:

            import numpy as np  # type: ignore[import]

        except Exception:

            pytest.skip("numpy not available for Spotify visualiser tests")

    

        buf: TripleBuffer[_AudioFrame] = TripleBuffer()

        worker = SpotifyVisualizerAudioWorker(bar_count=15, buffer=buf)

        worker._np = np  # type: ignore[attr-defined]

    

        n_samples = 2048

        sample_rate = 48000

        t = np.arange(n_samples, dtype=np.float32) / np.float32(sample_rate)

    

        bars_center = []

        frames = 120

        for frame in range(frames):

            intensity = np.float32(0.1 + 0.9 * (0.5 + 0.5 * np.sin(np.float32(2.0 * np.pi) * np.float32(frame) / np.float32(60.0))))

            env = np.exp(-t * np.float32(20.0)).astype(np.float32)

            base = (np.sin(np.float32(2.0 * np.pi * 80.0) * t) * env).astype(np.float32)

            samples = (base * (np.float32(0.03) * intensity)).astype(np.float32)

            bars = worker.compute_bars_from_samples(samples)

            if not isinstance(bars, list) or not bars:

                continue

            center_idx = len(bars) // 2

            bars_center.append(float(bars[center_idx]))

    

        assert bars_center

    

        center_arr = np.asarray(bars_center, dtype=np.float32)

        cmin = float(center_arr.min())

        cmax = float(center_arr.max())

        stuck_frac = float(np.mean(center_arr >= np.float32(0.98)))

        crange = cmax - cmin

    

        assert cmax >= 0.25

        assert crange >= 0.15

>       assert stuck_frac <= 0.55

E       assert 0.7166666666666667 <= 0.55



tests\test_spotify_visualizer_widget.py:167: AssertionError

______________________________________ test_spotify_visualizer_kick_emphasizes_center_more_than_vocals _______________________________________



    def test_spotify_visualizer_kick_emphasizes_center_more_than_vocals():

        try:

            import numpy as np  # type: ignore[import]

        except Exception:

            pytest.skip("numpy not available for Spotify visualiser tests")

    

        buf: TripleBuffer[_AudioFrame] = TripleBuffer()

        worker = SpotifyVisualizerAudioWorker(bar_count=15, buffer=buf)

        worker._np = np  # type: ignore[attr-defined]

    

        n_samples = 2048

        sample_rate = 48000

        t = np.arange(n_samples, dtype=np.float32) / np.float32(sample_rate)

    

        env = np.exp(-t * np.float32(18.0)).astype(np.float32)

        kick_base = (np.sin(np.float32(2.0 * np.pi * 80.0) * t) * env).astype(np.float32)

        vocal_base = (

            np.sin(np.float32(2.0 * np.pi * 1000.0) * t) * np.float32(0.7)

            + np.sin(np.float32(2.0 * np.pi * 2000.0) * t) * np.float32(0.5)

        ).astype(np.float32)

    

        kick_samples = (kick_base * np.float32(0.03)).astype(np.float32)

        vocal_samples = (vocal_base * np.float32(0.03)).astype(np.float32)

    

        kick_bars = worker.compute_bars_from_samples(kick_samples)

        vocal_bars = worker.compute_bars_from_samples(vocal_samples)

    

        assert isinstance(kick_bars, list) and len(kick_bars) >= 5

        assert isinstance(vocal_bars, list) and len(vocal_bars) >= 5

    

        n = len(kick_bars)

        c = n // 2

        q = n // 4

        tq = (3 * n) // 4

    

        center_kick = float(np.mean(kick_bars[max(0, c - 1):min(n, c + 2)]))

        shoulder_kick = float((kick_bars[q] + kick_bars[tq]) * 0.5)

    

        center_vocal = float(np.mean(vocal_bars[max(0, c - 1):min(n, c + 2)]))

        shoulder_vocal = float((vocal_bars[q] + vocal_bars[tq]) * 0.5)

    

>       assert (center_kick - shoulder_kick) > (center_vocal - shoulder_vocal)

E       assert (1.0 - 1.0) > (1.0 - 0.8200823068618774)



tests\test_spotify_visualizer_widget.py:211: AssertionError

========================================================== short test summary info ===========================================================

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top - assert 0.7166666666666667 <= 0.55

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals - assert (1.0 - 1.0) > (1.0 - 0.8200823068618774)

======================================================== 2 failed, 4 passed in 0.60s =========================================================


===== pytest run 2025-12-16 16:40:43 args=['tests/test_context_menu_effect_invalidation.py', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup 
FAILED                               [100%]




================================================================== FAILURES ==================================================================

_____________________________________________ test_context_menu_invalidates_effects_before_popup _____________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1b932c68220) at 0x000001B96242FF80>, qtbot = <pytestqt.qtbot.QtBot object at 0x000001B9627506D0>

settings_manager = <core.settings.settings_manager.SettingsManager(0x1b932c6a5a0) at 0x000001B962750AC0>

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000001B962753F50>



    @pytest.mark.qt

    def test_context_menu_invalidates_effects_before_popup(qt_app, qtbot, settings_manager, monkeypatch):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        qtbot.addWidget(widget)

        widget.resize(640, 360)

    

        dummy = QWidget(widget)

        dummy.resize(20, 20)

        dummy.show()

    

        eff = QGraphicsDropShadowEffect(dummy)

        dummy.setGraphicsEffect(eff)

    

        events: List[Tuple[str, object]] = []

    

        orig_invalidate = widget._invalidate_overlay_effects  # type: ignore[attr-defined]

    

        def _spy_invalidate(reason: str) -> None:

            events.append(("invalidate", reason))

            orig_invalidate(reason)

    

        monkeypatch.setattr(widget, "_invalidate_overlay_effects", _spy_invalidate)

    

        last_popup_menu: List[object] = []

    

        def _spy_popup(self, pos):  # type: ignore[no-untyped-def]

            last_popup_menu.clear()

            last_popup_menu.append(self)

            events.append(("popup", pos))

            assert any(e[0] == "invalidate" for e in events)

    

        monkeypatch.setattr(ScreensaverContextMenu, "popup", _spy_popup)

    

        widget.clock_widget = dummy  # type: ignore[assignment]

    

        effect_ids: List[int] = []

    

        for i in range(25):

            events.clear()

            widget._show_context_menu(QPoint(10 + i, 10))  # type: ignore[attr-defined]

            qt_app.processEvents()

            assert events

    

            try:

                active_eff = dummy.graphicsEffect()

            except Exception:

                active_eff = None

            assert isinstance(active_eff, QGraphicsDropShadowEffect)

            effect_ids.append(id(active_eff))

    

            invalidate_idx = next(idx for idx, e in enumerate(events) if e[0] == "invalidate")

            popup_idx = next(idx for idx, e in enumerate(events) if e[0] == "popup")

            assert invalidate_idx < popup_idx

    

            menu = last_popup_menu[0] if last_popup_menu else None

            assert menu is not None

            try:

                menu.aboutToHide.emit()

            except Exception:

                pass

            qt_app.processEvents()

    

            assert any(

                e[0] == "invalidate" and str(e[1]).startswith("menu_after_hide")

                for e in events

            )

    

>       assert len(set(effect_ids)) >= 2

E       assert 1 >= 2

E        +  where 1 = len({1895730858304})

E        +    where {1895730858304} = set([1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304])



tests\test_context_menu_effect_invalidation.py:81: AssertionError

----------------------------------------------------------- Captured log teardown ------------------------------------------------------------

WARNING  SettingsManager:settings_manager.py:842 All settings cleared

========================================================== short test summary info ===========================================================

FAILED tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup - assert 1 >= 2
 +  where 1 = len({1895730858304})
 +    where {1895730858304} = set([1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304, 1895730858304])


============================================================= 1 failed in 0.87s ==============================================================


===== pytest run 2025-12-16 16:44:27 args=['tests/test_spotify_visualizer_widget.py', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items



tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_tick_consumes_engine_smoothed_bars 
PASSED                              [ 16%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_compute_bars_reasonable_runtime 
PASSED                                 [ 33%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_widgets_share_audio_engine 
PASSED                                      [ 50%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_emits_perf_metrics 
PASSED                                              [ 66%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top 
PASSED                                           [ 83%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals 
PASSED                         [100%]




============================================================= 6 passed in 0.32s ==============================================================


===== pytest run 2025-12-16 16:44:29 args=['tests/test_context_menu_effect_invalidation.py', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup 
FAILED                               [100%]




================================================================== FAILURES ==================================================================

_____________________________________________ test_context_menu_invalidates_effects_before_popup _____________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2be20440890) at 0x000002BE4F62BD80>, qtbot = <pytestqt.qtbot.QtBot object at 0x000002BE4F9B7910>

settings_manager = <core.settings.settings_manager.SettingsManager(0x2be2043e650) at 0x000002BE4F9B66C0>

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002BE4F9D7F50>



    @pytest.mark.qt

    def test_context_menu_invalidates_effects_before_popup(qt_app, qtbot, settings_manager, monkeypatch):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        qtbot.addWidget(widget)

        widget.resize(640, 360)

    

        dummy = QWidget(widget)

        dummy.resize(20, 20)

        dummy.show()

    

        eff = QGraphicsDropShadowEffect(dummy)

        dummy.setGraphicsEffect(eff)

    

        events: List[Tuple[str, object]] = []

    

        orig_invalidate = widget._invalidate_overlay_effects  # type: ignore[attr-defined]

    

        def _spy_invalidate(reason: str) -> None:

            events.append(("invalidate", reason))

            orig_invalidate(reason)

    

        monkeypatch.setattr(widget, "_invalidate_overlay_effects", _spy_invalidate)

    

        last_popup_menu: List[object] = []

    

        def _spy_popup(self, pos):  # type: ignore[no-untyped-def]

            last_popup_menu.clear()

            last_popup_menu.append(self)

            events.append(("popup", pos))

            assert any(e[0] == "invalidate" for e in events)

    

        monkeypatch.setattr(ScreensaverContextMenu, "popup", _spy_popup)

    

        widget.clock_widget = dummy  # type: ignore[assignment]

    

        effect_ids: List[int] = []

    

        for i in range(25):

            events.clear()

            widget._show_context_menu(QPoint(10 + i, 10))  # type: ignore[attr-defined]

            qt_app.processEvents()

            assert events

    

            try:

                active_eff = dummy.graphicsEffect()

            except Exception:

                active_eff = None

            assert isinstance(active_eff, QGraphicsDropShadowEffect)

            effect_ids.append(id(active_eff))

    

            invalidate_idx = next(idx for idx, e in enumerate(events) if e[0] == "invalidate")

            popup_idx = next(idx for idx, e in enumerate(events) if e[0] == "popup")

            assert invalidate_idx < popup_idx

    

            menu = last_popup_menu[0] if last_popup_menu else None

            assert menu is not None

            try:

                menu.aboutToHide.emit()

            except Exception:

                pass

            qt_app.processEvents()

    

            assert any(

                e[0] == "invalidate" and str(e[1]).startswith("menu_after_hide")

                for e in events

            )

    

>       assert len(set(effect_ids)) >= 2

E       assert 1 >= 2

E        +  where 1 = len({3016398250752})

E        +    where {3016398250752} = set([3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752])



tests\test_context_menu_effect_invalidation.py:81: AssertionError

----------------------------------------------------------- Captured log teardown ------------------------------------------------------------

WARNING  SettingsManager:settings_manager.py:842 All settings cleared

========================================================== short test summary info ===========================================================

FAILED tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup - assert 1 >= 2
 +  where 1 = len({3016398250752})
 +    where {3016398250752} = set([3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752, 3016398250752])


============================================================= 1 failed in 0.61s ==============================================================


===== pytest run 2025-12-16 16:46:33 args=['tests/test_context_menu_effect_invalidation.py', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup 
FAILED                               [100%]




================================================================== FAILURES ==================================================================

_____________________________________________ test_context_menu_invalidates_effects_before_popup _____________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1e8cc1c7160) at 0x000001E8FBAA32C0>, qtbot = <pytestqt.qtbot.QtBot object at 0x000001E8FBAA3650>

settings_manager = <core.settings.settings_manager.SettingsManager(0x1e8cb600320) at 0x000001E8FBAA3A40>

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000001E8FBABFF50>



    @pytest.mark.qt

    def test_context_menu_invalidates_effects_before_popup(qt_app, qtbot, settings_manager, monkeypatch):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        qtbot.addWidget(widget)

        widget.resize(640, 360)

    

        dummy = QWidget(widget)

        dummy.resize(20, 20)

        dummy.show()

    

        eff = QGraphicsDropShadowEffect(dummy)

        dummy.setGraphicsEffect(eff)

    

        events: List[Tuple[str, object]] = []

    

        orig_invalidate = widget._invalidate_overlay_effects  # type: ignore[attr-defined]

    

        def _spy_invalidate(reason: str) -> None:

            events.append(("invalidate", reason))

            orig_invalidate(reason)

    

        monkeypatch.setattr(widget, "_invalidate_overlay_effects", _spy_invalidate)

    

        last_popup_menu: List[object] = []

    

        def _spy_popup(self, pos):  # type: ignore[no-untyped-def]

            last_popup_menu.clear()

            last_popup_menu.append(self)

            events.append(("popup", pos))

            assert any(e[0] == "invalidate" for e in events)

    

        monkeypatch.setattr(ScreensaverContextMenu, "popup", _spy_popup)

    

        widget.clock_widget = dummy  # type: ignore[assignment]

    

        effect_ids: List[int] = []

    

        for i in range(25):

            events.clear()

            widget._show_context_menu(QPoint(10 + i, 10))  # type: ignore[attr-defined]

            qt_app.processEvents()

            assert events

    

            try:

                active_eff = dummy.graphicsEffect()

            except Exception:

                active_eff = None

            assert isinstance(active_eff, QGraphicsDropShadowEffect)

            effect_ids.append(id(active_eff))

    

            invalidate_idx = next(idx for idx, e in enumerate(events) if e[0] == "invalidate")

            popup_idx = next(idx for idx, e in enumerate(events) if e[0] == "popup")

            assert invalidate_idx < popup_idx

    

            menu = last_popup_menu[0] if last_popup_menu else None

            assert menu is not None

            try:

                menu.aboutToHide.emit()

            except Exception:

                pass

            qt_app.processEvents()

    

            assert any(

                e[0] == "invalidate" and str(e[1]).startswith("menu_after_hide")

                for e in events

            )

    

>       assert len(set(effect_ids)) >= 2

E       assert 1 >= 2

E        +  where 1 = len({2100166577856})

E        +    where {2100166577856} = set([2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856])



tests\test_context_menu_effect_invalidation.py:81: AssertionError

----------------------------------------------------------- Captured log teardown ------------------------------------------------------------

WARNING  SettingsManager:settings_manager.py:842 All settings cleared

========================================================== short test summary info ===========================================================

FAILED tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup - assert 1 >= 2
 +  where 1 = len({2100166577856})
 +    where {2100166577856} = set([2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856, 2100166577856])


============================================================= 1 failed in 0.70s ==============================================================


===== pytest run 2025-12-16 16:47:32 args=['tests/test_context_menu_effect_invalidation.py', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup 
PASSED                               [100%]




============================================================= 1 passed in 0.50s ==============================================================


===== pytest run 2025-12-16 16:54:47 args=['tests/test_spotify_visualizer_widget.py', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items



tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_tick_consumes_engine_smoothed_bars 
PASSED                              [ 16%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_compute_bars_reasonable_runtime 
PASSED                                 [ 33%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_widgets_share_audio_engine 
PASSED                                      [ 50%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_emits_perf_metrics 
PASSED                                              [ 66%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top 
PASSED                                           [ 83%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals 
PASSED                         [100%]




============================================================= 6 passed in 0.53s ==============================================================


===== pytest run 2025-12-16 16:54:49 args=['tests/test_context_menu_effect_invalidation.py', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup 
PASSED                               [100%]




============================================================= 1 passed in 0.78s ==============================================================


===== pytest run 2025-12-16 17:36:04 args=['tests/test_spotify_visualizer_widget.py', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items



tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_tick_consumes_engine_smoothed_bars 
PASSED                              [ 16%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_compute_bars_reasonable_runtime 
PASSED                                 [ 33%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_widgets_share_audio_engine 
PASSED                                      [ 50%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_emits_perf_metrics 
PASSED                                              [ 66%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top 
PASSED                                           [ 83%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals 
PASSED                         [100%]




============================================================= 6 passed in 0.44s ==============================================================


===== pytest run 2025-12-16 17:46:13 args=[] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 488 items / 4 skipped



tests\test_animation.py 
.
.
.
.
.
.
.
.
.
.
.
                                                                                                     [  2%]


tests\test_animation_set_target_fps.py 
.
                                                                                                [  2%]


tests\test_block_puzzle_flip.py 
.
.
.
.
.
.
.
                                                                                                 [  3%]


tests\test_clock_integration_regression.py 
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                 [  6%]


tests\test_clock_widget.py 
.
.
F
.
.
.
.
.
.
.
.
F
.
F
.
F
.
.
.
                                                                                          [ 10%]


tests\test_context_menu_effect_invalidation.py 
.
                                                                                        [ 10%]


tests\test_ctrl_interaction_mode.py 
.
.
.

===== pytest run 2025-12-16 17:50:39 args=['tests/test_clock_widget.py', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 19 items



tests/test_clock_widget.py::test_time_format_enum 
PASSED                                                                                [  5%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED                                                                             [ 10%]


tests/test_clock_widget.py::test_clock_creation 
FAILED                                                                                  [ 15%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                                                                                [ 21%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                                                                                   [ 26%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                                                                                [ 31%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                                                                                [ 36%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED                                                                           [ 42%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED                                                                              [ 47%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED                                                                           [ 52%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED                                                                          [ 57%]


tests/test_clock_widget.py::test_clock_all_positions 
FAILED                                                                             [ 63%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED                                                                              [ 68%]


tests/test_clock_widget.py::test_clock_set_font_size 
FAILED                                                                             [ 73%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED                                                                            [ 78%]


tests/test_clock_widget.py::test_clock_set_margin 
FAILED                                                                                [ 84%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                                                                                   [ 89%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED                                                               [ 94%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED                                                                         [100%]




================================================================== FAILURES ==================================================================

____________________________________________________________ test_clock_creation _____________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x22eb40c2db0) at 0x0000022EB4D3F940>

parent_widget = <PySide6.QtWidgets.QWidget(0x22eb32951e0) at 0x0000022EB4D3FA40>



    def test_clock_creation(qapp, parent_widget):

        """Test clock widget creation."""

        clock = ClockWidget(

            parent=parent_widget,

            time_format=TimeFormat.TWELVE_HOUR,

            position=ClockPosition.TOP_RIGHT,

            show_seconds=True

        )

    

        assert clock is not None

        assert clock._time_format == TimeFormat.TWELVE_HOUR

>       assert clock._position == ClockPosition.TOP_RIGHT

E       assert <OverlayPosition.TOP_RIGHT: 'top_right'> == <ClockPosition.TOP_RIGHT: 'top_right'>

E        +  where <OverlayPosition.TOP_RIGHT: 'top_right'> = <widgets.clock_widget.ClockWidget(0x22eb3293260, name="clock_main") at 0x0000022EB4D3FB80>._position

E        +  and   <ClockPosition.TOP_RIGHT: 'top_right'> = ClockPosition.TOP_RIGHT



tests\test_clock_widget.py:54: AssertionError

__________________________________________________________ test_clock_all_positions __________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x22eb40c2db0) at 0x0000022EB4D3F940>

parent_widget = <PySide6.QtWidgets.QWidget(0x22eb429f280) at 0x0000022EB4860500>



    def test_clock_all_positions(qapp, parent_widget):

        """Test all clock positions."""

        parent_widget.show()  # Show parent so child visibility works

    

        positions = [

            ClockPosition.TOP_LEFT,

            ClockPosition.TOP_RIGHT,

            ClockPosition.BOTTOM_LEFT,

            ClockPosition.BOTTOM_RIGHT,

            ClockPosition.TOP_CENTER,

            ClockPosition.BOTTOM_CENTER

        ]

    

        for position in positions:

            clock = ClockWidget(parent=parent_widget, position=position)

            clock.start()

    

            # Check position is set

>           assert clock._position == position

E           assert <OverlayPosition.TOP_LEFT: 'top_left'> == <ClockPosition.TOP_LEFT: 'top_left'>

E            +  where <OverlayPosition.TOP_LEFT: 'top_left'> = <widgets.clock_widget.ClockWidget(0x22eb429fbe0, name="clock_main") at 0x0000022EB48636C0>._position



tests\test_clock_widget.py:216: AssertionError

__________________________________________________________ test_clock_set_font_size __________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x22eb40c2db0) at 0x0000022EB4D3F940>

parent_widget = <PySide6.QtWidgets.QWidget(0x22eb429df00) at 0x0000022EB4D35700>



    def test_clock_set_font_size(qapp, parent_widget):

        """Test setting font size."""

        clock = ClockWidget(parent=parent_widget)

    

        clock.set_font_size(72)

        assert clock._font_size == 72

    

        # Invalid size should fall back

        clock.set_font_size(-10)

>       assert clock._font_size == 48

E       assert 8 == 48

E        +  where 8 = <widgets.clock_widget.ClockWidget(0x22eb429dc60, name="clock_main") at 0x0000022EB4D35E40>._font_size



tests\test_clock_widget.py:249: AssertionError

___________________________________________________________ test_clock_set_margin ____________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x22eb40c2db0) at 0x0000022EB4D3F940>

parent_widget = <PySide6.QtWidgets.QWidget(0x22eb35919f0) at 0x0000022EB4D7DF00>



    def test_clock_set_margin(qapp, parent_widget):

        """Test setting margin."""

        clock = ClockWidget(parent=parent_widget)

    

        clock.set_margin(50)

        assert clock._margin == 50

    

        # Invalid margin should fall back

        clock.set_margin(-10)

>       assert clock._margin == 20

E       assert 0 == 20

E        +  where 0 = <widgets.clock_widget.ClockWidget(0x22eb3592470, name="clock_main") at 0x0000022EB4D7F3C0>._margin



tests\test_clock_widget.py:271: AssertionError

========================================================== short test summary info ===========================================================

FAILED tests/test_clock_widget.py::test_clock_creation - assert <OverlayPosition.TOP_RIGHT: 'top_right'> == <ClockPosition.TOP_RIGHT: 'top_right'>
 +  where <OverlayPosition.TOP_RIGHT: 'top_right'> = <widgets.clock_widget.ClockWidget(0x22eb3293260, name="clock_main") at 0x0000022EB4D3FB80>._position
 +  and   <ClockPosition.TOP_RIGHT: 'top_right'> = ClockPosition.TOP_RIGHT


FAILED tests/test_clock_widget.py::test_clock_all_positions - assert <OverlayPosition.TOP_LEFT: 'top_left'> == <ClockPosition.TOP_LEFT: 'top_left'>
 +  where <OverlayPosition.TOP_LEFT: 'top_left'> = <widgets.clock_widget.ClockWidget(0x22eb429fbe0, name="clock_main") at 0x0000022EB48636C0>._position


FAILED tests/test_clock_widget.py::test_clock_set_font_size - assert 8 == 48
 +  where 8 = <widgets.clock_widget.ClockWidget(0x22eb429dc60, name="clock_main") at 0x0000022EB4D35E40>._font_size


FAILED tests/test_clock_widget.py::test_clock_set_margin - assert 0 == 20
 +  where 0 = <widgets.clock_widget.ClockWidget(0x22eb3592470, name="clock_main") at 0x0000022EB4D7F3C0>._margin


======================================================== 4 failed, 15 passed in 4.47s ========================================================


===== pytest run 2025-12-16 17:57:17 args=['tests/test_clock_widget.py', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 19 items



tests/test_clock_widget.py::test_time_format_enum 
PASSED                                                                                [  5%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED                                                                             [ 10%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                                                                                  [ 15%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                                                                                [ 21%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                                                                                   [ 26%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                                                                                [ 31%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                                                                                [ 36%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED                                                                           [ 42%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED                                                                              [ 47%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED                                                                           [ 52%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED                                                                          [ 57%]


tests/test_clock_widget.py::test_clock_all_positions 
PASSED                                                                             [ 63%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED                                                                              [ 68%]


tests/test_clock_widget.py::test_clock_set_font_size 
PASSED                                                                             [ 73%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED                                                                            [ 78%]


tests/test_clock_widget.py::test_clock_set_margin 
PASSED                                                                                [ 84%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                                                                                   [ 89%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED                                                               [ 94%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED                                                                         [100%]




============================================================= 19 passed in 4.42s =============================================================


===== pytest run 2025-12-16 17:57:30 args=[] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 488 items / 4 skipped



tests\test_animation.py 
.
.
.
.
.
.
.
.
.
.
.
                                                                                                     [  2%]


tests\test_animation_set_target_fps.py 
.
                                                                                                [  2%]


tests\test_block_puzzle_flip.py 
.
.
.
.
.
.
.
                                                                                                 [  3%]


tests\test_clock_integration_regression.py 
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                 [  6%]


tests\test_clock_widget.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                          [ 10%]


tests\test_context_menu_effect_invalidation.py 
.
                                                                                        [ 10%]


tests\test_ctrl_interaction_mode.py 
.
.
.

===== pytest run 2025-12-16 18:01:40 args=['-x', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 488 items / 4 skipped



tests/test_animation.py::test_animation_manager_initialization 
PASSED                                                                   [  0%]


tests/test_animation.py::test_property_animation 
PASSED                                                                                 [  0%]


tests/test_animation.py::test_custom_animation 
PASSED                                                                                   [  0%]


tests/test_animation.py::test_animation_pause_resume 
PASSED                                                                             [  0%]


tests/test_animation.py::test_animation_cancel 
PASSED                                                                                   [  1%]


tests/test_animation.py::test_easing_curves 
PASSED                                                                                      [  1%]


tests/test_animation.py::test_animation_with_delay 
PASSED                                                                               [  1%]


tests/test_animation.py::test_multiple_animations 
PASSED                                                                                [  1%]


tests/test_animation.py::test_cancel_all_animations 
PASSED                                                                              [  1%]


tests/test_animation.py::test_animation_manager_auto_stop 
PASSED                                                                        [  2%]


tests/test_animation.py::test_animation_manager_emits_perf_metrics 
PASSED                                                               [  2%]


tests/test_animation_set_target_fps.py::test_set_target_fps_updates_timer_interval 
PASSED                                               [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_creation 
PASSED                                                                      [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_runs_and_labels 
PASSED                                                               [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_cleanup 
PASSED                                                                       [  3%]


tests/test_block_puzzle_flip.py::test_block_puzzle_invalid_pixmap 
PASSED                                                                [  3%]


tests/test_block_puzzle_flip.py::test_block_puzzle_set_flip_duration 
PASSED                                                             [  3%]


tests/test_block_puzzle_flip.py::test_block_puzzle_randomization 
PASSED                                                                 [  3%]


tests/test_block_puzzle_flip.py::test_block_puzzle_small_widget 
PASSED                                                                  [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug1_clock_widget_created 
PASSED                       [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug2_set_text_color_method_exists 
PASSED               [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug3_color_array_to_qcolor_conversion 
PASSED           [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug4_z_order_clock_on_top 
PASSED                       [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug5_settings_retrieval_no_crash 
PASSED                [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug6_boolean_type_conversion 
PASSED                    [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug7_position_string_to_enum 
PASSED                    [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug8_format_string_to_enum 
PASSED                      [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug9_missing_raise_call 
PASSED                         [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_visibility_after_setup 
PASSED             [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_size_and_position 
PASSED                  [  6%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_settings_complete_integration 
PASSED             [  6%]


tests/test_clock_widget.py::test_time_format_enum 
PASSED                                                                                [  6%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED                                                                             [  6%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                                                                                  [  6%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                                                                                [  7%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                                                                                   [  7%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                                                                                [  7%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                                                                                [  7%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED                                                                           [  7%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED                                                                              [  8%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED                                                                           [  8%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED                                                                          [  8%]


tests/test_clock_widget.py::test_clock_all_positions 
PASSED                                                                             [  8%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED                                                                              [  9%]


tests/test_clock_widget.py::test_clock_set_font_size 
PASSED                                                                             [  9%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED                                                                            [  9%]


tests/test_clock_widget.py::test_clock_set_margin 
PASSED                                                                                [  9%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                                                                                   [  9%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED                                                               [ 10%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED                                                                         [ 10%]


tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup 
PASSED                               [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget 
PASSED                                          [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets 
PASSED                                               [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344] 
PASSED                                           [ 11%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777349] 

===== pytest run 2025-12-16 18:04:25 args=['-x', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 488 items / 4 skipped



tests\test_animation.py 
.
.
.
.
.
.
.
.
.
.
.
                                                                                                     [  2%]


tests\test_animation_set_target_fps.py 
.
                                                                                                [  2%]


tests\test_block_puzzle_flip.py 
.
.
.
.
.
.
.
                                                                                                 [  3%]


tests\test_clock_integration_regression.py 
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                 [  6%]


tests\test_clock_widget.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                          [ 10%]


tests\test_context_menu_effect_invalidation.py 
.
                                                                                        [ 10%]


tests\test_ctrl_interaction_mode.py 
.
.
.

===== pytest run 2025-12-16 18:08:14 args=['tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777349]', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777349] 

===== pytest run 2025-12-16 18:11:41 args=['tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777349]', '-vv', '--tb=long'] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777349] 
PASSED                                           [100%]




============================================================= 1 passed in 0.73s ==============================================================


===== pytest run 2025-12-16 18:12:20 args=[] =====

============================================================ test session starts =============================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 488 items / 4 skipped



tests\test_animation.py 
.
.
.
.
.
.
.
.
.
.
.
                                                                                                     [  2%]


tests\test_animation_set_target_fps.py 
.
                                                                                                [  2%]


tests\test_block_puzzle_flip.py 
.
.
.
.
.
.
.
                                                                                                 [  3%]


tests\test_clock_integration_regression.py 
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                 [  6%]


tests\test_clock_widget.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                          [ 10%]


tests\test_context_menu_effect_invalidation.py 
.
                                                                                        [ 10%]


tests\test_ctrl_interaction_mode.py 
.
.
.
.
.
.
.
.
.
F
.
                                                                                         [ 12%]


tests\test_diffuse_transition.py 
.
.
.
.
.
.
.
F
.
.
.
.
.
                                                                                          [ 15%]


tests\test_dimming_and_interaction_fixes.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
F
F
                                                                           [ 18%]


tests\test_display_tab.py 
.
.
F
.
.
.
.
.
.
.
F
.
.
.
                                                                                                [ 21%]


tests\test_engine_lifecycle.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                     [ 25%]


tests\test_events.py 
.
.
.
.
.
F
                                                                                                             [ 27%]


tests\test_flicker_fix_integration.py 
.
.
F
.
.
.
.
                                                                                           [ 28%]


tests\test_frame_timing_workload.py 
.
.
                                                                                                  [ 28%]


tests\test_gl_compositor_blinds.py 
.
                                                                                                    [ 29%]


tests\test_gl_compositor_blockflip.py 
.
                                                                                                 [ 29%]


tests\test_gl_compositor_blockspin.py 
F
                                                                                                 [ 29%]


tests\test_gl_compositor_cleanup.py 
.
.
                                                                                                  [ 29%]


tests\test_gl_compositor_crossfade.py 
.
                                                                                                 [ 30%]


tests\test_gl_compositor_diffuse.py 
.
                                                                                                   [ 30%]


tests\test_gl_compositor_peel.py 
.
                                                                                                      [ 30%]


tests\test_gl_compositor_raindrops.py 
.
                                                                                                 [ 30%]


tests\test_gl_compositor_slide.py 
.
                                                                                                     [ 30%]


tests\test_gl_compositor_wipe.py 
.
.
.
.
.
.
                                                                                                 [ 32%]


tests\test_gl_prewarm.py 
.
                                                                                                              [ 32%]


tests\test_image_processor.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                  [ 37%]


tests\test_image_queue.py 
.
.
.
F
F
F
F
.
.
.
.
.
.
.
.
.
.
F
.
F
.
.
.
F
                                                                                      [ 42%]


tests\test_integration.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                               [ 45%]


tests\test_integration_settings.py 
.
.
.
.
.
.
.
.
.
.
                                                                                           [ 47%]


tests\test_lanczos_scaling.py 
.
.
.
.
.
s
.
.
.
.
.
.
.
                                                                                             [ 50%]


tests\test_logging_console_encoding.py 
.
.
.
                                                                                              [ 50%]


tests\test_media_widget.py 
.
.
.
.

===== pytest run 2025-12-16 22:53:56 args=[] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 488 items / 4 skipped



tests\test_animation.py 
.
.
.
.
.
.
.
.
.
.
.
                                      [  2%]


tests\test_animation_set_target_fps.py 
.
                                 [  2%]


tests\test_block_puzzle_flip.py 
.
.
.
.
.
.
.
                                  [  3%]


tests\test_clock_integration_regression.py 
.
.
.
.
.
.
.
.
.
.
.
.
                  [  6%]


tests\test_clock_widget.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                           [ 10%]


tests\test_context_menu_effect_invalidation.py 
F
                         [ 10%]


tests\test_ctrl_interaction_mode.py 
F
.
.
.
.
.
.
.
.
F
F
                          [ 12%]


tests\test_diffuse_transition.py 
.
.
.
.
.
.
.
F
.
.
.
.
.
                           [ 15%]


tests\test_dimming_and_interaction_fixes.py 
.
.
.
.
F
.
F
F
.
F
F
.
.
.
F
F
F
            [ 18%]


tests\test_display_tab.py 
.
.
F
.
.
.
.
.
.
.
F
.
.
.
                                 [ 21%]


tests\test_engine_lifecycle.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                      [ 25%]


tests\test_events.py 
.
.
.
.
.
F
                                              [ 27%]


tests\test_flicker_fix_integration.py 
.
.
.
.
.
.
.
                            [ 28%]


tests\test_frame_timing_workload.py 
.
.
                                   [ 28%]


tests\test_gl_compositor_blinds.py 
.
                                     [ 29%]


tests\test_gl_compositor_blockflip.py 
.
                                  [ 29%]


tests\test_gl_compositor_blockspin.py 
F
                                  [ 29%]


tests\test_gl_compositor_cleanup.py 
.
.
                                   [ 29%]


tests\test_gl_compositor_crossfade.py 
.
                                  [ 30%]


tests\test_gl_compositor_diffuse.py 
.
                                    [ 30%]


tests\test_gl_compositor_peel.py 
.
                                       [ 30%]


tests\test_gl_compositor_raindrops.py 
.
                                  [ 30%]


tests\test_gl_compositor_slide.py 
.
                                      [ 30%]


tests\test_gl_compositor_wipe.py 
.
.
.
.
.
.
                                  [ 32%]


tests\test_gl_prewarm.py 
.
                                               [ 32%]


tests\test_image_processor.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                   [ 37%]


tests\test_image_queue.py 
.
.
.
F
F
F
F
.
.
.
.
.
.
.
.
.
.
F
.
F
.
.
.
F
                       [ 42%]


tests\test_integration.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                [ 45%]


tests\test_integration_settings.py 
.
.
.
.
.
.
.
.
.
.
                            [ 47%]


tests\test_lanczos_scaling.py 
.
.
.
.
.
s
.
.
.
.
.
.
.
                              [ 50%]


tests\test_logging_console_encoding.py 
.
.
.
                               [ 50%]


tests\test_media_widget.py 
.
.
.
.

===== pytest run 2025-12-17 10:31:49 args=['tests/test_gmail_widget.py', '-v', '--timeout=30'] =====

ERROR: usage: pytest.py [options] [file_or_dir] [file_or_dir] [...]
pytest.py: error: unrecognized arguments: --timeout=30
  inifile: F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.ini
  rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver




===== pytest run 2025-12-17 10:33:18 args=['tests/test_gmail_widget.py', '-v', '--timeout=30'] =====

ERROR: usage: pytest.py [options] [file_or_dir] [file_or_dir] [...]
pytest.py: error: unrecognized arguments: --timeout=30
  inifile: F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.ini
  rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver




===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:28 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:29 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:30 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====


===== pytest run 2025-12-17 10:33:31 args=[] =====

--- Logging error ---

--- Logging error ---

--- Logging error ---

--- Logging error ---

--- Logging error ---

--- Logging error ---

--- Logging error ---

Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 75, in emit
    logging.FileHandler.emit(self, record)

  File "C:\Python311\Lib\logging\__init__.py", line 1230, in emit
    StreamHandler.emit(self, record)

  File "C:\Python311\Lib\logging\__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 687, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 377, in getMessage
    msg = msg % self.args
          ^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while getting the repr of an object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 117, in main
    logger.info("pytest.py starting with args: %r", argv)

  File "C:\Python311\Lib\logging\__init__.py", line 1489, in info
    self._log(INFO, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 74, in _flush_to_handler
    record = logging.LogRecord(
             ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 326, in __init__
    self.filename = os.path.basename(pathname)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen ntpath>", line 244, in basename

RecursionError: maximum recursion depth exceeded


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 123, in print_exception
    value, tb = _parse_value_tb(exc, value, tb)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 97, in _parse_value_tb
    if (value is _sentinel) != (tb is _sentinel):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded in comparison


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 74, in _flush_to_handler
    record = logging.LogRecord(
             ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 326, in __init__
    self.filename = os.path.basename(pathname)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen ntpath>", line 244, in basename

RecursionError: maximum recursion depth exceeded


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 723, in __init__
    _seen.add(id(exc_value))
              ^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 74, in _flush_to_handler
    record = logging.LogRecord(
             ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 326, in __init__
    self.filename = os.path.basename(pathname)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen ntpath>", line 244, in basename

  File "<frozen ntpath>", line 214, in split

RecursionError: maximum recursion depth exceeded


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 402, in _extract_from_extended_frame_gen
    limit = getattr(sys, 'tracebacklimit', None)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 74, in _flush_to_handler
    record = logging.LogRecord(
             ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 327, in __init__
    self.module = os.path.splitext(self.filename)[0]
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen ntpath>", line 236, in splitext

  File "<frozen genericpath>", line 131, in _splitext

RecursionError: maximum recursion depth exceeded in comparison


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 402, in _extract_from_extended_frame_gen
    limit = getattr(sys, 'tracebacklimit', None)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 688, in format
    if self.usesTime():
       ^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 656, in usesTime
    return self._style.usesTime()
           ^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 433, in usesTime
    return self._fmt.find(self.asctime_search) >= 0
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 83, in _flush_to_handler
    handler.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 74, in _flush_to_handler
    record = logging.LogRecord(
             ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 297, in __init__
    ct = time.time()
         ^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 413, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:

  File "C:\Python311\Lib\traceback.py", line 350, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 361, in _get_code_position
    if instruction_index < 0:
       ^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded in comparison


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 75, in emit
    logging.FileHandler.emit(self, record)

  File "C:\Python311\Lib\logging\__init__.py", line 1230, in emit
    StreamHandler.emit(self, record)

  File "C:\Python311\Lib\logging\__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 688, in format
    if self.usesTime():
       ^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 656, in usesTime
    return self._style.usesTime()
           ^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 433, in usesTime
    return self._fmt.find(self.asctime_search) >= 0
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 83, in _flush_to_handler
    handler.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 74, in _flush_to_handler
    record = logging.LogRecord(
             ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 326, in __init__
    self.filename = os.path.basename(pathname)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen ntpath>", line 244, in basename

RecursionError: maximum recursion depth exceeded


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 42, in getlines
    if len(entry) != 1:
       ^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1032, in handleError
    traceback.print_exception(t, v, tb, None, sys.stderr)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 396, in open
    buffer = _builtin_open(filename, 'rb')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 86, in updatecache
    if len(cache[filename]) != 1:
       ^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1032, in handleError
    traceback.print_exception(t, v, tb, None, sys.stderr)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 396, in open
    buffer = _builtin_open(filename, 'rb')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 396, in open
    buffer = _builtin_open(filename, 'rb')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\tokenize.py", line 398, in open
    encoding, lines = detect_encoding(buffer.readline)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 367, in detect_encoding
    first = read_or_stop()
            ^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 325, in read_or_stop
    return readline()
           ^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1032, in handleError
    traceback.print_exception(t, v, tb, None, sys.stderr)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 404, in open
    buffer.close()

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 396, in open
    buffer = _builtin_open(filename, 'rb')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1032, in handleError
    traceback.print_exception(t, v, tb, None, sys.stderr)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 396, in open
    buffer = _builtin_open(filename, 'rb')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\tokenize.py", line 400, in open
    text = TextIOWrapper(buffer, encoding, line_buffering=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen codecs>", line 310, in __init__

RecursionError: maximum recursion depth exceeded


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1032, in handleError
    traceback.print_exception(t, v, tb, None, sys.stderr)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 787, in __init__
    context = TracebackException(
              ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 404, in open
    buffer.close()

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\tokenize.py", line 400, in open
    text = TextIOWrapper(buffer, encoding, line_buffering=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen codecs>", line 310, in __init__

RecursionError: maximum recursion depth exceeded


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 404, in open
    buffer.close()

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1032, in handleError
    traceback.print_exception(t, v, tb, None, sys.stderr)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 787, in __init__
    context = TracebackException(
              ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:

RecursionError: maximum recursion depth exceeded while calling a Python object

Call stack:

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_gmail_widget.py", line 165, in <module>
    pytest.main([__file__, "-v"])

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)

  [Previous line repeated 971 more times]

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

Message: 'pytest run failed with unexpected error'
Arguments: ()


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:36 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:37 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:38 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====


===== pytest run 2025-12-17 10:33:39 args=[] =====

--- Logging error ---

--- Logging error ---

--- Logging error ---

--- Logging error ---

--- Logging error ---

--- Logging error ---

--- Logging error ---

Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 75, in emit
    logging.FileHandler.emit(self, record)

  File "C:\Python311\Lib\logging\__init__.py", line 1230, in emit
    StreamHandler.emit(self, record)

  File "C:\Python311\Lib\logging\__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 687, in format
    record.message = record.getMessage()
                     ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 377, in getMessage
    msg = msg % self.args
          ^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while getting the repr of an object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 117, in main
    logger.info("pytest.py starting with args: %r", argv)

  File "C:\Python311\Lib\logging\__init__.py", line 1489, in info
    self._log(INFO, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 74, in _flush_to_handler
    record = logging.LogRecord(
             ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 326, in __init__
    self.filename = os.path.basename(pathname)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen ntpath>", line 244, in basename

RecursionError: maximum recursion depth exceeded


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 123, in print_exception
    value, tb = _parse_value_tb(exc, value, tb)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 97, in _parse_value_tb
    if (value is _sentinel) != (tb is _sentinel):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded in comparison


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 74, in _flush_to_handler
    record = logging.LogRecord(
             ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 326, in __init__
    self.filename = os.path.basename(pathname)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen ntpath>", line 244, in basename

RecursionError: maximum recursion depth exceeded


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 723, in __init__
    _seen.add(id(exc_value))
              ^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 74, in _flush_to_handler
    record = logging.LogRecord(
             ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 326, in __init__
    self.filename = os.path.basename(pathname)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen ntpath>", line 244, in basename

  File "<frozen ntpath>", line 214, in split

RecursionError: maximum recursion depth exceeded


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 402, in _extract_from_extended_frame_gen
    limit = getattr(sys, 'tracebacklimit', None)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 74, in _flush_to_handler
    record = logging.LogRecord(
             ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 327, in __init__
    self.module = os.path.splitext(self.filename)[0]
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen ntpath>", line 236, in splitext

  File "<frozen genericpath>", line 131, in _splitext

RecursionError: maximum recursion depth exceeded in comparison


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 402, in _extract_from_extended_frame_gen
    limit = getattr(sys, 'tracebacklimit', None)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 688, in format
    if self.usesTime():
       ^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 656, in usesTime
    return self._style.usesTime()
           ^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 433, in usesTime
    return self._fmt.find(self.asctime_search) >= 0
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 83, in _flush_to_handler
    handler.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 74, in _flush_to_handler
    record = logging.LogRecord(
             ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 297, in __init__
    ct = time.time()
         ^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 413, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:

  File "C:\Python311\Lib\traceback.py", line 350, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 361, in _get_code_position
    if instruction_index < 0:
       ^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded in comparison


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 75, in emit
    logging.FileHandler.emit(self, record)

  File "C:\Python311\Lib\logging\__init__.py", line 1230, in emit
    StreamHandler.emit(self, record)

  File "C:\Python311\Lib\logging\__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 688, in format
    if self.usesTime():
       ^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 656, in usesTime
    return self._style.usesTime()
           ^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 433, in usesTime
    return self._fmt.find(self.asctime_search) >= 0
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 83, in _flush_to_handler
    handler.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1031, in handleError
    sys.stderr.write('--- Logging error ---\n')

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 95, in write
    _flush_to_handler()

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 74, in _flush_to_handler
    record = logging.LogRecord(
             ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 326, in __init__
    self.filename = os.path.basename(pathname)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen ntpath>", line 244, in basename

RecursionError: maximum recursion depth exceeded


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 42, in getlines
    if len(entry) != 1:
       ^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1032, in handleError
    traceback.print_exception(t, v, tb, None, sys.stderr)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 396, in open
    buffer = _builtin_open(filename, 'rb')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 86, in updatecache
    if len(cache[filename]) != 1:
       ^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1032, in handleError
    traceback.print_exception(t, v, tb, None, sys.stderr)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 396, in open
    buffer = _builtin_open(filename, 'rb')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 396, in open
    buffer = _builtin_open(filename, 'rb')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\tokenize.py", line 398, in open
    encoding, lines = detect_encoding(buffer.readline)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 367, in detect_encoding
    first = read_or_stop()
            ^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 325, in read_or_stop
    return readline()
           ^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1032, in handleError
    traceback.print_exception(t, v, tb, None, sys.stderr)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 404, in open
    buffer.close()

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 396, in open
    buffer = _builtin_open(filename, 'rb')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1032, in handleError
    traceback.print_exception(t, v, tb, None, sys.stderr)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 396, in open
    buffer = _builtin_open(filename, 'rb')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\tokenize.py", line 400, in open
    text = TextIOWrapper(buffer, encoding, line_buffering=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen codecs>", line 310, in __init__

RecursionError: maximum recursion depth exceeded


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1032, in handleError
    traceback.print_exception(t, v, tb, None, sys.stderr)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 787, in __init__
    context = TracebackException(
              ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 404, in open
    buffer.close()

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\tokenize.py", line 400, in open
    text = TextIOWrapper(buffer, encoding, line_buffering=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "<frozen codecs>", line 310, in __init__

RecursionError: maximum recursion depth exceeded


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:
         ^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\tokenize.py", line 404, in open
    buffer.close()

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)
           ^^^^^^^^^^^^^^^^^^^^^^

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

  File "C:\Python311\Lib\logging\__init__.py", line 1524, in exception
    self.error(msg, *args, exc_info=exc_info, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1518, in error
    self._log(ERROR, msg, args, **kwargs)

  File "C:\Python311\Lib\logging\__init__.py", line 1634, in _log
    self.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1644, in handle
    self.callHandlers(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1706, in callHandlers
    hdlr.handle(record)

  File "C:\Python311\Lib\logging\__init__.py", line 978, in handle
    self.emit(record)

  File "C:\Python311\Lib\logging\handlers.py", line 77, in emit
    self.handleError(record)

  File "C:\Python311\Lib\logging\__init__.py", line 1032, in handleError
    traceback.print_exception(t, v, tb, None, sys.stderr)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 787, in __init__
    context = TracebackException(
              ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:

RecursionError: maximum recursion depth exceeded while calling a Python object


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Python311\Lib\logging\handlers.py", line 73, in emit
    if self.shouldRollover(record):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\handlers.py", line 196, in shouldRollover
    msg = "%s\n" % self.format(record)
                   ^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\logging\__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)

  File "C:\Python311\Lib\traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 728, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\traceback.py", line 433, in _extract_from_extended_frame_gen
    f.line

  File "C:\Python311\Lib\traceback.py", line 318, in line
    self._line = linecache.getline(self.filename, self.lineno)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 30, in getline
    lines = getlines(filename, module_globals)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 46, in getlines
    return updatecache(filename, module_globals)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "C:\Python311\Lib\linecache.py", line 136, in updatecache
    with tokenize.open(fullname) as fp:

RecursionError: maximum recursion depth exceeded while calling a Python object

Call stack:

  File "<string>", line 1, in <module>

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 135, in main
    code = real_pytest.main(argv)

  [Previous line repeated 971 more times]

  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.py", line 143, in main
    logger.exception("pytest run failed with unexpected error")

Message: 'pytest run failed with unexpected error'
Arguments: ()


===== pytest run 2025-12-18 01:34:00 args=['-vv', '--maxfail=5', 'tests'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 548 items / 4 skipped



tests/test_animation.py::test_animation_manager_initialization 
PASSED    [  0%]


tests/test_animation.py::test_property_animation 
PASSED                  [  0%]


tests/test_animation.py::test_custom_animation 
PASSED                    [  0%]


tests/test_animation.py::test_animation_pause_resume 
PASSED              [  0%]


tests/test_animation.py::test_animation_cancel 
PASSED                    [  0%]


tests/test_animation.py::test_easing_curves 
PASSED                       [  1%]


tests/test_animation.py::test_animation_with_delay 
PASSED                [  1%]


tests/test_animation.py::test_multiple_animations 
PASSED                 [  1%]


tests/test_animation.py::test_cancel_all_animations 
PASSED               [  1%]


tests/test_animation.py::test_animation_manager_auto_stop 
PASSED         [  1%]


tests/test_animation.py::test_animation_manager_emits_perf_metrics 
PASSED [  2%]


tests/test_animation_set_target_fps.py::test_set_target_fps_updates_timer_interval 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_creation 
PASSED       [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_runs_and_labels 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_cleanup 
PASSED        [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_invalid_pixmap 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_set_flip_duration 
PASSED [  3%]


tests/test_block_puzzle_flip.py::test_block_puzzle_randomization 
PASSED  [  3%]


tests/test_block_puzzle_flip.py::test_block_puzzle_small_widget 
PASSED   [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug1_clock_widget_created 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug2_set_text_color_method_exists 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug3_color_array_to_qcolor_conversion 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug4_z_order_clock_on_top 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug5_settings_retrieval_no_crash 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug6_boolean_type_conversion 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug7_position_string_to_enum 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug8_format_string_to_enum 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug9_missing_raise_call 
PASSED [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_visibility_after_setup 
PASSED [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_size_and_position 
PASSED [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_settings_complete_integration 
PASSED [  5%]


tests/test_clock_widget.py::test_time_format_enum 
PASSED                 [  5%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED              [  6%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                   [  6%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                 [  6%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                    [  6%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                 [  6%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                 [  6%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED            [  7%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED               [  7%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED            [  7%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED           [  7%]


tests/test_clock_widget.py::test_clock_all_positions 
PASSED              [  7%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED               [  8%]


tests/test_clock_widget.py::test_clock_set_font_size 
PASSED              [  8%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED             [  8%]


tests/test_clock_widget.py::test_clock_set_margin 
PASSED                 [  8%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                    [  8%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED [  8%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED          [  9%]


tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup 
FAILED [  9%]


tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget 
FAILED [  9%]


tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777349] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777347] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777346] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777330] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777328] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777329] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out 
FAILED [ 11%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens 
FAILED [ 11%]


tests/test_diffuse_transition.py::test_diffuse_creation 
PASSED           [ 11%]


tests/test_diffuse_transition.py::test_diffuse_start_no_old_image 
PASSED [ 11%]


tests/test_diffuse_transition.py::test_diffuse_start_with_images 
PASSED  [ 11%]


tests/test_diffuse_transition.py::test_diffuse_signals 
PASSED            [ 12%]


tests/test_diffuse_transition.py::test_diffuse_progress_range 
PASSED     [ 12%]


tests/test_diffuse_transition.py::test_diffuse_stop 
PASSED               [ 12%]


tests/test_diffuse_transition.py::test_diffuse_grid_creation 
PASSED      [ 12%]


tests/test_diffuse_transition.py::test_diffuse_cleanup 
FAILED            [ 12%]




================================== FAILURES ===================================

_____________ test_context_menu_invalidates_effects_before_popup ______________



qt_app = <PySide6.QtWidgets.QApplication(0x223407f0ff0) at 0x000002237064C080>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000223707C2A50>

settings_manager = <core.settings.settings_manager.SettingsManager(0x22340e921d0) at 0x00000223707C0FC0>

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002237080DC10>



    @pytest.mark.qt

    def test_context_menu_invalidates_effects_before_popup(qt_app, qtbot, settings_manager, monkeypatch):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        qtbot.addWidget(widget)

        widget.resize(640, 360)

    

        dummy = QWidget(widget)

        dummy.resize(20, 20)

        dummy.show()

    

        eff = QGraphicsDropShadowEffect(dummy)

        dummy.setGraphicsEffect(eff)

    

        events: List[Tuple[str, object]] = []

    

        orig_invalidate = widget._invalidate_overlay_effects  # type: ignore[attr-defined]

    

        def _spy_invalidate(reason: str) -> None:

            events.append(("invalidate", reason))

            orig_invalidate(reason)

    

        monkeypatch.setattr(widget, "_invalidate_overlay_effects", _spy_invalidate)

    

        last_popup_menu: List[object] = []

    

        def _spy_popup(self, pos):  # type: ignore[no-untyped-def]

            last_popup_menu.clear()

            last_popup_menu.append(self)

            events.append(("popup", pos))

            assert any(e[0] == "invalidate" for e in events)

    

        monkeypatch.setattr(ScreensaverContextMenu, "popup", _spy_popup)

    

        widget.clock_widget = dummy  # type: ignore[assignment]

    

        effect_ids: List[int] = []

    

        for i in range(25):

            events.clear()

            widget._show_context_menu(QPoint(10 + i, 10))  # type: ignore[attr-defined]

            qt_app.processEvents()

            assert events

    

            try:

                active_eff = dummy.graphicsEffect()

            except Exception:

                active_eff = None

            assert isinstance(active_eff, QGraphicsDropShadowEffect)

            effect_ids.append(id(active_eff))

    

>           invalidate_idx = next(idx for idx, e in enumerate(events) if e[0] == "invalidate")

                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           StopIteration



tests\test_context_menu_effect_invalidation.py:64: StopIteration

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:862 All settings cleared

_____________ test_ctrl_held_suppresses_mouse_exit_single_widget ______________



qt_app = <PySide6.QtWidgets.QApplication(0x223407f0ff0) at 0x000002237064C080>

settings_manager = <core.settings.settings_manager.SettingsManager(0x22340e92510) at 0x0000022370B7C9C0>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000022370B7EA90>



    @pytest.mark.qt

    def test_ctrl_held_suppresses_mouse_exit_single_widget(qt_app, settings_manager, qtbot):

        """Holding Ctrl prevents mouse movement/click from exiting for one widget."""

        # Disable hard_exit mode so clicks can trigger exit after Ctrl release

        settings_manager.set("input.hard_exit", False)

    

        widget = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        qtbot.addWidget(widget)

        widget.resize(400, 300)

        widget.show()

    

        exits = []

        widget.exit_requested.connect(lambda: exits.append("exit"))

    

        # Press Ctrl and move the mouse around  no exit should be emitted.

        QTest.keyPress(widget, Qt.Key.Key_Control)

        QTest.mouseMove(widget, widget.rect().center())

        QTest.mouseMove(widget, widget.rect().center() + QPoint(50, 0))

        QTest.mouseClick(widget, Qt.MouseButton.LeftButton)

        qt_app.processEvents()

    

        assert exits == []

    

        # Release Ctrl  mouse click should now cause an exit.

        QTest.keyRelease(widget, Qt.Key.Key_Control)

        QTest.mouseClick(widget, Qt.MouseButton.LeftButton)

        qt_app.processEvents()

    

>       assert exits == ["exit"]

E       AssertionError: assert [] == ['exit']

E         

E         Right contains one more item: 'exit'

E         

E         Full diff:

E         + []

E         - [

E         -     'exit',

E         - ]



tests\test_ctrl_interaction_mode.py:49: AssertionError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:862 All settings cleared

_______________________ test_ctrl_halo_fades_in_and_out _______________________



qt_app = <PySide6.QtWidgets.QApplication(0x223407f0ff0) at 0x000002237064C080>

settings_manager = <core.settings.settings_manager.SettingsManager(0x22340cc0660) at 0x0000022374AC2780>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000022374AD3ED0>



    @pytest.mark.qt

    def test_ctrl_halo_fades_in_and_out(qt_app, settings_manager, qtbot):

        """Ctrl halo should fade in on press and fade out on release.

    

        This test probes the internal halo widget to ensure that the opacity

        animation is wired correctly; the visual verification is manual, but

        this guards against regressions in the timing/animation plumbing.

        """

        widget = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        qtbot.addWidget(widget)

        widget.resize(400, 300)

        widget.show()

    

        # Press Ctrl to summon the halo and start fade-in.

        QTest.keyPress(widget, Qt.Key.Key_Control)

        qt_app.processEvents()

        QTest.qWait(100)

        qt_app.processEvents()

    

        hint = getattr(widget, "_ctrl_cursor_hint", None)

        assert hint is not None

        # During or shortly after fade-in, opacity should be >0.

        opacity_during = float(getattr(hint, "_opacity", 0.0))

        assert 0.0 <= opacity_during <= 1.0

    

        # Let fade-in complete and then release Ctrl to start fade-out.

        QTest.qWait(600)

        qt_app.processEvents()

        QTest.keyRelease(widget, Qt.Key.Key_Control)

        qt_app.processEvents()

    

        # Wait longer than the 1200ms fade-out duration.

        QTest.qWait(1400)

        qt_app.processEvents()

    

        # After fade-out, the halo should either be hidden or effectively transparent.

        hint_after = getattr(widget, "_ctrl_cursor_hint", None)

        assert hint_after is not None

        if hint_after.isVisible():

            opacity_after = float(getattr(hint_after, "_opacity", 1.0))

>           assert opacity_after <= 0.1

E           assert 1.0 <= 0.1



tests\test_ctrl_interaction_mode.py:190: AssertionError

---------------------------- Captured Qt messages -----------------------------

QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)


---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:862 All settings cleared

________________ test_ctrl_halo_owner_migrates_between_screens ________________



qt_app = <PySide6.QtWidgets.QApplication(0x223407f0ff0) at 0x000002237064C080>

settings_manager = <core.settings.settings_manager.SettingsManager(0x22340a086e0) at 0x0000022374ACBD40>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000223707AA4D0>

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x0000022374AD3D90>



    @pytest.mark.qt

    def test_ctrl_halo_owner_migrates_between_screens(qt_app, settings_manager, qtbot, monkeypatch):

        """Ctrl halo ownership should migrate between DisplayWidgets by QScreen.

    

        This exercises the global Ctrl halo logic in DisplayWidget.eventFilter by

        mocking QCursor.pos and QGuiApplication.screenAt so that the halo moves

        from one DisplayWidget (screen 0) to another (screen 1) when the cursor is

        reported on a different QScreen.

        """

    

        # Two widgets representing different screens.

        w0 = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        w1 = DisplayWidget(

            screen_index=1,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        for w in (w0, w1):

            qtbot.addWidget(w)

            w.resize(400, 300)

            w.show()

    

        # Assign synthetic QScreen-like identities so that the eventFilter can

        # distinguish screens without relying on the host environment.

        screen0 = object()

        screen1 = object()

        w0._screen = screen0  # type: ignore[attr-defined]

        w1._screen = screen1  # type: ignore[attr-defined]

    

        # Start with Ctrl held and the halo owned by w0.

        from rendering import display_widget as display_mod

    

        display_mod.DisplayWidget._global_ctrl_held = True  # type: ignore[attr-defined]

        display_mod.DisplayWidget._halo_owner = w0  # type: ignore[attr-defined]

        # Ensure w0 has a visible halo before migration.

        w0._show_ctrl_cursor_hint(QPoint(10, 10), mode="fade_in")  # type: ignore[attr-defined]

        qt_app.processEvents()

    

        # Mock global cursor and QScreen mapping so the cursor moves to screen1.

        monkeypatch.setattr(

            display_mod.QCursor,  # type: ignore[attr-defined]

            "pos",

            staticmethod(lambda: QPoint(100, 100)),

        )

    

        def _fake_screen_at(pos):  # noqa: ARG001

            return screen1

    

        monkeypatch.setattr(

            display_mod.QGuiApplication,  # type: ignore[attr-defined]

            "screenAt",

            staticmethod(_fake_screen_at),

        )

    

        # Feed a synthetic mouse-move event through w0's eventFilter. The global

        # filter logic should notice the screen change and migrate the halo owner

        # from w0 to w1.

        event = QMouseEvent(

            QEvent.Type.MouseMove,

            QPoint(50, 50),

            Qt.MouseButton.NoButton,

            Qt.MouseButton.NoButton,

            Qt.KeyboardModifier.NoModifier,

        )

    

        w0.eventFilter(w0, event)

        qt_app.processEvents()

    

        # After migration, the global owner should be w1, w0's halo should be

        # hidden, and w1's halo should be visible.

>       assert display_mod.DisplayWidget._halo_owner is w1  # type: ignore[attr-defined]

        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E       AssertionError: assert <rendering.display_widget.DisplayWidget(0x22340bda0a0) at 0x0000022370A5F5C0> is <rendering.display_widget.DisplayWidget(0x22340bdb240) at 0x0000022374AC9300>

E        +  where <rendering.display_widget.DisplayWidget(0x22340bda0a0) at 0x0000022370A5F5C0> = <class 'rendering.display_widget.DisplayWidget'>._halo_owner

E        +    where <class 'rendering.display_widget.DisplayWidget'> = <module 'rendering.display_widget' from 'F:\\Programming\\Apps\\ShittyRandomPhotoScreenSaver\\rendering\\display_widget.py'>.DisplayWidget



tests\test_ctrl_interaction_mode.py:267: AssertionError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:862 All settings cleared

____________________________ test_diffuse_cleanup _____________________________



qapp = <PySide6.QtWidgets.QApplication(0x223407f0ff0) at 0x000002237064C080>

test_widget = <PySide6.QtWidgets.QWidget(0x22340bdeba0) at 0x0000022374B04B00>

test_pixmap = <PySide6.QtGui.QPixmap(QSize(400, 300),depth=32,devicePixelRatio=1,cacheKey=0xc700000001) at 0x0000022374B079C0>

test_pixmap2 = <PySide6.QtGui.QPixmap(QSize(400, 300),depth=32,devicePixelRatio=1,cacheKey=0xc800000001) at 0x0000022374B0C0C0>



    def test_diffuse_cleanup(qapp, test_widget, test_pixmap, test_pixmap2):

        """Test diffuse transition cleanup."""

        transition = DiffuseTransition(duration_ms=200, block_size=8)

    

        transition.start(test_pixmap, test_pixmap2, test_widget)

        transition.stop()

        transition.cleanup()

    

        assert transition._old_label is None

        assert transition._new_label is None

>       assert transition._timer is None

               ^^^^^^^^^^^^^^^^^

E       AttributeError: 'DiffuseTransition' object has no attribute '_timer'



tests\test_diffuse_transition.py:143: AttributeError

============================== warnings summary ===============================

tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\input_handler.py:575: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    pos = event.pos()




tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2299: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    logger.info(f"Mouse clicked at ({event.pos().x()}, {event.pos().y()}), requesting exit")




tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_ctrl_interaction_mode.py:254: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

=========================== short test summary info ===========================

FAILED tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup - StopIteration

FAILED tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget - AssertionError: assert [] == ['exit']
  
  Right contains one more item: 'exit'
  
  Full diff:
  + []
  - [
  -     'exit',
  - ]


FAILED tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out - assert 1.0 <= 0.1

FAILED tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens - AssertionError: assert <rendering.display_widget.DisplayWidget(0x22340bda0a0) at 0x0000022370A5F5C0> is <rendering.display_widget.DisplayWidget(0x22340bdb240) at 0x0000022374AC9300>
 +  where <rendering.display_widget.DisplayWidget(0x22340bda0a0) at 0x0000022370A5F5C0> = <class 'rendering.display_widget.DisplayWidget'>._halo_owner
 +    where <class 'rendering.display_widget.DisplayWidget'> = <module 'rendering.display_widget' from 'F:\\Programming\\Apps\\ShittyRandomPhotoScreenSaver\\rendering\\display_widget.py'>.DisplayWidget


FAILED tests/test_diffuse_transition.py::test_diffuse_cleanup - AttributeError: 'DiffuseTransition' object has no attribute '_timer'

!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 5 failures !!!!!!!!!!!!!!!!!!!!!!!!!!

============ 5 failed, 65 passed, 4 skipped, 6 warnings in 13.60s =============


===== pytest run 2025-12-18 01:37:38 args=['-vv', '--maxfail=5', 'tests'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 548 items / 4 skipped



tests/test_animation.py::test_animation_manager_initialization 
PASSED    [  0%]


tests/test_animation.py::test_property_animation 
PASSED                  [  0%]


tests/test_animation.py::test_custom_animation 
PASSED                    [  0%]


tests/test_animation.py::test_animation_pause_resume 
PASSED              [  0%]


tests/test_animation.py::test_animation_cancel 
PASSED                    [  0%]


tests/test_animation.py::test_easing_curves 
PASSED                       [  1%]


tests/test_animation.py::test_animation_with_delay 
PASSED                [  1%]


tests/test_animation.py::test_multiple_animations 
PASSED                 [  1%]


tests/test_animation.py::test_cancel_all_animations 
PASSED               [  1%]


tests/test_animation.py::test_animation_manager_auto_stop 
PASSED         [  1%]


tests/test_animation.py::test_animation_manager_emits_perf_metrics 
PASSED [  2%]


tests/test_animation_set_target_fps.py::test_set_target_fps_updates_timer_interval 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_creation 
PASSED       [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_runs_and_labels 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_cleanup 
PASSED        [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_invalid_pixmap 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_set_flip_duration 
PASSED [  3%]


tests/test_block_puzzle_flip.py::test_block_puzzle_randomization 
PASSED  [  3%]


tests/test_block_puzzle_flip.py::test_block_puzzle_small_widget 
PASSED   [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug1_clock_widget_created 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug2_set_text_color_method_exists 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug3_color_array_to_qcolor_conversion 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug4_z_order_clock_on_top 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug5_settings_retrieval_no_crash 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug6_boolean_type_conversion 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug7_position_string_to_enum 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug8_format_string_to_enum 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug9_missing_raise_call 
PASSED [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_visibility_after_setup 
PASSED [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_size_and_position 
PASSED [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_settings_complete_integration 
PASSED [  5%]


tests/test_clock_widget.py::test_time_format_enum 
PASSED                 [  5%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED              [  6%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                   [  6%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                 [  6%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                    [  6%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                 [  6%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                 [  6%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED            [  7%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED               [  7%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED            [  7%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED           [  7%]


tests/test_clock_widget.py::test_clock_all_positions 
PASSED              [  7%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED               [  8%]


tests/test_clock_widget.py::test_clock_set_font_size 
PASSED              [  8%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED             [  8%]


tests/test_clock_widget.py::test_clock_set_margin 
PASSED                 [  8%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                    [  8%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED [  8%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED          [  9%]


tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup 
FAILED [  9%]


tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget 
FAILED [  9%]


tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777349] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777347] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777346] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777330] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777328] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777329] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out 
FAILED [ 11%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens 
FAILED [ 11%]


tests/test_diffuse_transition.py::test_diffuse_creation 
PASSED           [ 11%]


tests/test_diffuse_transition.py::test_diffuse_start_no_old_image 
PASSED [ 11%]


tests/test_diffuse_transition.py::test_diffuse_start_with_images 
PASSED  [ 11%]


tests/test_diffuse_transition.py::test_diffuse_signals 
PASSED            [ 12%]


tests/test_diffuse_transition.py::test_diffuse_progress_range 
PASSED     [ 12%]


tests/test_diffuse_transition.py::test_diffuse_stop 
PASSED               [ 12%]


tests/test_diffuse_transition.py::test_diffuse_grid_creation 
PASSED      [ 12%]


tests/test_diffuse_transition.py::test_diffuse_cleanup 
FAILED            [ 12%]




================================== FAILURES ===================================

_____________ test_context_menu_invalidates_effects_before_popup ______________



qt_app = <PySide6.QtWidgets.QApplication(0x19e29c38f80) at 0x0000019E59D85E00>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000019E59C27750>

settings_manager = <core.settings.settings_manager.SettingsManager(0x19e2a0c3460) at 0x0000019E59C254C0>

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x0000019E59FB89D0>



    @pytest.mark.qt

    def test_context_menu_invalidates_effects_before_popup(qt_app, qtbot, settings_manager, monkeypatch):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        qtbot.addWidget(widget)

        widget.resize(640, 360)

    

        dummy = QWidget(widget)

        dummy.resize(20, 20)

        dummy.show()

    

        eff = QGraphicsDropShadowEffect(dummy)

        dummy.setGraphicsEffect(eff)

    

        events: List[Tuple[str, object]] = []

    

        orig_invalidate = widget._invalidate_overlay_effects  # type: ignore[attr-defined]

    

        def _spy_invalidate(reason: str) -> None:

            events.append(("invalidate", reason))

            orig_invalidate(reason)

    

        monkeypatch.setattr(widget, "_invalidate_overlay_effects", _spy_invalidate)

    

        last_popup_menu: List[object] = []

    

        def _spy_popup(self, pos):  # type: ignore[no-untyped-def]

            last_popup_menu.clear()

            last_popup_menu.append(self)

            events.append(("popup", pos))

            assert any(e[0] == "invalidate" for e in events)

    

        monkeypatch.setattr(ScreensaverContextMenu, "popup", _spy_popup)

    

        widget.clock_widget = dummy  # type: ignore[assignment]

    

        effect_ids: List[int] = []

    

        for i in range(25):

            events.clear()

            widget._show_context_menu(QPoint(10 + i, 10))  # type: ignore[attr-defined]

            qt_app.processEvents()

            assert events

    

            try:

                active_eff = dummy.graphicsEffect()

            except Exception:

                active_eff = None

            assert isinstance(active_eff, QGraphicsDropShadowEffect)

            effect_ids.append(id(active_eff))

    

>           invalidate_idx = next(idx for idx, e in enumerate(events) if e[0] == "invalidate")

                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           StopIteration



tests\test_context_menu_effect_invalidation.py:64: StopIteration

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:862 All settings cleared

_____________ test_ctrl_held_suppresses_mouse_exit_single_widget ______________



qt_app = <PySide6.QtWidgets.QApplication(0x19e29c38f80) at 0x0000019E59D85E00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x19e2a0c3f60) at 0x0000019E5A157480>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000019E5A154E90>



    @pytest.mark.qt

    def test_ctrl_held_suppresses_mouse_exit_single_widget(qt_app, settings_manager, qtbot):

        """Holding Ctrl prevents mouse movement/click from exiting for one widget."""

        # Disable hard_exit mode so clicks can trigger exit after Ctrl release

        settings_manager.set("input.hard_exit", False)

    

        widget = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        qtbot.addWidget(widget)

        widget.resize(400, 300)

        widget.show()

    

        exits = []

        widget.exit_requested.connect(lambda: exits.append("exit"))

    

        # Press Ctrl and move the mouse around  no exit should be emitted.

        QTest.keyPress(widget, Qt.Key.Key_Control)

        QTest.mouseMove(widget, widget.rect().center())

        QTest.mouseMove(widget, widget.rect().center() + QPoint(50, 0))

        QTest.mouseClick(widget, Qt.MouseButton.LeftButton)

        qt_app.processEvents()

    

        assert exits == []

    

        # Release Ctrl  mouse click should now cause an exit.

        QTest.keyRelease(widget, Qt.Key.Key_Control)

        QTest.mouseClick(widget, Qt.MouseButton.LeftButton)

        qt_app.processEvents()

    

>       assert exits == ["exit"]

E       AssertionError: assert [] == ['exit']

E         

E         Right contains one more item: 'exit'

E         

E         Full diff:

E         + []

E         - [

E         -     'exit',

E         - ]



tests\test_ctrl_interaction_mode.py:49: AssertionError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:862 All settings cleared

_______________________ test_ctrl_halo_fades_in_and_out _______________________



qt_app = <PySide6.QtWidgets.QApplication(0x19e29c38f80) at 0x0000019E59D85E00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x19e5a8291c0) at 0x0000019E5DD0E540>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000019E5A1A5690>



    @pytest.mark.qt

    def test_ctrl_halo_fades_in_and_out(qt_app, settings_manager, qtbot):

        """Ctrl halo should fade in on press and fade out on release.

    

        This test probes the internal halo widget to ensure that the opacity

        animation is wired correctly; the visual verification is manual, but

        this guards against regressions in the timing/animation plumbing.

        """

        widget = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        qtbot.addWidget(widget)

        widget.resize(400, 300)

        widget.show()

    

        # Press Ctrl to summon the halo and start fade-in.

        QTest.keyPress(widget, Qt.Key.Key_Control)

        qt_app.processEvents()

        QTest.qWait(100)

        qt_app.processEvents()

    

        hint = getattr(widget, "_ctrl_cursor_hint", None)

        assert hint is not None

        # During or shortly after fade-in, opacity should be >0.

        opacity_during = float(getattr(hint, "_opacity", 0.0))

        assert 0.0 <= opacity_during <= 1.0

    

        # Let fade-in complete and then release Ctrl to start fade-out.

        QTest.qWait(600)

        qt_app.processEvents()

        QTest.keyRelease(widget, Qt.Key.Key_Control)

        qt_app.processEvents()

    

        # Wait longer than the 1200ms fade-out duration.

        QTest.qWait(1400)

        qt_app.processEvents()

    

        # After fade-out, the halo should either be hidden or effectively transparent.

        hint_after = getattr(widget, "_ctrl_cursor_hint", None)

        assert hint_after is not None

        if hint_after.isVisible():

            opacity_after = float(getattr(hint_after, "_opacity", 1.0))

>           assert opacity_after <= 0.1

E           assert 1.0 <= 0.1



tests\test_ctrl_interaction_mode.py:190: AssertionError

---------------------------- Captured Qt messages -----------------------------

QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)


---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:862 All settings cleared

________________ test_ctrl_halo_owner_migrates_between_screens ________________



qt_app = <PySide6.QtWidgets.QApplication(0x19e29c38f80) at 0x0000019E59D85E00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x19e2a2cc8d0) at 0x0000019E5A145D80>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000019E5A016410>

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x0000019E5DD17DD0>



    @pytest.mark.qt

    def test_ctrl_halo_owner_migrates_between_screens(qt_app, settings_manager, qtbot, monkeypatch):

        """Ctrl halo ownership should migrate between DisplayWidgets by QScreen.

    

        This exercises the global Ctrl halo logic in DisplayWidget.eventFilter by

        mocking QCursor.pos and QGuiApplication.screenAt so that the halo moves

        from one DisplayWidget (screen 0) to another (screen 1) when the cursor is

        reported on a different QScreen.

        """

    

        # Two widgets representing different screens.

        w0 = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        w1 = DisplayWidget(

            screen_index=1,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        for w in (w0, w1):

            qtbot.addWidget(w)

            w.resize(400, 300)

            w.show()

    

        # Assign synthetic QScreen-like identities so that the eventFilter can

        # distinguish screens without relying on the host environment.

        screen0 = object()

        screen1 = object()

        w0._screen = screen0  # type: ignore[attr-defined]

        w1._screen = screen1  # type: ignore[attr-defined]

    

        # Start with Ctrl held and the halo owned by w0.

        from rendering import display_widget as display_mod

    

        display_mod.DisplayWidget._global_ctrl_held = True  # type: ignore[attr-defined]

        display_mod.DisplayWidget._halo_owner = w0  # type: ignore[attr-defined]

        # Ensure w0 has a visible halo before migration.

        w0._show_ctrl_cursor_hint(QPoint(10, 10), mode="fade_in")  # type: ignore[attr-defined]

        qt_app.processEvents()

    

        # Mock global cursor and QScreen mapping so the cursor moves to screen1.

        monkeypatch.setattr(

            display_mod.QCursor,  # type: ignore[attr-defined]

            "pos",

            staticmethod(lambda: QPoint(100, 100)),

        )

    

        def _fake_screen_at(pos):  # noqa: ARG001

            return screen1

    

        monkeypatch.setattr(

            display_mod.QGuiApplication,  # type: ignore[attr-defined]

            "screenAt",

            staticmethod(_fake_screen_at),

        )

    

        # Feed a synthetic mouse-move event through w0's eventFilter. The global

        # filter logic should notice the screen change and migrate the halo owner

        # from w0 to w1.

        event = QMouseEvent(

            QEvent.Type.MouseMove,

            QPoint(50, 50),

            Qt.MouseButton.NoButton,

            Qt.MouseButton.NoButton,

            Qt.KeyboardModifier.NoModifier,

        )

    

        w0.eventFilter(w0, event)

        qt_app.processEvents()

    

        # After migration, the global owner should be w1, w0's halo should be

        # hidden, and w1's halo should be visible.

>       assert display_mod.DisplayWidget._halo_owner is w1  # type: ignore[attr-defined]

        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E       AssertionError: assert <rendering.display_widget.DisplayWidget(0x19e2a0bdf60) at 0x0000019E5DD17C80> is <rendering.display_widget.DisplayWidget(0x19e2a0bdba0) at 0x0000019E5DD10840>

E        +  where <rendering.display_widget.DisplayWidget(0x19e2a0bdf60) at 0x0000019E5DD17C80> = <class 'rendering.display_widget.DisplayWidget'>._halo_owner

E        +    where <class 'rendering.display_widget.DisplayWidget'> = <module 'rendering.display_widget' from 'F:\\Programming\\Apps\\ShittyRandomPhotoScreenSaver\\rendering\\display_widget.py'>.DisplayWidget



tests\test_ctrl_interaction_mode.py:267: AssertionError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:862 All settings cleared

____________________________ test_diffuse_cleanup _____________________________



qapp = <PySide6.QtWidgets.QApplication(0x19e29c38f80) at 0x0000019E59D85E00>

test_widget = <PySide6.QtWidgets.QWidget(0x19e2a262780) at 0x0000019E5DD51400>

test_pixmap = <PySide6.QtGui.QPixmap(QSize(400, 300),depth=32,devicePixelRatio=1,cacheKey=0xcb00000001) at 0x0000019E5DD51100>

test_pixmap2 = <PySide6.QtGui.QPixmap(QSize(400, 300),depth=32,devicePixelRatio=1,cacheKey=0xcc00000001) at 0x0000019E5DD51780>



    def test_diffuse_cleanup(qapp, test_widget, test_pixmap, test_pixmap2):

        """Test diffuse transition cleanup."""

        transition = DiffuseTransition(duration_ms=200, block_size=8)

    

        transition.start(test_pixmap, test_pixmap2, test_widget)

        transition.stop()

        transition.cleanup()

    

        assert transition._old_label is None

        assert transition._new_label is None

>       assert transition._timer is None

               ^^^^^^^^^^^^^^^^^

E       AttributeError: 'DiffuseTransition' object has no attribute '_timer'



tests\test_diffuse_transition.py:143: AttributeError

============================== warnings summary ===============================

tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\input_handler.py:575: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    pos = event.pos()




tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2328: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    self._initial_mouse_pos = event.pos()




tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2299: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    logger.info(f"Mouse clicked at ({event.pos().x()}, {event.pos().y()}), requesting exit")




tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_ctrl_interaction_mode.py:254: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

=========================== short test summary info ===========================

FAILED tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup - StopIteration

FAILED tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget - AssertionError: assert [] == ['exit']
  
  Right contains one more item: 'exit'
  
  Full diff:
  + []
  - [
  -     'exit',
  - ]


FAILED tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out - assert 1.0 <= 0.1

FAILED tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens - AssertionError: assert <rendering.display_widget.DisplayWidget(0x19e2a0bdf60) at 0x0000019E5DD17C80> is <rendering.display_widget.DisplayWidget(0x19e2a0bdba0) at 0x0000019E5DD10840>
 +  where <rendering.display_widget.DisplayWidget(0x19e2a0bdf60) at 0x0000019E5DD17C80> = <class 'rendering.display_widget.DisplayWidget'>._halo_owner
 +    where <class 'rendering.display_widget.DisplayWidget'> = <module 'rendering.display_widget' from 'F:\\Programming\\Apps\\ShittyRandomPhotoScreenSaver\\rendering\\display_widget.py'>.DisplayWidget


FAILED tests/test_diffuse_transition.py::test_diffuse_cleanup - AttributeError: 'DiffuseTransition' object has no attribute '_timer'

!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 5 failures !!!!!!!!!!!!!!!!!!!!!!!!!!

============ 5 failed, 65 passed, 4 skipped, 7 warnings in 13.15s =============


===== pytest run 2025-12-18 01:44:17 args=['--version'] =====

pytest 8.4.1


===== pytest run 2025-12-18 01:50:20 args=['-vv', '--maxfail=1', 'tests/test_settings.py'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 9 items



tests/test_settings.py::test_settings_manager_initialization 
PASSED                                                                                                                                  [ 11%]


tests/test_settings.py::test_get_set_setting 
PASSED                                                                                                                                                  [ 22%]


tests/test_settings.py::test_default_values 
PASSED                                                                                                                                                   [ 33%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED                                                                                                                            [ 44%]


tests/test_settings.py::test_on_changed_handler 
PASSED                                                                                                                                               [ 55%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                                                                                                                                                [ 66%]


tests/test_settings.py::test_get_all_keys 
PASSED                                                                                                                                                     [ 77%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED                                                                                                                                          [ 88%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED                                                                                                                          [100%]




============================================================================================ 9 passed in 0.19s ============================================================================================


===== pytest run 2025-12-18 01:58:46 args=['-vv', '--maxfail=5', 'tests/test_events.py', 'tests/test_resources.py', 'tests/test_settings.py', 'tests/test_threading.py'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 28 items



tests/test_events.py::test_event_system_initialization 
PASSED            [  3%]


tests/test_events.py::test_subscribe_and_publish 
PASSED                  [  7%]


tests/test_events.py::test_unsubscribe 
PASSED                            [ 10%]


tests/test_events.py::test_priority_ordering 
PASSED                      [ 14%]


tests/test_events.py::test_event_filter 
PASSED                           [ 17%]


tests/test_events.py::test_event_history 
FAILED                          [ 21%]


tests/test_resources.py::test_resource_manager_initialization 
PASSED     [ 25%]


tests/test_resources.py::test_register_resource 
PASSED                   [ 28%]


tests/test_resources.py::test_unregister_resource 
PASSED                 [ 32%]


tests/test_resources.py::test_register_temp_file 
PASSED                  [ 35%]


tests/test_resources.py::test_get_all_resources 
PASSED                   [ 39%]


tests/test_resources.py::test_get_stats 
PASSED                           [ 42%]


tests/test_settings.py::test_settings_manager_initialization 
PASSED      [ 46%]


tests/test_settings.py::test_get_set_setting 
PASSED                      [ 50%]


tests/test_settings.py::test_default_values 
PASSED                       [ 53%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED [ 57%]


tests/test_settings.py::test_on_changed_handler 
PASSED                   [ 60%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                    [ 64%]


tests/test_settings.py::test_get_all_keys 
PASSED                         [ 67%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED              [ 71%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED [ 75%]


tests/test_threading.py::test_thread_manager_initialization 
PASSED       [ 78%]


tests/test_threading.py::test_submit_io_task 
PASSED                      [ 82%]


tests/test_threading.py::test_submit_compute_task 
PASSED                 [ 85%]


tests/test_threading.py::test_get_pool_stats 
PASSED                      [ 89%]


tests/test_threading.py::test_thread_manager_shutdown 
PASSED             [ 92%]


tests/test_threading.py::test_run_on_ui_thread_from_ui_thread 
PASSED     [ 96%]


tests/test_threading.py::test_run_on_ui_thread_from_worker_thread 
PASSED [100%]




================================== FAILURES ===================================

_____________________________ test_event_history ______________________________



    def test_event_history():

        """Test event history tracking."""

        system = EventSystem()

    

        # Publish some events

        system.publish("event.1", data="first")

        system.publish("event.2", data="second")

        system.publish("event.3", data="third")

    

>       history = system.get_event_history(limit=10)

                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^



tests\test_events.py:130: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <core.events.event_system.EventSystem object at 0x0000025E39790350>

limit = 10



    def get_event_history(self, limit: int = 100) -> List[Event]:

        """

        Get recent event history.

    

        Args:

            limit: Maximum number of events to return

    

        Returns:

            List of recent events

        """

        with self._lock:

>           return self._event_history[-limit:]

                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           TypeError: sequence index must be integer, not 'slice'



core\events\event_system.py:201: TypeError

=========================== short test summary info ===========================

FAILED tests/test_events.py::test_event_history - TypeError: sequence index must be integer, not 'slice'

======================== 1 failed, 27 passed in 0.68s =========================


===== pytest run 2025-12-18 07:53:22 args=['tests/test_settings_sync.py', '-v'] =====

=============================================================================================================================================== test session starts ===============================================================================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 7 items



tests/test_settings_sync.py::TestSettingsCriticalSync::test_transitions_key_triggers_sync 
PASSED                                                                                                                                                                                                             [ 14%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_widgets_key_triggers_sync 
PASSED                                                                                                                                                                                                                 [ 28%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_sources_folders_triggers_sync 
PASSED                                                                                                                                                                                                             [ 42%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_display_key_triggers_sync 
PASSED                                                                                                                                                                                                                 [ 57%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_non_critical_key_no_sync 
PASSED                                                                                                                                                                                                                  [ 71%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_critical_keys_list_complete 
PASSED                                                                                                                                                                                                               [ 85%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_nested_critical_key_triggers_sync 
PASSED                                                                                                                                                                                                         [100%]




================================================================================================================================================ 7 passed in 0.15s ================================================================================================================================================


===== pytest run 2025-12-18 07:57:23 args=['tests/test_settings_sync.py', '-v'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 7 items



tests/test_settings_sync.py::TestSettingsCriticalSync::test_transitions_key_triggers_sync 
PASSED [ 14%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_widgets_key_triggers_sync 
PASSED [ 28%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_sources_folders_triggers_sync 
PASSED [ 42%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_display_key_triggers_sync 
PASSED [ 57%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_non_critical_key_no_sync 
PASSED [ 71%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_critical_keys_list_complete 
PASSED [ 85%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_nested_critical_key_triggers_sync 
PASSED [100%]




============================== 7 passed in 0.09s ==============================


===== pytest run 2025-12-18 07:57:29 args=['tests/test_settings_sync.py'] =====

=============================================================================================================================================== test session starts ===============================================================================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 7 items



tests\test_settings_sync.py 
.
.
.
.
.
.
.
                                                                                                                                                                                                                                                                          [100%]




================================================================================================================================================ 7 passed in 0.10s ================================================================================================================================================


===== pytest run 2025-12-18 08:01:29 args=['tests/test_settings_sync.py', '-v'] =====

=============================================================================================================================================== test session starts ===============================================================================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 7 items



tests/test_settings_sync.py::TestSettingsCriticalSync::test_transitions_key_triggers_sync 
PASSED                                                                                                                                                                                                             [ 14%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_widgets_key_triggers_sync 
PASSED                                                                                                                                                                                                                 [ 28%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_sources_folders_triggers_sync 
PASSED                                                                                                                                                                                                             [ 42%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_display_key_triggers_sync 
PASSED                                                                                                                                                                                                                 [ 57%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_non_critical_key_no_sync 
PASSED                                                                                                                                                                                                                  [ 71%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_critical_keys_list_complete 
PASSED                                                                                                                                                                                                               [ 85%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_nested_critical_key_triggers_sync 
PASSED                                                                                                                                                                                                         [100%]




================================================================================================================================================ 7 passed in 0.12s ================================================================================================================================================


===== pytest run 2025-12-18 09:07:19 args=['tests/test_transitions_tab.py', 'tests/test_settings.py', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 11 items



tests/test_transitions_tab.py::test_slide_and_wipe_directions_are_independent 
PASSED                                                                                                                 [  9%]


tests/test_transitions_tab.py::test_default_transition_type_and_direction 
PASSED                                                                                                                     [ 18%]


tests/test_settings.py::test_settings_manager_initialization 
PASSED                                                                                                                                  [ 27%]


tests/test_settings.py::test_get_set_setting 
PASSED                                                                                                                                                  [ 36%]


tests/test_settings.py::test_default_values 
PASSED                                                                                                                                                   [ 45%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED                                                                                                                            [ 54%]


tests/test_settings.py::test_on_changed_handler 
PASSED                                                                                                                                               [ 63%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                                                                                                                                                [ 72%]


tests/test_settings.py::test_get_all_keys 
PASSED                                                                                                                                                     [ 81%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED                                                                                                                                          [ 90%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED                                                                                                                          [100%]




=========================================================================================== 11 passed in 0.90s ============================================================================================


===== pytest run 2025-12-18 09:35:55 args=['tests/test_settings.py', 'tests/test_transitions_tab.py', 'tests/test_settings_sync.py', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 18 items



tests/test_settings.py::test_settings_manager_initialization 
PASSED                                                                                                                                  [  5%]


tests/test_settings.py::test_get_set_setting 
PASSED                                                                                                                                                  [ 11%]


tests/test_settings.py::test_default_values 
PASSED                                                                                                                                                   [ 16%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED                                                                                                                            [ 22%]


tests/test_settings.py::test_on_changed_handler 
PASSED                                                                                                                                               [ 27%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                                                                                                                                                [ 33%]


tests/test_settings.py::test_get_all_keys 
PASSED                                                                                                                                                     [ 38%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED                                                                                                                                          [ 44%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED                                                                                                                          [ 50%]


tests/test_transitions_tab.py::test_slide_and_wipe_directions_are_independent 
PASSED                                                                                                                 [ 55%]


tests/test_transitions_tab.py::test_default_transition_type_and_direction 
PASSED                                                                                                                     [ 61%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_transitions_key_triggers_sync 
PASSED                                                                                                     [ 66%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_widgets_key_triggers_sync 
PASSED                                                                                                         [ 72%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_sources_folders_triggers_sync 
PASSED                                                                                                     [ 77%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_display_key_triggers_sync 
PASSED                                                                                                         [ 83%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_non_critical_key_no_sync 
PASSED                                                                                                          [ 88%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_critical_keys_list_complete 
PASSED                                                                                                       [ 94%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_nested_critical_key_triggers_sync 
PASSED                                                                                                 [100%]




=========================================================================================== 18 passed in 0.58s ============================================================================================


===== pytest run 2025-12-18 09:48:59 args=[] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 566 items / 4 skipped



archive\gmail_feature\test_gmail_widget.py 
F
F
F
F
F
F
F
F
F
F
F
                   [  1%]


tests\test_animation.py 
.
.
.
.
.
.
.
.
.
.
.
                                      [  3%]


tests\test_animation_set_target_fps.py 
.
                                 [  4%]


tests\test_block_puzzle_flip.py 
.
.
.
.
.
.
.
                                  [  5%]


tests\test_clock_integration_regression.py 
.
.
.
.
.
.
.
.
.
.
.
.
                  [  7%]


tests\test_clock_widget.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                           [ 10%]


tests\test_context_menu_effect_invalidation.py 
.
                         [ 10%]


tests\test_ctrl_interaction_mode.py 
.
.
.
.
.
.
.
.
.
.
.
                          [ 12%]


tests\test_diffuse_transition.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
                           [ 15%]


tests\test_dimming_and_interaction_fixes.py 
.
.
.
.
.
.
.
.
.
.
.
.
                 [ 17%]


tests\test_display_tab.py 
.
.
.
.
.
.
.
.
.
.
F
.
.
.
                                 [ 19%]


tests\test_engine_lifecycle.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                      [ 23%]


tests\test_events.py 
.
.
.
.
.
.
                                              [ 24%]


tests\test_flicker_fix_integration.py 
.
.
F
.
.
.
.
                            [ 25%]


tests\test_frame_timing_workload.py 
.
.
                                   [ 25%]


tests\test_gl_compositor_blinds.py 

===== pytest run 2025-12-18 10:22:03 args=['tests/', '--ignore=tests/test_gl_compositor_blinds.py', '--ignore=tests/test_gl_transitions.py', '-v'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 554 items / 4 skipped



tests/test_animation.py::test_animation_manager_initialization 
PASSED    [  0%]


tests/test_animation.py::test_property_animation 
PASSED                  [  0%]


tests/test_animation.py::test_custom_animation 
PASSED                    [  0%]


tests/test_animation.py::test_animation_pause_resume 
PASSED              [  0%]


tests/test_animation.py::test_animation_cancel 
PASSED                    [  0%]


tests/test_animation.py::test_easing_curves 
PASSED                       [  1%]


tests/test_animation.py::test_animation_with_delay 
PASSED                [  1%]


tests/test_animation.py::test_multiple_animations 
PASSED                 [  1%]


tests/test_animation.py::test_cancel_all_animations 
PASSED               [  1%]


tests/test_animation.py::test_animation_manager_auto_stop 
PASSED         [  1%]


tests/test_animation.py::test_animation_manager_emits_perf_metrics 
PASSED [  1%]


tests/test_animation_set_target_fps.py::test_set_target_fps_updates_timer_interval 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_creation 
PASSED       [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_runs_and_labels 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_cleanup 
PASSED        [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_invalid_pixmap 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_set_flip_duration 
PASSED [  3%]


tests/test_block_puzzle_flip.py::test_block_puzzle_randomization 
PASSED  [  3%]


tests/test_block_puzzle_flip.py::test_block_puzzle_small_widget 
PASSED   [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug1_clock_widget_created 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug2_set_text_color_method_exists 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug3_color_array_to_qcolor_conversion 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug4_z_order_clock_on_top 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug5_settings_retrieval_no_crash 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug6_boolean_type_conversion 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug7_position_string_to_enum 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug8_format_string_to_enum 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug9_missing_raise_call 
PASSED [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_visibility_after_setup 
PASSED [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_size_and_position 
PASSED [  5%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_settings_complete_integration 
PASSED [  5%]


tests/test_clock_widget.py::test_time_format_enum 
PASSED                 [  5%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED              [  5%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                   [  6%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                 [  6%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                    [  6%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                 [  6%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                 [  6%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED            [  7%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED               [  7%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED            [  7%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED           [  7%]


tests/test_clock_widget.py::test_clock_all_positions 
PASSED              [  7%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED               [  7%]


tests/test_clock_widget.py::test_clock_set_font_size 
PASSED              [  8%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED             [  8%]


tests/test_clock_widget.py::test_clock_set_margin 
PASSED                 [  8%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                    [  8%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED [  8%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED          [  9%]


tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777349] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777347] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777346] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777330] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777328] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777329] 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out 
PASSED [ 11%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens 
PASSED [ 11%]


tests/test_diffuse_transition.py::test_diffuse_creation 
PASSED           [ 11%]


tests/test_diffuse_transition.py::test_diffuse_start_no_old_image 
PASSED [ 11%]


tests/test_diffuse_transition.py::test_diffuse_start_with_images 
PASSED  [ 11%]


tests/test_diffuse_transition.py::test_diffuse_signals 
PASSED            [ 11%]


tests/test_diffuse_transition.py::test_diffuse_progress_range 
PASSED     [ 12%]


tests/test_diffuse_transition.py::test_diffuse_stop 
PASSED               [ 12%]


tests/test_diffuse_transition.py::test_diffuse_grid_creation 
PASSED      [ 12%]


tests/test_diffuse_transition.py::test_diffuse_cleanup 
PASSED            [ 12%]


tests/test_diffuse_transition.py::test_diffuse_invalid_pixmap 
PASSED     [ 12%]


tests/test_diffuse_transition.py::test_diffuse_already_running 
PASSED    [ 12%]


tests/test_diffuse_transition.py::test_diffuse_block_size 
PASSED         [ 13%]


tests/test_diffuse_transition.py::test_diffuse_small_widget 
PASSED       [ 13%]


tests/test_diffuse_transition.py::test_diffuse_randomization 
PASSED      [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayAttributes::test_dimming_overlay_uses_translucent_background 
PASSED [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayAttributes::test_dimming_overlay_opacity_calculation 
PASSED [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayAttributes::test_dimming_overlay_opacity_clamping 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestCtrlHaloAttributes::test_halo_code_uses_translucent_background 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestMediaWidgetClickDetection::test_click_detection_checks_y_coordinate 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestMediaWidgetClickDetection::test_controls_row_height_is_reasonable 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestCrumbleShaderPerformance::test_crumble_search_range_is_reduced 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestSettingsDotNotation::test_dimming_settings_use_dot_notation 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestSettingsDotNotation::test_pixel_shift_settings_use_dot_notation 
PASSED [ 15%]


tests/test_dimming_and_interaction_fixes.py::TestSettingsDotNotation::test_context_menu_dimming_uses_dot_notation 
PASSED [ 15%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayZOrder::test_raise_overlay_includes_dimming 
PASSED [ 15%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayZOrder::test_raise_overlay_zorder_documented 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_creation 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_loads_settings 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_saves_monitor_selection 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_saves_display_mode 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_saves_timing 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_boolean_conversion 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_lanczos_setting 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_sharpen_setting 
PASSED [ 17%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_same_image_monitors 
PASSED [ 17%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_all_settings_persist 
PASSED [ 17%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_default_values 
FAILED [ 17%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_invalid_mode_handling 
PASSED [ 17%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_invalid_interval_handling 
PASSED [ 18%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_ui_elements_exist 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestEngineState::test_engine_state_enum_values 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestEngineState::test_initial_state_is_uninitialized 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestEngineState::test_running_property_false_when_not_running 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestEngineState::test_running_property_true_when_running 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestEngineState::test_initialized_property 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_false_in_running 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_false_in_reinitializing 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_true_in_stopping 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_true_in_shutting_down 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_false_in_other_states 
PASSED [ 20%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_transition_state_success 
PASSED [ 20%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_transition_state_invalid_source 
PASSED [ 20%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_transition_from_shutting_down_blocked 
PASSED [ 20%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_transition_without_expected_from 
PASSED [ 20%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_is_state_check 
PASSED [ 20%]


tests/test_engine_lifecycle.py::TestStateTransitionThreadSafety::test_concurrent_state_reads 
PASSED [ 21%]


tests/test_engine_lifecycle.py::TestStateTransitionThreadSafety::test_concurrent_state_transitions 
PASSED [ 21%]


tests/test_engine_lifecycle.py::TestRSSReloadBugScenario::test_settings_change_does_not_abort_rss 
PASSED [ 21%]


tests/test_engine_lifecycle.py::TestRSSReloadBugScenario::test_actual_shutdown_aborts_rss 
PASSED [ 21%]


tests/test_engine_lifecycle.py::TestGetStats::test_get_stats_includes_state 
PASSED [ 21%]


tests/test_events.py::test_event_system_initialization 
PASSED            [ 22%]


tests/test_events.py::test_subscribe_and_publish 
PASSED                  [ 22%]


tests/test_events.py::test_unsubscribe 
PASSED                            [ 22%]


tests/test_events.py::test_priority_ordering 
PASSED                      [ 22%]


tests/test_events.py::test_event_filter 
PASSED                           [ 22%]


tests/test_events.py::test_event_history 
PASSED                          [ 22%]


tests/test_flicker_fix_integration.py::TestQtAllocationLimit::test_allocation_limit_increased 
PASSED [ 23%]


tests/test_flicker_fix_integration.py::TestQtAllocationLimit::test_large_image_can_be_allocated 
PASSED [ 23%]


tests/test_flicker_fix_integration.py::TestTransitionTelemetryFlow::test_transition_tracks_timing 
FAILED [ 23%]


tests/test_flicker_fix_integration.py::TestMultiDisplaySyncFlow::test_sync_queue_lifecycle 
PASSED [ 23%]


tests/test_flicker_fix_integration.py::TestMultiDisplaySyncFlow::test_sync_timeout_handling 
PASSED [ 23%]


tests/test_flicker_fix_integration.py::TestRegressionPrevention::test_no_process_events_in_transitions 
PASSED [ 24%]


tests/test_flicker_fix_integration.py::TestRegressionPrevention::test_showfullscreen_not_deferred 
PASSED [ 24%]


tests/test_frame_timing_workload.py::TestFrameTimingWorkload::test_slide_with_visualizer_load 
PASSED [ 24%]


tests/test_frame_timing_workload.py::TestFrameTimingWorkload::test_sustained_workload 
PASSED [ 24%]


tests/test_gl_compositor_blockflip.py::test_gl_compositor_blockflip_no_underlay_and_no_black 
PASSED [ 24%]


tests/test_gl_compositor_blockspin.py::test_gl_compositor_blockspin_no_underlay_and_no_black 
PASSED [ 24%]


tests/test_gl_compositor_cleanup.py::test_gl_compositor_cleanup_idempotent_without_context 
PASSED [ 25%]


tests/test_gl_compositor_cleanup.py::test_gl_compositor_cleanup_releases_pipeline_when_gl_available 
PASSED [ 25%]


tests/test_gl_compositor_crossfade.py::test_gl_compositor_crossfade_no_underlay_and_no_black 
PASSED [ 25%]


tests/test_gl_compositor_diffuse.py::test_gl_compositor_diffuse_no_underlay_and_no_black 
PASSED [ 25%]


tests/test_gl_compositor_peel.py::test_gl_compositor_peel_no_underlay_and_no_black 
PASSED [ 25%]


tests/test_gl_compositor_raindrops.py::test_gl_compositor_raindrops_no_underlay_and_no_black 
PASSED [ 25%]


tests/test_gl_compositor_slide.py::test_gl_compositor_slide_no_underlay_and_no_black 
PASSED [ 26%]


tests/test_gl_compositor_wipe.py::test_gl_compositor_wipe_no_underlay_and_no_black[WipeDirection.LEFT_TO_RIGHT] 
PASSED [ 26%]


tests/test_gl_compositor_wipe.py::test_gl_compositor_wipe_no_underlay_and_no_black[WipeDirection.RIGHT_TO_LEFT] 
PASSED [ 26%]


tests/test_gl_compositor_wipe.py::test_gl_compositor_wipe_no_underlay_and_no_black[WipeDirection.TOP_TO_BOTTOM] 
PASSED [ 26%]


tests/test_gl_compositor_wipe.py::test_gl_compositor_wipe_no_underlay_and_no_black[WipeDirection.BOTTOM_TO_TOP] 
PASSED [ 26%]


tests/test_gl_compositor_wipe.py::test_gl_compositor_wipe_no_underlay_and_no_black[WipeDirection.DIAG_TL_BR] 
PASSED [ 27%]


tests/test_gl_compositor_wipe.py::test_gl_compositor_wipe_no_underlay_and_no_black[WipeDirection.DIAG_TR_BL] 
PASSED [ 27%]


tests/test_gl_prewarm.py::test_gl_prewarm_overlays_ready 
PASSED          [ 27%]


tests/test_image_processor.py::test_fill_mode_wider_image 
PASSED         [ 27%]


tests/test_image_processor.py::test_fill_mode_taller_image 
PASSED        [ 27%]


tests/test_image_processor.py::test_fill_mode_small_image 
PASSED         [ 27%]


tests/test_image_processor.py::test_fit_mode_landscape 
PASSED            [ 28%]


tests/test_image_processor.py::test_fit_mode_portrait 
PASSED             [ 28%]


tests/test_image_processor.py::test_shrink_mode_large_image 
PASSED       [ 28%]


tests/test_image_processor.py::test_shrink_mode_small_image 
PASSED       [ 28%]


tests/test_image_processor.py::test_null_image_fallback 
PASSED           [ 28%]


tests/test_image_processor.py::test_square_image_fill 
PASSED             [ 29%]


tests/test_image_processor.py::test_aspect_ratio_preservation_fit 
PASSED [ 29%]


tests/test_image_processor.py::test_calculate_scale_factors_fill 
PASSED  [ 29%]


tests/test_image_processor.py::test_calculate_scale_factors_fit 
PASSED   [ 29%]


tests/test_image_processor.py::test_calculate_scale_factors_shrink_no_scaling 
PASSED [ 29%]


tests/test_image_processor.py::test_calculate_scale_factors_shrink_with_scaling 
PASSED [ 29%]


tests/test_image_processor.py::test_get_crop_rect 
PASSED                 [ 30%]


tests/test_image_processor.py::test_display_mode_from_string 
PASSED      [ 30%]


tests/test_image_processor.py::test_display_mode_from_string_invalid 
PASSED [ 30%]


tests/test_image_processor.py::test_display_mode_str 
PASSED              [ 30%]


tests/test_image_processor.py::test_qimage_sync_matches_pixmap[fill] 
PASSED [ 30%]


tests/test_image_processor.py::test_qimage_sync_matches_pixmap[fit] 
PASSED [ 31%]


tests/test_image_processor.py::test_qimage_sync_matches_pixmap[shrink] 
PASSED [ 31%]


tests/test_image_processor.py::test_qimage_async_matches_sync[fill] 
PASSED [ 31%]


tests/test_image_processor.py::test_qimage_async_matches_sync[fit] 
PASSED [ 31%]


tests/test_image_processor.py::test_qimage_async_matches_sync[shrink] 
PASSED [ 31%]


tests/test_image_queue.py::test_image_queue_initialization 
PASSED        [ 31%]


tests/test_image_queue.py::test_add_images_no_shuffle 
PASSED             [ 32%]


tests/test_image_queue.py::test_add_images_with_shuffle 
PASSED           [ 32%]


tests/test_image_queue.py::test_next_image 
PASSED                        [ 32%]


tests/test_image_queue.py::test_next_multiple_images 
PASSED              [ 32%]


tests/test_image_queue.py::test_queue_wraparound 
PASSED                  [ 32%]


tests/test_image_queue.py::test_current_image 
PASSED                     [ 33%]


tests/test_image_queue.py::test_peek_next_image 
PASSED                   [ 33%]


tests/test_image_queue.py::test_history_tracking 
PASSED                  [ 33%]


tests/test_image_queue.py::test_history_max_size 
PASSED                  [ 33%]


tests/test_image_queue.py::test_is_in_recent_history 
PASSED              [ 33%]


tests/test_image_queue.py::test_shuffle_method 
PASSED                    [ 33%]


tests/test_image_queue.py::test_set_shuffle_enabled 
PASSED               [ 34%]


tests/test_image_queue.py::test_clear_queue 
PASSED                       [ 34%]


tests/test_image_queue.py::test_set_images_replaces_all 
PASSED           [ 34%]


tests/test_image_queue.py::test_remove_image 
PASSED                      [ 34%]


tests/test_image_queue.py::test_remove_nonexistent_image 
PASSED          [ 34%]


tests/test_image_queue.py::test_get_stats 
PASSED                         [ 35%]


tests/test_image_queue.py::test_empty_queue_behavior 
PASSED              [ 35%]


tests/test_image_queue.py::test_queue_len_and_bool 
PASSED                [ 35%]


tests/test_image_queue.py::test_queue_repr 
PASSED                        [ 35%]


tests/test_image_queue.py::test_previous_image 
PASSED                    [ 35%]


tests/test_image_queue.py::test_previous_with_no_history 
PASSED          [ 35%]


tests/test_image_queue.py::test_wraparound_preserves_shuffle 
PASSED      [ 36%]


tests/test_integration.py::test_engine_creation 
PASSED                   [ 36%]


tests/test_integration.py::test_engine_initialization 
PASSED             [ 36%]


tests/test_integration.py::test_engine_core_systems 
PASSED               [ 36%]


tests/test_integration.py::test_engine_image_queue_initialization 
PASSED [ 36%]


tests/test_integration.py::test_engine_display_initialization 
PASSED     [ 37%]


tests/test_integration.py::test_engine_start_stop 
PASSED                 [ 37%]


tests/test_integration.py::test_engine_signals 
PASSED                    [ 37%]


tests/test_integration.py::test_engine_rotation_timer 
PASSED             [ 37%]


tests/test_integration.py::test_engine_get_stats 
PASSED                  [ 37%]


tests/test_integration.py::test_engine_cleanup 
PASSED                    [ 37%]


tests/test_integration.py::test_engine_without_initialization 
PASSED     [ 38%]


tests/test_integration.py::test_engine_default_rss_sources 
PASSED        [ 38%]


tests/test_integration.py::test_engine_settings_integration 
PASSED       [ 38%]


tests/test_integration.py::test_engine_multiple_start_calls 
PASSED       [ 38%]


tests/test_integration.py::test_engine_stop_without_start 
PASSED         [ 38%]


tests/test_integration_settings.py::test_sources_tab_folder_persistence 
PASSED [ 38%]


tests/test_integration_settings.py::test_sources_tab_rss_persistence 
PASSED [ 39%]


tests/test_integration_settings.py::test_settings_dialog_full_workflow 
PASSED [ 39%]


tests/test_integration_settings.py::test_nested_dict_does_not_work 
PASSED [ 39%]


tests/test_integration_settings.py::test_settings_load_on_startup 
PASSED [ 39%]


tests/test_integration_settings.py::TestEngineSettingsIntegration::test_sources_changed_triggers_reinitialize 
PASSED [ 39%]


tests/test_integration_settings.py::TestEngineSettingsIntegration::test_engine_state_during_settings_change 
PASSED [ 40%]


tests/test_integration_settings.py::TestEngineSettingsIntegration::test_just_make_it_work_clears_cache 
PASSED [ 40%]


tests/test_integration_settings.py::TestEngineSettingsIntegration::test_add_rss_feed_triggers_source_reinit 
PASSED [ 40%]


tests/test_integration_settings.py::TestEngineSettingsIntegration::test_remove_folder_triggers_queue_rebuild 
PASSED [ 40%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_downscaling 
PASSED [ 40%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_bug10_no_image_tripling 
PASSED [ 40%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_with_alpha_channel 
PASSED [ 41%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_with_sharpening 
PASSED [ 41%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_fallback_when_lanczos_disabled 
PASSED [ 41%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_fallback_when_pil_unavailable 
SKIPPED [ 41%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_fill_mode 
PASSED [ 41%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_fit_mode 
PASSED [ 42%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_shrink_mode_downscale 
PASSED [ 42%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_shrink_mode_no_upscale 
PASSED [ 42%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_aspect_ratio_preserved 
PASSED [ 42%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_null_image_handling 
PASSED [ 42%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_aggressive_downscale 
PASSED [ 42%]


tests/test_logging_console_encoding.py::test_console_handler_replaces_unencodable_characters_narrow_encodings[cp1252] 
PASSED [ 43%]


tests/test_logging_console_encoding.py::test_console_handler_replaces_unencodable_characters_narrow_encodings[latin-1] 
PASSED [ 43%]


tests/test_logging_console_encoding.py::test_console_handler_preserves_unicode_on_utf8_console 
PASSED [ 43%]


tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED [ 43%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED [ 43%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED [ 44%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED [ 44%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED [ 44%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
PASSED [ 44%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
FAILED   [ 44%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
FAILED [ 44%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
FAILED [ 45%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED [ 45%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED [ 45%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED [ 45%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED [ 45%]


tests/test_multidisplay_sync.py::TestDisplayManagerSync::test_sync_disabled_by_default 
PASSED [ 46%]


tests/test_multidisplay_sync.py::TestDisplayManagerSync::test_enable_sync_creates_queue 
PASSED [ 46%]


tests/test_multidisplay_sync.py::TestDisplayManagerSync::test_disable_sync_clears_queue 
PASSED [ 46%]


tests/test_multidisplay_sync.py::TestDisplayManagerSync::test_sync_not_enabled_for_single_display 
PASSED [ 46%]


tests/test_multidisplay_sync.py::TestSPSCQueueSync::test_ready_signal_queuing 
PASSED [ 46%]


tests/test_multidisplay_sync.py::TestSPSCQueueSync::test_wait_for_all_displays_success 
PASSED [ 46%]


tests/test_multidisplay_sync.py::TestSPSCQueueSync::test_wait_for_all_displays_timeout 
PASSED [ 47%]


tests/test_multidisplay_sync.py::TestSPSCQueueSync::test_wait_returns_true_when_sync_disabled 
PASSED [ 47%]


tests/test_multidisplay_sync.py::TestSPSCQueueSync::test_wait_returns_true_for_single_display 
PASSED [ 47%]


tests/test_multidisplay_sync.py::TestSynchronizedTransition::test_show_image_synchronized_falls_back_when_disabled 
PASSED [ 47%]


tests/test_multidisplay_sync.py::TestSynchronizedTransition::test_show_image_synchronized_clears_queue 
PASSED [ 47%]


tests/test_multidisplay_sync.py::TestQueueOverflow::test_queue_rejects_when_full 
PASSED [ 48%]


tests/test_multidisplay_sync.py::TestQueueOverflow::test_display_manager_logs_queue_full 
PASSED [ 48%]


tests/test_multidisplay_sync.py::TestConcurrentReadySignals::test_no_duplicate_ready_signals 
PASSED [ 48%]


tests/test_multidisplay_sync.py::TestPerformanceMetrics::test_sync_overhead_minimal 
PASSED [ 48%]


tests/test_overlay_ready_state.py::TestSWCrossfadeOverlayReady::test_sw_overlay_not_ready_before_paint 
PASSED [ 48%]


tests/test_overlay_ready_state.py::TestSWCrossfadeOverlayReady::test_sw_overlay_ready_after_paint 
PASSED [ 48%]


tests/test_overlay_ready_state.py::TestOverlayManagerReady::test_any_overlay_ready_returns_false_when_none_visible 
PASSED [ 49%]


tests/test_overlay_ready_state.py::TestOverlayManagerReady::test_display_widget_retains_previous_pixmap_on_clear 
PASSED [ 49%]


tests/test_overlay_ready_state.py::TestDisplayWidgetOverlayDiagnostics::test_notify_overlay_ready_tracks_counts 
PASSED [ 49%]


tests/test_overlay_ready_state.py::TestDisplayWidgetOverlayDiagnostics::test_handle_screen_change_updates_geometry_and_dpi 
FAILED [ 49%]


tests/test_overlay_timers.py::test_overlay_timer_uses_thread_manager_when_available 
PASSED [ 49%]


tests/test_overlay_timers.py::test_overlay_timer_falls_back_to_qtimer_without_thread_manager 
PASSED [ 50%]


tests/test_painter_shadow.py::TestShadowConfig::test_default_values 
PASSED [ 50%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_empty 
PASSED [ 50%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_none 
PASSED [ 50%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_disabled 
PASSED [ 50%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string 
FAILED [ 50%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_blur_radius 
PASSED [ 51%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_offset 
PASSED [ 51%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_color_list 
PASSED [ 51%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_color_qcolor 
PASSED [ 51%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_opacity 
PASSED [ 51%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_miss_on_empty 
PASSED [ 51%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_hit_after_set 
PASSED [ 52%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_miss_on_size_change 
PASSED [ 52%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_miss_on_config_change 
PASSED [ 52%]


tests/test_painter_shadow.py::TestShadowCache::test_invalidate_clears_cache 
PASSED [ 52%]


tests/test_painter_shadow.py::TestGlobalShadowCache::test_get_shadow_cache_creates_new 
PASSED [ 52%]


tests/test_painter_shadow.py::TestGlobalShadowCache::test_get_shadow_cache_returns_same 
PASSED [ 53%]


tests/test_painter_shadow.py::TestGlobalShadowCache::test_clear_shadow_cache_removes 
PASSED [ 53%]


tests/test_painter_shadow.py::TestPainterShadow::test_render_shadow_pixmap_creates_image 
PASSED [ 53%]


tests/test_painter_shadow.py::TestPainterShadow::test_render_shadow_pixmap_with_corner_radius 
PASSED [ 53%]


tests/test_painter_shadow.py::TestPainterShadow::test_render_shadow_pixmap_empty_size 
PASSED [ 53%]


tests/test_painter_shadow.py::TestPainterShadow::test_apply_blur_returns_image 
PASSED [ 53%]


tests/test_painter_shadow.py::TestPainterShadow::test_apply_blur_zero_radius 
PASSED [ 54%]


tests/test_painter_shadow.py::TestShadowConfigHash::test_same_config_same_hash 
PASSED [ 54%]


tests/test_painter_shadow.py::TestShadowConfigHash::test_different_blur_different_hash 
PASSED [ 54%]


tests/test_painter_shadow.py::TestShadowConfigHash::test_different_offset_different_hash 
PASSED [ 54%]


tests/test_pan_scan_integration.py::test_pan_scan_stopped_before_transition 
SKIPPED [ 54%]


tests/test_pan_scan_integration.py::test_diffuse_with_pan_scan 
SKIPPED   [ 55%]


tests/test_pan_scan_integration.py::test_block_puzzle_with_pan_scan 
SKIPPED [ 55%]


tests/test_pan_scan_integration.py::test_transition_uses_pan_preview_frame 
SKIPPED [ 55%]


tests/test_pan_scan_integration.py::test_wipe_with_pan_scan 
SKIPPED      [ 55%]


tests/test_pan_scan_integration.py::test_crossfade_duration 
PASSED       [ 55%]


tests/test_pan_scan_integration.py::test_pan_scan_cleanup_between_images 
SKIPPED [ 55%]


tests/test_pan_scan_integration.py::test_all_transitions_with_pan_scan 
SKIPPED [ 56%]


tests/test_particle_transition.py::TestParticleProgram::test_particle_program_import 
PASSED [ 56%]


tests/test_particle_transition.py::TestParticleProgram::test_particle_program_instantiation 
PASSED [ 56%]


tests/test_particle_transition.py::TestParticleProgram::test_particle_program_has_vertex_source 
PASSED [ 56%]


tests/test_particle_transition.py::TestParticleProgram::test_particle_program_has_fragment_source 
PASSED [ 56%]


tests/test_particle_transition.py::TestParticleProgram::test_particle_program_uniform_names 
PASSED [ 57%]


tests/test_particle_transition.py::TestParticleState::test_particle_state_import 
PASSED [ 57%]


tests/test_particle_transition.py::TestParticleState::test_particle_state_creation 
PASSED [ 57%]


tests/test_particle_transition.py::TestParticleState::test_particle_state_with_values 
PASSED [ 57%]


tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_import 
PASSED [ 57%]


tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_creation 
FAILED [ 57%]


tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_modes 
FAILED [ 58%]


tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_directions 
FAILED [ 58%]


tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_swirl_orders 
FAILED [ 58%]


tests/test_particle_transition.py::TestTransitionFactory::test_factory_import 
PASSED [ 58%]


tests/test_particle_transition.py::TestSettingsDefaults::test_settings_manager_has_particle_defaults 
FAILED [ 58%]


tests/test_particle_transition.py::TestSettingsDefaults::test_settings_manager_has_particle_in_pool 
PASSED [ 59%]


tests/test_perf_dt_max.py::TestPerfDtMax::test_visualizer_dt_max_with_transitions 
PASSED [ 59%]


tests/test_perf_dt_max.py::TestPerfDtMax::test_sustained_visualizer_load 
PASSED [ 59%]


tests/test_phase_e_effect_corruption.py::TestPhaseEEffectCorruption::test_effect_state_before_menu_open 
PASSED [ 59%]


tests/test_phase_e_effect_corruption.py::TestPhaseEEffectCorruption::test_effect_state_after_menu_open_same_display 
PASSED [ 59%]


tests/test_phase_e_effect_corruption.py::TestPhaseEEffectCorruption::test_cross_display_activation_cascade 
PASSED [ 59%]


tests/test_phase_e_effect_corruption.py::TestPhaseEEffectCorruption::test_wm_mouseactivate_handler_exists 
PASSED [ 60%]


tests/test_phase_e_effect_corruption.py::TestPhaseEEffectCorruption::test_single_focus_window_policy 
PASSED [ 60%]


tests/test_phase_e_effect_corruption.py::TestPhaseEEffectCorruption::test_effect_invalidation_on_menu_close 
PASSED [ 60%]


tests/test_phase_e_effect_corruption.py::TestPhaseEReproductionSequence::test_reddit_click_display_0_sequence 
PASSED [ 60%]


tests/test_phase_e_effect_corruption.py::TestPhaseEReproductionSequence::test_reddit_click_display_1_sequence 
PASSED [ 60%]


tests/test_phase_e_effect_corruption.py::TestPhaseEReproductionSequence::test_context_menu_display_1_corrupts_display_0 
PASSED [ 61%]


tests/test_phase_e_effect_corruption.py::TestPhaseEReproductionSequence::test_context_menu_display_0_is_safe 
PASSED [ 61%]


tests/test_phase_e_effect_corruption.py::TestPhaseEMitigation::test_effect_recreation_clears_corruption 
PASSED [ 61%]


tests/test_phase_e_effect_corruption.py::TestPhaseEMitigation::test_ma_noactivate_prevents_activation 
PASSED [ 61%]


tests/test_phase_e_effect_corruption.py::TestPhaseEMitigation::test_swp_noactivate_in_windowpos 
PASSED [ 61%]


tests/test_phase_e_effect_corruption.py::TestPhaseEDiagnostics::test_log_effect_state_changes 
PASSED [ 61%]


tests/test_phase_e_effect_corruption.py::TestPhaseEDiagnostics::test_log_native_events 
PASSED [ 62%]


tests/test_phase_e_effect_corruption.py::TestPhaseEDiagnostics::test_detect_effect_corruption 
PASSED [ 62%]


tests/test_phase_e_effect_corruption.py::TestPhaseEIntegration::test_qgraphicsdropshadoweffect_creation 
PASSED [ 62%]


tests/test_phase_e_effect_corruption.py::TestPhaseEIntegration::test_effect_toggle_invalidation 
PASSED [ 62%]


tests/test_phase_e_effect_corruption.py::TestPhaseEIntegration::test_effect_recreation 
PASSED [ 62%]


tests/test_qt_timer_threading.py::test_overlay_timer_stop_is_safe_from_other_threads 
PASSED [ 62%]


tests/test_reddit_exit_logic.py::TestRedditExitLogic::test_primary_covered_detection_same_screen 
PASSED [ 63%]


tests/test_reddit_exit_logic.py::TestRedditExitLogic::test_primary_covered_detection_different_screen 
PASSED [ 63%]


tests/test_reddit_exit_logic.py::TestRedditExitLogic::test_mc_mode_detection 
PASSED [ 63%]


tests/test_reddit_exit_logic.py::TestRedditClickRouting::test_reddit_click_returns_handled_tuple 
FAILED [ 63%]


tests/test_reddit_exit_logic.py::TestCacheInvalidationMitigation::test_no_setforegroundwindow_before_exit 
PASSED [ 63%]


tests/test_reddit_exit_logic.py::TestRedditExitIntegration::test_case_a_hard_exit_primary_covered 
SKIPPED [ 64%]


tests/test_reddit_exit_logic.py::TestRedditExitIntegration::test_case_b_ctrl_held_primary_covered 
SKIPPED [ 64%]


tests/test_reddit_exit_logic.py::TestRedditExitIntegration::test_case_c_mc_mode_stay_open 
SKIPPED [ 64%]


tests/test_reddit_widget.py::test_reddit_filters_daily_weekly_question_threads 
PASSED [ 64%]


tests/test_reddit_widget.py::test_reddit_format_age_variants 
PASSED      [ 64%]


tests/test_reddit_widget.py::test_reddit_error_hides_before_first_success 
PASSED [ 64%]


tests/test_reddit_widget.py::test_reddit_handle_click_row_opens_url 
PASSED [ 65%]


tests/test_reddit_widget.py::test_reddit_handle_click_header_opens_subreddit 
PASSED [ 65%]


tests/test_rendering_backends.py::test_opengl_backend_falls_back_to_software 
PASSED [ 65%]


tests/test_rendering_backends.py::test_explicit_software_backend_selection 
PASSED [ 65%]


tests/test_rendering_backends.py::test_backend_diagnostics_counters 
PASSED [ 65%]


tests/test_rendering_backends.py::test_unknown_backend_normalizes_to_opengl 
PASSED [ 66%]


tests/test_resource_pooling.py::TestPixmapPooling::test_acquire_returns_none_when_empty 
PASSED [ 66%]


tests/test_resource_pooling.py::TestPixmapPooling::test_release_and_acquire 
PASSED [ 66%]


tests/test_resource_pooling.py::TestPixmapPooling::test_pool_size_limit 
PASSED [ 66%]


tests/test_resource_pooling.py::TestPixmapPooling::test_pool_stats_tracking 
PASSED [ 66%]


tests/test_resource_pooling.py::TestPixmapPooling::test_different_sizes_separate_buckets 
PASSED [ 66%]


tests/test_resource_pooling.py::TestImagePooling::test_acquire_returns_none_when_empty 
PASSED [ 67%]


tests/test_resource_pooling.py::TestImagePooling::test_release_and_acquire 
PASSED [ 67%]


tests/test_resource_pooling.py::TestPoolCleanup::test_clear_pools 
PASSED [ 67%]


tests/test_resource_pooling.py::TestPoolCleanup::test_shutdown_clears_pools 
PASSED [ 67%]


tests/test_resources.py::test_resource_manager_initialization 
PASSED     [ 67%]


tests/test_resources.py::test_register_resource 
PASSED                   [ 68%]


tests/test_resources.py::test_unregister_resource 
PASSED                 [ 68%]


tests/test_resources.py::test_register_temp_file 
PASSED                  [ 68%]


tests/test_resources.py::test_get_all_resources 
PASSED                   [ 68%]


tests/test_resources.py::test_get_stats 
PASSED                           [ 68%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_source_fetches_from_multiple_feeds 
PASSED [ 68%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_source_tracks_cached_urls 
PASSED [ 69%]


tests/test_rss_behavior.py::TestRSSBehavior::test_image_queue_rotates_rss_images 
PASSED [ 69%]


tests/test_rss_behavior.py::TestRSSBehavior::test_image_queue_history_prevents_duplicates 
FAILED [ 69%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_refresh_adds_new_images_only 
PASSED [ 69%]


tests/test_rss_behavior.py::TestRSSIntegration::test_real_reddit_feed 
SKIPPED [ 69%]


tests/test_rss_behavior.py::TestRSSIntegration::test_rate_limiting_behavior 
SKIPPED [ 70%]


tests/test_s_hotkey_workflow.py::test_s_hotkey_opens_settings_without_crash 
PASSED [ 70%]


tests/test_s_hotkey_workflow.py::test_display_initialized_flag_lifecycle 
PASSED [ 70%]


tests/test_s_hotkey_workflow.py::test_engine_has_required_attributes 
PASSED [ 70%]


tests/test_s_hotkey_workflow.py::test_settings_requested_handler_doesnt_crash_on_stop 
PASSED [ 70%]


tests/test_s_hotkey_workflow.py::test_settings_dialog_import_exists 
PASSED [ 70%]


tests/test_settings.py::test_settings_manager_initialization 
PASSED      [ 71%]


tests/test_settings.py::test_get_set_setting 
PASSED                      [ 71%]


tests/test_settings.py::test_default_values 
PASSED                       [ 71%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED [ 71%]


tests/test_settings.py::test_on_changed_handler 
PASSED                   [ 71%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                    [ 72%]


tests/test_settings.py::test_get_all_keys 
PASSED                         [ 72%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED              [ 72%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED [ 72%]


tests/test_settings_dialog.py::test_custom_title_bar_creation 
PASSED     [ 72%]


tests/test_settings_dialog.py::test_custom_title_bar_signals 
PASSED      [ 72%]


tests/test_settings_dialog.py::test_tab_button_creation 
PASSED           [ 73%]


tests/test_settings_dialog.py::test_settings_dialog_creation 
PASSED      [ 73%]


tests/test_settings_dialog.py::test_settings_dialog_has_title_bar 
PASSED [ 73%]


tests/test_settings_dialog.py::test_settings_dialog_has_tabs 
FAILED      [ 73%]


tests/test_settings_dialog.py::test_settings_dialog_has_content_stack 
FAILED [ 73%]


tests/test_settings_dialog.py::test_settings_dialog_default_tab 
PASSED   [ 74%]


tests/test_settings_dialog.py::test_settings_dialog_tab_switching 
FAILED [ 74%]


tests/test_settings_dialog.py::test_settings_dialog_has_size_grip 
PASSED [ 74%]


tests/test_settings_dialog.py::test_settings_dialog_toggle_maximize 
PASSED [ 74%]


tests/test_settings_dialog.py::test_settings_dialog_has_drop_shadow 
PASSED [ 74%]


tests/test_settings_dialog.py::test_settings_dialog_theme_loaded 
PASSED  [ 74%]


tests/test_settings_dialog.py::test_settings_dialog_tab_button_clicks 
PASSED [ 75%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_transitions_key_triggers_sync 
PASSED [ 75%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_widgets_key_triggers_sync 
PASSED [ 75%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_sources_folders_triggers_sync 
PASSED [ 75%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_display_key_triggers_sync 
PASSED [ 75%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_non_critical_key_no_sync 
PASSED [ 75%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_critical_keys_list_complete 
PASSED [ 76%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_nested_critical_key_triggers_sync 
PASSED [ 76%]


tests/test_slide_jitter.py::TestSlideJitter::test_slide_dt_max_under_threshold 
PASSED [ 76%]


tests/test_slide_jitter.py::TestSlideJitter::test_slide_frame_count_reasonable 
PASSED [ 76%]


tests/test_slide_transition.py::test_slide_direction_enum 
PASSED         [ 76%]


tests/test_slide_transition.py::test_slide_creation 
PASSED               [ 77%]


tests/test_slide_transition.py::test_slide_all_directions 
PASSED         [ 77%]


tests/test_slide_transition.py::test_slide_start_no_old_image 
PASSED     [ 77%]


tests/test_slide_transition.py::test_slide_signals 
PASSED                [ 77%]


tests/test_slide_transition.py::test_slide_progress_range 
PASSED         [ 77%]


tests/test_slide_transition.py::test_slide_stop 
PASSED                   [ 77%]


tests/test_slide_transition.py::test_slide_cleanup 
PASSED                [ 78%]


tests/test_slide_transition.py::test_slide_invalid_pixmap 
PASSED         [ 78%]


tests/test_slide_transition.py::test_slide_already_running 
PASSED        [ 78%]


tests/test_slide_transition.py::test_slide_set_direction 
PASSED          [ 78%]


tests/test_slide_transition.py::test_slide_easing_curves 
PASSED          [ 78%]


tests/test_slide_transition.py::test_slide_position_calculation 
PASSED   [ 79%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_tick_consumes_engine_smoothed_bars 
PASSED [ 79%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_compute_bars_reasonable_runtime 
PASSED [ 79%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_widgets_share_audio_engine 
PASSED [ 79%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_emits_perf_metrics 
PASSED [ 79%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top 
PASSED [ 79%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals 
PASSED [ 80%]


tests/test_startup_black_flash.py::test_startup_no_base_black_fallback_software 
PASSED [ 80%]


tests/test_startup_black_flash.py::test_startup_no_base_black_fallback_opengl 
PASSED [ 80%]


tests/test_threading.py::test_thread_manager_initialization 
PASSED       [ 80%]


tests/test_threading.py::test_submit_io_task 
PASSED                      [ 80%]


tests/test_threading.py::test_submit_compute_task 
PASSED                 [ 81%]


tests/test_threading.py::test_get_pool_stats 
PASSED                      [ 81%]


tests/test_threading.py::test_thread_manager_shutdown 
PASSED             [ 81%]


tests/test_threading.py::test_run_on_ui_thread_from_ui_thread 
PASSED     [ 81%]


tests/test_threading.py::test_run_on_ui_thread_from_worker_thread 
PASSED [ 81%]


tests/test_timezone_support.py::TestTimezoneUtils::test_get_local_timezone 
PASSED [ 81%]


tests/test_timezone_support.py::TestTimezoneUtils::test_get_common_timezones 
PASSED [ 82%]


tests/test_timezone_support.py::TestTimezoneUtils::test_get_all_pytz_timezones 
PASSED [ 82%]


tests/test_timezone_support.py::TestTimezoneUtils::test_validate_timezone_local 
PASSED [ 82%]


tests/test_timezone_support.py::TestTimezoneUtils::test_validate_timezone_utc_offsets 
PASSED [ 82%]


tests/test_timezone_support.py::TestTimezoneUtils::test_validate_timezone_pytz 
PASSED [ 82%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_creation_default_timezone 
PASSED [ 83%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_creation_with_timezone 
PASSED [ 83%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_parse_utc_offset_positive 
PASSED [ 83%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_parse_utc_offset_negative 
PASSED [ 83%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_parse_utc_offset_with_minutes 
PASSED [ 83%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_parse_pytz_timezone 
PASSED [ 83%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_timezone_abbrev_local 
PASSED [ 84%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_timezone_abbrev_utc 
PASSED [ 84%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_timezone_abbrev_offset 
PASSED [ 84%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_set_timezone 
PASSED [ 84%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_set_show_timezone 
PASSED [ 84%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_time_update_with_timezone 
FAILED [ 85%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_local_vs_utc_time_difference 
PASSED [ 85%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_invalid_timezone_fallback 
PASSED [ 85%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_timezone_display_formats 
FAILED [ 85%]


tests/test_timezone_support.py::TestTimezoneEdgeCases::test_timezone_negative_half_hour 
PASSED [ 85%]


tests/test_timezone_support.py::TestTimezoneEdgeCases::test_timezone_45_minute_offset 
PASSED [ 85%]


tests/test_timezone_support.py::TestTimezoneEdgeCases::test_timezone_extreme_positive 
PASSED [ 86%]


tests/test_timezone_support.py::TestTimezoneEdgeCases::test_timezone_extreme_negative 
PASSED [ 86%]


tests/test_timezone_support.py::TestTimezoneEdgeCases::test_empty_timezone_string 
PASSED [ 86%]


tests/test_timezone_support.py::TestTimezoneEdgeCases::test_case_insensitive_utc 
PASSED [ 86%]


tests/test_transition_integration.py::TestTransitionIntegration::test_crossfade_transition_runs 
FAILED [ 86%]


tests/test_transition_integration.py::TestTransitionIntegration::test_slide_transition_runs 
FAILED [ 87%]


tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_runs 
FAILED [ 87%]


tests/test_transition_integration.py::TestTransitionIntegration::test_block_puzzle_flip_transition_runs 
FAILED [ 87%]


tests/test_transition_integration.py::TestTransitionIntegration::test_wipe_transition_runs 
FAILED [ 87%]


tests/test_transition_integration.py::TestTransitionIntegration::test_transition_cleanup_on_stop 
PASSED [ 87%]


tests/test_transition_integration.py::TestTransitionIntegration::test_transition_settings_respected 
FAILED [ 87%]


tests/test_transition_integration.py::TestTransitionIntegration::test_transition_fallback_on_error 
PASSED [ 88%]


tests/test_transition_integration.py::TestTransitionIntegration::test_random_slide_direction 
PASSED [ 88%]


tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_software_backend_no_watchdog 
FAILED [ 88%]


tests/test_transition_integration.py::TestTransitionIntegration::test_block_flip_transition_software_backend_no_watchdog 
FAILED [ 88%]


tests/test_transition_telemetry.py::TestBaseTelemetry::test_transition_has_telemetry_fields 
PASSED [ 88%]


tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_start_sets_time 
FAILED [ 88%]


tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_end_sets_time 
FAILED [ 89%]


tests/test_transition_telemetry.py::TestBaseTelemetry::test_get_elapsed_ms_returns_none_without_start 
PASSED [ 89%]


tests/test_transition_telemetry.py::TestBaseTelemetry::test_get_elapsed_ms_returns_time_after_start 
FAILED [ 89%]


tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_start_logs_debug 
FAILED [ 89%]


tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_logs_performance 
FAILED [ 89%]


tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_warns_on_timing_drift 
FAILED [ 90%]


tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_start 
FAILED [ 90%]


tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_end_on_complete 
FAILED [ 90%]


tests/test_transition_telemetry.py::TestSWTransitionTelemetry::test_sw_crossfade_has_telemetry 
PASSED [ 90%]


tests/test_transition_telemetry.py::TestPerformanceMetrics::test_elapsed_time_accuracy 
FAILED [ 90%]


tests/test_transition_telemetry.py::TestPerformanceMetrics::test_delta_calculation 
FAILED [ 90%]


tests/test_transition_telemetry.py::TestTelemetryThreadSafety::test_elapsed_time_thread_safe 
PASSED [ 91%]


tests/test_transitions.py::test_transition_state_enum 
PASSED             [ 91%]


tests/test_transitions.py::test_crossfade_creation 
PASSED                [ 91%]


tests/test_transitions.py::test_crossfade_duration 
PASSED                [ 91%]


tests/test_transitions.py::test_crossfade_start_with_no_old_image 
PASSED [ 91%]


tests/test_transitions.py::test_crossfade_start_with_images 
PASSED       [ 92%]


tests/test_transitions.py::test_crossfade_signals 
PASSED                 [ 92%]


tests/test_transitions.py::test_crossfade_progress_range 
PASSED          [ 92%]


tests/test_transitions.py::test_crossfade_stop 
PASSED                    [ 92%]


tests/test_transitions.py::test_crossfade_cleanup 
PASSED                 [ 92%]


tests/test_transitions.py::test_crossfade_invalid_pixmap 
PASSED          [ 92%]


tests/test_transitions.py::test_crossfade_already_running 
PASSED         [ 93%]


tests/test_transitions.py::test_crossfade_easing_curves 
PASSED           [ 93%]


tests/test_transitions.py::test_crossfade_set_easing 
PASSED              [ 93%]


tests/test_transitions.py::test_crossfade_repr 
PASSED                    [ 93%]


tests/test_transitions.py::test_crossfade_state_transitions 
PASSED       [ 93%]


tests/test_transitions.py::test_crossfade_multiple_transitions 
PASSED    [ 94%]


tests/test_transitions_integration.py::test_crossfade_with_pan_and_scan 
SKIPPED [ 94%]


tests/test_transitions_integration.py::test_diffuse_with_pan_and_scan 
SKIPPED [ 94%]


tests/test_transitions_integration.py::test_pan_and_scan_no_zoom_after_transition 
SKIPPED [ 94%]


tests/test_transitions_tab.py::test_slide_and_wipe_directions_are_independent 
PASSED [ 94%]


tests/test_transitions_tab.py::test_default_transition_type_and_direction 
PASSED [ 94%]


tests/test_weather_widget.py::test_weather_position_enum 
PASSED          [ 95%]


tests/test_weather_widget.py::test_weather_creation 
FAILED               [ 95%]


tests/test_weather_widget.py::test_weather_no_api_key 
PASSED             [ 95%]


tests/test_weather_widget.py::test_weather_stop 
FAILED                   [ 95%]


tests/test_weather_widget.py::test_weather_signals 
PASSED                [ 95%]


tests/test_weather_widget.py::test_weather_display_update 
PASSED         [ 96%]


tests/test_weather_widget.py::test_weather_cache 
FAILED                  [ 96%]


tests/test_weather_widget.py::test_weather_all_positions 
FAILED          [ 96%]


tests/test_weather_widget.py::test_weather_set_position 
PASSED           [ 96%]


tests/test_weather_widget.py::test_weather_set_api_key 
PASSED            [ 96%]


tests/test_weather_widget.py::test_weather_set_location 
PASSED           [ 96%]


tests/test_weather_widget.py::test_weather_set_font_size 
FAILED          [ 97%]


tests/test_weather_widget.py::test_weather_set_text_color 
PASSED         [ 97%]


tests/test_weather_widget.py::test_weather_cleanup 
FAILED                [ 97%]


tests/test_weather_widget.py::test_weather_error_handling 
PASSED         [ 97%]


tests/test_weather_widget.py::test_weather_error_with_cache 
PASSED       [ 97%]


tests/test_weather_widget.py::test_weather_fetcher_creation 
PASSED       [ 98%]


tests/test_weather_widget.py::test_weather_fetcher_success 
PASSED        [ 98%]


tests/test_weather_widget.py::test_weather_fetcher_error 
FAILED          [ 98%]


tests/test_weather_widget.py::test_weather_display_no_data 
PASSED        [ 98%]


tests/test_weather_widget.py::test_weather_concurrent_start_prevention 
FAILED [ 98%]


tests/test_widgets_media_integration.py::test_widgets_tab_media_roundtrip 
PASSED [ 98%]


tests/test_widgets_media_integration.py::test_media_widget_created_after_config_roundtrip 
PASSED [ 99%]


tests/test_widgets_persistence_integration.py::test_widgets_tab_changes_reflected_in_display_widget 
PASSED [ 99%]


tests/test_widgets_persistence_integration.py::test_display_widget_respects_widget_monitor_selection 
PASSED [ 99%]


tests/test_widgets_tab.py::TestWidgetsTab::test_widgets_tab_creation 
PASSED [ 99%]


tests/test_widgets_tab.py::TestWidgetsTab::test_widgets_tab_default_values 
FAILED [ 99%]


tests/test_widgets_tab.py::TestWidgetsTab::test_widgets_tab_saves_and_roundtrips 
PASSED [100%]




================================== FAILURES ===================================

_______________ TestDisplayTab.test_display_tab_default_values ________________



self = <tests.test_display_tab.TestDisplayTab object at 0x00000275B07B6310>

qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>



    def test_display_tab_default_values(self, qt_app):

        """Test that DisplayTab uses correct default values."""

        # Create fresh settings manager

        fresh_settings = SettingsManager(organization="Test", application="DisplayTabTest")

        fresh_settings.reset_to_defaults()

    

        tab = DisplayTab(fresh_settings)

    

        # Check defaults

        monitor = fresh_settings.get('display.show_on_monitors', 'ALL')

        assert monitor == 'ALL'

    

        mode = fresh_settings.get('display.mode', 'fill')

        assert mode == 'fill'

    

        interval = fresh_settings.get('timing.interval', 5)

>       assert interval == 40

E       assert 45 == 40



tests\test_display_tab.py:183: AssertionError

__________ TestTransitionTelemetryFlow.test_transition_tracks_timing __________



self = <tests.test_flicker_fix_integration.TestTransitionTelemetryFlow object at 0x00000275B0B2ED10>

qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

dummy_pixmap = <PySide6.QtGui.QPixmap(QSize(10, 10),depth=32,devicePixelRatio=1,cacheKey=0xf100000001) at 0x00000275B5687000>



    def test_transition_tracks_timing(self, qapp, dummy_pixmap):

        """GL compositor transition should track start and end times."""

        from transitions.gl_compositor_crossfade_transition import (

            GLCompositorCrossfadeTransition,

        )

    

        widget = QWidget()

        widget.setGeometry(0, 0, 100, 100)

    

        try:

            trans = GLCompositorCrossfadeTransition(duration_ms=100)

    

            # Start transition (telemetry implemented in GL version)

            trans.start(dummy_pixmap, dummy_pixmap, widget)

    

            # Should have start time (GL version calls _mark_start)

>           assert trans._start_time is not None

E           assert None is not None

E            +  where None = GLCompositorCrossfadeTransition(duration=100ms, state=finished)._start_time



tests\test_flicker_fix_integration.py:84: AssertionError

------------------------------ Captured log call ------------------------------

WARNING  transitions.gl_compositor_crossfade_transition:gl_compositor_crossfade_transition.py:62 [GL COMPOSITOR] No compositor attached to widget; falling back to immediate display

_____________________ test_media_widget_displays_metadata _____________________



qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000275DC958D10>



    @pytest.mark.qt

    def test_media_widget_displays_metadata(qt_app, qtbot):

        """MediaWidget should render title/artist/album and state text."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        w.start()

        qt_app.processEvents()

    

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

    

        html = w.text()

>       assert "Song Title" in html

E       AssertionError: assert 'Song Title' in ''



tests\test_media_widget.py:209: AssertionError

_____________ test_media_widget_hides_again_when_media_disappears _____________



qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000275DC8C2250>



    @pytest.mark.qt

    def test_media_widget_hides_again_when_media_disappears(qt_app, qtbot):

        """Widget should hide after being visible when media goes away."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        # Start with media present

        w.start()

        qt_app.processEvents()

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

>       assert w.isVisible()

E       assert False

E        +  where False = <built-in method isVisible of MediaWidget object at 0x00000275CD2AD540>()

E        +    where <built-in method isVisible of MediaWidget object at 0x00000275CD2AD540> = <widgets.media_widget.MediaWidget(0x2764a4590b0) at 0x00000275CD2AD540>.isVisible



tests\test_media_widget.py:236: AssertionError

____________ test_media_widget_decodes_artwork_and_adjusts_margins ____________



qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

qtbot = <pytestqt.qtbot.QtBot object at 0x000002767E821410>



    @pytest.mark.qt

    def test_media_widget_decodes_artwork_and_adjusts_margins(qt_app, qtbot):

        """Artwork bytes should be decoded into a pixmap and margins updated."""

    

        # Create a tiny in-memory PNG for artwork

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.red)

        pm = QPixmap.fromImage(img)

    

        # Encode to PNG bytes using an in-memory buffer so loadFromData can decode it.

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

>       assert pm.save(buf, b"PNG")

               ^^^^^^^^^^^^^^^^^^^^

E       TypeError: 'PySide6.QtGui.QPixmap.save' called with wrong argument types:

E         PySide6.QtGui.QPixmap.save(QBuffer, bytes)

E       Supported signatures:

E         PySide6.QtGui.QPixmap.save(device: PySide6.QtCore.QIODevice, /, format: str | None = None, quality: int = -1)

E         PySide6.QtGui.QPixmap.save(fileName: str, /, format: str | None = None, quality: int = -1)



tests\test_media_widget.py:257: TypeError

____________ test_media_widget_starts_fade_in_when_artwork_appears ____________



qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

qtbot = <pytestqt.qtbot.QtBot object at 0x000002767E81C290>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

>       assert pm.save(buf, b"PNG")

               ^^^^^^^^^^^^^^^^^^^^

E       TypeError: 'PySide6.QtGui.QPixmap.save' called with wrong argument types:

E         PySide6.QtGui.QPixmap.save(QBuffer, bytes)

E       Supported signatures:

E         PySide6.QtGui.QPixmap.save(device: PySide6.QtCore.QIODevice, /, format: str | None = None, quality: int = -1)

E         PySide6.QtGui.QPixmap.save(fileName: str, /, format: str | None = None, quality: int = -1)



tests\test_media_widget.py:300: TypeError

____________ test_display_widget_ctrl_click_routes_to_media_widget ____________



qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x27651be25c0) at 0x000002767E88FB00>

qtbot = <pytestqt.qtbot.QtBot object at 0x000002767E88EFD0>

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002767E88EB90>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(qt_app, settings_manager, qtbot, monkeypatch):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x2764a45a370) at 0x000002767E88FF80>.media_widget



tests\test_media_widget.py:379: AssertionError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:688 All settings cleared

_________ test_display_widget_hard_exit_click_routes_to_media_widget __________



qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x27651be24c0) at 0x000002767E8A1400>

qtbot = <pytestqt.qtbot.QtBot object at 0x000002767E8A3750>

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002767E8A2F90>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(qt_app, settings_manager, qtbot, monkeypatch):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x2764a45b5d0) at 0x000002767E8A39C0>.media_widget



tests\test_media_widget.py:436: AssertionError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:688 All settings cleared

_ TestDisplayWidgetOverlayDiagnostics.test_handle_screen_change_updates_geometry_and_dpi _



self = <tests.test_overlay_ready_state.TestDisplayWidgetOverlayDiagnostics object at 0x0000027580844090>

qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

dummy_pixmap = <PySide6.QtGui.QPixmap(QSize(10, 10),depth=32,devicePixelRatio=1,cacheKey=0x51f00000001) at 0x000002767E891780>



    def test_handle_screen_change_updates_geometry_and_dpi(self, qapp, dummy_pixmap):

        from rendering.display_widget import DisplayWidget

    

        class _FakeScreen:

            def __init__(self, rect: QRect, dpr: float) -> None:

                self._rect = rect

                self._dpr = dpr

    

            def geometry(self) -> QRect:

                return self._rect

    

            def devicePixelRatio(self) -> float:

                return self._dpr

    

        widget = DisplayWidget(0, None, None)

        widget.resize(100, 100)

    

        fake_screen = _FakeScreen(QRect(0, 0, 640, 360), 1.75)

        widget._handle_screen_change(fake_screen)

    

        assert widget._screen is fake_screen

>       assert widget.width() == 640 and widget.height() == 360

E       assert (640 == 640 and 359 == 360)

E        +  where 640 = <built-in method width of DisplayWidget object at 0x000002767E891740>()

E        +    where <built-in method width of DisplayWidget object at 0x000002767E891740> = <rendering.display_widget.DisplayWidget(0x2764a45eab0) at 0x000002767E891740>.width

E        +  and   359 = <built-in method height of DisplayWidget object at 0x000002767E891740>()

E        +    where <built-in method height of DisplayWidget object at 0x000002767E891740> = <rendering.display_widget.DisplayWidget(0x2764a45eab0) at 0x000002767E891740>.height



tests\test_overlay_ready_state.py:127: AssertionError

_____________ TestShadowConfig.test_from_settings_enabled_string ______________



self = <tests.test_painter_shadow.TestShadowConfig object at 0x00000275B0D78790>



    def test_from_settings_enabled_string(self):

        """from_settings should parse string 'false' as disabled."""

        config = ShadowConfig.from_settings({"enabled": "false"})

>       assert config.enabled is False

E       assert True is False

E        +  where True = ShadowConfig(enabled=True, blur_radius=18, offset_x=4, offset_y=4, color=PySide6.QtGui.QColor.fromRgbF(0.000000, 0.000000, 0.000000, 0.705882), opacity=1.0).enabled



tests\test_painter_shadow.py:62: AssertionError

---------------------------- Captured Qt messages -----------------------------

QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)

__________ TestParticleTransition.test_particle_transition_creation ___________



self = <tests.test_particle_transition.TestParticleTransition object at 0x00000275B0DC3410>



    def test_particle_transition_creation(self):

        """Test particle transition can be created."""

        from transitions.gl_compositor_particle_transition import GLCompositorParticleTransition

    

        mock_compositor = MagicMock()

>       transition = GLCompositorParticleTransition(

            compositor=mock_compositor,

            duration_ms=1000,

        )

E       TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'



tests\test_particle_transition.py:133: TypeError

____________ TestParticleTransition.test_particle_transition_modes ____________



self = <tests.test_particle_transition.TestParticleTransition object at 0x00000275B0DC3A10>



    def test_particle_transition_modes(self):

        """Test particle transition supports different modes."""

        from transitions.gl_compositor_particle_transition import GLCompositorParticleTransition

    

        mock_compositor = MagicMock()

    

        for mode in [0, 1, 2]:  # Directional, Swirl, Converge

>           transition = GLCompositorParticleTransition(

                compositor=mock_compositor,

                duration_ms=500,

                mode=mode,

            )

E           TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'



tests\test_particle_transition.py:147: TypeError

_________ TestParticleTransition.test_particle_transition_directions __________



self = <tests.test_particle_transition.TestParticleTransition object at 0x00000275B0DC8090>



    def test_particle_transition_directions(self):

        """Test particle transition supports different directions."""

        from transitions.gl_compositor_particle_transition import GLCompositorParticleTransition

    

        mock_compositor = MagicMock()

    

        for direction in range(10):  # 0-9 directions including random

>           transition = GLCompositorParticleTransition(

                compositor=mock_compositor,

                duration_ms=500,

                direction=direction,

            )

E           TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'



tests\test_particle_transition.py:161: TypeError

________ TestParticleTransition.test_particle_transition_swirl_orders _________



self = <tests.test_particle_transition.TestParticleTransition object at 0x00000275B0DC8690>



    def test_particle_transition_swirl_orders(self):

        """Test particle transition supports different swirl orders."""

        from transitions.gl_compositor_particle_transition import GLCompositorParticleTransition

    

        mock_compositor = MagicMock()

    

        for order in [0, 1, 2]:  # Typical, Center Outward, Edges Inward

>           transition = GLCompositorParticleTransition(

                compositor=mock_compositor,

                duration_ms=500,

                mode=1,  # Swirl mode

                swirl_order=order,

            )

E           TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'



tests\test_particle_transition.py:175: TypeError

______ TestSettingsDefaults.test_settings_manager_has_particle_defaults _______



self = <tests.test_particle_transition.TestSettingsDefaults object at 0x00000275B0DC9750>



    def test_settings_manager_has_particle_defaults(self):

        """Test SettingsManager includes particle defaults."""

        from core.settings.settings_manager import SettingsManager

    

        manager = SettingsManager(organization="Test", application="ParticleTest")

        try:

            transitions = manager.get('transitions', {})

    

            assert 'particle' in transitions, "Particle settings missing from defaults"

            particle = transitions['particle']

    

            assert particle.get('mode') == 'Converge'

>           assert particle.get('swirl_order') == 2  # Edges Inward

            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AssertionError: assert 0 == 2

E            +  where 0 = <built-in method get of dict object at 0x000002767E84E640>('swirl_order')

E            +    where <built-in method get of dict object at 0x000002767E84E640> = {'direction': 'Left to Right', 'gloss_size': 72.0, 'light_direction': 0, 'mode': 'Converge', ...}.get



tests\test_particle_transition.py:208: AssertionError

_______ TestRedditClickRouting.test_reddit_click_returns_handled_tuple ________



self = <tests.test_reddit_exit_logic.TestRedditClickRouting object at 0x00000275B0E4AD90>

qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

qtbot = <pytestqt.qtbot.QtBot object at 0x000002767E81D6D0>



    @pytest.mark.qt

    def test_reddit_click_returns_handled_tuple(self, qt_app, qtbot):

        """route_widget_click should return (handled, reddit_handled) tuple."""

        from rendering.input_handler import InputHandler

        from widgets.reddit_widget import RedditWidget

    

        # Create a mock parent

        parent = MagicMock()

        parent.settings_manager = MagicMock()

        parent.settings_manager.get.return_value = False

        parent._coordinator = MagicMock()

        parent._coordinator.ctrl_held = False

    

>       handler = InputHandler(parent)

                  ^^^^^^^^^^^^^^^^^^^^



tests\test_reddit_exit_logic.py:78: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <[RuntimeError("'__init__' method of object's base class (InputHandler) not called.") raised in repr()] InputHandler object at 0x275dc8ec680>

parent = <MagicMock id='2707951762000'>, settings_manager = None

widget_manager = None



    def __init__(

        self,

        parent: "DisplayWidget",

        settings_manager: Optional[SettingsManager] = None,

        widget_manager: Optional["WidgetManager"] = None,

    ):

        """

        Initialize the InputHandler.

    

        Args:

            parent: The DisplayWidget that owns this handler

            settings_manager: Optional SettingsManager for input settings

            widget_manager: Optional WidgetManager for effect invalidation coordination

        """

>       super().__init__(parent)

E       TypeError: 'PySide6.QtCore.QObject.__init__' called with wrong argument types:

E         PySide6.QtCore.QObject.__init__(MagicMock)

E       Supported signatures:

E         PySide6.QtCore.QObject.__init__(parent: PySide6.QtCore.QObject | None = None, *, objectName: str | None = None)



rendering\input_handler.py:74: TypeError

________ TestRSSBehavior.test_image_queue_history_prevents_duplicates _________



self = <tests.test_rss_behavior.TestRSSBehavior object at 0x00000275B0F184D0>

temp_cache_dir = WindowsPath('C:/Users/Basjohn/AppData/Local/Temp/test_rss_cache_9b8ycu5b')



    def test_image_queue_history_prevents_duplicates(self, temp_cache_dir):

        """Test that ImageQueue history prevents immediate duplicates."""

        from engine.image_queue import ImageQueue

        from sources.base_provider import ImageMetadata, ImageSourceType

    

        # Create a small pool of RSS images to force potential duplicates

        rss_images = []

        for i in range(3):  # Only 3 RSS images

            rss_images.append(ImageMetadata(

                source_type=ImageSourceType.RSS,

                source_id="test_feed",

                image_id=f"rss_image_{i}",

                local_path=temp_cache_dir / f"rss_{i}.jpg",

                url=f"https://example.com/rss_{i}.jpg",

                title=f"RSS Image {i}",

            ))

    

        # No local images - force RSS selection

        queue = ImageQueue(local_ratio=0, history_size=50)  # 0% local = 100% RSS

        queue.add_images(rss_images)

    

        # Get 10 images and check for consecutive duplicates

        selected = []

        for _ in range(10):

            img = queue.next()

            if img:

                selected.append(img.image_id)

    

        print("\n=== Duplicate Prevention Test ===")

        print(f"RSS pool size: {len(rss_images)}")

        print(f"Selected sequence: {selected}")

    

        # Check for consecutive duplicates

        consecutive_duplicates = 0

        for i in range(1, len(selected)):

            if selected[i] == selected[i-1]:

                consecutive_duplicates += 1

    

        print(f"Consecutive duplicates: {consecutive_duplicates}")

    

        # With history check, we should have minimal consecutive duplicates

        # (some may occur if pool is exhausted)

>       assert consecutive_duplicates <= 2, \

            f"Too many consecutive duplicates: {consecutive_duplicates}"

E       AssertionError: Too many consecutive duplicates: 3

E       assert 3 <= 2



tests\test_rss_behavior.py:261: AssertionError

---------------------------- Captured stdout call -----------------------------


=== Duplicate Prevention Test ===
RSS pool size: 3
Selected sequence: ['rss_image_2', 'rss_image_1', 'rss_image_0', 'rss_image_0', 'rss_image_1', 'rss_image_2', 'rss_image_2', 'rss_image_0', 'rss_image_1', 'rss_image_1']
Consecutive duplicates: 3


________________________ test_settings_dialog_has_tabs ________________________



qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x2760b0e5920) at 0x00000275B5C55E00>

animation_manager = <core.animation.animator.AnimationManager(0x2760b0e56c0) at 0x0000027602B6EBC0>



    def test_settings_dialog_has_tabs(qapp, settings_manager, animation_manager):

        """Test dialog has all tab buttons."""

        dialog = SettingsDialog(settings_manager, animation_manager)

    

        assert hasattr(dialog, 'sources_tab_btn')

        assert hasattr(dialog, 'display_tab_btn')

        assert hasattr(dialog, 'transitions_tab_btn')

        assert hasattr(dialog, 'widgets_tab_btn')

        assert hasattr(dialog, 'about_tab_btn')

    

>       assert len(dialog.tab_buttons) == 5

E       assert 6 == 5

E        +  where 6 = len([<ui.settings_dialog.TabButton(0x276524e57b0, name="tabButton") at 0x0000027602B6E6C0>, <ui.settings_dialog.TabButton(0x276524e4da0, name="tabButton") at 0x0000027605E76140>, <ui.settings_dialog.TabButton(0x276524e4a90, name="tabButton") at 0x00000275DC8FEBC0>, <ui.settings_dialog.TabButton(0x276524e4f60, name="tabButton") at 0x0000027602B6E580>, <ui.settings_dialog.TabButton(0x276524e5890, name="tabButton") at 0x0000027602B6E280>, <ui.settings_dialog.TabButton(0x276524e6fc0, name="tabButton") at 0x0000027602B6E380>])

E        +    where [<ui.settings_dialog.TabButton(0x276524e57b0, name="tabButton") at 0x0000027602B6E6C0>, <ui.settings_dialog.TabButton(0x276524e4da0, name="tabButton") at 0x0000027605E76140>, <ui.settings_dialog.TabButton(0x276524e4a90, name="tabButton") at 0x00000275DC8FEBC0>, <ui.settings_dialog.TabButton(0x276524e4f60, name="tabButton") at 0x0000027602B6E580>, <ui.settings_dialog.TabButton(0x276524e5890, name="tabButton") at 0x0000027602B6E280>, <ui.settings_dialog.TabButton(0x276524e6fc0, name="tabButton") at 0x0000027602B6E380>] = <ui.settings_dialog.SettingsDialog(0x2765234bcf0) at 0x00000275C519DDC0>.tab_buttons



tests\test_settings_dialog.py:102: AssertionError

___________________ test_settings_dialog_has_content_stack ____________________



qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x276121aa2f0) at 0x00000275B5B68D40>

animation_manager = <core.animation.animator.AnimationManager(0x276121ab790) at 0x0000027602BA5D80>



    def test_settings_dialog_has_content_stack(qapp, settings_manager, animation_manager):

        """Test dialog has stacked widget for content."""

        dialog = SettingsDialog(settings_manager, animation_manager)

    

        assert hasattr(dialog, 'content_stack')

>       assert dialog.content_stack.count() == 5

E       assert 6 == 5

E        +  where 6 = <built-in method count of PySide6.QtWidgets.QStackedWidget object at 0x0000027602B8B500>()

E        +    where <built-in method count of PySide6.QtWidgets.QStackedWidget object at 0x0000027602B8B500> = <PySide6.QtWidgets.QStackedWidget(0x276126ada40, name="contentArea") at 0x0000027602B8B500>.count

E        +      where <PySide6.QtWidgets.QStackedWidget(0x276126ada40, name="contentArea") at 0x0000027602B8B500> = <ui.settings_dialog.SettingsDialog(0x2761267bfd0) at 0x0000027602B958C0>.content_stack



tests\test_settings_dialog.py:110: AssertionError

_____________________ test_settings_dialog_tab_switching ______________________



qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x27613929630) at 0x0000027602BFB780>

animation_manager = <core.animation.animator.AnimationManager(0x27613929250) at 0x0000027602C73E00>



    def test_settings_dialog_tab_switching(qapp, settings_manager, animation_manager):

        """Test tab switching functionality."""

        dialog = SettingsDialog(settings_manager, animation_manager)

    

        # Switch to display tab

        dialog._switch_tab(1)

        assert dialog.display_tab_btn.isChecked() is True

        assert dialog.sources_tab_btn.isChecked() is False

    

        # Switch to transitions tab

        dialog._switch_tab(2)

        assert dialog.transitions_tab_btn.isChecked() is True

        assert dialog.display_tab_btn.isChecked() is False

    

        # Switch to widgets tab

        dialog._switch_tab(3)

        assert dialog.widgets_tab_btn.isChecked() is True

        assert dialog.transitions_tab_btn.isChecked() is False

    

        # Switch to about tab

        dialog._switch_tab(4)

>       assert dialog.about_tab_btn.isChecked() is True

E       assert False is True

E        +  where False = <built-in method isChecked of TabButton object at 0x0000027602C713C0>()

E        +    where <built-in method isChecked of TabButton object at 0x0000027602C713C0> = <ui.settings_dialog.TabButton(0x27613274950, name="tabButton") at 0x0000027602C713C0>.isChecked

E        +      where <ui.settings_dialog.TabButton(0x27613274950, name="tabButton") at 0x0000027602C713C0> = <ui.settings_dialog.SettingsDialog(0x27618c11270) at 0x0000027602C71940>.about_tab_btn



tests\test_settings_dialog.py:142: AssertionError

________ TestClockWidgetTimezone.test_clock_time_update_with_timezone _________



self = <tests.test_timezone_support.TestClockWidgetTimezone object at 0x00000275B0FA7BD0>

qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>



    def test_clock_time_update_with_timezone(self, qt_app):

        """Test that time updates work with timezone set."""

        parent = QWidget()

        parent.resize(800, 600)

        clock = ClockWidget(parent, timezone_str='UTC', show_timezone=True)

        clock.start()

    

        # Process events to ensure update happens

        qt_app.processEvents()

    

        # Check that text is set

        text = clock.text()

        assert len(text) > 0

        # Should include 'UTC' abbreviation

>       assert 'UTC' in text or 'GMT' in text

E       AssertionError: assert ('UTC' in '8:30:28 AM' or 'GMT' in '8:30:28 AM')



tests\test_timezone_support.py:222: AssertionError

_________ TestClockWidgetTimezone.test_clock_timezone_display_formats _________



self = <tests.test_timezone_support.TestClockWidgetTimezone object at 0x00000275B0FB0ED0>

qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>



    def test_clock_timezone_display_formats(self, qt_app):

        """Test timezone with different time formats."""

        parent = QWidget()

        parent.resize(800, 600)

    

        # 12-hour format with timezone

        clock_12h = ClockWidget(parent, time_format=TimeFormat.TWELVE_HOUR,

                                timezone_str='UTC', show_timezone=True)

        clock_12h.start()

        qt_app.processEvents()

        text_12h = clock_12h.text()

        assert 'AM' in text_12h or 'PM' in text_12h

>       assert 'UTC' in text_12h or 'GMT' in text_12h

E       AssertionError: assert ('UTC' in '8:30:28 AM' or 'GMT' in '8:30:28 AM')



tests\test_timezone_support.py:277: AssertionError

__________ TestTransitionIntegration.test_crossfade_transition_runs ___________



self = <tests.test_transition_integration.TestTransitionIntegration object at 0x00000275B0FB0C90>

qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

display_widget = <rendering.display_widget.DisplayWidget(0x27650c5ada0) at 0x0000027606F81600>

test_pixmap = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc5e00000002) at 0x0000027606F821C0>

test_pixmap2 = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc5f00000002) at 0x0000027606F80340>



    def test_crossfade_transition_runs(self, qt_app, display_widget, test_pixmap, test_pixmap2):

        """Test that crossfade transition actually runs."""

        # Set up transition settings

        self._set_transitions(

            display_widget.settings_manager,

            transition_type='Crossfade',

            duration_ms=500,

        )

    

        # Display first image

        display_widget.set_image(test_pixmap, "test1.png")

        assert display_widget.current_pixmap is not None

    

        # Track transition completion

        transition_finished = {'value': False}

    

        def on_finished():

            transition_finished['value'] = True

    

        # Display second image with transition

        display_widget.set_image(test_pixmap2, "test2.png")

    

        # Check transition was created

        if display_widget._current_transition:

            display_widget._current_transition.finished.connect(on_finished)

    

            # Process events for transition to complete (longer timeout for timer-based animation)

            QTimer.singleShot(3000, qt_app.quit)

            qt_app.exec()

    

            # Verify transition completed

>           assert transition_finished['value'], "Crossfade transition should finish"

E           AssertionError: Crossfade transition should finish

E           assert False



tests\test_transition_integration.py:135: AssertionError

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'


---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:688 All settings cleared

____________ TestTransitionIntegration.test_slide_transition_runs _____________



self = <tests.test_transition_integration.TestTransitionIntegration object at 0x00000275B0FBC0D0>

qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

display_widget = <rendering.display_widget.DisplayWidget(0x27650c41120) at 0x0000027606EB7140>

test_pixmap = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc6200000002) at 0x0000027602BF9A80>

test_pixmap2 = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc6300000002) at 0x00000276060FE640>



    def test_slide_transition_runs(self, qt_app, display_widget, test_pixmap, test_pixmap2):

        """Test that slide transition actually runs."""

        # Set up transition settings

        self._set_transitions(

            display_widget.settings_manager,

            transition_type='Slide',

            duration_ms=300,

            slide_direction='Left to Right',

        )

    

        # Display first image

        display_widget.set_image(test_pixmap, "test1.png")

    

        # Track transition completion

        transition_finished = {'value': False}

    

        def on_finished():

            transition_finished['value'] = True

    

        # Display second image with transition

        display_widget.set_image(test_pixmap2, "test2.png")

    

        # Check transition was created

        if display_widget._current_transition:

            display_widget._current_transition.finished.connect(on_finished)

    

            # Process events for transition to complete

            QTimer.singleShot(3000, qt_app.quit)

            qt_app.exec()

    

            # Verify transition completed

>           assert transition_finished['value'], "Slide transition should finish"

E           AssertionError: Slide transition should finish

E           assert False



tests\test_transition_integration.py:171: AssertionError

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'


---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:688 All settings cleared

___________ TestTransitionIntegration.test_diffuse_transition_runs ____________



self = <tests.test_transition_integration.TestTransitionIntegration object at 0x00000275B0FBC450>

qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

display_widget = <rendering.display_widget.DisplayWidget(0x27650c570e0) at 0x00000275C0528E40>

test_pixmap = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc6600000002) at 0x000002767E81F880>

test_pixmap2 = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc6700000002) at 0x0000027602D6AF80>



    def test_diffuse_transition_runs(self, qt_app, display_widget, test_pixmap, test_pixmap2):

        """Test that diffuse transition actually runs."""

        self._set_transitions(

            display_widget.settings_manager,

            transition_type='Diffuse',

            duration_ms=300,

            diffuse_block_size=50,

        )

    

        display_widget.set_image(test_pixmap, "test1.png")

    

        transition_finished = {'value': False}

    

        def on_finished():

            transition_finished['value'] = True

    

        display_widget.set_image(test_pixmap2, "test2.png")

    

        if display_widget._current_transition:

            display_widget._current_transition.finished.connect(on_finished)

            QTimer.singleShot(2000, qt_app.quit)

            qt_app.exec()

>           assert transition_finished['value'], "Diffuse transition should finish"

E           AssertionError: Diffuse transition should finish

E           assert False



tests\test_transition_integration.py:197: AssertionError

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'


---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:688 All settings cleared

______ TestTransitionIntegration.test_block_puzzle_flip_transition_runs _______



self = <tests.test_transition_integration.TestTransitionIntegration object at 0x00000275B0FBC810>

qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

display_widget = <rendering.display_widget.DisplayWidget(0x276131a52c0) at 0x000002767E8B5180>

test_pixmap = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc6a00000002) at 0x00000276060E4340>

test_pixmap2 = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc6b00000002) at 0x0000027606F5B480>



    def test_block_puzzle_flip_transition_runs(self, qt_app, display_widget, test_pixmap, test_pixmap2):

        """Test that block puzzle flip transition actually runs."""

        self._set_transitions(

            display_widget.settings_manager,

            transition_type='Block Puzzle Flip',

            duration_ms=200,

            block_rows=2,

            block_cols=2,

        )

    

        display_widget.set_image(test_pixmap, "test1.png")

    

        transition_finished = {'value': False}

    

        def on_finished():

            transition_finished['value'] = True

    

        display_widget.set_image(test_pixmap2, "test2.png")

    

        if display_widget._current_transition:

            display_widget._current_transition.finished.connect(on_finished)

            QTimer.singleShot(2000, qt_app.quit)

            qt_app.exec()

>           assert transition_finished['value'], "Block puzzle flip transition should finish"

E           AssertionError: Block puzzle flip transition should finish

E           assert False



tests\test_transition_integration.py:224: AssertionError

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'


---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:688 All settings cleared

_____________ TestTransitionIntegration.test_wipe_transition_runs _____________



self = <tests.test_transition_integration.TestTransitionIntegration object at 0x00000275B0FBCB90>

qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

display_widget = <rendering.display_widget.DisplayWidget(0x27650c5ada0) at 0x0000027602E00EC0>

test_pixmap = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc6e00000002) at 0x0000027606ED4B80>

test_pixmap2 = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc6f00000002) at 0x00000275DC8BD500>



    def test_wipe_transition_runs(self, qt_app, display_widget, test_pixmap, test_pixmap2):

        """Test that wipe transition actually runs."""

        self._set_transitions(

            display_widget.settings_manager,

            transition_type='Wipe',

            duration_ms=200,

        )

    

        display_widget.set_image(test_pixmap, "test1.png")

    

        transition_finished = {'value': False}

    

        def on_finished():

            transition_finished['value'] = True

    

        display_widget.set_image(test_pixmap2, "test2.png")

    

        if display_widget._current_transition:

            display_widget._current_transition.finished.connect(on_finished)

            QTimer.singleShot(2000, qt_app.quit)

            qt_app.exec()

>           assert transition_finished['value'], "Wipe transition should finish"

E           AssertionError: Wipe transition should finish

E           assert False



tests\test_transition_integration.py:249: AssertionError

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'


---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:688 All settings cleared

________ TestTransitionIntegration.test_transition_settings_respected _________



self = <tests.test_transition_integration.TestTransitionIntegration object at 0x00000275B0FBD790>

qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

display_widget = <rendering.display_widget.DisplayWidget(0x27650c41ba0) at 0x000002760610B580>

test_pixmap = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc7600000002) at 0x0000027602D04580>

test_pixmap2 = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc7700000002) at 0x0000027602D06D00>



    def test_transition_settings_respected(self, qt_app, display_widget, test_pixmap, test_pixmap2):

        """Test that transition settings are properly read and applied."""

        # Set specific settings

        self._set_transitions(

            display_widget.settings_manager,

            transition_type='Slide',

            duration_ms=750,

            slide_direction='Top to Bottom',

        )

    

        display_widget.set_image(test_pixmap, "test1.png")

        display_widget.set_image(test_pixmap2, "test2.png")

    

        # Verify the active slide-style transition honours duration and direction

        current = display_widget._current_transition

        if current:

>           assert current.duration_ms == 750

E           assert 5032 == 750

E            +  where 5032 = GLCompositorSlideTransition(duration=5032ms, state=running).duration_ms



tests\test_transition_integration.py:290: AssertionError

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'


---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:688 All settings cleared

_ TestTransitionIntegration.test_diffuse_transition_software_backend_no_watchdog _



self = <tests.test_transition_integration.TestTransitionIntegration object at 0x00000275B0FBE9D0>

qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x27650ed4df0) at 0x0000027606F082C0>

test_pixmap = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc8200000002) at 0x0000027606F08F00>

test_pixmap2 = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc8300000002) at 0x0000027606F09740>



    def test_diffuse_transition_software_backend_no_watchdog(self, qt_app, settings_manager, test_pixmap, test_pixmap2):

        self._set_transitions(

            settings_manager,

            transition_type='Diffuse',

            duration_ms=300,

            diffuse_block_size=50,

        )

        settings_manager.set('display.render_backend_mode', 'software')

        settings_manager.set('display.hw_accel', False)

        settings_manager.set('transitions.watchdog_timeout_sec', 1.0)

    

        widget = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        widget.resize(400, 400)

    

        watchdog_flag = {'triggered': False}

>       original_timeout = widget._on_transition_watchdog_timeout

                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'DisplayWidget' object has no attribute '_on_transition_watchdog_timeout'



tests\test_transition_integration.py:350: AttributeError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:688 All settings cleared

_ TestTransitionIntegration.test_block_flip_transition_software_backend_no_watchdog _



self = <tests.test_transition_integration.TestTransitionIntegration object at 0x00000275B0FBEFD0>

qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x27650ed4e50) at 0x000002767E85F700>

test_pixmap = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc8400000002) at 0x0000027606133C40>

test_pixmap2 = <PySide6.QtGui.QPixmap(QSize(200, 200),depth=32,devicePixelRatio=1,cacheKey=0xc8500000002) at 0x0000027606131D00>



    def test_block_flip_transition_software_backend_no_watchdog(self, qt_app, settings_manager, test_pixmap, test_pixmap2):

        self._set_transitions(

            settings_manager,

            transition_type='Block Puzzle Flip',

            duration_ms=300,

            block_rows=2,

            block_cols=2,

        )

        settings_manager.set('display.render_backend_mode', 'software')

        settings_manager.set('display.hw_accel', False)

        settings_manager.set('transitions.watchdog_timeout_sec', 1.0)

    

        widget = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        widget.resize(400, 400)

    

        watchdog_flag = {'triggered': False}

>       original_timeout = widget._on_transition_watchdog_timeout

                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'DisplayWidget' object has no attribute '_on_transition_watchdog_timeout'



tests\test_transition_integration.py:396: AttributeError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:688 All settings cleared

_________________ TestBaseTelemetry.test_mark_start_sets_time _________________



self = <tests.test_transition_telemetry.TestBaseTelemetry object at 0x00000275B0FBCE10>



    def test_mark_start_sets_time(self):

        """_mark_start should set start time."""

        from transitions.crossfade_transition import CrossfadeTransition

    

        trans = CrossfadeTransition(duration_ms=1000)

    

        trans._mark_start()

    

>       assert trans._start_time is not None

E       assert None is not None

E        +  where None = CrossfadeTransition(duration=1000ms, state=idle)._start_time



tests\test_transition_telemetry.py:62: AssertionError

__________________ TestBaseTelemetry.test_mark_end_sets_time __________________



self = <tests.test_transition_telemetry.TestBaseTelemetry object at 0x00000275B0FCCF50>



    def test_mark_end_sets_time(self):

        """_mark_end should set end time."""

        from transitions.crossfade_transition import CrossfadeTransition

    

        trans = CrossfadeTransition(duration_ms=1000)

    

        trans._mark_start()

        time.sleep(0.01)

        trans._mark_end()

    

>       assert trans._end_time is not None

E       assert None is not None

E        +  where None = CrossfadeTransition(duration=1000ms, state=idle)._end_time



tests\test_transition_telemetry.py:75: AssertionError

_______ TestBaseTelemetry.test_get_elapsed_ms_returns_time_after_start ________



self = <tests.test_transition_telemetry.TestBaseTelemetry object at 0x00000275B0FCD9D0>



    def test_get_elapsed_ms_returns_time_after_start(self):

        """get_elapsed_ms should return elapsed time after start."""

        from transitions.crossfade_transition import CrossfadeTransition

    

        trans = CrossfadeTransition(duration_ms=1000)

    

        trans._mark_start()

        time.sleep(0.05)  # 50ms

    

        elapsed = trans.get_elapsed_ms()

    

>       assert elapsed is not None

E       assert None is not None



tests\test_transition_telemetry.py:99: AssertionError

_______________ TestTelemetryLogging.test_mark_start_logs_debug _______________



self = <tests.test_transition_telemetry.TestTelemetryLogging object at 0x00000275B0FCDF50>

caplog = <_pytest.logging.LogCaptureFixture object at 0x00000276061321D0>



    def test_mark_start_logs_debug(self, caplog):

        """_mark_start should log debug message."""

        from transitions.crossfade_transition import CrossfadeTransition

    

        trans = CrossfadeTransition(duration_ms=1000)

    

        with caplog.at_level("DEBUG"):

            trans._mark_start()

    

        # Check for PERF log

        perf_logs = [r for r in caplog.records if "[PERF]" in r.message]

>       assert len(perf_logs) > 0

E       assert 0 > 0

E        +  where 0 = len([])



tests\test_transition_telemetry.py:117: AssertionError

_____________ TestTelemetryLogging.test_mark_end_logs_performance _____________



self = <tests.test_transition_telemetry.TestTelemetryLogging object at 0x00000275B0FCE310>

caplog = <_pytest.logging.LogCaptureFixture object at 0x00000275C67FE690>



    def test_mark_end_logs_performance(self, caplog):

        """_mark_end should log performance metrics."""

        from transitions.crossfade_transition import CrossfadeTransition

    

        trans = CrossfadeTransition(duration_ms=1000)

        trans._mark_start()

        time.sleep(0.05)

    

        with caplog.at_level("INFO"):

            trans._mark_end()

    

        # Should log completion time

        perf_logs = [r for r in caplog.records if "[PERF]" in r.message and "completed" in r.message]

>       assert len(perf_logs) > 0

E       assert 0 > 0

E        +  where 0 = len([])



tests\test_transition_telemetry.py:132: AssertionError

__________ TestTelemetryLogging.test_mark_end_warns_on_timing_drift ___________



self = <tests.test_transition_telemetry.TestTelemetryLogging object at 0x00000275B0FCE950>

caplog = <_pytest.logging.LogCaptureFixture object at 0x0000027606F65310>



    def test_mark_end_warns_on_timing_drift(self, caplog):

        """_mark_end should warn if actual time differs from expected."""

        from transitions.crossfade_transition import CrossfadeTransition

    

        trans = CrossfadeTransition(duration_ms=100)  # Expect 100ms

        trans._mark_start()

        time.sleep(0.2)  # Actually take 200ms

    

        with caplog.at_level("WARNING"):

            trans._mark_end()

    

        # Should log timing drift warning

        drift_logs = [r for r in caplog.records if "TIMING DRIFT" in r.message]

>       assert len(drift_logs) > 0

E       assert 0 > 0

E        +  where 0 = len([])



tests\test_transition_telemetry.py:147: AssertionError

________ TestGLTransitionTelemetry.test_gl_crossfade_calls_mark_start _________



self = <tests.test_transition_telemetry.TestGLTransitionTelemetry object at 0x00000275B0FCF210>

qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

dummy_widget = <PySide6.QtWidgets.QWidget(0x2765119cca0) at 0x0000027602C4E8C0>

dummy_pixmap = <PySide6.QtGui.QPixmap(QSize(10, 10),depth=32,devicePixelRatio=1,cacheKey=0xc8600000001) at 0x0000027602C4F7C0>



    def test_gl_crossfade_calls_mark_start(self, qapp, dummy_widget, dummy_pixmap):

        """GL compositor crossfade should call _mark_start on transition start."""

        from transitions.gl_compositor_crossfade_transition import (

            GLCompositorCrossfadeTransition,

        )

    

        trans = GLCompositorCrossfadeTransition(duration_ms=1000)

    

        trans.start(dummy_pixmap, dummy_pixmap, dummy_widget)

    

        # Should have start time set

>       assert trans._start_time is not None

E       assert None is not None

E        +  where None = GLCompositorCrossfadeTransition(duration=1000ms, state=finished)._start_time



tests\test_transition_telemetry.py:164: AssertionError

------------------------------ Captured log call ------------------------------

WARNING  transitions.gl_compositor_crossfade_transition:gl_compositor_crossfade_transition.py:62 [GL COMPOSITOR] No compositor attached to widget; falling back to immediate display

___ TestGLTransitionTelemetry.test_gl_crossfade_calls_mark_end_on_complete ____



self = <tests.test_transition_telemetry.TestGLTransitionTelemetry object at 0x00000275B0FCF8D0>

qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

dummy_widget = <PySide6.QtWidgets.QWidget(0x2765119cee0) at 0x0000027606131300>

dummy_pixmap = <PySide6.QtGui.QPixmap(QSize(10, 10),depth=32,devicePixelRatio=1,cacheKey=0xc8700000001) at 0x0000027606133980>



    def test_gl_crossfade_calls_mark_end_on_complete(self, qapp, dummy_widget, dummy_pixmap):

        """GL compositor crossfade should call _mark_end when animation completes."""

        from transitions.gl_compositor_crossfade_transition import (

            GLCompositorCrossfadeTransition,

        )

    

        trans = GLCompositorCrossfadeTransition(duration_ms=100)

        trans.start(dummy_pixmap, dummy_pixmap, dummy_widget)

    

        # Manually trigger completion

        trans._on_anim_complete()

    

        # Should have end time set

>       assert trans._end_time is not None

E       assert None is not None

E        +  where None = GLCompositorCrossfadeTransition(duration=100ms, state=finished)._end_time



tests\test_transition_telemetry.py:179: AssertionError

------------------------------ Captured log call ------------------------------

WARNING  transitions.gl_compositor_crossfade_transition:gl_compositor_crossfade_transition.py:62 [GL COMPOSITOR] No compositor attached to widget; falling back to immediate display

______________ TestPerformanceMetrics.test_elapsed_time_accuracy ______________



self = <tests.test_transition_telemetry.TestPerformanceMetrics object at 0x00000275B0FD4AD0>



    def test_elapsed_time_accuracy(self):

        """Elapsed time calculation should be accurate."""

        from transitions.crossfade_transition import CrossfadeTransition

    

        trans = CrossfadeTransition(duration_ms=1000)

    

        trans._mark_start()

        sleep_time = 0.1  # 100ms

        time.sleep(sleep_time)

    

        elapsed = trans.get_elapsed_ms()

    

        # Should be within 20ms of expected

>       assert abs(elapsed - (sleep_time * 1000)) < 20

                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E       TypeError: unsupported operand type(s) for -: 'NoneType' and 'float'



tests\test_transition_telemetry.py:212: TypeError

________________ TestPerformanceMetrics.test_delta_calculation ________________



self = <tests.test_transition_telemetry.TestPerformanceMetrics object at 0x00000275B0FD50D0>



    def test_delta_calculation(self):

        """Delta from expected duration should be calculated."""

        from transitions.crossfade_transition import CrossfadeTransition

    

        trans = CrossfadeTransition(duration_ms=100)

        trans._mark_start()

        time.sleep(0.15)  # 150ms actual vs 100ms expected

        trans._mark_end()

    

        # Delta should be ~50ms

>       delta = (trans._end_time - trans._start_time) * 1000 - trans.duration_ms

                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E       TypeError: unsupported operand type(s) for -: 'NoneType' and 'NoneType'



tests\test_transition_telemetry.py:224: TypeError

____________________________ test_weather_creation ____________________________



qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

parent_widget = <PySide6.QtWidgets.QWidget(0x276511a3300) at 0x0000027606F32300>



    def test_weather_creation(qapp, parent_widget):

        """Test weather widget creation."""

        weather = WeatherWidget(

            parent=parent_widget,

            location="London",

            position=WeatherPosition.BOTTOM_LEFT

        )

    

        assert weather is not None

        assert weather._location == "London"

>       assert weather._position == WeatherPosition.BOTTOM_LEFT

E       AssertionError: assert <OverlayPosition.BOTTOM_LEFT: 'bottom_left'> == <WeatherPosition.BOTTOM_LEFT: 'bottom_left'>

E        +  where <OverlayPosition.BOTTOM_LEFT: 'bottom_left'> = <widgets.weather_widget.WeatherWidget(0x276511a39c0) at 0x0000027606F31F00>._position

E        +  and   <WeatherPosition.BOTTOM_LEFT: 'bottom_left'> = WeatherPosition.BOTTOM_LEFT



tests\test_weather_widget.py:63: AssertionError

______________________________ test_weather_stop ______________________________



qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

parent_widget = <PySide6.QtWidgets.QWidget(0x276511a44a0) at 0x0000027606F2D200>



    def test_weather_stop(qapp, parent_widget):

        """Test stopping weather widget."""

        weather = WeatherWidget(parent=parent_widget)

    

        # Mock the fetch to avoid actual API call

        with patch.object(weather, '_fetch_weather'):

            weather.start()

            assert weather.is_running() is True

    

>           weather.stop()



tests\test_weather_widget.py:86: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.weather_widget.WeatherWidget(0x276511a3ba0) at 0x0000027606F2CA80>



    def stop(self) -> None:

        """Stop weather updates."""

        if not self._enabled:

            return

    

        if self._update_timer_handle is not None:

            try:

                self._update_timer_handle.stop()

            except Exception:

                pass

            self._update_timer_handle = None

    

        if self._update_timer is not None:

            try:

                self._update_timer.stop()

                self._update_timer.deleteLater()

            except RuntimeError:

                pass

            self._update_timer = None

        if self._retry_timer:

            try:

                self._retry_timer.stop()

                self._retry_timer.deleteLater()

            except RuntimeError:

                pass

            self._retry_timer = None

    

>       if self._icon_timer_handle is not None:

           ^^^^^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'WeatherWidget' object has no attribute '_icon_timer_handle'



widgets\weather_widget.py:269: AttributeError

_____________________________ test_weather_cache ______________________________



qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

parent_widget = <PySide6.QtWidgets.QWidget(0x276511a0360) at 0x0000027606F47E00>

mock_weather_data = {'main': {'humidity': 65, 'temp': 20.5}, 'name': 'London', 'weather': [{'description': 'scattered clouds', 'main': 'Clouds'}]}



    def test_weather_cache(qapp, parent_widget, mock_weather_data):

        """Test weather caching."""

        weather = WeatherWidget(parent=parent_widget)

    

        # Initially no cache

>       assert weather._is_cache_valid() is False

E       assert True is False

E        +  where True = _is_cache_valid()

E        +    where _is_cache_valid = <widgets.weather_widget.WeatherWidget(0x276511a03c0) at 0x0000027606F2ED80>._is_cache_valid



tests\test_weather_widget.py:122: AssertionError

_________________________ test_weather_all_positions __________________________



qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

parent_widget = <PySide6.QtWidgets.QWidget(0x276511a2b80) at 0x00000276061307C0>



    def test_weather_all_positions(qapp, parent_widget):

        """Test all weather positions."""

        positions = [

            WeatherPosition.TOP_LEFT,

            WeatherPosition.TOP_RIGHT,

            WeatherPosition.BOTTOM_LEFT,

            WeatherPosition.BOTTOM_RIGHT

        ]

    

        for position in positions:

            weather = WeatherWidget(

                parent=parent_widget,

                position=position

            )

    

>           assert weather._position == position

E           AssertionError: assert <OverlayPosition.TOP_LEFT: 'top_left'> == <WeatherPosition.TOP_LEFT: 'top_left'>

E            +  where <OverlayPosition.TOP_LEFT: 'top_left'> = <widgets.weather_widget.WeatherWidget(0x276511a1d40) at 0x00000276061313C0>._position



tests\test_weather_widget.py:147: AssertionError

_________________________ test_weather_set_font_size __________________________



qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

parent_widget = <PySide6.QtWidgets.QWidget(0x276511a75c0) at 0x00000276061B7F00>



    def test_weather_set_font_size(qapp, parent_widget):

        """Test setting font size."""

        weather = WeatherWidget(parent=parent_widget)

    

        weather.set_font_size(32)

        assert weather._font_size == 32

    

        # Invalid size should fall back

        weather.set_font_size(-10)

>       assert weather._font_size == 24

E       assert 8 == 24

E        +  where 8 = <widgets.weather_widget.WeatherWidget(0x276511a7020) at 0x00000276061B4480>._font_size



tests\test_weather_widget.py:203: AssertionError

____________________________ test_weather_cleanup _____________________________



qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

parent_widget = <PySide6.QtWidgets.QWidget(0x276511a6660) at 0x0000027606F72480>



    def test_weather_cleanup(qapp, parent_widget):

        """Test weather cleanup."""

        weather = WeatherWidget(parent=parent_widget)

    

        with patch.object(weather, '_fetch_weather'):

            weather.start()

            assert weather.is_running() is True

    

>           weather.cleanup()



tests\test_weather_widget.py:224: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

widgets\weather_widget.py:698: in cleanup

    self.stop()

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.weather_widget.WeatherWidget(0x276511a72c0) at 0x00000275B10525C0>



    def stop(self) -> None:

        """Stop weather updates."""

        if not self._enabled:

            return

    

        if self._update_timer_handle is not None:

            try:

                self._update_timer_handle.stop()

            except Exception:

                pass

            self._update_timer_handle = None

    

        if self._update_timer is not None:

            try:

                self._update_timer.stop()

                self._update_timer.deleteLater()

            except RuntimeError:

                pass

            self._update_timer = None

        if self._retry_timer:

            try:

                self._retry_timer.stop()

                self._retry_timer.deleteLater()

            except RuntimeError:

                pass

            self._retry_timer = None

    

>       if self._icon_timer_handle is not None:

           ^^^^^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'WeatherWidget' object has no attribute '_icon_timer_handle'



widgets\weather_widget.py:269: AttributeError

_________________________ test_weather_fetcher_error __________________________



mock_get = <MagicMock name='get' id='2705877024208'>

qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>



    @patch('weather.open_meteo_provider.requests.get')

    def test_weather_fetcher_error(mock_get, qapp):

        """Test weather fetch error."""

        # Mock failed API response

        mock_get.side_effect = Exception("Network error")

    

        fetcher = WeatherFetcher(location="London")

    

        errors_received = []

        fetcher.error_occurred.connect(lambda e: errors_received.append(e))

    

        fetcher.fetch()

    

>       assert len(errors_received) == 1

E       assert 0 == 1

E        +  where 0 = len([])



tests\test_weather_widget.py:302: AssertionError

---------------------------- Captured Qt messages -----------------------------

QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)
QtWarningMsg: QSettings: Failed to delete key "Software\Test\ScreensaverTest" (Illegal operation attempted on a registry key that has been marked for deletion.)


__________________ test_weather_concurrent_start_prevention ___________________



qapp = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>

parent_widget = <PySide6.QtWidgets.QWidget(0x2765119d6c0) at 0x000002760611BBC0>



    def test_weather_concurrent_start_prevention(qapp, parent_widget):

        """Test that starting when already running is handled."""

        weather = WeatherWidget(parent=parent_widget)

    

        with patch.object(weather, '_fetch_weather'):

            weather.start()

            assert weather.is_running() is True

    

            # Try to start again

            weather.start()

            assert weather.is_running() is True

    

>           weather.stop()



tests\test_weather_widget.py:327: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.weather_widget.WeatherWidget(0x2765119e620) at 0x000002760611BC40>



    def stop(self) -> None:

        """Stop weather updates."""

        if not self._enabled:

            return

    

        if self._update_timer_handle is not None:

            try:

                self._update_timer_handle.stop()

            except Exception:

                pass

            self._update_timer_handle = None

    

        if self._update_timer is not None:

            try:

                self._update_timer.stop()

                self._update_timer.deleteLater()

            except RuntimeError:

                pass

            self._update_timer = None

        if self._retry_timer:

            try:

                self._retry_timer.stop()

                self._retry_timer.deleteLater()

            except RuntimeError:

                pass

            self._retry_timer = None

    

>       if self._icon_timer_handle is not None:

           ^^^^^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'WeatherWidget' object has no attribute '_icon_timer_handle'



widgets\weather_widget.py:269: AttributeError

------------------------------ Captured log call ------------------------------

WARNING  widgets.weather_widget:weather_widget.py:177 [FALLBACK] Weather widget already running

_______________ TestWidgetsTab.test_widgets_tab_default_values ________________



self = <tests.test_widgets_tab.TestWidgetsTab object at 0x00000275B10A91D0>

qt_app = <PySide6.QtWidgets.QApplication(0x275810ee560) at 0x00000275B0F92E00>



    def test_widgets_tab_default_values(self, qt_app):

        """Default widget settings match canonical SettingsManager defaults."""

        mgr = SettingsManager(organization="Test", application="WidgetsTabTest")

        # Ensure a clean slate and then re-apply canonical defaults so the

        # nested `widgets` map reflects SettingsManager._set_defaults().

        mgr.reset_to_defaults()

    

        tab = WidgetsTab(mgr)

    

        # Clock defaults: enabled on monitor 1, Top Right, 24h, seconds on,

        # analogue mode with background frame enabled at 70% opacity.

        assert tab.clock_enabled.isChecked() is True

        assert tab.clock_position.currentText() == "Top Right"

        assert tab.clock_format.currentText() == "24 Hour"

        assert tab.clock_seconds.isChecked() is True

        assert tab.clock_show_background.isChecked() is True

        assert tab.clock_bg_opacity.value() == 70

        # Monitor selection stored as integer 1 in settings  combo shows "1"

>       assert tab.clock_monitor_combo.currentText() == "1"

E       AssertionError: assert 'ALL' == '1'

E         

E         - 1

E         + ALL



tests\test_widgets_tab.py:49: AssertionError

============================== warnings summary ===============================

tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\input_handler.py:620: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    pos = event.pos()




tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets
tests/test_s_hotkey_workflow.py::test_s_hotkey_opens_settings_without_crash
tests/test_s_hotkey_workflow.py::test_s_hotkey_opens_settings_without_crash


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2321: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    logger.info(f"Mouse clicked at ({event.pos().x()}, {event.pos().y()}), requesting exit")




tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344]
tests/test_integration.py::test_engine_default_rss_sources
tests/test_s_hotkey_workflow.py::test_s_hotkey_opens_settings_without_crash


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2350: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    self._initial_mouse_pos = event.pos()




tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344]
tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344]
tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344]
tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344]
tests/test_integration.py::test_engine_default_rss_sources
tests/test_s_hotkey_workflow.py::test_s_hotkey_opens_settings_without_crash


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2355: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dx = event.pos().x() - self._initial_mouse_pos.x()




tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344]
tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344]
tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344]
tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344]
tests/test_integration.py::test_engine_default_rss_sources
tests/test_s_hotkey_workflow.py::test_s_hotkey_opens_settings_without_crash


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2356: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dy = event.pos().y() - self._initial_mouse_pos.y()




tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_ctrl_interaction_mode.py:254: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

=========================== short test summary info ===========================

FAILED tests/test_display_tab.py::TestDisplayTab::test_display_tab_default_values

FAILED tests/test_flicker_fix_integration.py::TestTransitionTelemetryFlow::test_transition_tracks_timing

FAILED tests/test_media_widget.py::test_media_widget_displays_metadata - Asse...

FAILED tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears

FAILED tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins

FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears

FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget

FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget

FAILED tests/test_overlay_ready_state.py::TestDisplayWidgetOverlayDiagnostics::test_handle_screen_change_updates_geometry_and_dpi

FAILED tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_creation

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_modes

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_directions

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_swirl_orders

FAILED tests/test_particle_transition.py::TestSettingsDefaults::test_settings_manager_has_particle_defaults

FAILED tests/test_reddit_exit_logic.py::TestRedditClickRouting::test_reddit_click_returns_handled_tuple

FAILED tests/test_rss_behavior.py::TestRSSBehavior::test_image_queue_history_prevents_duplicates

FAILED tests/test_settings_dialog.py::test_settings_dialog_has_tabs - assert ...

FAILED tests/test_settings_dialog.py::test_settings_dialog_has_content_stack

FAILED tests/test_settings_dialog.py::test_settings_dialog_tab_switching - as...

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_time_update_with_timezone

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_timezone_display_formats

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_crossfade_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_slide_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_block_puzzle_flip_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_wipe_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_transition_settings_respected

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_software_backend_no_watchdog

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_block_flip_transition_software_backend_no_watchdog

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_start_sets_time

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_end_sets_time

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_get_elapsed_ms_returns_time_after_start

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_start_logs_debug

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_logs_performance

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_warns_on_timing_drift

FAILED tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_start

FAILED tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_end_on_complete

FAILED tests/test_transition_telemetry.py::TestPerformanceMetrics::test_elapsed_time_accuracy

FAILED tests/test_transition_telemetry.py::TestPerformanceMetrics::test_delta_calculation

FAILED tests/test_weather_widget.py::test_weather_creation - AssertionError: ...

FAILED tests/test_weather_widget.py::test_weather_stop - AttributeError: 'Wea...

FAILED tests/test_weather_widget.py::test_weather_cache - assert True is False

FAILED tests/test_weather_widget.py::test_weather_all_positions - AssertionEr...

FAILED tests/test_weather_widget.py::test_weather_set_font_size - assert 8 == 24

FAILED tests/test_weather_widget.py::test_weather_cleanup - AttributeError: '...

FAILED tests/test_weather_widget.py::test_weather_fetcher_error - assert 0 == 1

FAILED tests/test_weather_widget.py::test_weather_concurrent_start_prevention

FAILED tests/test_widgets_tab.py::TestWidgetsTab::test_widgets_tab_default_values

===== 49 failed, 489 passed, 20 skipped, 24 warnings in 521.57s (0:08:41) =====


===== pytest run 2025-12-18 11:07:09 args=['tests/test_settings.py', 'tests/test_transitions_tab.py', 'tests/test_rss_behavior.py', '-v'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 18 items



tests/test_settings.py::test_settings_manager_initialization 
PASSED      [  5%]


tests/test_settings.py::test_get_set_setting 
PASSED                      [ 11%]


tests/test_settings.py::test_default_values 
PASSED                       [ 16%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED [ 22%]


tests/test_settings.py::test_on_changed_handler 
PASSED                   [ 27%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                    [ 33%]


tests/test_settings.py::test_get_all_keys 
PASSED                         [ 38%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED              [ 44%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED [ 50%]


tests/test_transitions_tab.py::test_slide_and_wipe_directions_are_independent 
PASSED [ 55%]


tests/test_transitions_tab.py::test_default_transition_type_and_direction 
PASSED [ 61%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_source_fetches_from_multiple_feeds 
PASSED [ 66%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_source_tracks_cached_urls 
PASSED [ 72%]


tests/test_rss_behavior.py::TestRSSBehavior::test_image_queue_rotates_rss_images 
PASSED [ 77%]


tests/test_rss_behavior.py::TestRSSBehavior::test_image_queue_history_prevents_duplicates 
PASSED [ 83%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_refresh_adds_new_images_only 
PASSED [ 88%]


tests/test_rss_behavior.py::TestRSSIntegration::test_real_reddit_feed 
SKIPPED [ 94%]


tests/test_rss_behavior.py::TestRSSIntegration::test_rate_limiting_behavior 
SKIPPED [100%]




======================= 16 passed, 2 skipped in 12.82s ========================


===== pytest run 2025-12-18 11:07:29 args=['tests/test_settings.py', 'tests/test_transitions_tab.py', 'tests/test_rss_behavior.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 18 items



tests/test_settings.py::test_settings_manager_initialization 
PASSED                                                                                                                                  [  5%]


tests/test_settings.py::test_get_set_setting 
PASSED                                                                                                                                                  [ 11%]


tests/test_settings.py::test_default_values 
PASSED                                                                                                                                                   [ 16%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED                                                                                                                            [ 22%]


tests/test_settings.py::test_on_changed_handler 
PASSED                                                                                                                                               [ 27%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                                                                                                                                                [ 33%]


tests/test_settings.py::test_get_all_keys 
PASSED                                                                                                                                                     [ 38%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED                                                                                                                                          [ 44%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED                                                                                                                          [ 50%]


tests/test_transitions_tab.py::test_slide_and_wipe_directions_are_independent 
PASSED                                                                                                                 [ 55%]


tests/test_transitions_tab.py::test_default_transition_type_and_direction 
PASSED                                                                                                                     [ 61%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_source_fetches_from_multiple_feeds 
PASSED                                                                                                      [ 66%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_source_tracks_cached_urls 
PASSED                                                                                                               [ 72%]


tests/test_rss_behavior.py::TestRSSBehavior::test_image_queue_rotates_rss_images 
PASSED                                                                                                              [ 77%]


tests/test_rss_behavior.py::TestRSSBehavior::test_image_queue_history_prevents_duplicates 
PASSED                                                                                                     [ 83%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_refresh_adds_new_images_only 
PASSED                                                                                                            [ 88%]


tests/test_rss_behavior.py::TestRSSIntegration::test_real_reddit_feed 
SKIPPED (Requires network access - run manually with: pytest -k test_real -s)                                                  [ 94%]


tests/test_rss_behavior.py::TestRSSIntegration::test_rate_limiting_behavior 
SKIPPED (Requires network access - run manually)                                                                         [100%]




===================================================================================== 16 passed, 2 skipped in 12.84s ======================================================================================


===== pytest run 2025-12-18 11:07:49 args=['tests/test_settings.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 9 items



tests/test_settings.py::test_settings_manager_initialization 
PASSED                                                                                                                                  [ 11%]


tests/test_settings.py::test_get_set_setting 
PASSED                                                                                                                                                  [ 22%]


tests/test_settings.py::test_default_values 
PASSED                                                                                                                                                   [ 33%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED                                                                                                                            [ 44%]


tests/test_settings.py::test_on_changed_handler 
PASSED                                                                                                                                               [ 55%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                                                                                                                                                [ 66%]


tests/test_settings.py::test_get_all_keys 
PASSED                                                                                                                                                     [ 77%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED                                                                                                                                          [ 88%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED                                                                                                                          [100%]




============================================================================================ 9 passed in 0.18s ============================================================================================


===== pytest run 2025-12-18 11:07:57 args=['tests/test_settings.py', '-v', '--tb=short'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 9 items



tests/test_settings.py::test_settings_manager_initialization 
PASSED      [ 11%]


tests/test_settings.py::test_get_set_setting 
PASSED                      [ 22%]


tests/test_settings.py::test_default_values 
PASSED                       [ 33%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED [ 44%]


tests/test_settings.py::test_on_changed_handler 
PASSED                   [ 55%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                    [ 66%]


tests/test_settings.py::test_get_all_keys 
PASSED                         [ 77%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED              [ 88%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED [100%]




============================== 9 passed in 0.20s ==============================


===== pytest run 2025-12-18 11:08:17 args=['tests/test_settings.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 9 items



tests/test_settings.py::test_settings_manager_initialization 
PASSED                                                                                                                                  [ 11%]


tests/test_settings.py::test_get_set_setting 
PASSED                                                                                                                                                  [ 22%]


tests/test_settings.py::test_default_values 
PASSED                                                                                                                                                   [ 33%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED                                                                                                                            [ 44%]


tests/test_settings.py::test_on_changed_handler 
PASSED                                                                                                                                               [ 55%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                                                                                                                                                [ 66%]


tests/test_settings.py::test_get_all_keys 
PASSED                                                                                                                                                     [ 77%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED                                                                                                                                          [ 88%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED                                                                                                                          [100%]




============================================================================================ 9 passed in 0.18s ============================================================================================


===== pytest run 2025-12-18 11:08:24 args=['tests/test_settings.py', '-v', '--tb=short'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 9 items



tests/test_settings.py::test_settings_manager_initialization 
PASSED      [ 11%]


tests/test_settings.py::test_get_set_setting 
PASSED                      [ 22%]


tests/test_settings.py::test_default_values 
PASSED                       [ 33%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED [ 44%]


tests/test_settings.py::test_on_changed_handler 
PASSED                   [ 55%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                    [ 66%]


tests/test_settings.py::test_get_all_keys 
PASSED                         [ 77%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED              [ 88%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED [100%]




============================== 9 passed in 0.20s ==============================


===== pytest run 2025-12-18 11:08:38 args=['tests/test_settings.py', '-v', '--tb=short'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 9 items



tests/test_settings.py::test_settings_manager_initialization 
PASSED      [ 11%]


tests/test_settings.py::test_get_set_setting 
PASSED                      [ 22%]


tests/test_settings.py::test_default_values 
PASSED                       [ 33%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED [ 44%]


tests/test_settings.py::test_on_changed_handler 
PASSED                   [ 55%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                    [ 66%]


tests/test_settings.py::test_get_all_keys 
PASSED                         [ 77%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED              [ 88%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED [100%]




============================== 9 passed in 0.16s ==============================


===== pytest run 2025-12-18 11:09:13 args=['tests/test_settings.py', 'tests/test_transitions_tab.py', 'tests/test_rss_behavior.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 18 items



tests/test_settings.py::test_settings_manager_initialization 
PASSED                                                                                                                                  [  5%]


tests/test_settings.py::test_get_set_setting 
PASSED                                                                                                                                                  [ 11%]


tests/test_settings.py::test_default_values 
PASSED                                                                                                                                                   [ 16%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED                                                                                                                            [ 22%]


tests/test_settings.py::test_on_changed_handler 
PASSED                                                                                                                                               [ 27%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                                                                                                                                                [ 33%]


tests/test_settings.py::test_get_all_keys 
PASSED                                                                                                                                                     [ 38%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED                                                                                                                                          [ 44%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED                                                                                                                          [ 50%]


tests/test_transitions_tab.py::test_slide_and_wipe_directions_are_independent 
PASSED                                                                                                                 [ 55%]


tests/test_transitions_tab.py::test_default_transition_type_and_direction 
PASSED                                                                                                                     [ 61%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_source_fetches_from_multiple_feeds 
PASSED                                                                                                      [ 66%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_source_tracks_cached_urls 
PASSED                                                                                                               [ 72%]


tests/test_rss_behavior.py::TestRSSBehavior::test_image_queue_rotates_rss_images 
PASSED                                                                                                              [ 77%]


tests/test_rss_behavior.py::TestRSSBehavior::test_image_queue_history_prevents_duplicates 
FAILED                                                                                                     [ 83%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_refresh_adds_new_images_only 
PASSED                                                                                                            [ 88%]


tests/test_rss_behavior.py::TestRSSIntegration::test_real_reddit_feed 
SKIPPED (Requires network access - run manually with: pytest -k test_real -s)                                                  [ 94%]


tests/test_rss_behavior.py::TestRSSIntegration::test_rate_limiting_behavior 
SKIPPED (Requires network access - run manually)                                                                         [100%]




================================================================================================ FAILURES =================================================================================================

______________________________________________________________________ TestRSSBehavior.test_image_queue_history_prevents_duplicates _______________________________________________________________________

tests\test_rss_behavior.py:261: in test_image_queue_history_prevents_duplicates

    assert consecutive_duplicates <= 2, \

E   AssertionError: Too many consecutive duplicates: 3

E   assert 3 <= 2

------------------------------------------------------------------------------------------ Captured stdout call -------------------------------------------------------------------------------------------


=== Duplicate Prevention Test ===
RSS pool size: 3
Selected sequence: ['rss_image_2', 'rss_image_1', 'rss_image_0', 'rss_image_0', 'rss_image_1', 'rss_image_2', 'rss_image_2', 'rss_image_1', 'rss_image_0', 'rss_image_0']
Consecutive duplicates: 3


========================================================================================= short test summary info =========================================================================================

FAILED tests/test_rss_behavior.py::TestRSSBehavior::test_image_queue_history_prevents_duplicates - AssertionError: Too many consecutive duplicates: 3

================================================================================ 1 failed, 15 passed, 2 skipped in 13.25s =================================================================================


===== pytest run 2025-12-18 11:09:54 args=['tests/test_settings.py', 'tests/test_transitions_tab.py', 'tests/test_transitions_integration.py', 'tests/test_image_queue.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 38 items



tests/test_settings.py::test_settings_manager_initialization 
PASSED                                                                                                                                  [  2%]


tests/test_settings.py::test_get_set_setting 
PASSED                                                                                                                                                  [  5%]


tests/test_settings.py::test_default_values 
PASSED                                                                                                                                                   [  7%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED                                                                                                                            [ 10%]


tests/test_settings.py::test_on_changed_handler 
PASSED                                                                                                                                               [ 13%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                                                                                                                                                [ 15%]


tests/test_settings.py::test_get_all_keys 
PASSED                                                                                                                                                     [ 18%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED                                                                                                                                          [ 21%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED                                                                                                                          [ 23%]


tests/test_transitions_tab.py::test_slide_and_wipe_directions_are_independent 
PASSED                                                                                                                 [ 26%]


tests/test_transitions_tab.py::test_default_transition_type_and_direction 
PASSED                                                                                                                     [ 28%]


tests/test_transitions_integration.py::test_crossfade_with_pan_and_scan 
SKIPPED (Pan & Scan feature removed in v1.2; DisplayWidget no longer exposes _pan_and_scan.)                                 [ 31%]


tests/test_transitions_integration.py::test_diffuse_with_pan_and_scan 
SKIPPED (Pan & Scan feature removed in v1.2; DisplayWidget no longer exposes _pan_and_scan.)                                   [ 34%]


tests/test_transitions_integration.py::test_pan_and_scan_no_zoom_after_transition 
SKIPPED (Pan & Scan feature removed in v1.2; DisplayWidget no longer exposes _pan_and_scan.)                       [ 36%]


tests/test_image_queue.py::test_image_queue_initialization 
PASSED                                                                                                                                    [ 39%]


tests/test_image_queue.py::test_add_images_no_shuffle 
PASSED                                                                                                                                         [ 42%]


tests/test_image_queue.py::test_add_images_with_shuffle 
PASSED                                                                                                                                       [ 44%]


tests/test_image_queue.py::test_next_image 
PASSED                                                                                                                                                    [ 47%]


tests/test_image_queue.py::test_next_multiple_images 
PASSED                                                                                                                                          [ 50%]


tests/test_image_queue.py::test_queue_wraparound 
PASSED                                                                                                                                              [ 52%]


tests/test_image_queue.py::test_current_image 
PASSED                                                                                                                                                 [ 55%]


tests/test_image_queue.py::test_peek_next_image 
PASSED                                                                                                                                               [ 57%]


tests/test_image_queue.py::test_history_tracking 
PASSED                                                                                                                                              [ 60%]


tests/test_image_queue.py::test_history_max_size 
PASSED                                                                                                                                              [ 63%]


tests/test_image_queue.py::test_is_in_recent_history 
PASSED                                                                                                                                          [ 65%]


tests/test_image_queue.py::test_shuffle_method 
PASSED                                                                                                                                                [ 68%]


tests/test_image_queue.py::test_set_shuffle_enabled 
PASSED                                                                                                                                           [ 71%]


tests/test_image_queue.py::test_clear_queue 
PASSED                                                                                                                                                   [ 73%]


tests/test_image_queue.py::test_set_images_replaces_all 
PASSED                                                                                                                                       [ 76%]


tests/test_image_queue.py::test_remove_image 
PASSED                                                                                                                                                  [ 78%]


tests/test_image_queue.py::test_remove_nonexistent_image 
PASSED                                                                                                                                      [ 81%]


tests/test_image_queue.py::test_get_stats 
PASSED                                                                                                                                                     [ 84%]


tests/test_image_queue.py::test_empty_queue_behavior 
PASSED                                                                                                                                          [ 86%]


tests/test_image_queue.py::test_queue_len_and_bool 
PASSED                                                                                                                                            [ 89%]


tests/test_image_queue.py::test_queue_repr 
PASSED                                                                                                                                                    [ 92%]


tests/test_image_queue.py::test_previous_image 
PASSED                                                                                                                                                [ 94%]


tests/test_image_queue.py::test_previous_with_no_history 
PASSED                                                                                                                                      [ 97%]


tests/test_image_queue.py::test_wraparound_preserves_shuffle 
PASSED                                                                                                                                  [100%]




====================================================================================== 35 passed, 3 skipped in 1.01s ======================================================================================


===== pytest run 2025-12-18 11:16:21 args=['tests/test_reddit_exit_logic.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 8 items



tests/test_reddit_exit_logic.py::TestRedditExitLogic::test_primary_covered_detection_same_screen 
PASSED                                                                                              [ 12%]


tests/test_reddit_exit_logic.py::TestRedditExitLogic::test_primary_covered_detection_different_screen 
PASSED                                                                                         [ 25%]


tests/test_reddit_exit_logic.py::TestRedditExitLogic::test_mc_mode_detection 
PASSED                                                                                                                  [ 37%]


tests/test_reddit_exit_logic.py::TestRedditClickRouting::test_reddit_click_returns_handled_tuple 
FAILED                                                                                              [ 50%]


tests/test_reddit_exit_logic.py::TestCacheInvalidationMitigation::test_no_setforegroundwindow_before_exit 
PASSED                                                                                     [ 62%]


tests/test_reddit_exit_logic.py::TestRedditExitIntegration::test_case_a_hard_exit_primary_covered 
SKIPPED (Requires full Qt app with multi-monitor setup)                                            [ 75%]


tests/test_reddit_exit_logic.py::TestRedditExitIntegration::test_case_b_ctrl_held_primary_covered 
SKIPPED (Requires full Qt app with multi-monitor setup)                                            [ 87%]


tests/test_reddit_exit_logic.py::TestRedditExitIntegration::test_case_c_mc_mode_stay_open 
SKIPPED (Requires full Qt app with multi-monitor setup)                                                    [100%]




================================================================================================ FAILURES =================================================================================================

_____________________________________________________________________ TestRedditClickRouting.test_reddit_click_returns_handled_tuple ______________________________________________________________________

tests\test_reddit_exit_logic.py:78: in test_reddit_click_returns_handled_tuple

    handler = InputHandler(parent)

              ^^^^^^^^^^^^^^^^^^^^

rendering\input_handler.py:74: in __init__

    super().__init__(parent)

E   TypeError: 'PySide6.QtCore.QObject.__init__' called with wrong argument types:

E     PySide6.QtCore.QObject.__init__(MagicMock)

E   Supported signatures:

E     PySide6.QtCore.QObject.__init__(parent: PySide6.QtCore.QObject | None = None, *, objectName: str | None = None)

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_reddit_exit_logic.py::TestRedditClickRouting::test_reddit_click_returns_handled_tuple - TypeError: 'PySide6.QtCore.QObject.__init__' called with wrong argument types:

================================================================================= 1 failed, 4 passed, 3 skipped in 0.51s ==================================================================================


===== pytest run 2025-12-18 11:27:32 args=['tests/test_transitions_tab.py', 'tests/test_settings.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 11 items



tests/test_transitions_tab.py::test_slide_and_wipe_directions_are_independent 
PASSED                                                                                                                 [  9%]


tests/test_transitions_tab.py::test_default_transition_type_and_direction 
PASSED                                                                                                                     [ 18%]


tests/test_settings.py::test_settings_manager_initialization 
PASSED                                                                                                                                  [ 27%]


tests/test_settings.py::test_get_set_setting 
PASSED                                                                                                                                                  [ 36%]


tests/test_settings.py::test_default_values 
PASSED                                                                                                                                                   [ 45%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED                                                                                                                            [ 54%]


tests/test_settings.py::test_on_changed_handler 
PASSED                                                                                                                                               [ 63%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                                                                                                                                                [ 72%]


tests/test_settings.py::test_get_all_keys 
PASSED                                                                                                                                                     [ 81%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED                                                                                                                                          [ 90%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED                                                                                                                          [100%]




=========================================================================================== 11 passed in 0.56s ============================================================================================


===== pytest run 2025-12-18 11:40:03 args=['tests/test_transitions_tab.py', 'tests/test_settings.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 11 items



tests/test_transitions_tab.py::test_slide_and_wipe_directions_are_independent 
PASSED                                                                                                                 [  9%]


tests/test_transitions_tab.py::test_default_transition_type_and_direction 
PASSED                                                                                                                     [ 18%]


tests/test_settings.py::test_settings_manager_initialization 
PASSED                                                                                                                                  [ 27%]


tests/test_settings.py::test_get_set_setting 
PASSED                                                                                                                                                  [ 36%]


tests/test_settings.py::test_default_values 
PASSED                                                                                                                                                   [ 45%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED                                                                                                                            [ 54%]


tests/test_settings.py::test_on_changed_handler 
PASSED                                                                                                                                               [ 63%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                                                                                                                                                [ 72%]


tests/test_settings.py::test_get_all_keys 
PASSED                                                                                                                                                     [ 81%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED                                                                                                                                          [ 90%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED                                                                                                                          [100%]




=========================================================================================== 11 passed in 0.65s ============================================================================================


===== pytest run 2025-12-19 01:08:06 args=['-q', 'tests/test_geometry_dpi_matrix.py', '-vv'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items



tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary] 
FAILED [ 16%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin] 
FAILED [ 33%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[4k_125pct] 
FAILED [ 50%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct] 
FAILED [ 66%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct] 
FAILED [ 83%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct] 
FAILED [100%]




================================== FAILURES ===================================

___ test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary] ____



qt_app = <PySide6.QtWidgets.QApplication(0x151792546e0) at 0x000001517E78A880>

settings_manager = <core.settings.settings_manager.SettingsManager(0x15177d641e0) at 0x000001517E78A6C0>

rect = PySide6.QtCore.QRect(0, 0, 1920, 1080), dpr = 1.0



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:741 All settings cleared

__ test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin] ___



qt_app = <PySide6.QtWidgets.QApplication(0x151792546e0) at 0x000001517E78A880>

settings_manager = <core.settings.settings_manager.SettingsManager(0x15177d6fe40) at 0x000001517E801E40>

rect = PySide6.QtCore.QRect(-2560, 0, 2560, 1440), dpr = 1.0



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:741 All settings cleared

________ test_handle_screen_change_applies_geometry_and_dpr[4k_125pct] ________



qt_app = <PySide6.QtWidgets.QApplication(0x151792546e0) at 0x000001517E78A880>

settings_manager = <core.settings.settings_manager.SettingsManager(0x15177d8e420) at 0x000001517E843780>

rect = PySide6.QtCore.QRect(0, 0, 3840, 2160), dpr = 1.25



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:741 All settings cleared

_____ test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct] _____



qt_app = <PySide6.QtWidgets.QApplication(0x151792546e0) at 0x000001517E78A880>

settings_manager = <core.settings.settings_manager.SettingsManager(0x15177d8df20) at 0x000001517F0849C0>

rect = PySide6.QtCore.QRect(3840, 0, 3840, 2160), dpr = 1.5



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:741 All settings cleared

__ test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct] __



qt_app = <PySide6.QtWidgets.QApplication(0x151792546e0) at 0x000001517E78A880>

settings_manager = <core.settings.settings_manager.SettingsManager(0x15177d8de60) at 0x000001517F084100>

rect = PySide6.QtCore.QRect(0, -1920, 1080, 1920), dpr = 2.0



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:741 All settings cleared

______ test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct] ______



qt_app = <PySide6.QtWidgets.QApplication(0x151792546e0) at 0x000001517E78A880>

settings_manager = <core.settings.settings_manager.SettingsManager(0x15177d8e900) at 0x000001517F0B8EC0>

rect = PySide6.QtCore.QRect(0, 0, 1366, 768), dpr = 1.75



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

---------------------------- Captured log teardown ----------------------------

WARNING  SettingsManager:settings_manager.py:741 All settings cleared

=========================== short test summary info ===========================

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary]

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin]

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[4k_125pct]

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct]

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct]

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct]

============================== 6 failed in 1.18s ==============================


===== pytest run 2025-12-19 01:12:04 args=['-q', 'tests/test_geometry_dpi_matrix.py', '-vv'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items



tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary] 
FAILED [ 16%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin] 
FAILED [ 33%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[4k_125pct] 
FAILED [ 50%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct] 
FAILED [ 66%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct] 
FAILED [ 83%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct] 
FAILED [100%]




================================== FAILURES ===================================

___ test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary] ____



qt_app = <PySide6.QtWidgets.QApplication(0x1d6abcf42c0) at 0x000001D6DB37EE00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x1d6ab6bd5f0) at 0x000001D6DB394FC0>

rect = PySide6.QtCore.QRect(0, 0, 1920, 1080), dpr = 1.0



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

__ test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin] ___



qt_app = <PySide6.QtWidgets.QApplication(0x1d6abcf42c0) at 0x000001D6DB37EE00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x1d6aa772780) at 0x000001D6DBA51E00>

rect = PySide6.QtCore.QRect(-2560, 0, 2560, 1440), dpr = 1.0



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

________ test_handle_screen_change_applies_geometry_and_dpr[4k_125pct] ________



qt_app = <PySide6.QtWidgets.QApplication(0x1d6abcf42c0) at 0x000001D6DB37EE00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x1d6aa772120) at 0x000001D6DBA625C0>

rect = PySide6.QtCore.QRect(0, 0, 3840, 2160), dpr = 1.25



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

_____ test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct] _____



qt_app = <PySide6.QtWidgets.QApplication(0x1d6abcf42c0) at 0x000001D6DB37EE00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x1d6aa772220) at 0x000001D6DB43EF40>

rect = PySide6.QtCore.QRect(3840, 0, 3840, 2160), dpr = 1.5



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

__ test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct] __



qt_app = <PySide6.QtWidgets.QApplication(0x1d6abcf42c0) at 0x000001D6DB37EE00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x1d6aa794490) at 0x000001D6DB43ED40>

rect = PySide6.QtCore.QRect(0, -1920, 1080, 1920), dpr = 2.0



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

______ test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct] ______



qt_app = <PySide6.QtWidgets.QApplication(0x1d6abcf42c0) at 0x000001D6DB37EE00>

settings_manager = <core.settings.settings_manager.SettingsManager(0x1d6aa7941d0) at 0x000001D6DB43E740>

rect = PySide6.QtCore.QRect(0, 0, 1366, 768), dpr = 1.75



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

=========================== short test summary info ===========================

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary]

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin]

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[4k_125pct]

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct]

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct]

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct]

============================== 6 failed in 0.80s ==============================


===== pytest run 2025-12-19 01:15:54 args=['-vv', 'tests/test_geometry_dpi_matrix.py'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items



tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary] 
FAILED                                                                                     [ 16%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin] 
FAILED                                                                                   [ 33%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[4k_125pct] 
FAILED                                                                                              [ 50%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct] 
FAILED                                                                                        [ 66%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct] 
FAILED                                                                                  [ 83%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct] 
FAILED                                                                                          [100%]




================================================================================================ FAILURES =================================================================================================

_________________________________________________________________ test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary] __________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1e7cf1872b0) at 0x000001E7FE7D1100>, settings_manager = <core.settings.settings_manager.SettingsManager(0x1e7cdc4f7d0) at 0x000001E7FE7D12C0>

rect = PySide6.QtCore.QRect(0, 0, 1920, 1080), dpr = 1.0



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

________________________________________________________________ test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin] _________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1e7cf1872b0) at 0x000001E7FE7D1100>, settings_manager = <core.settings.settings_manager.SettingsManager(0x1e7cdc5dc90) at 0x000001E7FE7E1F80>

rect = PySide6.QtCore.QRect(-2560, 0, 2560, 1440), dpr = 1.0



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

______________________________________________________________________ test_handle_screen_change_applies_geometry_and_dpr[4k_125pct] ______________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1e7cf1872b0) at 0x000001E7FE7D1100>, settings_manager = <core.settings.settings_manager.SettingsManager(0x1e7ce062ef0) at 0x000001E7FEE9B0C0>

rect = PySide6.QtCore.QRect(0, 0, 3840, 2160), dpr = 1.25



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

___________________________________________________________________ test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct] ___________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1e7cf1872b0) at 0x000001E7FE7D1100>, settings_manager = <core.settings.settings_manager.SettingsManager(0x1e7cf2f62d0) at 0x000001E7FEE8DB80>

rect = PySide6.QtCore.QRect(3840, 0, 3840, 2160), dpr = 1.5



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

________________________________________________________________ test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct] ________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1e7cf1872b0) at 0x000001E7FE7D1100>, settings_manager = <core.settings.settings_manager.SettingsManager(0x1e7cf2f6630) at 0x000001E7FE873F00>

rect = PySide6.QtCore.QRect(0, -1920, 1080, 1920), dpr = 2.0



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

____________________________________________________________________ test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct] ____________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1e7cf1872b0) at 0x000001E7FE7D1100>, settings_manager = <core.settings.settings_manager.SettingsManager(0x1e7cf2f6150) at 0x000001E7FEE8DF80>

rect = PySide6.QtCore.QRect(0, 0, 1366, 768), dpr = 1.75



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary] - AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin] - AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[4k_125pct] - AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct] - AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct] - AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct] - AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'

============================================================================================ 6 failed in 0.95s ============================================================================================


===== pytest run 2025-12-19 01:16:35 args=['-vv', 'tests/test_geometry_dpi_matrix.py'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items



tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary] 
FAILED [ 16%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin] 
FAILED [ 33%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[4k_125pct] 
FAILED [ 50%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct] 
FAILED [ 66%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct] 
FAILED [ 83%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct] 
FAILED [100%]




================================== FAILURES ===================================

___ test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary] ____



qt_app = <PySide6.QtWidgets.QApplication(0x2af5c052da0) at 0x000002AF7FA65540>

settings_manager = <core.settings.settings_manager.SettingsManager(0x2af5ae96690) at 0x000002AF7FA85880>

rect = PySide6.QtCore.QRect(0, 0, 1920, 1080), dpr = 1.0



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

__ test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin] ___



qt_app = <PySide6.QtWidgets.QApplication(0x2af5c052da0) at 0x000002AF7FA65540>

settings_manager = <core.settings.settings_manager.SettingsManager(0x2af5ae96a10) at 0x000002AF0C13C680>

rect = PySide6.QtCore.QRect(-2560, 0, 2560, 1440), dpr = 1.0



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

________ test_handle_screen_change_applies_geometry_and_dpr[4k_125pct] ________



qt_app = <PySide6.QtWidgets.QApplication(0x2af5c052da0) at 0x000002AF7FA65540>

settings_manager = <core.settings.settings_manager.SettingsManager(0x2af5ae96e10) at 0x000002AF0C14AD80>

rect = PySide6.QtCore.QRect(0, 0, 3840, 2160), dpr = 1.25



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

_____ test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct] _____



qt_app = <PySide6.QtWidgets.QApplication(0x2af5c052da0) at 0x000002AF7FA65540>

settings_manager = <core.settings.settings_manager.SettingsManager(0x2af5ae97650) at 0x000002AF0C13CCC0>

rect = PySide6.QtCore.QRect(3840, 0, 3840, 2160), dpr = 1.5



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

__ test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct] __



qt_app = <PySide6.QtWidgets.QApplication(0x2af5c052da0) at 0x000002AF7FA65540>

settings_manager = <core.settings.settings_manager.SettingsManager(0x2af5ae971b0) at 0x000002AF7FB27C00>

rect = PySide6.QtCore.QRect(0, -1920, 1080, 1920), dpr = 2.0



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

______ test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct] ______



qt_app = <PySide6.QtWidgets.QApplication(0x2af5c052da0) at 0x000002AF7FA65540>

settings_manager = <core.settings.settings_manager.SettingsManager(0x2af5ae97290) at 0x000002AF0C13FC40>

rect = PySide6.QtCore.QRect(0, 0, 1366, 768), dpr = 1.75



    @pytest.mark.parametrize(

        "rect,dpr",

        [

            pytest.param(QRect(0, 0, 1920, 1080), 1.0, id="1080p_dpr1_primary"),

            pytest.param(QRect(-2560, 0, 2560, 1440), 1.0, id="left_negative_origin"),

            pytest.param(QRect(0, 0, 3840, 2160), 1.25, id="4k_125pct"),

            pytest.param(QRect(3840, 0, 3840, 2160), 1.5, id="right_4k_150pct"),

            pytest.param(QRect(0, -1920, 1080, 1920), 2.0, id="portrait_above_200pct"),

            pytest.param(QRect(0, 0, 1366, 768), 1.75, id="laptop_175pct"),

        ],

    )

    def test_handle_screen_change_applies_geometry_and_dpr(qt_app, settings_manager, rect: QRect, dpr: float):

        widget = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

        widget.resize(100, 100)

    

        try:

            fake = _FakeScreen(rect, dpr)

            widget._handle_screen_change(fake)

    

            # Geometry should match, including negative origins.

            assert widget.x() == rect.x()

            assert widget.y() == rect.y()

            assert widget.width() == rect.width()

    

            # Height may be reduced by the fullscreen compat workaround (-1).

            expected_h = rect.height()

            assert widget.height() in {expected_h, max(1, expected_h - 1)}

    

            assert pytest.approx(widget._device_pixel_ratio, rel=1e-3) == float(dpr)

    

            # Physical size should scale by DPR.

            logical = widget.size()

>           physical = widget.logical_to_physical_size()

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E           AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'



tests\test_geometry_dpi_matrix.py:66: AttributeError

=========================== short test summary info ===========================

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary] - AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin] - AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[4k_125pct] - AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct] - AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct] - AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'

FAILED tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct] - AttributeError: 'DisplayWidget' object has no attribute 'logical_to_physical_size'

============================== 6 failed in 0.99s ==============================


===== pytest run 2025-12-19 01:57:05 args=['-q', 'tests/test_hotkeys_no_text.py', 'tests/test_scrollwheel_volume.py'] =====

.
F
                                                                                                                                                                                                   [100%]


================================================================================================ FAILURES =================================================================================================

___________________________________________________________________________ test_ctrl_mode_wheel_adjusts_spotify_volume_widget ____________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x245288fd7d0) at 0x000002452926E3C0>, settings_manager = <core.settings.settings_manager.SettingsManager(0x24528abab90) at 0x00000245293F7640>

qtbot = <pytestqt.qtbot.QtBot object at 0x000002452941F310>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002452941F690>



    @pytest.mark.qt

    def test_ctrl_mode_wheel_adjusts_spotify_volume_widget(qt_app, settings_manager, qtbot, monkeypatch):

        from rendering.display_widget import DisplayWidget

        from rendering.multi_monitor_coordinator import MultiMonitorCoordinator

        from widgets.spotify_volume_widget import SpotifyVolumeWidget

    

        monkeypatch.setattr(SpotifyVolumeWidget, "_schedule_set_volume", lambda self, level: None)

    

        # Keep the test independent of OpenGL availability.

        try:

            settings_manager.set("display.hw_accel", False)

        except Exception:

            pass

        try:

            settings_manager.set("display.render_backend_mode", "software")

        except Exception:

            pass

    

        MultiMonitorCoordinator.reset()

        try:

            w = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

            qtbot.addWidget(w)

            w.resize(640, 360)

    

            vol = SpotifyVolumeWidget(w)

            qtbot.addWidget(vol)

            w.spotify_volume_widget = vol

    

            vol.setGeometry(10, 10, 32, 180)

            vol._volume = 0.5

            vol.show()

    

            w._coordinator.set_ctrl_held(True)

    

            pos = QPointF(15.0, 20.0)

            global_pos = QPointF(15.0, 20.0)

            event = QWheelEvent(

                pos,

                global_pos,

                QPoint(0, 0),

                QPoint(0, 120),

                Qt.MouseButton.NoButton,

                Qt.KeyboardModifier.NoModifier,

                Qt.ScrollPhase.ScrollUpdate,

                False,

            )

    

            before = vol._volume

            w.wheelEvent(event)

            after = vol._volume

    

>           assert after > before

E           assert 0.5 > 0.5



tests\test_scrollwheel_volume.py:57: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_scrollwheel_volume.py::test_ctrl_mode_wheel_adjusts_spotify_volume_widget - assert 0.5 > 0.5

1 failed, 1 passed in 0.94s


===== pytest run 2025-12-24 02:28:18 args=['tests/test_weather_widget.py'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 21 items



tests\test_weather_widget.py 
.
F
.
.
.
.
F
F
.
.
.
F
.
.
.
.
.
.
F
.
.
                                                                                                                                                   [100%]




================================================================================================ FAILURES =================================================================================================

__________________________________________________________________________________________ test_weather_creation __________________________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x2558e064c80) at 0x000002558EE8EB80>, parent_widget = <PySide6.QtWidgets.QWidget(0x2558df0e960) at 0x000002558EE8E740>



    def test_weather_creation(qapp, parent_widget):

        """Test weather widget creation."""

        weather = WeatherWidget(

            parent=parent_widget,

            location="London",

            position=WeatherPosition.BOTTOM_LEFT

        )

    

        assert weather is not None

        assert weather._location == "London"

>       assert weather._position == WeatherPosition.BOTTOM_LEFT

E       AssertionError: assert <OverlayPosition.BOTTOM_LEFT: 'bottom_left'> == <WeatherPosition.BOTTOM_LEFT: 'bottom_left'>

E        +  where <OverlayPosition.BOTTOM_LEFT: 'bottom_left'> = <widgets.weather_widget.WeatherWidget(0x2558df0d940) at 0x000002558EE8E440>._position

E        +  and   <WeatherPosition.BOTTOM_LEFT: 'bottom_left'> = WeatherPosition.BOTTOM_LEFT



tests\test_weather_widget.py:63: AssertionError

___________________________________________________________________________________________ test_weather_cache ____________________________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x2558e064c80) at 0x000002558EE8EB80>, parent_widget = <PySide6.QtWidgets.QWidget(0x2558e07eff0) at 0x000002558F5159C0>

mock_weather_data = {'main': {'humidity': 65, 'temp': 20.5}, 'name': 'London', 'weather': [{'description': 'scattered clouds', 'main': 'Clouds'}]}



    def test_weather_cache(qapp, parent_widget, mock_weather_data):

        """Test weather caching."""

        weather = WeatherWidget(parent=parent_widget)

    

        # Initially no cache

>       assert weather._is_cache_valid() is False

E       assert True is False

E        +  where True = _is_cache_valid()

E        +    where _is_cache_valid = <widgets.weather_widget.WeatherWidget(0x2558e07f470) at 0x000002558F515D80>._is_cache_valid



tests\test_weather_widget.py:122: AssertionError

_______________________________________________________________________________________ test_weather_all_positions ________________________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x2558e064c80) at 0x000002558EE8EB80>, parent_widget = <PySide6.QtWidgets.QWidget(0x2558e4fd6e0) at 0x000002558EEEBC00>



    def test_weather_all_positions(qapp, parent_widget):

        """Test all weather positions."""

        positions = [

            WeatherPosition.TOP_LEFT,

            WeatherPosition.TOP_RIGHT,

            WeatherPosition.BOTTOM_LEFT,

            WeatherPosition.BOTTOM_RIGHT

        ]

    

        for position in positions:

            weather = WeatherWidget(

                parent=parent_widget,

                position=position

            )

    

>           assert weather._position == position

E           AssertionError: assert <OverlayPosition.TOP_LEFT: 'top_left'> == <WeatherPosition.TOP_LEFT: 'top_left'>

E            +  where <OverlayPosition.TOP_LEFT: 'top_left'> = <widgets.weather_widget.WeatherWidget(0x2558e4fd260) at 0x000002558EEEBD80>._position



tests\test_weather_widget.py:147: AssertionError

_______________________________________________________________________________________ test_weather_set_font_size ________________________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x2558e064c80) at 0x000002558EE8EB80>, parent_widget = <PySide6.QtWidgets.QWidget(0x2558e4fa320) at 0x000002558F592AC0>



    def test_weather_set_font_size(qapp, parent_widget):

        """Test setting font size."""

        weather = WeatherWidget(parent=parent_widget)

    

        weather.set_font_size(32)

        assert weather._font_size == 32

    

        # Invalid size should fall back

        weather.set_font_size(-10)

>       assert weather._font_size == 24

E       assert 8 == 24

E        +  where 8 = <widgets.weather_widget.WeatherWidget(0x2558e4fa140) at 0x000002558F599580>._font_size



tests\test_weather_widget.py:203: AssertionError

_______________________________________________________________________________________ test_weather_fetcher_error ________________________________________________________________________________________



mock_get = <MagicMock name='get' id='2566499953552'>, qapp = <PySide6.QtWidgets.QApplication(0x2558e064c80) at 0x000002558EE8EB80>



    @patch('weather.open_meteo_provider.requests.get')

    def test_weather_fetcher_error(mock_get, qapp):

        """Test weather fetch error."""

        # Mock failed API response

        mock_get.side_effect = Exception("Network error")

    

        fetcher = WeatherFetcher(location="London")

    

        errors_received = []

        fetcher.error_occurred.connect(lambda e: errors_received.append(e))

    

        fetcher.fetch()

    

>       assert len(errors_received) == 1

E       assert 0 == 1

E        +  where 0 = len([])



tests\test_weather_widget.py:302: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_weather_widget.py::test_weather_creation - AssertionError: assert <OverlayPosition.BOTTOM_LEFT: 'bottom_left'> == <WeatherPosition.BOTTOM_LEFT: 'bottom_left'>

FAILED tests/test_weather_widget.py::test_weather_cache - assert True is False

FAILED tests/test_weather_widget.py::test_weather_all_positions - AssertionError: assert <OverlayPosition.TOP_LEFT: 'top_left'> == <WeatherPosition.TOP_LEFT: 'top_left'>

FAILED tests/test_weather_widget.py::test_weather_set_font_size - assert 8 == 24

FAILED tests/test_weather_widget.py::test_weather_fetcher_error - assert 0 == 1

====================================================================================== 5 failed, 16 passed in 1.10s =======================================================================================


===== pytest run 2025-12-24 02:56:05 args=['tests/test_weather_widget.py'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 21 items



tests\test_weather_widget.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
.
.
                                                                                                                                                   [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________________ test_weather_fetcher_error ________________________________________________________________________________________



mock_get = <MagicMock name='get' id='2009844222864'>, qapp = <PySide6.QtWidgets.QApplication(0x1d3f330c360) at 0x000001D3F408BA80>



    @patch('weather.open_meteo_provider.requests.get')

    def test_weather_fetcher_error(mock_get, qapp):

        """Test weather fetch error."""

        # Mock failed API response

        mock_get.side_effect = Exception("Network error")

    

        fetcher = WeatherFetcher(location="London")

    

        errors_received = []

        fetcher.error_occurred.connect(lambda e: errors_received.append(e))

    

        fetcher.fetch()

    

        assert len(errors_received) == 1

>       assert "Network error" in errors_received[0]

E       AssertionError: assert 'Network error' in 'No weather data returned for London'



tests\test_weather_widget.py:317: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    weather.open_meteo_provider:open_meteo_provider.py:225 Unexpected error during geocoding for London: Network error
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\weather\open_meteo_provider.py", line 193, in geocode
    response = requests.get(self.GEOCODING_URL, params=params, timeout=self._timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\unittest\mock.py", line 1124, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\unittest\mock.py", line 1128, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\unittest\mock.py", line 1183, in _execute_mock_call
    raise effect
Exception: Network error
ERROR    weather.open_meteo_provider:open_meteo_provider.py:258 Cannot fetch weather - failed to geocode: London
ERROR    widgets.weather_widget:weather_widget.py:71 No weather data returned for London


========================================================================================= short test summary info =========================================================================================

FAILED tests/test_weather_widget.py::test_weather_fetcher_error - AssertionError: assert 'Network error' in 'No weather data returned for London'

====================================================================================== 1 failed, 20 passed in 0.55s =======================================================================================


===== pytest run 2025-12-24 02:56:50 args=['tests/test_weather_widget.py'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 21 items



tests\test_weather_widget.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                   [100%]




=========================================================================================== 21 passed in 0.40s ============================================================================================


===== pytest run 2025-12-24 03:00:07 args=['tests/test_geometry_dpi_matrix.py'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 6 items



tests\test_geometry_dpi_matrix.py 
.
.
.
.
.
.
                                                                                                                                                             [100%]




============================================================================================ 6 passed in 1.52s ============================================================================================


===== pytest run 2025-12-24 03:03:05 args=['tests/test_context_menu_effect_invalidation.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup 
PASSED                                                                                            [100%]




============================================================================================ 1 passed in 0.76s ============================================================================================


===== pytest run 2025-12-24 03:03:19 args=['tests/test_scrollwheel_volume.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items



tests/test_scrollwheel_volume.py::test_spotify_volume_widget_handle_wheel_clamps_and_schedules 
FAILED                                                                                                [ 16%]


tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_uses_local_coordinates 
PASSED                                                                                                       [ 33%]


tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_ignores_hidden_volume 
PASSED                                                                                                        [ 50%]


tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_propagates_widget_rejection 
FAILED                                                                                                  [ 66%]


tests/test_scrollwheel_volume.py::test_ctrl_mode_wheel_adjusts_spotify_volume_widget 
PASSED                                                                                                          [ 83%]


tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume 
PASSED                                                                                                             [100%]




================================================================================================ FAILURES =================================================================================================

______________________________________________________________________ test_spotify_volume_widget_handle_wheel_clamps_and_schedules _______________________________________________________________________



qtbot = <pytestqt.qtbot.QtBot object at 0x000002639813F2D0>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002639813F690>



    @pytest.mark.qt

    def test_spotify_volume_widget_handle_wheel_clamps_and_schedules(qtbot, monkeypatch):

        from widgets.spotify_volume_widget import SpotifyVolumeWidget

    

        vol = SpotifyVolumeWidget()

        qtbot.addWidget(vol)

        vol.setGeometry(0, 0, 32, 180)

        vol.show()

        qtbot.wait(1)

    

        applied_levels: list[float] = []

        scheduled_levels: list[float] = []

    

        def _fake_apply(level: float) -> None:

            applied_levels.append(level)

            vol._volume = level

    

        def _fake_schedule(level: float) -> None:

            scheduled_levels.append(level)

    

        monkeypatch.setattr(vol, "_apply_volume_and_broadcast", _fake_apply)

        monkeypatch.setattr(vol, "_schedule_set_volume", _fake_schedule)

    

        vol._volume = 0.95

        assert vol.handle_wheel(QPoint(10, 10), 120)

        assert applied_levels[-1] <= 1.0

        assert scheduled_levels[-1] == applied_levels[-1]

    

        vol._volume = 0.02

        assert vol.handle_wheel(QPoint(10, 170), -120)

>       assert applied_levels[-1] >= 0.0

E       assert -0.030000000000000002 >= 0.0



tests\test_scrollwheel_volume.py:37: AssertionError

_______________________________________________________________________ test_input_handler_route_wheel_propagates_widget_rejection ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x263975c6570) at 0x000002639813F1C0>, settings_manager = <core.settings.settings_manager.SettingsManager(0x26399836590) at 0x00000263C8C67A00>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000263C8C67E90>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x00000263C8C70310>



    @pytest.mark.qt

    def test_input_handler_route_wheel_propagates_widget_rejection(qt_app, settings_manager, qtbot, monkeypatch):

        from rendering.display_widget import DisplayWidget

        from rendering.multi_monitor_coordinator import MultiMonitorCoordinator

        from widgets.spotify_volume_widget import SpotifyVolumeWidget

    

        MultiMonitorCoordinator.reset()

        try:

            w = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

            qtbot.addWidget(w)

            w.resize(500, 300)

            w.show()

            qt_app.processEvents()

    

            vol = SpotifyVolumeWidget(w)

            qtbot.addWidget(vol)

            vol.setGeometry(70, 40, 32, 180)

            vol._volume = 0.4

            vol.show()

            w.spotify_volume_widget = vol

            qt_app.processEvents()

    

            assert w._input_handler is not None

    

            def _fake_handle(self, local_pos, delta_y):

                return False

    

            monkeypatch.setattr(SpotifyVolumeWidget, "handle_wheel", _fake_handle)

    

            handled = w._input_handler.route_wheel_event(QPoint(80, 60), 120, vol, None, None)

    

            assert handled is False

        finally:

>           MultiMonitorCoordinato

E           NameError: name 'MultiMonitorCoordinato' is not defined



tests\test_scrollwheel_volume.py:152: NameError

============================================================================================ warnings summary =============================================================================================

tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2486: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    self._initial_mouse_pos = event.pos()




tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume
tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume
tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2491: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dx = event.pos().x() - self._initial_mouse_pos.x()




tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume
tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume
tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2492: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dy = event.pos().y() - self._initial_mouse_pos.y()




tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume
tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume
tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2477: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    event.pos(), getattr(self, "spotify_volume_widget", None)




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_scrollwheel_volume.py::test_spotify_volume_widget_handle_wheel_clamps_and_schedules - assert -0.030000000000000002 >= 0.0

FAILED tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_propagates_widget_rejection - NameError: name 'MultiMonitorCoordinato' is not defined

================================================================================ 2 failed, 4 passed, 10 warnings in 1.38s =================================================================================


===== pytest run 2025-12-24 03:04:17 args=['tests/test_scrollwheel_volume.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items



tests/test_scrollwheel_volume.py::test_spotify_volume_widget_handle_wheel_clamps_and_schedules 
PASSED                                                                                                [ 16%]


tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_uses_local_coordinates 
PASSED                                                                                                       [ 33%]


tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_ignores_hidden_volume 
PASSED                                                                                                        [ 50%]


tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_propagates_widget_rejection 
FAILED                                                                                                  [ 66%]


tests/test_scrollwheel_volume.py::test_ctrl_mode_wheel_adjusts_spotify_volume_widget 
PASSED                                                                                                          [ 83%]


tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume 
PASSED                                                                                                             [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________ test_input_handler_route_wheel_propagates_widget_rejection ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x14f82c50db0) at 0x0000014F8379B340>, settings_manager = <core.settings.settings_manager.SettingsManager(0x14f82d90990) at 0x0000014FB42F26C0>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000014FB42F3150>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x0000014FB42F3490>



    @pytest.mark.qt

    def test_input_handler_route_wheel_propagates_widget_rejection(qt_app, settings_manager, qtbot, monkeypatch):

        from rendering.display_widget import DisplayWidget

        from rendering.multi_monitor_coordinator import MultiMonitorCoordinator

        from widgets.spotify_volume_widget import SpotifyVolumeWidget

    

        MultiMonitorCoordinator.reset()

        try:

            w = DisplayWidget(screen_index=0, display_mode=None, settings_manager=settings_manager)

            qtbot.addWidget(w)

            w.resize(500, 300)

            w.show()

            qt_app.processEvents()

    

            vol = SpotifyVolumeWidget(w)

            qtbot.addWidget(vol)

            vol.setGeometry(70, 40, 32, 180)

            vol._volume = 0.4

            vol.show()

            w.spotify_volume_widget = vol

            qt_app.processEvents()

    

            assert w._input_handler is not None

    

            def _fake_handle(self, local_pos, delta_y):

                return False

    

            monkeypatch.setattr(SpotifyVolumeWidget, "handle_wheel", _fake_handle)

    

            handled = w._input_handler.route_wheel_event(QPoint(80, 60), 120, vol, None, None)

    

            assert handled is False

        finally:

>           MultiMonitorCoordinato

E           NameError: name 'MultiMonitorCoordinato' is not defined



tests\test_scrollwheel_volume.py:152: NameError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_propagates_widget_rejection - NameError: name 'MultiMonitorCoordinato' is not defined

======================================================================================= 1 failed, 5 passed in 1.28s =======================================================================================


===== pytest run 2025-12-24 03:05:10 args=['tests/test_scrollwheel_volume.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items



tests/test_scrollwheel_volume.py::test_spotify_volume_widget_handle_wheel_clamps_and_schedules 
PASSED                                                                                                [ 16%]


tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_uses_local_coordinates 
PASSED                                                                                                       [ 33%]


tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_ignores_hidden_volume 
PASSED                                                                                                        [ 50%]


tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_propagates_widget_rejection 
PASSED                                                                                                  [ 66%]


tests/test_scrollwheel_volume.py::test_ctrl_mode_wheel_adjusts_spotify_volume_widget 
PASSED                                                                                                          [ 83%]


tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume 
PASSED                                                                                                             [100%]




============================================================================================ 6 passed in 1.09s ============================================================================================


===== pytest run 2025-12-24 04:15:14 args=['tests/test_spotify_visualizer_widget.py', '-vv', '-k', 'bars_not_stuck_at_top or kick_emphasizes_center_more_than_vocals'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items / 4 deselected / 2 selected



tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top 
PASSED                                                                                                        [ 50%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals 
PASSED                                                                                      [100%]




===================================================================================== 2 passed, 4 deselected in 0.45s =====================================================================================


===== pytest run 2025-12-24 04:15:47 args=['tests/test_spotify_visualizer_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 6 items



tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_tick_consumes_engine_smoothed_bars 
PASSED                                                                                           [ 16%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_compute_bars_reasonable_runtime 
PASSED                                                                                              [ 33%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_widgets_share_audio_engine 
PASSED                                                                                                   [ 50%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_emits_perf_metrics 
PASSED                                                                                                           [ 66%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top 
PASSED                                                                                                        [ 83%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals 
PASSED                                                                                      [100%]




============================================================================================ 6 passed in 0.85s ============================================================================================


===== pytest run 2025-12-24 04:17:50 args=['tests/test_clock_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 19 items



tests/test_clock_widget.py::test_time_format_enum 
PASSED                                                                                                                                             [  5%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED                                                                                                                                          [ 10%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                                                                                                                                               [ 15%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                                                                                                                                             [ 21%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                                                                                                                                                [ 26%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                                                                                                                                             [ 31%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                                                                                                                                             [ 36%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED                                                                                                                                        [ 42%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED                                                                                                                                           [ 47%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED                                                                                                                                        [ 52%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED                                                                                                                                       [ 57%]


tests/test_clock_widget.py::test_clock_all_positions 
PASSED                                                                                                                                          [ 63%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED                                                                                                                                           [ 68%]


tests/test_clock_widget.py::test_clock_set_font_size 
FAILED                                                                                                                                          [ 73%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED                                                                                                                                         [ 78%]


tests/test_clock_widget.py::test_clock_set_margin 
FAILED                                                                                                                                             [ 84%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                                                                                                                                                [ 89%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED                                                                                                                            [ 94%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED                                                                                                                                      [100%]




================================================================================================ FAILURES =================================================================================================

________________________________________________________________________________________ test_clock_set_font_size _________________________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x238c24ca5a0) at 0x00000238C30DF540>, parent_widget = <PySide6.QtWidgets.QWidget(0x238c271d400) at 0x00000238C3727A40>



    def test_clock_set_font_size(qapp, parent_widget):

        """Test setting font size."""

        clock = ClockWidget(parent=parent_widget)

    

        clock.set_font_size(72)

        assert clock._font_size == 72

    

        # Invalid size should fall back

        clock.set_font_size(-10)

>       assert clock._font_size == 8

E       assert 48 == 8

E        +  where 48 = <widgets.clock_widget.ClockWidget(0x238c271cda0, name="clock_main") at 0x00000238C3727BC0>._font_size



tests\test_clock_widget.py:250: AssertionError

__________________________________________________________________________________________ test_clock_set_margin __________________________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x238c24ca5a0) at 0x00000238C30DF540>, parent_widget = <PySide6.QtWidgets.QWidget(0x238c2719c20) at 0x00000238C379CFC0>



    def test_clock_set_margin(qapp, parent_widget):

        """Test setting margin."""

        clock = ClockWidget(parent=parent_widget)

    

        clock.set_margin(50)

        assert clock._margin == 50

    

        # Invalid margin should clamp to zero per BaseOverlayWidget

        clock.set_margin(-10)

>       assert clock._margin == 0

E       assert 20 == 0

E        +  where 20 = <widgets.clock_widget.ClockWidget(0x238c271a2e0, name="clock_main") at 0x00000238C379D680>._margin



tests\test_clock_widget.py:272: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_clock_widget.py::test_clock_set_font_size - assert 48 == 8
 +  where 48 = <widgets.clock_widget.ClockWidget(0x238c271cda0, name="clock_main") at 0x00000238C3727BC0>._font_size


FAILED tests/test_clock_widget.py::test_clock_set_margin - assert 20 == 0
 +  where 20 = <widgets.clock_widget.ClockWidget(0x238c271a2e0, name="clock_main") at 0x00000238C379D680>._margin


====================================================================================== 2 failed, 17 passed in 5.35s =======================================================================================


===== pytest run 2025-12-24 04:18:26 args=['tests/test_clock_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 19 items



tests/test_clock_widget.py::test_time_format_enum 
PASSED                                                                                                                                             [  5%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED                                                                                                                                          [ 10%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                                                                                                                                               [ 15%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                                                                                                                                             [ 21%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                                                                                                                                                [ 26%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                                                                                                                                             [ 31%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                                                                                                                                             [ 36%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED                                                                                                                                        [ 42%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED                                                                                                                                           [ 47%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED                                                                                                                                        [ 52%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED                                                                                                                                       [ 57%]


tests/test_clock_widget.py::test_clock_all_positions 
PASSED                                                                                                                                          [ 63%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED                                                                                                                                           [ 68%]


tests/test_clock_widget.py::test_clock_set_font_size 
PASSED                                                                                                                                          [ 73%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED                                                                                                                                         [ 78%]


tests/test_clock_widget.py::test_clock_set_margin 
PASSED                                                                                                                                             [ 84%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                                                                                                                                                [ 89%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED                                                                                                                            [ 94%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED                                                                                                                                      [100%]




=========================================================================================== 19 passed in 4.57s ============================================================================================


===== pytest run 2025-12-24 04:19:37 args=['tests/test_ctrl_interaction_mode.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 16 items



tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget 
PASSED                                                                                                       [  6%]


tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets 
PASSED                                                                                                            [ 12%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344] 
PASSED                                                                                                        [ 18%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777349] 
PASSED                                                                                                        [ 25%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777347] 
PASSED                                                                                                        [ 31%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777346] 
PASSED                                                                                                        [ 37%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777330] 
PASSED                                                                                                        [ 43%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777328] 
PASSED                                                                                                        [ 50%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777329] 
PASSED                                                                                                        [ 56%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out 
PASSED                                                                                                                          [ 62%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens 
PASSED                                                                                                            [ 68%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_shows_without_slack_attr 
PASSED                                                                                                                  [ 75%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_context_menu_active 
PASSED                                                                                                      [ 81%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_hides_when_cursor_leaves_display 
PASSED                                                                                                          [ 87%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_inactivity_timeout 
PASSED                                                                                                                        [ 93%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active 
FAILED                                                                                                   [100%]




================================================================================================ FAILURES =================================================================================================

_________________________________________________________________________ test_ctrl_halo_suppressed_while_settings_dialog_active __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x15d792538f0) at 0x0000015D7E4E9CC0>, settings_manager = <core.settings.settings_manager.SettingsManager(0x15d782b84e0) at 0x0000015D7F273700>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000015D7F26BC50>



    @pytest.mark.qt

    def test_ctrl_halo_suppressed_while_settings_dialog_active(qt_app, settings_manager, qtbot):

        """Settings dialog active flag must fully suppress Ctrl halo in hard-exit mode."""

        settings_manager.set("input.hard_exit", True)

        widget = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        qtbot.addWidget(widget)

        widget.resize(400, 300)

        widget.show()

    

        coord = get_coordinator()

        coord.set_settings_dialog_active(False)

        coord.set_ctrl_held(False)

    

        # Warm-up: halo should appear normally when settings dialog is inactive.

        QTest.keyPress(widget, Qt.Key.Key_Control)

        qt_app.processEvents()

        QTest.mouseMove(widget, widget.rect().center())

        qt_app.processEvents()

        hint = getattr(widget, "_ctrl_cursor_hint", None)

        assert hint is not None and hint.isVisible()

        QTest.keyRelease(widget, Qt.Key.Key_Control)

        coord.set_ctrl_held(False)

        qt_app.processEvents()

    

        # Activate settings dialog flag - halo must hide and refuse to show.

        coord.set_settings_dialog_active(True)

        QTest.keyPress(widget, Qt.Key.Key_Control)

        qt_app.processEvents()

        QTest.mouseMove(widget, widget.rect().center() + QPoint(10, 10))

        qt_app.processEvents()

        hint_active = getattr(widget, "_ctrl_cursor_hint", None)

        if hint_active is not None:

>           assert not hint_active.isVisible()

E           assert not True

E            +  where True = <built-in method isVisible of CursorHaloWidget object at 0x0000015D7F26A740>()

E            +    where <built-in method isVisible of CursorHaloWidget object at 0x0000015D7F26A740> = <widgets.cursor_halo.CursorHaloWidget(0x15d794f59d0) at 0x0000015D7F26A740>.isVisible



tests\test_ctrl_interaction_mode.py:442: AssertionError

============================================================================================ warnings summary =============================================================================================

tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\input_handler.py:631: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    pos = event.pos()




tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2457: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    logger.info(f"Mouse clicked at ({event.pos().x()}, {event.pos().y()}), requesting exit")




tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2486: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    self._initial_mouse_pos = event.pos()




tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2477: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    event.pos(), getattr(self, "spotify_volume_widget", None)




tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_ctrl_interaction_mode.py:271: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active - assert not True
 +  where True = <built-in method isVisible of CursorHaloWidget object at 0x0000015D7F26A740>()
 +    where <built-in method isVisible of CursorHaloWidget object at 0x0000015D7F26A740> = <widgets.cursor_halo.CursorHaloWidget(0x15d794f59d0) at 0x0000015D7F26A740>.isVisible


================================================================================ 1 failed, 15 passed, 17 warnings in 5.58s ================================================================================


===== pytest run 2025-12-24 04:20:22 args=['tests/test_ctrl_interaction_mode.py', '-vv', '-k', 'settings_dialog_active'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 16 items / 15 deselected / 1 selected



tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active 
FAILED                                                                                                   [100%]




================================================================================================ FAILURES =================================================================================================

_________________________________________________________________________ test_ctrl_halo_suppressed_while_settings_dialog_active __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x210e47fa7a0) at 0x00000210FFC1B740>, settings_manager = <core.settings.settings_manager.SettingsManager(0x210e47fab00) at 0x000002109436CA00>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000210943853D0>



    @pytest.mark.qt

    def test_ctrl_halo_suppressed_while_settings_dialog_active(qt_app, settings_manager, qtbot):

        """Settings dialog active flag must fully suppress Ctrl halo in hard-exit mode."""

        settings_manager.set("input.hard_exit", True)

        widget = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        qtbot.addWidget(widget)

        widget.resize(400, 300)

        widget.show()

    

        coord = get_coordinator()

        coord.set_settings_dialog_active(False)

        coord.set_ctrl_held(False)

    

        # Warm-up: halo should appear normally when settings dialog is inactive.

        QTest.keyPress(widget, Qt.Key.Key_Control)

        qt_app.processEvents()

        QTest.mouseMove(widget, widget.rect().center())

        qt_app.processEvents()

        hint = getattr(widget, "_ctrl_cursor_hint", None)

>       assert hint is not None and hint.isVisible()

E       assert (<widgets.cursor_halo.CursorHaloWidget(0x210e4a7a0f0) at 0x00000210943A3980> is not None and False)

E        +  where False = <built-in method isVisible of CursorHaloWidget object at 0x00000210943A3980>()

E        +    where <built-in method isVisible of CursorHaloWidget object at 0x00000210943A3980> = <widgets.cursor_halo.CursorHaloWidget(0x210e4a7a0f0) at 0x00000210943A3980>.isVisible



tests\test_ctrl_interaction_mode.py:429: AssertionError

============================================================================================ warnings summary =============================================================================================

tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2487: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    event.pos(), getattr(self, "spotify_volume_widget", None)




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active - assert (<widgets.cursor_halo.CursorHaloWidget(0x210e4a7a0f0) at 0x00000210943A3980> is not None and False)
 +  where False = <built-in method isVisible of CursorHaloWidget object at 0x00000210943A3980>()
 +    where <built-in method isVisible of CursorHaloWidget object at 0x00000210943A3980> = <widgets.cursor_halo.CursorHaloWidget(0x210e4a7a0f0) at 0x00000210943A3980>.isVisible


============================================================================== 1 failed, 15 deselected, 2 warnings in 1.19s ===============================================================================


===== pytest run 2025-12-24 04:23:36 args=['tests/test_ctrl_interaction_mode.py', '-vv', '-k', 'settings_dialog_active'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 16 items / 15 deselected / 1 selected



tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active 
FAILED                                                                                                   [100%]




================================================================================================ FAILURES =================================================================================================

_________________________________________________________________________ test_ctrl_halo_suppressed_while_settings_dialog_active __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2e3a5ff9130) at 0x000002E3D51A9CC0>, settings_manager = <core.settings.settings_manager.SettingsManager(0x2e3a5ff9210) at 0x000002E3D5619600>

qtbot = <pytestqt.qtbot.QtBot object at 0x000002E3D561AD50>



    @pytest.mark.qt

    def test_ctrl_halo_suppressed_while_settings_dialog_active(qt_app, settings_manager, qtbot):

        """Settings dialog active flag must fully suppress Ctrl halo in hard-exit mode."""

        settings_manager.set("input.hard_exit", True)

        widget = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        qtbot.addWidget(widget)

        widget.resize(400, 300)

        widget.show()

    

        coord = get_coordinator()

        coord.set_settings_dialog_active(False)

        coord.set_ctrl_held(False)

>       coord.register_display_widget(widget)

        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'MultiMonitorCoordinator' object has no attribute 'register_display_widget'



tests\test_ctrl_interaction_mode.py:422: AttributeError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active - AttributeError: 'MultiMonitorCoordinator' object has no attribute 'register_display_widget'

==================================================================================== 1 failed, 15 deselected in 1.14s =====================================================================================


===== pytest run 2025-12-24 04:24:21 args=['tests/test_ctrl_interaction_mode.py', '-vv', '-k', 'settings_dialog_active'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 16 items / 15 deselected / 1 selected



tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active 
FAILED                                                                                                   [100%]




================================================================================================ FAILURES =================================================================================================

_________________________________________________________________________ test_ctrl_halo_suppressed_while_settings_dialog_active __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1efc8f378a0) at 0x000001EFF852D480>, settings_manager = <core.settings.settings_manager.SettingsManager(0x1efc7876040) at 0x000001EFF850D980>

qtbot = <pytestqt.qtbot.QtBot object at 0x000001EFF852ED10>



    @pytest.mark.qt

    def test_ctrl_halo_suppressed_while_settings_dialog_active(qt_app, settings_manager, qtbot):

        """Settings dialog active flag must fully suppress Ctrl halo in hard-exit mode."""

        settings_manager.set("input.hard_exit", True)

        widget = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        qtbot.addWidget(widget)

        widget.resize(400, 300)

        widget.show()

    

        coord = get_coordinator()

        coord.set_settings_dialog_active(False)

        coord.set_ctrl_held(False)

        coord.register_instance(widget, widget.screen())

        coord.hide_all_halos()

        coord.reset_all_ctrl_state()

    

        # Warm-up: halo should appear normally when settings dialog is inactive.

        QTest.keyPress(widget, Qt.Key.Key_Control)

        qt_app.processEvents()

        QTest.mouseMove(widget, widget.rect().center())

        qt_app.processEvents()

        hint = getattr(widget, "_ctrl_cursor_hint", None)

>       assert hint is not None and hint.isVisible()

E       assert (<widgets.cursor_halo.CursorHaloWidget(0x1efc9019830) at 0x000001EFF855FD80> is not None and False)

E        +  where False = <built-in method isVisible of CursorHaloWidget object at 0x000001EFF855FD80>()

E        +    where <built-in method isVisible of CursorHaloWidget object at 0x000001EFF855FD80> = <widgets.cursor_halo.CursorHaloWidget(0x1efc9019830) at 0x000001EFF855FD80>.isVisible



tests\test_ctrl_interaction_mode.py:432: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active - assert (<widgets.cursor_halo.CursorHaloWidget(0x1efc9019830) at 0x000001EFF855FD80> is not None and False)
 +  where False = <built-in method isVisible of CursorHaloWidget object at 0x000001EFF855FD80>()
 +    where <built-in method isVisible of CursorHaloWidget object at 0x000001EFF855FD80> = <widgets.cursor_halo.CursorHaloWidget(0x1efc9019830) at 0x000001EFF855FD80>.isVisible


==================================================================================== 1 failed, 15 deselected in 1.15s =====================================================================================


===== pytest run 2025-12-24 04:31:35 args=['tests/test_ctrl_interaction_mode.py', '-vv', '-k', 'settings_dialog_active'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 16 items / 15 deselected / 1 selected



tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active 
PASSED                                                                                                   [100%]




============================================================================================ warnings summary =============================================================================================

tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active
tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2487: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    event.pos(), getattr(self, "spotify_volume_widget", None)




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

============================================================================== 1 passed, 15 deselected, 7 warnings in 1.03s ===============================================================================


===== pytest run 2025-12-25 18:41:21 args=[] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 593 items / 4 skipped



archive\gmail_feature\test_gmail_widget.py 
F
F
F
F
F
F
F
F
F
F
F
                                                                                                                                               [  1%]


tests\test_animation.py 
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                                  [  3%]


tests\test_animation_set_target_fps.py 
.
                                                                                                                                                             [  3%]


tests\test_block_puzzle_flip.py 
.
.
.
.
.
.
.
                                                                                                                                                              [  5%]


tests\test_clock_integration_regression.py 
.
.
F
F
.
.
.
.
F
F
.
F
                                                                                                                                              [  7%]


tests\test_clock_widget.py 
.
.
.
F
F
F
F
F
F
F
F
F
F
.
.
.
F
F
F
                                                                                                                                                       [ 10%]


tests\test_context_menu_effect_invalidation.py 
.
                                                                                                                                                     [ 10%]


tests\test_ctrl_interaction_mode.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
                                                                                                                                                 [ 13%]


tests\test_diffuse_transition.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                       [ 15%]


tests\test_dimming_and_interaction_fixes.py 
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                             [ 17%]


tests\test_display_tab.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                             [ 19%]


tests\test_engine_lifecycle.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                  [ 23%]


tests\test_events.py 
.
.
.
.
.
.
                                                                                                                                                                          [ 24%]


tests\test_flicker_fix_integration.py 
.
.
F
.
.
.
.
                                                                                                                                                        [ 25%]


tests\test_frame_timing_workload.py 
.
.
                                                                                                                                                               [ 25%]


tests\test_geometry_dpi_matrix.py 
.

===== pytest run 2025-12-25 18:51:03 args=['tests/test_gl_compositor_blinds.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_gl_compositor_blinds.py::test_gl_compositor_blinds_no_underlay_and_no_black 
PASSED                                                                                                        [100%]




============================================================================================ 1 passed in 3.31s ============================================================================================


===== pytest run 2025-12-25 18:51:39 args=['--maxfail=1', 'tests/test_ctrl_interaction_mode.py', '-k', 'settings_dialog_active', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 16 items / 15 deselected / 1 selected



tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active 
FAILED                                                                                                   [100%]




================================================================================================ FAILURES =================================================================================================

_________________________________________________________________________ test_ctrl_halo_suppressed_while_settings_dialog_active __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x171964d1ba0) at 0x00000171C56AAE80>, settings_manager = <core.settings.settings_manager.SettingsManager(0x17194e752d0) at 0x00000171C5B09740>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000171C5B21BD0>



    @pytest.mark.qt

    def test_ctrl_halo_suppressed_while_settings_dialog_active(qt_app, settings_manager, qtbot):

        """Settings dialog active flag must fully suppress Ctrl halo in hard-exit mode."""

        settings_manager.set("input.hard_exit", True)

        widget = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

        )

        qtbot.addWidget(widget)

        widget.resize(400, 300)

        widget.show()

    

        coord = get_coordinator()

        coord.set_settings_dialog_active(False)

        coord.set_ctrl_held(False)

        coord.register_instance(widget, widget.screen())

        coord.hide_all_halos()

        coord.reset_all_ctrl_state()

    

        # Warm-up: halo should appear normally when settings dialog is inactive.

        QTest.keyPress(widget, Qt.Key.Key_Control)

        qt_app.processEvents()

        QTest.mouseMove(widget, widget.rect().center())

        qt_app.processEvents()

        hint = getattr(widget, "_ctrl_cursor_hint", None)

>       assert hint is not None and hint.isVisible()

E       assert (<widgets.cursor_halo.CursorHaloWidget(0x1719661d1d0) at 0x00000171C5B3DAC0> is not None and False)

E        +  where False = <built-in method isVisible of CursorHaloWidget object at 0x00000171C5B3DAC0>()

E        +    where <built-in method isVisible of CursorHaloWidget object at 0x00000171C5B3DAC0> = <widgets.cursor_halo.CursorHaloWidget(0x1719661d1d0) at 0x00000171C5B3DAC0>.isVisible



tests\test_ctrl_interaction_mode.py:432: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active - assert (<widgets.cursor_halo.CursorHaloWidget(0x1719661d1d0) at 0x00000171C5B3DAC0> is not None and False)
 +  where False = <built-in method isVisible of CursorHaloWidget object at 0x00000171C5B3DAC0>()
 +    where <built-in method isVisible of CursorHaloWidget object at 0x00000171C5B3DAC0> = <widgets.cursor_halo.CursorHaloWidget(0x1719661d1d0) at 0x00000171C5B3DAC0>.isVisible


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

==================================================================================== 1 failed, 15 deselected in 1.17s =====================================================================================


===== pytest run 2025-12-25 19:19:14 args=[] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 593 items / 4 skipped



archive\gmail_feature\test_gmail_widget.py 
F
F
F
F
F
F
F
F
F
F
F
                                                                                                                                               [  1%]


tests\test_animation.py 
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                                  [  3%]


tests\test_animation_set_target_fps.py 
.
                                                                                                                                                             [  3%]


tests\test_block_puzzle_flip.py 
.
.
.
.
.
.
.
                                                                                                                                                              [  5%]


tests\test_clock_integration_regression.py 
.
.
F
F
.
.
.
.
F
F
.
F
                                                                                                                                              [  7%]


tests\test_clock_widget.py 
.
.
.
F
F
F
F
F
F
F
F
F
F
.
.
.
F
F
F
                                                                                                                                                       [ 10%]


tests\test_context_menu_effect_invalidation.py 
.
                                                                                                                                                     [ 10%]


tests\test_ctrl_interaction_mode.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
                                                                                                                                                 [ 13%]


tests\test_diffuse_transition.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                       [ 15%]


tests\test_dimming_and_interaction_fixes.py 
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                             [ 17%]


tests\test_display_tab.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                             [ 19%]


tests\test_engine_lifecycle.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                  [ 23%]


tests\test_events.py 
.
.
.
.
.
.
                                                                                                                                                                          [ 24%]


tests\test_flicker_fix_integration.py 
.
.
F
.
.
.
.
                                                                                                                                                        [ 25%]


tests\test_frame_timing_workload.py 
.
.
                                                                                                                                                               [ 25%]


tests\test_geometry_dpi_matrix.py 
.
.

===== pytest run 2025-12-25 19:38:34 args=['tests/test_media_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items



tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED                                                                                                                             [  7%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED                                                                                                                   [ 15%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED                                                                                                             [ 23%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED                                                                                                        [ 30%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED                                                                                                                  [ 38%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
FAILED                                                                                                                       [ 46%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
FAILED                                                                                                                               [ 53%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
FAILED                                                                                                               [ 61%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
FAILED                                                                                                             [ 69%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED                                                                                                             [ 76%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED                                                                                                               [ 84%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED                                                                                                             [ 92%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________ test_media_widget_placeholder_when_no_media _______________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x17a67f0bde0) at 0x0000017A7FDCE580>, qtbot = <pytestqt.qtbot.QtBot object at 0x0000017A7FDC5C90>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000017A7FE15090>



    @pytest.mark.qt

    def test_media_widget_placeholder_when_no_media(qt_app, qtbot, thread_manager):

        """When controller returns None, widget should remain hidden (no media)."""

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 80)

    

>       w.start()



tests\test_media_widget.py:178: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.media_widget.MediaWidget(0x17a68480b10) at 0x0000017A7FD7FD00>



    def start(self) -> None:

        """Begin polling media controller and showing widget."""

    

        if self._enabled:

            logger.warning("Media widget already running")

            return

        if not self._ensure_thread_manager("MediaWidget.start"):

            return

    

        self._enabled = True

>       self._refresh_media()

        ^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'MediaWidget' object has no attribute '_refresh_media'



widgets\media_widget.py:187: AttributeError

___________________________________________________________________________________ test_media_widget_displays_metadata ___________________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x17a67f0bde0) at 0x0000017A7FDCE580>, qtbot = <pytestqt.qtbot.QtBot object at 0x0000017A678A84D0>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000017A678A8510>



    @pytest.mark.qt

    def test_media_widget_displays_metadata(qt_app, qtbot, thread_manager):

        """MediaWidget should render title/artist/album and state text."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        w.start()

        qt_app.processEvents()

    

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

    

        html = w.text()

>       assert "Song Title" in html

E       AssertionError: assert 'Song Title' in ''



tests\test_media_widget.py:210: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

___________________________________________________________________________ test_media_widget_hides_again_when_media_disappears ___________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x17a67f0bde0) at 0x0000017A7FDCE580>, qtbot = <pytestqt.qtbot.QtBot object at 0x0000017A678CDF90>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000017A678B1390>



    @pytest.mark.qt

    def test_media_widget_hides_again_when_media_disappears(qt_app, qtbot, thread_manager):

        """Widget should hide after being visible when media goes away."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        # Start with media present

        w.start()

        qt_app.processEvents()

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

>       assert w.isVisible()

E       assert False

E        +  where False = <built-in method isVisible of MediaWidget object at 0x0000017A678B0EC0>()

E        +    where <built-in method isVisible of MediaWidget object at 0x0000017A678B0EC0> = <widgets.media_widget.MediaWidget(0x17a68480f90) at 0x0000017A678B0EC0>.isVisible



tests\test_media_widget.py:237: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_decodes_artwork_and_adjusts_margins __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x17a67f0bde0) at 0x0000017A7FDCE580>, qtbot = <pytestqt.qtbot.QtBot object at 0x0000017A7FDC6F10>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000017A7FE16410>



    @pytest.mark.qt

    def test_media_widget_decodes_artwork_and_adjusts_margins(qt_app, qtbot, thread_manager):

        """Artwork bytes should be decoded into a pixmap and margins updated."""

    

        # Create a tiny in-memory PNG for artwork

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.red)

        pm = QPixmap.fromImage(img)

    

        # Encode to PNG bytes using an in-memory buffer so loadFromData can decode it.

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        w.start()

        qt_app.processEvents()

    

        # Capture initial left margin, then refresh and ensure it increases

        # when artwork is successfully decoded.

        initial_margins = w.contentsMargins()

    

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

    

        updated_margins = w.contentsMargins()

        assert updated_margins.left() >= initial_margins.left()

        # When artwork is decoded, we expect the left margin to grow to

        # accommodate the icon.

>       assert updated_margins.left() > initial_margins.left()

E       assert 29 > 29

E        +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x0000017A678C4D40>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x0000017A678C4D40> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x0000017A678C4D40>.left

E        +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x0000017A678C5E00>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x0000017A678C5E00> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x0000017A678C5E00>.left



tests\test_media_widget.py:288: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_starts_fade_in_when_artwork_appears __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x17a67f0bde0) at 0x0000017A7FDCE580>, qtbot = <pytestqt.qtbot.QtBot object at 0x0000017A7FE3F0D0>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000017A7FE3EA50>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot, thread_manager):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Fade Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        # First refresh with no media keeps widget hidden and no artwork.

        w.start()

        qt_app.processEvents()

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert not w.isVisible()

    

        # Now provide artwork-bearing media and refresh once; this should

        # create an artwork pixmap and start a fade-in (opacity starts at 0).

        ctrl._info = info

        w._refresh()  # type: ignore[attr-defined]

    

>       assert getattr(w, "_artwork_opacity", 1.0) == 0.0

E       AssertionError: assert 1.0 == 0.0

E        +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x17a6864bf00) at 0x0000017A7FE3DD40>, '_artwork_opacity', 1.0)



tests\test_media_widget.py:330: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_display_widget_ctrl_click_routes_to_media_widget __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x17a67f0bde0) at 0x0000017A7FDCE580>, settings_manager = <core.settings.settings_manager.SettingsManager(0x17a68586b10) at 0x0000017A7FB95FC0>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000017A18956750>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x0000017A18954CD0>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000017A189549D0>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x17a6864cfe0) at 0x0000017A678B3AC0>.media_widget



tests\test_media_widget.py:383: AssertionError

_______________________________________________________________________ test_display_widget_hard_exit_click_routes_to_media_widget ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x17a67f0bde0) at 0x0000017A7FDCE580>, settings_manager = <core.settings.settings_manager.SettingsManager(0x17a687c5660) at 0x0000017A7FDC60C0>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000017A18931A50>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x0000017A678E72D0>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000017A678E4FD0>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x17a689057f0) at 0x0000017A1891B8C0>.media_widget



tests\test_media_widget.py:443: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_media_widget.py::test_media_widget_placeholder_when_no_media - AttributeError: 'MediaWidget' object has no attribute '_refresh_media'

FAILED tests/test_media_widget.py::test_media_widget_displays_metadata - AssertionError: assert 'Song Title' in ''

FAILED tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears - assert False
 +  where False = <built-in method isVisible of MediaWidget object at 0x0000017A678B0EC0>()
 +    where <built-in method isVisible of MediaWidget object at 0x0000017A678B0EC0> = <widgets.media_widget.MediaWidget(0x17a68480f90) at 0x0000017A678B0EC0>.isVisible


FAILED tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins - assert 29 > 29
 +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x0000017A678C4D40>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x0000017A678C4D40> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x0000017A678C4D40>.left
 +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x0000017A678C5E00>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x0000017A678C5E00> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x0000017A678C5E00>.left


FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears - AssertionError: assert 1.0 == 0.0
 +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x17a6864bf00) at 0x0000017A7FE3DD40>, '_artwork_opacity', 1.0)


FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x17a6864cfe0) at 0x0000017A678B3AC0>.media_widget


FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x17a689057f0) at 0x0000017A1891B8C0>.media_widget


======================================================================================= 7 failed, 6 passed in 1.27s =======================================================================================


===== pytest run 2025-12-25 19:56:49 args=['tests/test_media_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items



tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED                                                                                                                             [  7%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED                                                                                                                   [ 15%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED                                                                                                             [ 23%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED                                                                                                        [ 30%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED                                                                                                                  [ 38%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
FAILED                                                                                                                       [ 46%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
FAILED                                                                                                                               [ 53%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
FAILED                                                                                                               [ 61%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
FAILED                                                                                                             [ 69%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED                                                                                                             [ 76%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED                                                                                                               [ 84%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED                                                                                                             [ 92%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________ test_media_widget_placeholder_when_no_media _______________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2688691a3f0) at 0x00000268B5E5FEC0>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000268B66A7E90>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000268B66C8150>



    @pytest.mark.qt

    def test_media_widget_placeholder_when_no_media(qt_app, qtbot, thread_manager):

        """When controller returns None, widget should remain hidden (no media)."""

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 80)

    

>       w.start()



tests\test_media_widget.py:183: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.media_widget.MediaWidget(0x26886cedd10) at 0x00000268B5FCC580>



    def start(self) -> None:

        """Begin polling media controller and showing widget."""

    

        if self._enabled:

            logger.warning("Media widget already running")

            return

        if not self._ensure_thread_manager("MediaWidget.start"):

            return

    

        self._enabled = True

>       self._refresh_media()

        ^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'MediaWidget' object has no attribute '_refresh_media'



widgets\media_widget.py:187: AttributeError

___________________________________________________________________________________ test_media_widget_displays_metadata ___________________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2688691a3f0) at 0x00000268B5E5FEC0>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000268861AABD0>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000268861AB090>



    @pytest.mark.qt

    def test_media_widget_displays_metadata(qt_app, qtbot, thread_manager):

        """MediaWidget should render title/artist/album and state text."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        w.start()

        qt_app.processEvents()

    

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

    

        html = w.text()

>       assert "Song Title" in html

E       AssertionError: assert 'Song Title' in ''



tests\test_media_widget.py:217: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

___________________________________________________________________________ test_media_widget_hides_again_when_media_disappears ___________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2688691a3f0) at 0x00000268B5E5FEC0>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000268861D7DD0>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000268861D78D0>



    @pytest.mark.qt

    def test_media_widget_hides_again_when_media_disappears(qt_app, qtbot, thread_manager):

        """Widget should hide after being visible when media goes away."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        # Start with media present

        w.start()

        qt_app.processEvents()

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

>       assert w.isVisible()

E       assert False

E        +  where False = <built-in method isVisible of MediaWidget object at 0x00000268861E0E80>()

E        +    where <built-in method isVisible of MediaWidget object at 0x00000268861E0E80> = <widgets.media_widget.MediaWidget(0x26886cec390) at 0x00000268861E0E80>.isVisible



tests\test_media_widget.py:244: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_decodes_artwork_and_adjusts_margins __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2688691a3f0) at 0x00000268B5E5FEC0>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000268861EFCD0>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000268861ED710>



    @pytest.mark.qt

    def test_media_widget_decodes_artwork_and_adjusts_margins(qt_app, qtbot, thread_manager):

        """Artwork bytes should be decoded into a pixmap and margins updated."""

    

        # Create a tiny in-memory PNG for artwork

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.red)

        pm = QPixmap.fromImage(img)

    

        # Encode to PNG bytes using an in-memory buffer so loadFromData can decode it.

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        w.start()

        qt_app.processEvents()

    

        # Capture initial left margin, then refresh and ensure it increases

        # when artwork is successfully decoded.

        initial_margins = w.contentsMargins()

    

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

    

        updated_margins = w.contentsMargins()

        assert updated_margins.left() >= initial_margins.left()

        # When artwork is decoded, we expect the left margin to grow to

        # accommodate the icon.

>       assert updated_margins.left() > initial_margins.left()

E       assert 29 > 29

E        +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000268861EEBC0>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000268861EEBC0> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000268861EEBC0>.left

E        +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000268861E0F40>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000268861E0F40> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000268861E0F40>.left



tests\test_media_widget.py:295: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_starts_fade_in_when_artwork_appears __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2688691a3f0) at 0x00000268B5E5FEC0>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000268861C94D0>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000268861C8F10>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot, thread_manager):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Fade Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        # First refresh with no media keeps widget hidden and no artwork.

        w.start()

        qt_app.processEvents()

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert not w.isVisible()

    

        # Now provide artwork-bearing media and refresh once; this should

        # create an artwork pixmap and start a fade-in (opacity starts at 0).

        ctrl._info = info

        w._refresh()  # type: ignore[attr-defined]

    

>       assert getattr(w, "_artwork_opacity", 1.0) == 0.0

E       AssertionError: assert 1.0 == 0.0

E        +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x268869502c0) at 0x00000268B66DE480>, '_artwork_opacity', 1.0)



tests\test_media_widget.py:337: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_display_widget_ctrl_click_routes_to_media_widget __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2688691a3f0) at 0x00000268B5E5FEC0>, settings_manager = <core.settings.settings_manager.SettingsManager(0x26886da8310) at 0x00000268861C3800>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000268B71B5550>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x00000268B71B6150>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000268B71B5D90>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x2688694d860) at 0x00000268B60DF6C0>.media_widget



tests\test_media_widget.py:390: AssertionError

_______________________________________________________________________ test_display_widget_hard_exit_click_routes_to_media_widget ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2688691a3f0) at 0x00000268B5E5FEC0>, settings_manager = <core.settings.settings_manager.SettingsManager(0x26886da9510) at 0x00000268861EC540>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000268861EFD10>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x00000268861AB290>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000268861AB890>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x268871430b0) at 0x00000268861DC980>.media_widget



tests\test_media_widget.py:450: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_media_widget.py::test_media_widget_placeholder_when_no_media - AttributeError: 'MediaWidget' object has no attribute '_refresh_media'

FAILED tests/test_media_widget.py::test_media_widget_displays_metadata - AssertionError: assert 'Song Title' in ''

FAILED tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears - assert False
 +  where False = <built-in method isVisible of MediaWidget object at 0x00000268861E0E80>()
 +    where <built-in method isVisible of MediaWidget object at 0x00000268861E0E80> = <widgets.media_widget.MediaWidget(0x26886cec390) at 0x00000268861E0E80>.isVisible


FAILED tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins - assert 29 > 29
 +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000268861EEBC0>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000268861EEBC0> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000268861EEBC0>.left
 +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000268861E0F40>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000268861E0F40> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000268861E0F40>.left


FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears - AssertionError: assert 1.0 == 0.0
 +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x268869502c0) at 0x00000268B66DE480>, '_artwork_opacity', 1.0)


FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x2688694d860) at 0x00000268B60DF6C0>.media_widget


FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x268871430b0) at 0x00000268861DC980>.media_widget


======================================================================================= 7 failed, 6 passed in 1.27s =======================================================================================


===== pytest run 2025-12-25 20:08:50 args=['tests/test_media_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items



tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED                                                                                                                             [  7%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED                                                                                                                   [ 15%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED                                                                                                             [ 23%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED                                                                                                        [ 30%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED                                                                                                                  [ 38%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
FAILED                                                                                                                       [ 46%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
FAILED                                                                                                                               [ 53%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
FAILED                                                                                                               [ 61%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
FAILED                                                                                                             [ 69%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED                                                                                                             [ 76%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED                                                                                                               [ 84%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED                                                                                                             [ 92%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________ test_media_widget_placeholder_when_no_media _______________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x238f579be90) at 0x00000238FF6BC200>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000238FF6D3910>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000238FF6D3CD0>



    @pytest.mark.qt

    def test_media_widget_placeholder_when_no_media(qt_app, qtbot, thread_manager):

        """When controller returns None, widget should remain hidden (no media)."""

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 80)

    

>       w.start()



tests\test_media_widget.py:184: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.media_widget.MediaWidget(0x238f48cbca0) at 0x00000238FF6E0780>



    def start(self) -> None:

        """Begin polling media controller and showing widget."""

    

        if self._enabled:

            logger.warning("Media widget already running")

            return

        if not self._ensure_thread_manager("MediaWidget.start"):

            return

    

        self._enabled = True

>       self._refresh_media()

        ^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'MediaWidget' object has no attribute '_refresh_media'



widgets\media_widget.py:194: AttributeError

___________________________________________________________________________________ test_media_widget_displays_metadata ___________________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x238f579be90) at 0x00000238FF6BC200>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000238F517C610>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000238F517FB10>



    @pytest.mark.qt

    def test_media_widget_displays_metadata(qt_app, qtbot, thread_manager):

        """MediaWidget should render title/artist/album and state text."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        w.start()

        qt_app.processEvents()

    

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

    

        html = w.text()

>       assert "Song Title" in html

E       AssertionError: assert 'Song Title' in ''



tests\test_media_widget.py:218: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

___________________________________________________________________________ test_media_widget_hides_again_when_media_disappears ___________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x238f579be90) at 0x00000238FF6BC200>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000238F4FB3CD0>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000238F657F910>



    @pytest.mark.qt

    def test_media_widget_hides_again_when_media_disappears(qt_app, qtbot, thread_manager):

        """Widget should hide after being visible when media goes away."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        # Start with media present

        w.start()

        qt_app.processEvents()

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

>       assert w.isVisible()

E       assert False

E        +  where False = <built-in method isVisible of MediaWidget object at 0x00000238F6587D40>()

E        +    where <built-in method isVisible of MediaWidget object at 0x00000238F6587D40> = <widgets.media_widget.MediaWidget(0x238f48cd620) at 0x00000238F6587D40>.isVisible



tests\test_media_widget.py:245: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_decodes_artwork_and_adjusts_margins __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x238f579be90) at 0x00000238FF6BC200>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000238F5169690>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000238F516A210>



    @pytest.mark.qt

    def test_media_widget_decodes_artwork_and_adjusts_margins(qt_app, qtbot, thread_manager):

        """Artwork bytes should be decoded into a pixmap and margins updated."""

    

        # Create a tiny in-memory PNG for artwork

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.red)

        pm = QPixmap.fromImage(img)

    

        # Encode to PNG bytes using an in-memory buffer so loadFromData can decode it.

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        w.start()

        qt_app.processEvents()

    

        # Capture initial left margin, then refresh and ensure it increases

        # when artwork is successfully decoded.

        initial_margins = w.contentsMargins()

    

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

    

        updated_margins = w.contentsMargins()

        assert updated_margins.left() >= initial_margins.left()

        # When artwork is decoded, we expect the left margin to grow to

        # accommodate the icon.

>       assert updated_margins.left() > initial_margins.left()

E       assert 29 > 29

E        +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000238FEFD9D40>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000238FEFD9D40> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000238FEFD9D40>.left

E        +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000238F65840C0>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000238F65840C0> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000238F65840C0>.left



tests\test_media_widget.py:296: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_starts_fade_in_when_artwork_appears __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x238f579be90) at 0x00000238FF6BC200>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000238FF67FF50>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000238FF67FB90>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot, thread_manager):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Fade Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        # First refresh with no media keeps widget hidden and no artwork.

        w.start()

        qt_app.processEvents()

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert not w.isVisible()

    

        # Now provide artwork-bearing media and refresh once; this should

        # create an artwork pixmap and start a fade-in (opacity starts at 0).

        ctrl._info = info

        w._refresh()  # type: ignore[attr-defined]

    

>       assert getattr(w, "_artwork_opacity", 1.0) == 0.0

E       AssertionError: assert 1.0 == 0.0

E        +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x238f48ca4a0) at 0x00000238F5195580>, '_artwork_opacity', 1.0)



tests\test_media_widget.py:338: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_display_widget_ctrl_click_routes_to_media_widget __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x238f579be90) at 0x00000238FF6BC200>, settings_manager = <core.settings.settings_manager.SettingsManager(0x238f483de30) at 0x00000238A61E4900>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000238A6246190>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x00000238A6244F90>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000238A6244ED0>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x238f48cdce0) at 0x00000238FF4FB4C0>.media_widget



tests\test_media_widget.py:391: AssertionError

_______________________________________________________________________ test_display_widget_hard_exit_click_routes_to_media_widget ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x238f579be90) at 0x00000238FF6BC200>, settings_manager = <core.settings.settings_manager.SettingsManager(0x238f5e92220) at 0x00000238F516B340>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000238F5142690>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x00000238F5143950>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000238FF73C350>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x238f5fe0580) at 0x00000238A621D140>.media_widget



tests\test_media_widget.py:451: AssertionError

============================================================================================ warnings summary =============================================================================================

tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2508: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    event.pos(), getattr(self, "spotify_volume_widget", None)




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_media_widget.py::test_media_widget_placeholder_when_no_media - AttributeError: 'MediaWidget' object has no attribute '_refresh_media'

FAILED tests/test_media_widget.py::test_media_widget_displays_metadata - AssertionError: assert 'Song Title' in ''

FAILED tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears - assert False
 +  where False = <built-in method isVisible of MediaWidget object at 0x00000238F6587D40>()
 +    where <built-in method isVisible of MediaWidget object at 0x00000238F6587D40> = <widgets.media_widget.MediaWidget(0x238f48cd620) at 0x00000238F6587D40>.isVisible


FAILED tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins - assert 29 > 29
 +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000238FEFD9D40>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000238FEFD9D40> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000238FEFD9D40>.left
 +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000238F65840C0>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000238F65840C0> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000238F65840C0>.left


FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears - AssertionError: assert 1.0 == 0.0
 +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x238f48ca4a0) at 0x00000238F5195580>, '_artwork_opacity', 1.0)


FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x238f48cdce0) at 0x00000238FF4FB4C0>.media_widget


FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x238f5fe0580) at 0x00000238A621D140>.media_widget


================================================================================= 7 failed, 6 passed, 8 warnings in 1.79s =================================================================================


===== pytest run 2025-12-25 20:11:15 args=['tests/test_media_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items



tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED                                                                                                                             [  7%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED                                                                                                                   [ 15%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED                                                                                                             [ 23%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED                                                                                                        [ 30%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED                                                                                                                  [ 38%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
FAILED                                                                                                                       [ 46%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
FAILED                                                                                                                               [ 53%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
FAILED                                                                                                               [ 61%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
FAILED                                                                                                             [ 69%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED                                                                                                             [ 76%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED                                                                                                               [ 84%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED                                                                                                             [ 92%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________ test_media_widget_placeholder_when_no_media _______________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x29136850a30) at 0x000002916632D880>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000291663D4310>

thread_manager = <core.threading.manager.ThreadManager object at 0x000002916632D690>



    @pytest.mark.qt

    def test_media_widget_placeholder_when_no_media(qt_app, qtbot, thread_manager):

        """When controller returns None, widget should remain hidden (no media)."""

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 80)

    

>       w.start()



tests\test_media_widget.py:184: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.media_widget.MediaWidget(0x291353a51a0) at 0x000002916632F000>



    def start(self) -> None:

        """Begin polling media controller and showing widget."""

    

        if self._enabled:

            logger.warning("Media widget already running")

            return

        if not self._ensure_thread_manager("MediaWidget.start"):

            return

    

        self._enabled = True

>       self._refresh_media()

        ^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'MediaWidget' object has no attribute '_refresh_media'



widgets\media_widget.py:194: AttributeError

___________________________________________________________________________________ test_media_widget_displays_metadata ___________________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x29136850a30) at 0x000002916632D880>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000291661AB850>

thread_manager = <core.threading.manager.ThreadManager object at 0x000002916632DD10>



    @pytest.mark.qt

    def test_media_widget_displays_metadata(qt_app, qtbot, thread_manager):

        """MediaWidget should render title/artist/album and state text."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        w.start()

        qt_app.processEvents()

    

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

    

        html = w.text()

>       assert "Song Title" in html

E       AssertionError: assert 'Song Title' in ''



tests\test_media_widget.py:218: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

___________________________________________________________________________ test_media_widget_hides_again_when_media_disappears ___________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x29136850a30) at 0x000002916632D880>, qtbot = <pytestqt.qtbot.QtBot object at 0x0000029166EC8710>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000029166EC86D0>



    @pytest.mark.qt

    def test_media_widget_hides_again_when_media_disappears(qt_app, qtbot, thread_manager):

        """Widget should hide after being visible when media goes away."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        # Start with media present

        w.start()

        qt_app.processEvents()

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

>       assert w.isVisible()

E       assert False

E        +  where False = <built-in method isVisible of MediaWidget object at 0x0000029166EC8840>()

E        +    where <built-in method isVisible of MediaWidget object at 0x0000029166EC8840> = <widgets.media_widget.MediaWidget(0x29135522410) at 0x0000029166EC8840>.isVisible



tests\test_media_widget.py:245: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_decodes_artwork_and_adjusts_margins __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x29136850a30) at 0x000002916632D880>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000291663BB2D0>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000029135E32950>



    @pytest.mark.qt

    def test_media_widget_decodes_artwork_and_adjusts_margins(qt_app, qtbot, thread_manager):

        """Artwork bytes should be decoded into a pixmap and margins updated."""

    

        # Create a tiny in-memory PNG for artwork

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.red)

        pm = QPixmap.fromImage(img)

    

        # Encode to PNG bytes using an in-memory buffer so loadFromData can decode it.

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        w.start()

        qt_app.processEvents()

    

        # Capture initial left margin, then refresh and ensure it increases

        # when artwork is successfully decoded.

        initial_margins = w.contentsMargins()

    

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

    

        updated_margins = w.contentsMargins()

        assert updated_margins.left() >= initial_margins.left()

        # When artwork is decoded, we expect the left margin to grow to

        # accommodate the icon.

>       assert updated_margins.left() > initial_margins.left()

E       assert 29 > 29

E        +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x0000029135E33140>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x0000029135E33140> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x0000029135E33140>.left

E        +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x0000029135E336C0>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x0000029135E336C0> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x0000029135E336C0>.left



tests\test_media_widget.py:296: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_starts_fade_in_when_artwork_appears __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x29136850a30) at 0x000002916632D880>, qtbot = <pytestqt.qtbot.QtBot object at 0x0000029135E73E50>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000029135E722D0>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot, thread_manager):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Fade Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        # First refresh with no media keeps widget hidden and no artwork.

        w.start()

        qt_app.processEvents()

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert not w.isVisible()

    

        # Now provide artwork-bearing media and refresh once; this should

        # create an artwork pixmap and start a fade-in (opacity starts at 0).

        ctrl._info = info

        w._refresh()  # type: ignore[attr-defined]

    

>       assert getattr(w, "_artwork_opacity", 1.0) == 0.0

E       AssertionError: assert 1.0 == 0.0

E        +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x2913551eed0) at 0x0000029135E87300>, '_artwork_opacity', 1.0)



tests\test_media_widget.py:338: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_display_widget_ctrl_click_routes_to_media_widget __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x29136850a30) at 0x000002916632D880>, settings_manager = <core.settings.settings_manager.SettingsManager(0x291355040b0) at 0x0000029166F44D80>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000029166F46FD0>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x0000029166F47F90>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000029166F47650>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x2913551f9b0) at 0x0000029166F47940>.media_widget



tests\test_media_widget.py:391: AssertionError

_______________________________________________________________________ test_display_widget_hard_exit_click_routes_to_media_widget ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x29136850a30) at 0x000002916632D880>, settings_manager = <core.settings.settings_manager.SettingsManager(0x2913708ba00) at 0x0000029166E8ED40>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000029166E8ED90>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x0000029135E64B50>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000029135E66110>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x2913702f8c0) at 0x0000029166F34300>.media_widget



tests\test_media_widget.py:451: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_media_widget.py::test_media_widget_placeholder_when_no_media - AttributeError: 'MediaWidget' object has no attribute '_refresh_media'

FAILED tests/test_media_widget.py::test_media_widget_displays_metadata - AssertionError: assert 'Song Title' in ''

FAILED tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears - assert False
 +  where False = <built-in method isVisible of MediaWidget object at 0x0000029166EC8840>()
 +    where <built-in method isVisible of MediaWidget object at 0x0000029166EC8840> = <widgets.media_widget.MediaWidget(0x29135522410) at 0x0000029166EC8840>.isVisible


FAILED tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins - assert 29 > 29
 +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x0000029135E33140>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x0000029135E33140> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x0000029135E33140>.left
 +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x0000029135E336C0>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x0000029135E336C0> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x0000029135E336C0>.left


FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears - AssertionError: assert 1.0 == 0.0
 +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x2913551eed0) at 0x0000029135E87300>, '_artwork_opacity', 1.0)


FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x2913551f9b0) at 0x0000029166F47940>.media_widget


FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x2913702f8c0) at 0x0000029166F34300>.media_widget


======================================================================================= 7 failed, 6 passed in 1.40s =======================================================================================


===== pytest run 2025-12-25 20:16:36 args=['tests/test_media_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items



tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED                                                                                                                             [  7%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED                                                                                                                   [ 15%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED                                                                                                             [ 23%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED                                                                                                        [ 30%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED                                                                                                                  [ 38%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
FAILED                                                                                                                       [ 46%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
FAILED                                                                                                                               [ 53%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
FAILED                                                                                                               [ 61%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
FAILED                                                                                                             [ 69%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED                                                                                                             [ 76%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED                                                                                                               [ 84%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED                                                                                                             [ 92%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________ test_media_widget_placeholder_when_no_media _______________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x208c629c4b0) at 0x00000208F5F700C0>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000208F5FC3810>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000208F5FC3B90>



    @pytest.mark.qt

    def test_media_widget_placeholder_when_no_media(qt_app, qtbot, thread_manager):

        """When controller returns None, widget should remain hidden (no media)."""

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 80)

    

>       w.start()



tests\test_media_widget.py:184: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.media_widget.MediaWidget(0x208c67c9390) at 0x00000208F584F000>



    def start(self) -> None:

        """Begin polling media controller and showing widget."""

    

        if self._enabled:

            logger.warning("Media widget already running")

            return

        if not self._ensure_thread_manager("MediaWidget.start"):

            return

    

        self._enabled = True

>       self._refresh_media()

        ^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'MediaWidget' object has no attribute '_refresh_media'



widgets\media_widget.py:194: AttributeError

___________________________________________________________________________________ test_media_widget_displays_metadata ___________________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x208c629c4b0) at 0x00000208F5F700C0>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000208C5A01090>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000208C5A037D0>



    @pytest.mark.qt

    def test_media_widget_displays_metadata(qt_app, qtbot, thread_manager):

        """MediaWidget should render title/artist/album and state text."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

>       w.start()



tests\test_media_widget.py:211: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.media_widget.MediaWidget(0x208c67c9450) at 0x00000208C5A14540>



    def start(self) -> None:

        """Begin polling media controller and showing widget."""

    

        if self._enabled:

            logger.warning("Media widget already running")

            return

        if not self._ensure_thread_manager("MediaWidget.start"):

            return

    

        self._enabled = True

>       self._refresh_media()

        ^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'MediaWidget' object has no attribute '_refresh_media'



widgets\media_widget.py:194: AttributeError

___________________________________________________________________________ test_media_widget_hides_again_when_media_disappears ___________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x208c629c4b0) at 0x00000208F5F700C0>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000208C6DFF210>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000208C59D94D0>



    @pytest.mark.qt

    def test_media_widget_hides_again_when_media_disappears(qt_app, qtbot, thread_manager):

        """Widget should hide after being visible when media goes away."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        # Start with media present

        w.start()

        qt_app.processEvents()

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

>       assert w.isVisible()

E       assert False

E        +  where False = <built-in method isVisible of MediaWidget object at 0x00000208C59DBC40>()

E        +    where <built-in method isVisible of MediaWidget object at 0x00000208C59DBC40> = <widgets.media_widget.MediaWidget(0x208c67c9bd0) at 0x00000208C59DBC40>.isVisible



tests\test_media_widget.py:246: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_decodes_artwork_and_adjusts_margins __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x208c629c4b0) at 0x00000208F5F700C0>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000208C59E0410>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000208C59E1F10>



    @pytest.mark.qt

    def test_media_widget_decodes_artwork_and_adjusts_margins(qt_app, qtbot, thread_manager):

        """Artwork bytes should be decoded into a pixmap and margins updated."""

    

        # Create a tiny in-memory PNG for artwork

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.red)

        pm = QPixmap.fromImage(img)

    

        # Encode to PNG bytes using an in-memory buffer so loadFromData can decode it.

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        w.start()

        qt_app.processEvents()

    

        # Capture initial left margin, then refresh and ensure it increases

        # when artwork is successfully decoded.

        initial_margins = w.contentsMargins()

    

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

    

        updated_margins = w.contentsMargins()

        assert updated_margins.left() >= initial_margins.left()

        # When artwork is decoded, we expect the left margin to grow to

        # accommodate the icon.

>       assert updated_margins.left() > initial_margins.left()

E       assert 29 > 29

E        +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000208C59E3640>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000208C59E3640> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000208C59E3640>.left

E        +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000208C59E3040>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000208C59E3040> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000208C59E3040>.left



tests\test_media_widget.py:297: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_starts_fade_in_when_artwork_appears __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x208c629c4b0) at 0x00000208F5F700C0>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000208F5FAE510>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000208F5FC1990>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot, thread_manager):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Fade Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        # First refresh with no media keeps widget hidden and no artwork.

>       w.start()



tests\test_media_widget.py:328: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.media_widget.MediaWidget(0x208c67c7710) at 0x00000208C59E9CC0>



    def start(self) -> None:

        """Begin polling media controller and showing widget."""

    

        if self._enabled:

            logger.warning("Media widget already running")

            return

        if not self._ensure_thread_manager("MediaWidget.start"):

            return

    

        self._enabled = True

>       self._refresh_media()

        ^^^^^^^^^^^^^^^^^^^

E       AttributeError: 'MediaWidget' object has no attribute '_refresh_media'



widgets\media_widget.py:194: AttributeError

__________________________________________________________________________ test_display_widget_ctrl_click_routes_to_media_widget __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x208c629c4b0) at 0x00000208F5F700C0>, settings_manager = <core.settings.settings_manager.SettingsManager(0x208c66bea00) at 0x00000208C59E08C0>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000208F6AFE090>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x00000208F6AFEF10>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000208F6AFCC50>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x208c4834ff0) at 0x00000208F6AFEBC0>.media_widget



tests\test_media_widget.py:393: AssertionError

_______________________________________________________________________ test_display_widget_hard_exit_click_routes_to_media_widget ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x208c629c4b0) at 0x00000208F5F700C0>, settings_manager = <core.settings.settings_manager.SettingsManager(0x208c6984020) at 0x00000208C5A011C0>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000208F6A78D90>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x00000208F6A79210>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000208F6A79110>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x208c6795fa0) at 0x00000208F6A792C0>.media_widget



tests\test_media_widget.py:453: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_media_widget.py::test_media_widget_placeholder_when_no_media - AttributeError: 'MediaWidget' object has no attribute '_refresh_media'

FAILED tests/test_media_widget.py::test_media_widget_displays_metadata - AttributeError: 'MediaWidget' object has no attribute '_refresh_media'

FAILED tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears - assert False
 +  where False = <built-in method isVisible of MediaWidget object at 0x00000208C59DBC40>()
 +    where <built-in method isVisible of MediaWidget object at 0x00000208C59DBC40> = <widgets.media_widget.MediaWidget(0x208c67c9bd0) at 0x00000208C59DBC40>.isVisible


FAILED tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins - assert 29 > 29
 +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000208C59E3640>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000208C59E3640> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000208C59E3640>.left
 +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000208C59E3040>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000208C59E3040> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000208C59E3040>.left


FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears - AttributeError: 'MediaWidget' object has no attribute '_refresh_media'

FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x208c4834ff0) at 0x00000208F6AFEBC0>.media_widget


FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x208c6795fa0) at 0x00000208F6A792C0>.media_widget


======================================================================================= 7 failed, 6 passed in 1.57s =======================================================================================


===== pytest run 2025-12-25 20:19:00 args=['tests/test_media_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items



tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED                                                                                                                             [  7%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED                                                                                                                   [ 15%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED                                                                                                             [ 23%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED                                                                                                        [ 30%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED                                                                                                                  [ 38%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
PASSED                                                                                                                       [ 46%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
FAILED                                                                                                                               [ 53%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
FAILED                                                                                                               [ 61%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
FAILED                                                                                                             [ 69%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED                                                                                                             [ 76%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED                                                                                                               [ 84%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED                                                                                                             [ 92%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

___________________________________________________________________________________ test_media_widget_displays_metadata ___________________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1750589bb20) at 0x00000175352D4840>, qtbot = <pytestqt.qtbot.QtBot object at 0x000001753525EE90>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000175353069D0>



    @pytest.mark.qt

    def test_media_widget_displays_metadata(qt_app, qtbot, thread_manager):

        """MediaWidget should render title/artist/album and state text."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        w.start()

        qt_app.processEvents()

    

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

    

        html = w.text()

        assert "Song Title" in html

        assert "Artist Name" in html

>       assert "Album Name" in html

E       assert 'Album Name' in "<div style='line-height:1.25'><div style='font-size:24pt; font-weight:750; letter-spacing:1px; margin-left:36px; color:rgba(255,255,255,255);'>SPOTIFY</div><div style='margin-top:8px;'><div style='font-size:23pt; font-weight:700;'>Song Title</div><div style='margin-top:4px; font-size:18pt; font-weight:600; opacity:0.95;'>Artist Name</div></div></div>"



tests\test_media_widget.py:221: AssertionError

___________________________________________________________________________ test_media_widget_hides_again_when_media_disappears ___________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1750589bb20) at 0x00000175352D4840>, qtbot = <pytestqt.qtbot.QtBot object at 0x0000017538768150>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000017538768490>



    @pytest.mark.qt

    def test_media_widget_hides_again_when_media_disappears(qt_app, qtbot, thread_manager):

        """Widget should hide after being visible when media goes away."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        # Start with media present

        w.start()

        qt_app.processEvents()

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

>       assert w.isVisible()

E       assert False

E        +  where False = <built-in method isVisible of MediaWidget object at 0x0000017538768D80>()

E        +    where <built-in method isVisible of MediaWidget object at 0x0000017538768D80> = <widgets.media_widget.MediaWidget(0x17505dd8f90) at 0x0000017538768D80>.isVisible



tests\test_media_widget.py:246: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_decodes_artwork_and_adjusts_margins __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1750589bb20) at 0x00000175352D4840>, qtbot = <pytestqt.qtbot.QtBot object at 0x000001753877B410>

thread_manager = <core.threading.manager.ThreadManager object at 0x000001753877B6D0>



    @pytest.mark.qt

    def test_media_widget_decodes_artwork_and_adjusts_margins(qt_app, qtbot, thread_manager):

        """Artwork bytes should be decoded into a pixmap and margins updated."""

    

        # Create a tiny in-memory PNG for artwork

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.red)

        pm = QPixmap.fromImage(img)

    

        # Encode to PNG bytes using an in-memory buffer so loadFromData can decode it.

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        w.start()

        qt_app.processEvents()

    

        # Capture initial left margin, then refresh and ensure it increases

        # when artwork is successfully decoded.

        initial_margins = w.contentsMargins()

    

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

    

        updated_margins = w.contentsMargins()

        assert updated_margins.left() >= initial_margins.left()

        # When artwork is decoded, we expect the left margin to grow to

        # accommodate the icon.

>       assert updated_margins.left() > initial_margins.left()

E       assert 29 > 29

E        +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x000001753877BBC0>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x000001753877BBC0> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x000001753877BBC0>.left

E        +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x0000017538778140>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x0000017538778140> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x0000017538778140>.left



tests\test_media_widget.py:297: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_starts_fade_in_when_artwork_appears __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1750589bb20) at 0x00000175352D4840>, qtbot = <pytestqt.qtbot.QtBot object at 0x0000017535313C90>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000017535311110>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot, thread_manager):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Fade Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        # First refresh with no media keeps widget hidden and no artwork.

        w.start()

        qt_app.processEvents()

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert not w.isVisible()

    

        # Now provide artwork-bearing media and refresh once; this should

        # create an artwork pixmap and start a fade-in (opacity starts at 0).

        ctrl._info = info

        w._refresh()  # type: ignore[attr-defined]

    

>       assert getattr(w, "_artwork_opacity", 1.0) == 0.0

E       AssertionError: assert 1.0 == 0.0

E        +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x17505df5c60) at 0x000001753536BB00>, '_artwork_opacity', 1.0)



tests\test_media_widget.py:340: AssertionError

__________________________________________________________________________ test_display_widget_ctrl_click_routes_to_media_widget __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1750589bb20) at 0x00000175352D4840>, settings_manager = <core.settings.settings_manager.SettingsManager(0x17505cf10e0) at 0x0000017538780900>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000017538782050>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x0000017538781550>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000175387816D0>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x17505df7580) at 0x000001753877C140>.media_widget



tests\test_media_widget.py:393: AssertionError

_______________________________________________________________________ test_display_widget_hard_exit_click_routes_to_media_widget ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1750589bb20) at 0x00000175352D4840>, settings_manager = <core.settings.settings_manager.SettingsManager(0x17505cf1a80) at 0x0000017538781300>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000017538E216D0>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x0000017538E21910>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000017538E21A50>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x17505c4d3b0) at 0x0000017538E20880>.media_widget



tests\test_media_widget.py:453: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_media_widget.py::test_media_widget_displays_metadata - assert 'Album Name' in "<div style='line-height:1.25'><div style='font-size:24pt; font-weight:750; letter-spacing:1px; margin-left:36px; color:rgba(255,255,255,255);'>SPOTIFY</div><div style='margin-top:8px;'><div style='font-size:23pt; font-weight:700;'>Song Title</div><div style='margin-top:4px; font-size:18pt; font-weight:600; opacity:0.95;'>Artist Name</div></div></div>"

FAILED tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears - assert False
 +  where False = <built-in method isVisible of MediaWidget object at 0x0000017538768D80>()
 +    where <built-in method isVisible of MediaWidget object at 0x0000017538768D80> = <widgets.media_widget.MediaWidget(0x17505dd8f90) at 0x0000017538768D80>.isVisible


FAILED tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins - assert 29 > 29
 +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x000001753877BBC0>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x000001753877BBC0> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x000001753877BBC0>.left
 +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x0000017538778140>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x0000017538778140> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x0000017538778140>.left


FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears - AssertionError: assert 1.0 == 0.0
 +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x17505df5c60) at 0x000001753536BB00>, '_artwork_opacity', 1.0)


FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x17505df7580) at 0x000001753877C140>.media_widget


FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x17505c4d3b0) at 0x0000017538E20880>.media_widget


======================================================================================= 6 failed, 7 passed in 1.34s =======================================================================================


===== pytest run 2025-12-25 20:21:21 args=['tests/test_media_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items



tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED                                                                                                                             [  7%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED                                                                                                                   [ 15%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED                                                                                                             [ 23%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED                                                                                                        [ 30%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED                                                                                                                  [ 38%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
PASSED                                                                                                                       [ 46%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
FAILED                                                                                                                               [ 53%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
FAILED                                                                                                               [ 61%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
FAILED                                                                                                             [ 69%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED                                                                                                             [ 76%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED                                                                                                               [ 84%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED                                                                                                             [ 92%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

___________________________________________________________________________________ test_media_widget_displays_metadata ___________________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x27777817880) at 0x00000277285DFEC0>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000277286904D0>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000277286938D0>



    @pytest.mark.qt

    def test_media_widget_displays_metadata(qt_app, qtbot, thread_manager):

        """MediaWidget should render title/artist/album and state text."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        w.start()

        qt_app.processEvents()

    

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

    

        html = w.text()

        assert "Song Title" in html

        assert "Artist Name" in html

>       assert "Album Name" in html

E       assert 'Album Name' in "<div style='line-height:1.25'><div style='font-size:24pt; font-weight:750; letter-spacing:1px; margin-left:36px; color:rgba(255,255,255,255);'>SPOTIFY</div><div style='margin-top:8px;'><div style='font-size:23pt; font-weight:700;'>Song Title</div><div style='margin-top:4px; font-size:18pt; font-weight:600; opacity:0.95;'>Artist Name</div></div></div>"



tests\test_media_widget.py:220: AssertionError

___________________________________________________________________________ test_media_widget_hides_again_when_media_disappears ___________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x27777817880) at 0x00000277285DFEC0>, qtbot = <pytestqt.qtbot.QtBot object at 0x000002772B5F8C50>

thread_manager = <core.threading.manager.ThreadManager object at 0x000002772B5F82D0>



    @pytest.mark.qt

    def test_media_widget_hides_again_when_media_disappears(qt_app, qtbot, thread_manager):

        """Widget should hide after being visible when media goes away."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        # Start with media present

        w.start()

        qt_app.processEvents()

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

>       assert w.isVisible()

E       assert False

E        +  where False = <built-in method isVisible of MediaWidget object at 0x000002772B5F8A80>()

E        +    where <built-in method isVisible of MediaWidget object at 0x000002772B5F8A80> = <widgets.media_widget.MediaWidget(0x27779169540) at 0x000002772B5F8A80>.isVisible



tests\test_media_widget.py:245: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_decodes_artwork_and_adjusts_margins __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x27777817880) at 0x00000277285DFEC0>, qtbot = <pytestqt.qtbot.QtBot object at 0x000002772B624490>

thread_manager = <core.threading.manager.ThreadManager object at 0x000002772B624CD0>



    @pytest.mark.qt

    def test_media_widget_decodes_artwork_and_adjusts_margins(qt_app, qtbot, thread_manager):

        """Artwork bytes should be decoded into a pixmap and margins updated."""

    

        # Create a tiny in-memory PNG for artwork

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.red)

        pm = QPixmap.fromImage(img)

    

        # Encode to PNG bytes using an in-memory buffer so loadFromData can decode it.

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        w.start()

        qt_app.processEvents()

    

        # Capture initial left margin, then refresh and ensure it increases

        # when artwork is successfully decoded.

        initial_margins = w.contentsMargins()

    

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

    

        updated_margins = w.contentsMargins()

        assert updated_margins.left() >= initial_margins.left()

        # When artwork is decoded, we expect the left margin to grow to

        # accommodate the icon.

>       assert updated_margins.left() > initial_margins.left()

E       assert 29 > 29

E        +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x000002772B6252C0>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x000002772B6252C0> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x000002772B6252C0>.left

E        +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x000002772B6254C0>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x000002772B6254C0> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x000002772B6254C0>.left



tests\test_media_widget.py:296: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_starts_fade_in_when_artwork_appears __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x27777817880) at 0x00000277285DFEC0>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000277285C5810>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000027728679750>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot, thread_manager):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Fade Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        # First refresh with no media keeps widget hidden and no artwork.

        w.start()

        qt_app.processEvents()

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert not w.isVisible()

    

        # Now provide artwork-bearing media and refresh once; this should

        # create an artwork pixmap and start a fade-in (opacity starts at 0).

        ctrl._info = info

        w._refresh()  # type: ignore[attr-defined]

    

>       assert getattr(w, "_artwork_opacity", 1.0) == 0.0

E       AssertionError: assert 1.0 == 0.0

E        +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x27778e964e0) at 0x0000027778003680>, '_artwork_opacity', 1.0)



tests\test_media_widget.py:339: AssertionError

__________________________________________________________________________ test_display_widget_ctrl_click_routes_to_media_widget __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x27777817880) at 0x00000277285DFEC0>, settings_manager = <core.settings.settings_manager.SettingsManager(0x27778ffd2f0) at 0x000002777803D340>

qtbot = <pytestqt.qtbot.QtBot object at 0x000002777804F6D0>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x0000027778021B50>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000027778020150>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x27778e939c0) at 0x0000027778056280>.media_widget



tests\test_media_widget.py:392: AssertionError

_______________________________________________________________________ test_display_widget_hard_exit_click_routes_to_media_widget ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x27777817880) at 0x00000277285DFEC0>, settings_manager = <core.settings.settings_manager.SettingsManager(0x27779305390) at 0x000002772B62FE00>

qtbot = <pytestqt.qtbot.QtBot object at 0x000002772B62FFD0>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002772BC91B90>

thread_manager = <core.threading.manager.ThreadManager object at 0x000002772BC91A90>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x27776e082f0) at 0x000002772BC90CC0>.media_widget



tests\test_media_widget.py:452: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_media_widget.py::test_media_widget_displays_metadata - assert 'Album Name' in "<div style='line-height:1.25'><div style='font-size:24pt; font-weight:750; letter-spacing:1px; margin-left:36px; color:rgba(255,255,255,255);'>SPOTIFY</div><div style='margin-top:8px;'><div style='font-size:23pt; font-weight:700;'>Song Title</div><div style='margin-top:4px; font-size:18pt; font-weight:600; opacity:0.95;'>Artist Name</div></div></div>"

FAILED tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears - assert False
 +  where False = <built-in method isVisible of MediaWidget object at 0x000002772B5F8A80>()
 +    where <built-in method isVisible of MediaWidget object at 0x000002772B5F8A80> = <widgets.media_widget.MediaWidget(0x27779169540) at 0x000002772B5F8A80>.isVisible


FAILED tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins - assert 29 > 29
 +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x000002772B6252C0>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x000002772B6252C0> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x000002772B6252C0>.left
 +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x000002772B6254C0>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x000002772B6254C0> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x000002772B6254C0>.left


FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears - AssertionError: assert 1.0 == 0.0
 +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x27778e964e0) at 0x0000027778003680>, '_artwork_opacity', 1.0)


FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x27778e939c0) at 0x0000027778056280>.media_widget


FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x27776e082f0) at 0x000002772BC90CC0>.media_widget


======================================================================================= 6 failed, 7 passed in 1.29s =======================================================================================


===== pytest run 2025-12-25 22:39:55 args=['tests/test_media_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items



tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED                                                                                                                             [  7%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED                                                                                                                   [ 15%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED                                                                                                             [ 23%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED                                                                                                        [ 30%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED                                                                                                                  [ 38%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
PASSED                                                                                                                       [ 46%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
FAILED                                                                                                                               [ 53%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
FAILED                                                                                                               [ 61%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
FAILED                                                                                                             [ 69%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED                                                                                                             [ 76%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED                                                                                                               [ 84%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED                                                                                                             [ 92%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

___________________________________________________________________________________ test_media_widget_displays_metadata ___________________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1fe1c4c8400) at 0x000001FE4C482A80>, qtbot = <pytestqt.qtbot.QtBot object at 0x000001FE4BD57B90>

thread_manager = <core.threading.manager.ThreadManager object at 0x000001FE4C4FB1D0>



    @pytest.mark.qt

    def test_media_widget_displays_metadata(qt_app, qtbot, thread_manager):

        """MediaWidget should render title/artist/album and state text."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        w.start()

        qt_app.processEvents()

    

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

    

        html = w.text()

        assert "Song Title" in html

        assert "Artist Name" in html

>       assert "Album Name" in html

E       assert 'Album Name' in "<div style='line-height:1.25'><div style='font-size:24pt; font-weight:750; letter-spacing:1px; margin-left:36px; color:rgba(255,255,255,255);'>SPOTIFY</div><div style='margin-top:8px;'><div style='font-size:23pt; font-weight:700;'>Song Title</div><div style='margin-top:4px; font-size:18pt; font-weight:600; opacity:0.95;'>Artist Name</div></div></div>"



tests\test_media_widget.py:220: AssertionError

___________________________________________________________________________ test_media_widget_hides_again_when_media_disappears ___________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1fe1c4c8400) at 0x000001FE4C482A80>, qtbot = <pytestqt.qtbot.QtBot object at 0x000001FE4C4CB790>

thread_manager = <core.threading.manager.ThreadManager object at 0x000001FE4C4CB650>



    @pytest.mark.qt

    def test_media_widget_hides_again_when_media_disappears(qt_app, qtbot, thread_manager):

        """Widget should hide after being visible when media goes away."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        # Start with media present

        w.start()

        qt_app.processEvents()

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert w.isVisible()

    

        # Now simulate media disappearing

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

>       assert not w.isVisible()

E       assert not True

E        +  where True = <built-in method isVisible of MediaWidget object at 0x000001FE1D39C780>()

E        +    where <built-in method isVisible of MediaWidget object at 0x000001FE1D39C780> = <widgets.media_widget.MediaWidget(0x1fe1d04b880) at 0x000001FE1D39C780>.isVisible



tests\test_media_widget.py:252: AssertionError

__________________________________________________________________________ test_media_widget_decodes_artwork_and_adjusts_margins __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1fe1c4c8400) at 0x000001FE4C482A80>, qtbot = <pytestqt.qtbot.QtBot object at 0x000001FE1BF7B950>

thread_manager = <core.threading.manager.ThreadManager object at 0x000001FE1BF79DD0>



    @pytest.mark.qt

    def test_media_widget_decodes_artwork_and_adjusts_margins(qt_app, qtbot, thread_manager):

        """Artwork bytes should be decoded into a pixmap and margins updated."""

    

        # Create a tiny in-memory PNG for artwork

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.red)

        pm = QPixmap.fromImage(img)

    

        # Encode to PNG bytes using an in-memory buffer so loadFromData can decode it.

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        w.start()

        qt_app.processEvents()

    

        # Capture initial left margin, then refresh and ensure it increases

        # when artwork is successfully decoded.

        initial_margins = w.contentsMargins()

    

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

    

        updated_margins = w.contentsMargins()

        assert updated_margins.left() >= initial_margins.left()

        # When artwork is decoded, we expect the left margin to grow to

        # accommodate the icon.

>       assert updated_margins.left() > initial_margins.left()

E       assert 29 > 29

E        +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x000001FE4C413140>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x000001FE4C413140> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x000001FE4C413140>.left

E        +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x000001FE4BC5D600>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x000001FE4BC5D600> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x000001FE4BC5D600>.left



tests\test_media_widget.py:297: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_media_widget_starts_fade_in_when_artwork_appears __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1fe1c4c8400) at 0x000001FE4C482A80>, qtbot = <pytestqt.qtbot.QtBot object at 0x000001FE1BF9D490>

thread_manager = <core.threading.manager.ThreadManager object at 0x000001FE1BF9D350>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot, thread_manager):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Fade Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        # First refresh with no media keeps widget hidden and no artwork.

        w.start()

        qt_app.processEvents()

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert not w.isVisible()

    

        # Now provide artwork-bearing media and refresh once; this should

        # create an artwork pixmap and start a fade-in (opacity starts at 0).

        ctrl._info = info

        w._refresh()  # type: ignore[attr-defined]

    

>       assert getattr(w, "_artwork_opacity", 1.0) == 0.0

E       AssertionError: assert 1.0 == 0.0

E        +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x1fe1cdcdf10) at 0x000001FE1BFA5140>, '_artwork_opacity', 1.0)



tests\test_media_widget.py:340: AssertionError

__________________________________________________________________________ test_display_widget_ctrl_click_routes_to_media_widget __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1fe1c4c8400) at 0x000001FE4C482A80>, settings_manager = <core.settings.settings_manager.SettingsManager(0x1fe1cd81520) at 0x000001FE4FA48A40>

qtbot = <pytestqt.qtbot.QtBot object at 0x000001FE1BFA5590>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000001FE1BF69FD0>

thread_manager = <core.threading.manager.ThreadManager object at 0x000001FE1BF69E50>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x1fe1cdcf6b0) at 0x000001FE1BF78100>.media_widget



tests\test_media_widget.py:393: AssertionError

_______________________________________________________________________ test_display_widget_hard_exit_click_routes_to_media_widget ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x1fe1c4c8400) at 0x000001FE4C482A80>, settings_manager = <core.settings.settings_manager.SettingsManager(0x1fe1cd81680) at 0x000001FE4FA73AC0>

qtbot = <pytestqt.qtbot.QtBot object at 0x000001FE4FD22850>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000001FE4FD22510>

thread_manager = <core.threading.manager.ThreadManager object at 0x000001FE4FD22410>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x1fe1aceba00) at 0x000001FE4FCEDCC0>.media_widget



tests\test_media_widget.py:453: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_media_widget.py::test_media_widget_displays_metadata - assert 'Album Name' in "<div style='line-height:1.25'><div style='font-size:24pt; font-weight:750; letter-spacing:1px; margin-left:36px; color:rgba(255,255,255,255);'>SPOTIFY</div><div style='margin-top:8px;'><div style='font-size:23pt; font-weight:700;'>Song Title</div><div style='margin-top:4px; font-size:18pt; font-weight:600; opacity:0.95;'>Artist Name</div></div></div>"

FAILED tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears - assert not True
 +  where True = <built-in method isVisible of MediaWidget object at 0x000001FE1D39C780>()
 +    where <built-in method isVisible of MediaWidget object at 0x000001FE1D39C780> = <widgets.media_widget.MediaWidget(0x1fe1d04b880) at 0x000001FE1D39C780>.isVisible


FAILED tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins - assert 29 > 29
 +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x000001FE4C413140>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x000001FE4C413140> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x000001FE4C413140>.left
 +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x000001FE4BC5D600>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x000001FE4BC5D600> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x000001FE4BC5D600>.left


FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears - AssertionError: assert 1.0 == 0.0
 +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x1fe1cdcdf10) at 0x000001FE1BFA5140>, '_artwork_opacity', 1.0)


FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x1fe1cdcf6b0) at 0x000001FE1BF78100>.media_widget


FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x1fe1aceba00) at 0x000001FE4FCEDCC0>.media_widget


======================================================================================= 6 failed, 7 passed in 1.90s =======================================================================================


===== pytest run 2025-12-25 22:46:55 args=['tests/test_media_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items



tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED                                                                                                                             [  7%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED                                                                                                                   [ 15%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED                                                                                                             [ 23%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED                                                                                                        [ 30%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED                                                                                                                  [ 38%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
PASSED                                                                                                                       [ 46%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
PASSED                                                                                                                               [ 53%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
FAILED                                                                                                               [ 61%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
FAILED                                                                                                             [ 69%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED                                                                                                             [ 76%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED                                                                                                               [ 84%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED                                                                                                             [ 92%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

___________________________________________________________________________ test_media_widget_hides_again_when_media_disappears ___________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x147804a68f0) at 0x00000147AFDFAE40>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000147AFEE1ED0>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000147AFEE24D0>



    @pytest.mark.qt

    def test_media_widget_hides_again_when_media_disappears(qt_app, qtbot, thread_manager):

        """Widget should hide after being visible when media goes away."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        # Start with media present

        w.start()

        qt_app.processEvents()

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert w.isVisible()

    

        # Now simulate media disappearing

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

>       assert not w.isVisible()

E       assert not True

E        +  where True = <built-in method isVisible of MediaWidget object at 0x00000147AFEE2D40>()

E        +    where <built-in method isVisible of MediaWidget object at 0x00000147AFEE2D40> = <widgets.media_widget.MediaWidget(0x14780d1a5a0) at 0x00000147AFEE2D40>.isVisible



tests\test_media_widget.py:247: AssertionError

__________________________________________________________________________ test_media_widget_decodes_artwork_and_adjusts_margins __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x147804a68f0) at 0x00000147AFDFAE40>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000147AFEE1DD0>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000147AFEEA450>



    @pytest.mark.qt

    def test_media_widget_decodes_artwork_and_adjusts_margins(qt_app, qtbot, thread_manager):

        """Artwork bytes should be decoded into a pixmap and margins updated."""

    

        # Create a tiny in-memory PNG for artwork

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.red)

        pm = QPixmap.fromImage(img)

    

        # Encode to PNG bytes using an in-memory buffer so loadFromData can decode it.

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        w.start()

        qt_app.processEvents()

    

        # Capture initial left margin, then refresh and ensure it increases

        # when artwork is successfully decoded.

        initial_margins = w.contentsMargins()

    

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

    

        updated_margins = w.contentsMargins()

        assert updated_margins.left() >= initial_margins.left()

        # When artwork is decoded, we expect the left margin to grow to

        # accommodate the icon.

>       assert updated_margins.left() > initial_margins.left()

E       assert 29 > 29

E        +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000147AFEE2840>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000147AFEE2840> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000147AFEE2840>.left

E        +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000147AFF4A400>()

E        +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000147AFF4A400> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000147AFF4A400>.left



tests\test_media_widget.py:293: AssertionError

__________________________________________________________________________ test_media_widget_starts_fade_in_when_artwork_appears __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x147804a68f0) at 0x00000147AFDFAE40>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000147AFEE3E10>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000147AFEE0D90>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot, thread_manager):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Fade Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        # First refresh with no media keeps widget hidden and no artwork.

        w.start()

        qt_app.processEvents()

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert not w.isVisible()

    

        # Now provide artwork-bearing media and refresh once; this should

        # create an artwork pixmap and start a fade-in (opacity starts at 0).

        ctrl._info = info

        w._refresh()  # type: ignore[attr-defined]

    

>       assert getattr(w, "_artwork_opacity", 1.0) == 0.0

E       AssertionError: assert 1.0 == 0.0

E        +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x14780d16220) at 0x00000147AFEEBB40>, '_artwork_opacity', 1.0)



tests\test_media_widget.py:336: AssertionError

__________________________________________________________________________ test_display_widget_ctrl_click_routes_to_media_widget __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x147804a68f0) at 0x00000147AFDFAE40>, settings_manager = <core.settings.settings_manager.SettingsManager(0x14780a1bbc0) at 0x00000147FF901180>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000147AFED7AD0>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x00000147B30A0210>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000147B30A1550>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x14780d17420) at 0x00000147AFEE39C0>.media_widget



tests\test_media_widget.py:389: AssertionError

_______________________________________________________________________ test_display_widget_hard_exit_click_routes_to_media_widget ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x147804a68f0) at 0x00000147AFDFAE40>, settings_manager = <core.settings.settings_manager.SettingsManager(0x14780dbd690) at 0x00000147B32EBB40>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000147B37B55D0>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x00000147B37B5AD0>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000147B37B5A90>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x147ff07a4b0) at 0x00000147B37B4A80>.media_widget



tests\test_media_widget.py:449: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears - assert not True
 +  where True = <built-in method isVisible of MediaWidget object at 0x00000147AFEE2D40>()
 +    where <built-in method isVisible of MediaWidget object at 0x00000147AFEE2D40> = <widgets.media_widget.MediaWidget(0x14780d1a5a0) at 0x00000147AFEE2D40>.isVisible


FAILED tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins - assert 29 > 29
 +  where 29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000147AFEE2840>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000147AFEE2840> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000147AFEE2840>.left
 +  and   29 = <built-in method left of PySide6.QtCore.QMargins object at 0x00000147AFF4A400>()
 +    where <built-in method left of PySide6.QtCore.QMargins object at 0x00000147AFF4A400> = <PySide6.QtCore.QMargins(29, 12, 12, 12) at 0x00000147AFF4A400>.left


FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears - AssertionError: assert 1.0 == 0.0
 +  where 1.0 = getattr(<widgets.media_widget.MediaWidget(0x14780d16220) at 0x00000147AFEEBB40>, '_artwork_opacity', 1.0)


FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x14780d17420) at 0x00000147AFEE39C0>.media_widget


FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x147ff07a4b0) at 0x00000147B37B4A80>.media_widget


======================================================================================= 5 failed, 8 passed in 1.47s =======================================================================================


===== pytest run 2025-12-25 22:50:57 args=['tests/test_media_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items



tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED                                                                                                                             [  7%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED                                                                                                                   [ 15%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED                                                                                                             [ 23%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED                                                                                                        [ 30%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED                                                                                                                  [ 38%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
PASSED                                                                                                                       [ 46%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
PASSED                                                                                                                               [ 53%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
FAILED                                                                                                               [ 61%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
PASSED                                                                                                             [ 69%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED                                                                                                             [ 76%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED                                                                                                               [ 84%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED                                                                                                             [ 92%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

___________________________________________________________________________ test_media_widget_hides_again_when_media_disappears ___________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x273885ffb00) at 0x00000273B809A100>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000273B80E15D0>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000273B80E21D0>



    @pytest.mark.qt

    def test_media_widget_hides_again_when_media_disappears(qt_app, qtbot, thread_manager):

        """Widget should hide after being visible when media goes away."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        # Start with media present

        w.start()

        qt_app.processEvents()

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

        qtbot.waitUntil(lambda: w.isVisible(), timeout=2000)

    

        # Now simulate media disappearing

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

>       assert not w.isVisible()

E       assert not True

E        +  where True = <built-in method isVisible of MediaWidget object at 0x00000273B80E2EC0>()

E        +    where <built-in method isVisible of MediaWidget object at 0x00000273B80E2EC0> = <widgets.media_widget.MediaWidget(0x27388e766e0) at 0x00000273B80E2EC0>.isVisible



tests\test_media_widget.py:257: AssertionError

__________________________________________________________________________ test_media_widget_starts_fade_in_when_artwork_appears __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x273885ffb00) at 0x00000273B809A100>, qtbot = <pytestqt.qtbot.QtBot object at 0x00000273B81477D0>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000273B8146610>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot, thread_manager):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Fade Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        # First refresh with no media keeps widget hidden and no artwork.

        w.start()

        qt_app.processEvents()

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert not w.isVisible()

    

        # Now provide artwork-bearing media and refresh once; this should

        # create an artwork pixmap and start a fade-in (opacity starts at 0).

        ctrl._info = info

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

    

>       assert getattr(w, "_artwork_anim", None) is not None

E       AssertionError: assert None is not None

E        +  where None = getattr(<widgets.media_widget.MediaWidget(0x27388b4ce30) at 0x00000273B80EEF80>, '_artwork_anim', None)



tests\test_media_widget.py:350: AssertionError

__________________________________________________________________________ test_display_widget_ctrl_click_routes_to_media_widget __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x273885ffb00) at 0x00000273B809A100>, settings_manager = <core.settings.settings_manager.SettingsManager(0x27388e59910) at 0x00000273B80E3E00>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000273B80BB950>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x00000273B8029A10>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000273B8029F10>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

>       qtbot.waitUntil(lambda: isinstance(getattr(w, "media_widget", None), MediaWidget), timeout=2000)

E       pytestqt.exceptions.TimeoutError: waitUntil timed out in 2000 milliseconds



tests\test_media_widget.py:402: TimeoutError

_______________________________________________________________________ test_display_widget_hard_exit_click_routes_to_media_widget ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x273885ffb00) at 0x00000273B809A100>, settings_manager = <core.settings.settings_manager.SettingsManager(0x27388b16c40) at 0x00000273BB7C5F80>

qtbot = <pytestqt.qtbot.QtBot object at 0x00000273BB81E710>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x00000273BB81ED50>

thread_manager = <core.threading.manager.ThreadManager object at 0x00000273BB81EE10>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x27388e731a0) at 0x00000273BB7E0380>.media_widget



tests\test_media_widget.py:462: AssertionError

============================================================================================ warnings summary =============================================================================================

tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2515: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    self._initial_mouse_pos = event.pos()




tests/test_media_widget.py: 130 warnings

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2520: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dx = event.pos().x() - self._initial_mouse_pos.x()




tests/test_media_widget.py: 130 warnings

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2521: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dy = event.pos().y() - self._initial_mouse_pos.y()




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears - assert not True
 +  where True = <built-in method isVisible of MediaWidget object at 0x00000273B80E2EC0>()
 +    where <built-in method isVisible of MediaWidget object at 0x00000273B80E2EC0> = <widgets.media_widget.MediaWidget(0x27388e766e0) at 0x00000273B80E2EC0>.isVisible


FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears - AssertionError: assert None is not None
 +  where None = getattr(<widgets.media_widget.MediaWidget(0x27388b4ce30) at 0x00000273B80EEF80>, '_artwork_anim', None)


FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget - pytestqt.exceptions.TimeoutError: waitUntil timed out in 2000 milliseconds

FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x27388e731a0) at 0x00000273BB7E0380>.media_widget


================================================================================ 4 failed, 9 passed, 261 warnings in 3.61s ================================================================================


===== pytest run 2025-12-25 23:13:00 args=['tests/test_media_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items



tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED                                                                                                                             [  7%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED                                                                                                                   [ 15%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED                                                                                                             [ 23%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED                                                                                                        [ 30%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED                                                                                                                  [ 38%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
PASSED                                                                                                                       [ 46%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
FAILED                                                                                                                               [ 53%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
PASSED                                                                                                               [ 61%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
PASSED                                                                                                             [ 69%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED                                                                                                             [ 76%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED                                                                                                               [ 84%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED                                                                                                             [ 92%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

___________________________________________________________________________________ test_media_widget_displays_metadata ___________________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2156b112150) at 0x000002157EAD9F80>, qtbot = <pytestqt.qtbot.QtBot object at 0x000002157EBA4C10>

thread_manager = <core.threading.manager.ThreadManager object at 0x000002157EBA7FD0>



    @pytest.mark.qt

    def test_media_widget_displays_metadata(qt_app, qtbot, thread_manager):

        """MediaWidget should render title/artist/album and state text."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        w.start()

        qt_app.processEvents()

    

        # First refresh primes layout (widget stays hidden)

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

    

        # Second refresh with same info triggers actual fade/show

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

    

        qtbot.waitUntil(lambda: w.isVisible(), timeout=2000)

        html = w.text()

        assert "Song Title" in html

        assert "Artist Name" in html

>       assert "Playing" in html  # state badge headline

        ^^^^^^^^^^^^^^^^^^^^^^^^

E       assert 'Playing' in "<div style='line-height:1.25'><div style='font-size:24pt; font-weight:750; letter-spacing:1px; margin-left:36px; color:rgba(255,255,255,255);'>SPOTIFY</div><div style='margin-top:8px;'><div style='font-size:23pt; font-weight:700;'>Song Title</div><div style='margin-top:4px; font-size:18pt; font-weight:600; opacity:0.95;'>Artist Name</div></div></div>"



tests\test_media_widget.py:227: AssertionError

__________________________________________________________________________ test_media_widget_starts_fade_in_when_artwork_appears __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2156b112150) at 0x000002157EAD9F80>, qtbot = <pytestqt.qtbot.QtBot object at 0x000002157EC56D10>

thread_manager = <core.threading.manager.ThreadManager object at 0x000002157EC06450>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot, thread_manager):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Fade Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        # First refresh with no media keeps widget hidden and no artwork.

        w.start()

        qt_app.processEvents()

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert not w.isVisible()

    

        # Now provide artwork-bearing media and refresh once; this should

        # create an artwork pixmap and start a fade-in (opacity starts at 0).

        ctrl._info = info

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

    

>       assert getattr(w, "_artwork_anim", None) is not None

E       AssertionError: assert None is not None

E        +  where None = getattr(<widgets.media_widget.MediaWidget(0x2156b617450) at 0x000002157EC07AC0>, '_artwork_anim', None)



tests\test_media_widget.py:355: AssertionError

__________________________________________________________________________ test_display_widget_ctrl_click_routes_to_media_widget __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2156b112150) at 0x000002157EAD9F80>, settings_manager = <core.settings.settings_manager.SettingsManager(0x2156b7e9e40) at 0x000002157EB01CC0>

qtbot = <pytestqt.qtbot.QtBot object at 0x000002156A40A950>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002156A6689D0>

thread_manager = <core.threading.manager.ThreadManager object at 0x000002156A6692D0>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

>       qtbot.waitUntil(lambda: isinstance(getattr(w, "media_widget", None), MediaWidget), timeout=2000)

E       pytestqt.exceptions.TimeoutError: waitUntil timed out in 2000 milliseconds



tests\test_media_widget.py:407: TimeoutError

_______________________________________________________________________ test_display_widget_hard_exit_click_routes_to_media_widget ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2156b112150) at 0x000002157EAD9F80>, settings_manager = <core.settings.settings_manager.SettingsManager(0x2156b587b20) at 0x000002151DF19080>

qtbot = <pytestqt.qtbot.QtBot object at 0x000002151DED0750>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002151DE6A790>

thread_manager = <core.threading.manager.ThreadManager object at 0x000002151DE6AB90>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x2156b61a1b0) at 0x000002151DF197C0>.media_widget



tests\test_media_widget.py:467: AssertionError

============================================================================================ warnings summary =============================================================================================

tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2515: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    self._initial_mouse_pos = event.pos()




tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2486: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    logger.info(f"Mouse clicked at ({event.pos().x()}, {event.pos().y()}), requesting exit")




tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2520: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dx = event.pos().x() - self._initial_mouse_pos.x()




tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2521: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dy = event.pos().y() - self._initial_mouse_pos.y()




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_media_widget.py::test_media_widget_displays_metadata - assert 'Playing' in "<div style='line-height:1.25'><div style='font-size:24pt; font-weight:750; letter-spacing:1px; margin-left:36px; color:rgba(255,255,255,255);'>SPOTIFY</div><div style='margin-top:8px;'><div style='font-size:23pt; font-weight:700;'>Song Title</div><div style='margin-top:4px; font-size:18pt; font-weight:600; opacity:0.95;'>Artist Name</div></div></div>"

FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears - AssertionError: assert None is not None
 +  where None = getattr(<widgets.media_widget.MediaWidget(0x2156b617450) at 0x000002157EC07AC0>, '_artwork_anim', None)


FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget - pytestqt.exceptions.TimeoutError: waitUntil timed out in 2000 milliseconds

FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x2156b61a1b0) at 0x000002151DF197C0>.media_widget


================================================================================ 4 failed, 9 passed, 11 warnings in 3.44s =================================================================================


===== pytest run 2025-12-26 00:31:24 args=['tests/test_media_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items



tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED                                                                                                                             [  7%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED                                                                                                                   [ 15%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED                                                                                                             [ 23%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED                                                                                                        [ 30%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED                                                                                                                  [ 38%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
PASSED                                                                                                                       [ 46%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
FAILED                                                                                                                               [ 53%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
PASSED                                                                                                               [ 61%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
PASSED                                                                                                             [ 69%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED                                                                                                             [ 76%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED                                                                                                               [ 84%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED                                                                                                             [ 92%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

___________________________________________________________________________________ test_media_widget_displays_metadata ___________________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x23deb8294d0) at 0x0000023DFEEFE900>, qtbot = <pytestqt.qtbot.QtBot object at 0x0000023DFEFA7550>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000023DFEFA7910>



    @pytest.mark.qt

    def test_media_widget_displays_metadata(qt_app, qtbot, thread_manager):

        """MediaWidget should render title/artist/album and state text."""

    

        info = mc.MediaTrackInfo(

            title="Song Title",

            artist="Artist Name",

            album="Album Name",

            state=mc.MediaPlaybackState.PLAYING,

        )

        ctrl = _DummyController(info=info)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(500, 100)

    

        w.start()

        qt_app.processEvents()

    

        # First refresh primes layout (widget stays hidden)

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

    

        # Second refresh with same info triggers actual fade/show

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

    

        qtbot.waitUntil(lambda: w.isVisible(), timeout=2000)

        html = w.text()

        assert "Song Title" in html

        assert "Artist Name" in html

>       assert "Playing" in html  # state badge headline

        ^^^^^^^^^^^^^^^^^^^^^^^^

E       assert 'Playing' in "<div style='line-height:1.25'><div style='font-size:24pt; font-weight:750; letter-spacing:1px; margin-left:36px; color:rgba(255,255,255,255);'>SPOTIFY</div><div style='margin-top:8px;'><div style='font-size:23pt; font-weight:700;'>Song Title</div><div style='margin-top:4px; font-size:18pt; font-weight:600; opacity:0.95;'>Artist Name</div></div></div>"



tests\test_media_widget.py:227: AssertionError

__________________________________________________________________________ test_media_widget_starts_fade_in_when_artwork_appears __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x23deb8294d0) at 0x0000023DFEEFE900>, qtbot = <pytestqt.qtbot.QtBot object at 0x0000023D9E299910>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000023D9E299750>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot, thread_manager):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Fade Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        # First refresh with no media keeps widget hidden and no artwork.

        w.start()

        qt_app.processEvents()

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert not w.isVisible()

    

        # Now provide artwork-bearing media and refresh once; this should

        # create an artwork pixmap and start a fade-in (opacity starts at 0).

        ctrl._info = info

        w._refresh()  # type: ignore[attr-defined]

        _wait_for_media_refresh(qtbot, w)

        qt_app.processEvents()

    

>       assert getattr(w, "_artwork_anim", None) is not None

E       AssertionError: assert None is not None

E        +  where None = getattr(<widgets.media_widget.MediaWidget(0x23debb99000) at 0x0000023D9E2A1E80>, '_artwork_anim', None)



tests\test_media_widget.py:355: AssertionError

__________________________________________________________________________ test_display_widget_ctrl_click_routes_to_media_widget __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x23deb8294d0) at 0x0000023DFEEFE900>, settings_manager = <core.settings.settings_manager.SettingsManager(0x23debb68290) at 0x0000023D9E2AACC0>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000023DFF004190>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x0000023D9E275A10>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000023D9E275B50>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

>       qtbot.waitUntil(lambda: isinstance(getattr(w, "media_widget", None), MediaWidget), timeout=2000)

E       pytestqt.exceptions.TimeoutError: waitUntil timed out in 2000 milliseconds



tests\test_media_widget.py:407: TimeoutError

_______________________________________________________________________ test_display_widget_hard_exit_click_routes_to_media_widget ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x23deb8294d0) at 0x0000023DFEEFE900>, settings_manager = <core.settings.settings_manager.SettingsManager(0x23debb67590) at 0x0000023D9E25AB40>

qtbot = <pytestqt.qtbot.QtBot object at 0x0000023DEAA2F410>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x0000023DEAA2DD50>

thread_manager = <core.threading.manager.ThreadManager object at 0x0000023DEAA2E250>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

        qt_app.processEvents()

    

>       assert isinstance(w.media_widget, MediaWidget)

E       assert False

E        +  where False = isinstance(None, MediaWidget)

E        +    where None = <rendering.display_widget.DisplayWidget(0x23debb9a020) at 0x0000023DEAA1B580>.media_widget



tests\test_media_widget.py:467: AssertionError

============================================================================================ warnings summary =============================================================================================

tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2515: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    self._initial_mouse_pos = event.pos()




tests/test_media_widget.py: 66 warnings

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2520: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dx = event.pos().x() - self._initial_mouse_pos.x()




tests/test_media_widget.py: 66 warnings

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2521: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dy = event.pos().y() - self._initial_mouse_pos.y()




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_media_widget.py::test_media_widget_displays_metadata - assert 'Playing' in "<div style='line-height:1.25'><div style='font-size:24pt; font-weight:750; letter-spacing:1px; margin-left:36px; color:rgba(255,255,255,255);'>SPOTIFY</div><div style='margin-top:8px;'><div style='font-size:23pt; font-weight:700;'>Song Title</div><div style='margin-top:4px; font-size:18pt; font-weight:600; opacity:0.95;'>Artist Name</div></div></div>"

FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears - AssertionError: assert None is not None
 +  where None = getattr(<widgets.media_widget.MediaWidget(0x23debb99000) at 0x0000023D9E2A1E80>, '_artwork_anim', None)


FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget - pytestqt.exceptions.TimeoutError: waitUntil timed out in 2000 milliseconds

FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget - assert False
 +  where False = isinstance(None, MediaWidget)
 +    where None = <rendering.display_widget.DisplayWidget(0x23debb9a020) at 0x0000023DEAA1B580>.media_widget


================================================================================ 4 failed, 9 passed, 133 warnings in 3.62s ================================================================================


===== pytest run 2025-12-26 00:39:06 args=['tests/test_media_widget.py', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items



tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED                                                                                                                             [  7%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED                                                                                                                   [ 15%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED                                                                                                             [ 23%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED                                                                                                        [ 30%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED                                                                                                                  [ 38%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
PASSED                                                                                                                       [ 46%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
PASSED                                                                                                                               [ 53%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
PASSED                                                                                                               [ 61%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
PASSED                                                                                                             [ 69%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
FAILED                                                                                                             [ 76%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED                                                                                                               [ 84%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
FAILED                                                                                                             [ 92%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

__________________________________________________________________________ test_media_widget_starts_fade_in_when_artwork_appears __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2d3d21593f0) at 0x000002D3FF9BEFC0>, qtbot = <pytestqt.qtbot.QtBot object at 0x000002D3FFA26A90>

thread_manager = <core.threading.manager.ThreadManager object at 0x000002D3FFA2C150>



    @pytest.mark.qt

    def test_media_widget_starts_fade_in_when_artwork_appears(qt_app, qtbot, thread_manager):

        """Artwork appearing should trigger a fade-in animation."""

    

        img = QImage(8, 8, QImage.Format.Format_ARGB32)

        img.fill(Qt.GlobalColor.blue)

        pm = QPixmap.fromImage(img)

    

        buf = QBuffer()

        buf.open(QIODevice.OpenModeFlag.ReadWrite)

        assert pm.save(buf, "PNG")

        png_bytes = bytes(buf.data())

    

        info = mc.MediaTrackInfo(

            title="Artwork Fade Test",

            artist="Artist",

            album="Album",

            state=mc.MediaPlaybackState.PLAYING,

            artwork=png_bytes,

        )

    

        ctrl = _DummyController(info=None)

        w = MediaWidget(parent=None, controller=ctrl)

        w.set_thread_manager(thread_manager)

        qtbot.addWidget(w)

        w.resize(400, 120)

    

        # First refresh with no media keeps widget hidden and no artwork.

        w.start()

        qt_app.processEvents()

        ctrl._info = None

        w._refresh()  # type: ignore[attr-defined]

        qt_app.processEvents()

        assert not w.isVisible()

    

        # Now provide artwork-bearing media and refresh once; this should

        # create an artwork pixmap and start a fade-in (opacity starts at 0).

        ctrl._info = info

        for _ in range(2):

            w._refresh()  # type: ignore[attr-defined]

            _wait_for_media_refresh(qtbot, w)

            qt_app.processEvents()

    

>       assert getattr(w, "_artwork_anim", None) is not None

E       AssertionError: assert None is not None

E        +  where None = getattr(<widgets.media_widget.MediaWidget(0x2d3d293b5e0) at 0x000002D3FFA2CA00>, '_artwork_anim', None)



tests\test_media_widget.py:365: AssertionError

__________________________________________________________________________ test_display_widget_ctrl_click_routes_to_media_widget __________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2d3d21593f0) at 0x000002D3FF9BEFC0>, settings_manager = <core.settings.settings_manager.SettingsManager(0x2d3d2530610) at 0x000002D3FF9A1340>

qtbot = <pytestqt.qtbot.QtBot object at 0x000002D3FFA2D190>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002D3FFA2CC90>

thread_manager = <core.threading.manager.ThreadManager object at 0x000002D3FFA2D3D0>



    @pytest.mark.qt

    def test_display_widget_ctrl_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Ctrl-held click over media widget should trigger play/pause, not exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(media_mod, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

>       _wait_for_display_media_widget(qt_app, qtbot, w)



tests\test_media_widget.py:416: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



qt_app = <PySide6.QtWidgets.QApplication(0x2d3d21593f0) at 0x000002D3FF9BEFC0>, qtbot = <pytestqt.qtbot.QtBot object at 0x000002D3FFA2D190>

display = <rendering.display_widget.DisplayWidget(0x2d3d293cfc0) at 0x000002D3FF9F6300>, timeout = 3000



    def _wait_for_display_media_widget(qt_app, qtbot, display: DisplayWidget, timeout: int = 3000) -> None:

        """Wait until DisplayWidget.media_widget is created and registered."""

    

        def _ready() -> bool:

            qt_app.processEvents()

            return isinstance(getattr(display, "media_widget", None), MediaWidget)

    

>       qtbot.waitUntil(_ready, timeout=timeout)

E       pytestqt.exceptions.TimeoutError: waitUntil timed out in 3000 milliseconds



tests\test_media_widget.py:180: TimeoutError

_______________________________________________________________________ test_display_widget_hard_exit_click_routes_to_media_widget ________________________________________________________________________



qt_app = <PySide6.QtWidgets.QApplication(0x2d3d21593f0) at 0x000002D3FF9BEFC0>, settings_manager = <core.settings.settings_manager.SettingsManager(0x2d3d28d1560) at 0x000002D3FFA2FCC0>

qtbot = <pytestqt.qtbot.QtBot object at 0x000002D3FFA2FBD0>, monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000002D3852C6850>

thread_manager = <core.threading.manager.ThreadManager object at 0x000002D3852C6410>



    @pytest.mark.qt

    def test_display_widget_hard_exit_click_routes_to_media_widget(

        qt_app, settings_manager, qtbot, monkeypatch, thread_manager

    ):

        """Hard-exit mode should also allow media widget interaction without exit."""

    

        fake_info = mc.MediaTrackInfo(title="Track", state=mc.MediaPlaybackState.PLAYING)

        fake_ctrl = _DummyController(info=fake_info)

    

        monkeypatch.setattr(mc, "create_media_controller", lambda: fake_ctrl)

    

        settings_manager.set(

            "widgets",

            {

                "media": {

                    "enabled": True,

                    "position": "Bottom Left",

                    "monitor": "ALL",

                }

            },

        )

        settings_manager.set("input.hard_exit", True)

    

        w = DisplayWidget(

            screen_index=0,

            display_mode=DisplayMode.FILL,

            settings_manager=settings_manager,

            thread_manager=thread_manager,

        )

        qtbot.addWidget(w)

        w.resize(800, 600)

        w.show()

>       _wait_for_display_media_widget(qt_app, qtbot, w)



tests\test_media_widget.py:474: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



qt_app = <PySide6.QtWidgets.QApplication(0x2d3d21593f0) at 0x000002D3FF9BEFC0>, qtbot = <pytestqt.qtbot.QtBot object at 0x000002D3FFA2FBD0>

display = <rendering.display_widget.DisplayWidget(0x2d3d2940a40) at 0x000002D3852C2780>, timeout = 3000



    def _wait_for_display_media_widget(qt_app, qtbot, display: DisplayWidget, timeout: int = 3000) -> None:

        """Wait until DisplayWidget.media_widget is created and registered."""

    

        def _ready() -> bool:

            qt_app.processEvents()

            return isinstance(getattr(display, "media_widget", None), MediaWidget)

    

>       qtbot.waitUntil(_ready, timeout=timeout)

E       pytestqt.exceptions.TimeoutError: waitUntil timed out in 3000 milliseconds



tests\test_media_widget.py:180: TimeoutError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears - AssertionError: assert None is not None
 +  where None = getattr(<widgets.media_widget.MediaWidget(0x2d3d293b5e0) at 0x000002D3FFA2CA00>, '_artwork_anim', None)


FAILED tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget - pytestqt.exceptions.TimeoutError: waitUntil timed out in 3000 milliseconds

FAILED tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget - pytestqt.exceptions.TimeoutError: waitUntil timed out in 3000 milliseconds

====================================================================================== 3 failed, 10 passed in 7.97s =======================================================================================


===== pytest run 2025-12-27 20:02:00 args=['tests/test_spotify_visualizer_widget.py', '-k', 'bars_not_stuck'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 13 items / 12 deselected / 1 selected



tests\test_spotify_visualizer_widget.py 
F
                                                                                                                                                            [100%]




================================================================================================ FAILURES =================================================================================================

______________________________________________________________________________ test_spotify_visualizer_bars_not_stuck_at_top ______________________________________________________________________________



    def test_spotify_visualizer_bars_not_stuck_at_top():

        try:

            import numpy as np  # type: ignore[import]

        except Exception:

            pytest.skip("numpy not available for Spotify visualiser tests")

    

        buf: TripleBuffer[_AudioFrame] = TripleBuffer()

        worker = SpotifyVisualizerAudioWorker(bar_count=15, buffer=buf)

        worker._np = np  # type: ignore[attr-defined]

    

        n_samples = 2048

        sample_rate = 48000

        t = np.arange(n_samples, dtype=np.float32) / np.float32(sample_rate)

    

        bars_center = []

        frames = 120

        for frame in range(frames):

            intensity = np.float32(0.1 + 0.9 * (0.5 + 0.5 * np.sin(np.float32(2.0 * np.pi) * np.float32(frame) / np.float32(60.0))))

            env = np.exp(-t * np.float32(20.0)).astype(np.float32)

            base = (np.sin(np.float32(2.0 * np.pi * 80.0) * t) * env).astype(np.float32)

            samples = (base * (np.float32(0.03) * intensity)).astype(np.float32)

            bars = worker.compute_bars_from_samples(samples)

            if not isinstance(bars, list) or not bars:

                continue

            center_idx = len(bars) // 2

            bars_center.append(float(bars[center_idx]))

    

        assert bars_center

    

        center_arr = np.asarray(bars_center, dtype=np.float32)

        cmin = float(center_arr.min())

        cmax = float(center_arr.max())

        stuck_frac = float(np.mean(center_arr >= np.float32(0.98)))

        crange = cmax - cmin

    

        assert cmax >= 0.25

        assert crange >= 0.15

>       assert stuck_frac <= 0.55

E       assert 0.7333333333333333 <= 0.55



tests\test_spotify_visualizer_widget.py:246: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top - assert 0.7333333333333333 <= 0.55

==================================================================================== 1 failed, 12 deselected in 0.45s =====================================================================================


===== pytest run 2025-12-27 20:02:20 args=['tests/test_spotify_visualizer_widget.py', '-k', 'bars_not_stuck', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 13 items / 12 deselected / 1 selected



tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top 
FAILED                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

______________________________________________________________________________ test_spotify_visualizer_bars_not_stuck_at_top ______________________________________________________________________________



    def test_spotify_visualizer_bars_not_stuck_at_top():

        try:

            import numpy as np  # type: ignore[import]

        except Exception:

            pytest.skip("numpy not available for Spotify visualiser tests")

    

        buf: TripleBuffer[_AudioFrame] = TripleBuffer()

        worker = SpotifyVisualizerAudioWorker(bar_count=15, buffer=buf)

        worker._np = np  # type: ignore[attr-defined]

    

        n_samples = 2048

        sample_rate = 48000

        t = np.arange(n_samples, dtype=np.float32) / np.float32(sample_rate)

    

        bars_center = []

        frames = 120

        for frame in range(frames):

            intensity = np.float32(0.1 + 0.9 * (0.5 + 0.5 * np.sin(np.float32(2.0 * np.pi) * np.float32(frame) / np.float32(60.0))))

            env = np.exp(-t * np.float32(20.0)).astype(np.float32)

            base = (np.sin(np.float32(2.0 * np.pi * 80.0) * t) * env).astype(np.float32)

            samples = (base * (np.float32(0.03) * intensity)).astype(np.float32)

            bars = worker.compute_bars_from_samples(samples)

            if not isinstance(bars, list) or not bars:

                continue

            center_idx = len(bars) // 2

            bars_center.append(float(bars[center_idx]))

    

        assert bars_center

    

        center_arr = np.asarray(bars_center, dtype=np.float32)

        cmin = float(center_arr.min())

        cmax = float(center_arr.max())

        stuck_frac = float(np.mean(center_arr >= np.float32(0.98)))

        crange = cmax - cmin

    

        assert cmax >= 0.25

        assert crange >= 0.15

>       assert stuck_frac <= 0.55

E       assert 0.7333333333333333 <= 0.55



tests\test_spotify_visualizer_widget.py:246: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top - assert 0.7333333333333333 <= 0.55

==================================================================================== 1 failed, 12 deselected in 0.36s =====================================================================================


===== pytest run 2025-12-27 20:03:27 args=['tests/test_spotify_visualizer_widget.py', '-k', 'bars_not_stuck'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 13 items / 12 deselected / 1 selected



tests\test_spotify_visualizer_widget.py 
F
                                                                                                                                                            [100%]




================================================================================================ FAILURES =================================================================================================

______________________________________________________________________________ test_spotify_visualizer_bars_not_stuck_at_top ______________________________________________________________________________



    def test_spotify_visualizer_bars_not_stuck_at_top():

        try:

            import numpy as np  # type: ignore[import]

        except Exception:

            pytest.skip("numpy not available for Spotify visualiser tests")

    

        buf: TripleBuffer[_AudioFrame] = TripleBuffer()

        worker = SpotifyVisualizerAudioWorker(bar_count=15, buffer=buf)

        worker._np = np  # type: ignore[attr-defined]

    

        n_samples = 2048

        sample_rate = 48000

        t = np.arange(n_samples, dtype=np.float32) / np.float32(sample_rate)

    

        bars_center = []

        frames = 120

        for frame in range(frames):

            intensity = np.float32(0.1 + 0.9 * (0.5 + 0.5 * np.sin(np.float32(2.0 * np.pi) * np.float32(frame) / np.float32(60.0))))

            env = np.exp(-t * np.float32(20.0)).astype(np.float32)

            base = (np.sin(np.float32(2.0 * np.pi * 80.0) * t) * env).astype(np.float32)

            samples = (base * (np.float32(0.03) * intensity)).astype(np.float32)

            bars = worker.compute_bars_from_samples(samples)

            if not isinstance(bars, list) or not bars:

                continue

            center_idx = len(bars) // 2

            bars_center.append(float(bars[center_idx]))

    

        assert bars_center

    

        center_arr = np.asarray(bars_center, dtype=np.float32)

        cmin = float(center_arr.min())

        cmax = float(center_arr.max())

        stuck_frac = float(np.mean(center_arr >= np.float32(0.98)))

        crange = cmax - cmin

    

        assert cmax >= 0.25

        assert crange >= 0.15

>       assert stuck_frac <= 0.55

E       assert 0.7333333333333333 <= 0.55



tests\test_spotify_visualizer_widget.py:246: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top - assert 0.7333333333333333 <= 0.55

==================================================================================== 1 failed, 12 deselected in 0.39s =====================================================================================


===== pytest run 2025-12-27 21:54:31 args=['tests/test_visualizer_distribution.py', '-k', 'reactivity_realistic', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 0 items



========================================================================================== no tests ran in 0.40s ==========================================================================================


===== pytest run 2025-12-27 21:54:48 args=['tests/test_visualizer_distribution.py', '-k', 'reactivity_realistic', '-vv', '-s'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 0 items



========================================================================================== no tests ran in 0.33s ==========================================================================================


===== pytest run 2025-12-28 01:49:53 args=['tests/test_visualizer_distribution.py'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 0 items



========================================================================================== no tests ran in 0.36s ==========================================================================================


===== pytest run 2025-12-28 01:50:24 args=['tests/test_visualizer_distribution.py'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 0 items



========================================================================================== no tests ran in 0.23s ==========================================================================================


===== pytest run 2025-12-28 18:08:31 args=['tests/test_spotify_visualizer_widget.py', '-k', 'manual_floor or sensitivity'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 12 items / 10 deselected / 2 selected



tests\test_spotify_visualizer_widget.py 
F
F
                                                                                                                                                           [100%]




================================================================================================ FAILURES =================================================================================================

__________________________________________________________________________ test_manual_floor_produces_higher_energy_than_dynamic __________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_manual_floor_produces_higher_energy_than_dynamic(np_module):

        worker = _make_audio_worker(np_module)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_floor_config(dynamic_enabled=True, manual_floor=2.1)

        bars_dynamic = worker._fft_to_bars(fft)

    

        worker.set_floor_config(dynamic_enabled=False, manual_floor=0.2)

        bars_manual = worker._fft_to_bars(fft)

    

        assert isinstance(bars_dynamic, list)

        assert isinstance(bars_manual, list)

>       assert max(bars_manual) > max(bars_dynamic)

E       assert 1.0 > 1.0

E        +  where 1.0 = max([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, ...])

E        +  and   1.0 = max([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, ...])



tests\test_spotify_visualizer_widget.py:117: AssertionError

_______________________________________________________________________________ test_sensitivity_config_affects_noise_floor _______________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_sensitivity_config_affects_noise_floor(np_module):

        worker = _make_audio_worker(np_module)

        worker.set_floor_config(dynamic_enabled=False, manual_floor=2.1)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_sensitivity_config(recommended=True, sensitivity=1.0)

        bars_rec = worker._fft_to_bars(fft)

    

        worker.set_sensitivity_config(recommended=False, sensitivity=2.5)

        bars_manual = worker._fft_to_bars(fft)

    

        assert isinstance(bars_rec, list)

        assert isinstance(bars_manual, list)

>       assert max(bars_manual) > max(bars_rec)

E       assert 1.0 > 1.0

E        +  where 1.0 = max([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, ...])

E        +  and   1.0 = max([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, ...])



tests\test_spotify_visualizer_widget.py:133: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic - assert 1.0 > 1.0

FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor - assert 1.0 > 1.0

==================================================================================== 2 failed, 10 deselected in 0.39s =====================================================================================


===== pytest run 2025-12-28 18:08:48 args=['tests/test_spotify_visualizer_widget.py', '-k', 'manual_floor or sensitivity', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 12 items / 10 deselected / 2 selected



tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic 
FAILED                                                                                                [ 50%]


tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor 
FAILED                                                                                                          [100%]




================================================================================================ FAILURES =================================================================================================

__________________________________________________________________________ test_manual_floor_produces_higher_energy_than_dynamic __________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_manual_floor_produces_higher_energy_than_dynamic(np_module):

        worker = _make_audio_worker(np_module)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_floor_config(dynamic_enabled=True, manual_floor=2.1)

        bars_dynamic = worker._fft_to_bars(fft)

    

        worker.set_floor_config(dynamic_enabled=False, manual_floor=0.2)

        bars_manual = worker._fft_to_bars(fft)

    

        assert isinstance(bars_dynamic, list)

        assert isinstance(bars_manual, list)

>       assert max(bars_manual) > max(bars_dynamic)

E       assert 1.0 > 1.0

E        +  where 1.0 = max([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.6070854663848877, 0.27445414662361145, 0.13407500088214874, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])

E        +  and   1.0 = max([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.6070855855941772, 0.27445417642593384, 0.13407501578330994, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])



tests\test_spotify_visualizer_widget.py:117: AssertionError

_______________________________________________________________________________ test_sensitivity_config_affects_noise_floor _______________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_sensitivity_config_affects_noise_floor(np_module):

        worker = _make_audio_worker(np_module)

        worker.set_floor_config(dynamic_enabled=False, manual_floor=2.1)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_sensitivity_config(recommended=True, sensitivity=1.0)

        bars_rec = worker._fft_to_bars(fft)

    

        worker.set_sensitivity_config(recommended=False, sensitivity=2.5)

        bars_manual = worker._fft_to_bars(fft)

    

        assert isinstance(bars_rec, list)

        assert isinstance(bars_manual, list)

>       assert max(bars_manual) > max(bars_rec)

E       assert 1.0 > 1.0

E        +  where 1.0 = max([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.6070854663848877, 0.27445414662361145, 0.13407500088214874, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])

E        +  and   1.0 = max([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.6070855855941772, 0.27445417642593384, 0.13407501578330994, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])



tests\test_spotify_visualizer_widget.py:133: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic - assert 1.0 > 1.0
 +  where 1.0 = max([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.6070854663848877, 0.27445414662361145, 0.13407500088214874, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])
 +  and   1.0 = max([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.6070855855941772, 0.27445417642593384, 0.13407501578330994, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])


FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor - assert 1.0 > 1.0
 +  where 1.0 = max([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.6070854663848877, 0.27445414662361145, 0.13407500088214874, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])
 +  and   1.0 = max([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.6070855855941772, 0.27445417642593384, 0.13407501578330994, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])


==================================================================================== 2 failed, 10 deselected in 0.36s =====================================================================================


===== pytest run 2025-12-28 18:10:14 args=['tests/test_spotify_visualizer_widget.py', '-k', 'manual_floor or sensitivity', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 12 items / 10 deselected / 2 selected



tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic 
PASSED                                                                                                [ 50%]


tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor 
FAILED                                                                                                          [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________ test_sensitivity_config_affects_noise_floor _______________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_sensitivity_config_affects_noise_floor(np_module):

        worker = _make_audio_worker(np_module)

        worker.set_floor_config(dynamic_enabled=False, manual_floor=2.1)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_sensitivity_config(recommended=True, sensitivity=1.0)

        bars_rec = worker._fft_to_bars(fft)

    

        worker.set_sensitivity_config(recommended=False, sensitivity=2.5)

        bars_manual = worker._fft_to_bars(fft)

    

        assert isinstance(bars_rec, list)

        assert isinstance(bars_manual, list)

>       assert max(bars_manual) > max(bars_rec)

E       assert 0.4761904776096344 > 0.4761904776096344

E        +  where 0.4761904776096344 = max([0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.41164153814315796, 0.27445414662361145, 0.13407500088214874, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])

E        +  and   0.4761904776096344 = max([0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.41164159774780273, 0.27445417642593384, 0.13407501578330994, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])



tests\test_spotify_visualizer_widget.py:133: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor - assert 0.4761904776096344 > 0.4761904776096344
 +  where 0.4761904776096344 = max([0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.41164153814315796, 0.27445414662361145, 0.13407500088214874, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])
 +  and   0.4761904776096344 = max([0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.41164159774780273, 0.27445417642593384, 0.13407501578330994, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])


=============================================================================== 1 failed, 1 passed, 10 deselected in 0.37s ================================================================================


===== pytest run 2025-12-28 18:10:36 args=['tests/test_spotify_visualizer_widget.py', '-k', 'manual_floor or sensitivity', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 12 items / 10 deselected / 2 selected



tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic 
PASSED                                                                                                [ 50%]


tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor 
FAILED                                                                                                          [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________ test_sensitivity_config_affects_noise_floor _______________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_sensitivity_config_affects_noise_floor(np_module):

        worker = _make_audio_worker(np_module)

        worker.set_floor_config(dynamic_enabled=False, manual_floor=2.1)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_sensitivity_config(recommended=True, sensitivity=1.0)

        bars_rec = worker._fft_to_bars(fft)

    

        worker.set_sensitivity_config(recommended=False, sensitivity=2.5)

        bars_manual = worker._fft_to_bars(fft)

    

        assert isinstance(bars_rec, list)

        assert isinstance(bars_manual, list)

>       assert max(bars_manual) > max(bars_rec)

E       assert 0.4761904776096344 > 0.4761904776096344

E        +  where 0.4761904776096344 = max([0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.41164153814315796, 0.27445414662361145, 0.13407500088214874, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])

E        +  and   0.4761904776096344 = max([0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.41164159774780273, 0.27445417642593384, 0.13407501578330994, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])



tests\test_spotify_visualizer_widget.py:133: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor - assert 0.4761904776096344 > 0.4761904776096344
 +  where 0.4761904776096344 = max([0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.41164153814315796, 0.27445414662361145, 0.13407500088214874, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])
 +  and   0.4761904776096344 = max([0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.41164159774780273, 0.27445417642593384, 0.13407501578330994, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])


=============================================================================== 1 failed, 1 passed, 10 deselected in 0.35s ================================================================================


===== pytest run 2025-12-28 18:11:37 args=['tests/test_spotify_visualizer_widget.py', '-k', 'manual_floor or sensitivity', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 12 items / 10 deselected / 2 selected



tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic 
PASSED                                                                                                [ 50%]


tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor 
FAILED                                                                                                          [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________ test_sensitivity_config_affects_noise_floor _______________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_sensitivity_config_affects_noise_floor(np_module):

        worker = _make_audio_worker(np_module)

        worker.set_floor_config(dynamic_enabled=False, manual_floor=2.1)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_sensitivity_config(recommended=True, sensitivity=1.0)

        bars_rec = worker._fft_to_bars(fft)

    

        worker.set_sensitivity_config(recommended=False, sensitivity=2.5)

        bars_manual = worker._fft_to_bars(fft)

    

        assert isinstance(bars_rec, list)

        assert isinstance(bars_manual, list)

>       assert max(bars_manual) > max(bars_rec)

E       assert 0.4761904776096344 > 0.4761904776096344

E        +  where 0.4761904776096344 = max([0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.41164153814315796, 0.27445414662361145, 0.13407500088214874, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])

E        +  and   0.4761904776096344 = max([0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.41164159774780273, 0.27445417642593384, 0.13407501578330994, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])



tests\test_spotify_visualizer_widget.py:133: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor - assert 0.4761904776096344 > 0.4761904776096344
 +  where 0.4761904776096344 = max([0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.41164153814315796, 0.27445414662361145, 0.13407500088214874, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])
 +  and   0.4761904776096344 = max([0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.4761904776096344, 0.41164159774780273, 0.27445417642593384, 0.13407501578330994, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])


=============================================================================== 1 failed, 1 passed, 10 deselected in 0.38s ================================================================================


===== pytest run 2025-12-28 18:15:19 args=['tests/test_spotify_visualizer_widget.py', '-k', 'manual_floor or sensitivity', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 12 items / 10 deselected / 2 selected



tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic 
PASSED                                                                                                [ 50%]


tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor 
PASSED                                                                                                          [100%]




==================================================================================== 2 passed, 10 deselected in 0.31s =====================================================================================


===== pytest run 2025-12-28 18:15:28 args=['tests/test_spotify_visualizer_widget.py', '-k', 'manual_floor or sensitivity', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 12 items / 10 deselected / 2 selected



tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic 
PASSED                                                                                                [ 50%]


tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor 
PASSED                                                                                                          [100%]




==================================================================================== 2 passed, 10 deselected in 0.26s =====================================================================================


===== pytest run 2025-12-28 18:24:08 args=['tests/test_spotify_visualizer_widget.py', '-k', 'manual_floor or sensitivity', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 12 items / 10 deselected / 2 selected



tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic 
FAILED                                                                                                [ 50%]


tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor 
FAILED                                                                                                          [100%]




================================================================================================ FAILURES =================================================================================================

__________________________________________________________________________ test_manual_floor_produces_higher_energy_than_dynamic __________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_manual_floor_produces_higher_energy_than_dynamic(np_module):

        worker = _make_audio_worker(np_module)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_floor_config(dynamic_enabled=True, manual_floor=2.1)

>       bars_dynamic = worker._fft_to_bars(fft)

                       ^^^^^^^^^^^^^^^^^^^^^^^^



tests\test_spotify_visualizer_widget.py:110: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

widgets\spotify_visualizer_widget.py:796: in _fft_to_bars

    self._apply_targeted_bar_mapping(arr, freq_values, np, center)

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.spotify_visualizer_widget.SpotifyVisualizerAudioWorker(0x1fa429bccb0) at 0x000001FA72CA8CC0>

arr = array([0.5049429 , 0.5049429 , 0.5049429 , 0.5049429 , 0.5049429 ,
       0.5049429 , 0.41867658, 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ],
      dtype=float32)


freq_values = array([1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171,
       1.0866234, 0.       , 0.       , 0.       , 0.       , 0.       ,
       0.       , 0.       , 0.       ], dtype=float32)


np_mod = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>, center = 7



    def _apply_targeted_bar_mapping(self, arr, freq_values, np_mod, center: int) -> None:

        """Overlay targeted feature envelopes while keeping the sculpted shape."""

        if (

            arr.size == 0

            or freq_values is None

            or freq_values.size == 0

            or np_mod is None

        ):

            return

    

        peak = float(freq_values.max())

        if peak <= 1e-6:

            return

    

        base_shape = arr.copy()

        overlay = np_mod.zeros_like(arr)

    

        total_bands = freq_values.size

        bass_slice = freq_values[: max(2, total_bands // 7)]

        vocal_slice = freq_values[total_bands // 7 : max(total_bands // 2, total_bands // 7 + 1)]

        percussion_slice = freq_values[-max(2, total_bands // 5) :]

    

        bass_norm = self._normalize_feature_slice(np_mod, bass_slice, peak, percentile=85, exponent=0.7)

        vocal_norm = self._normalize_feature_slice(np_mod, vocal_slice, peak, percentile=75, exponent=0.85)

        percussion_norm = self._normalize_feature_slice(np_mod, percussion_slice, peak, percentile=92, exponent=0.6)

    

        bass_env = self._update_feature_env("_feature_env_bass", bass_norm, attack=0.65, release=0.25)

        vocal_env = self._update_feature_env("_feature_env_vocal", vocal_norm, attack=0.7, release=0.2)

        percussion_env = self._update_feature_env("_feature_env_percussion", percussion_norm, attack=0.55, release=0.3)

    

        bass_profile = [(-2, 0.7), (-1, 1.2), (0, 0.4), (1, 1.2), (2, 0.7)]

        vocal_profile = [(-2, 0.65), (-1, 1.25), (0, 0.55), (1, 1.25), (2, 0.65)]

    

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=bass_profile,

            energy=bass_env,

            drop_floor=0.05,

            peak_boost=1.3,

        )

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=vocal_profile,

            energy=vocal_env,

            drop_floor=0.04,

            peak_boost=1.2,

        )

        self._write_edge_overlay(

            overlay,

            energy=percussion_env,

            drop_floor=0.06,

            peak_boost=1.05,

        )

    

        base_mix = 0.25

>       arr[:] = np.clip(base_shape * base_mix + overlay, 0.0, 0.98)

                 ^^

E       NameError: name 'np' is not defined



widgets\spotify_visualizer_widget.py:879: NameError

_______________________________________________________________________________ test_sensitivity_config_affects_noise_floor _______________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_sensitivity_config_affects_noise_floor(np_module):

        worker = _make_audio_worker(np_module)

        worker.set_floor_config(dynamic_enabled=False, manual_floor=2.1)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_sensitivity_config(recommended=True, sensitivity=1.0)

>       bars_rec = worker._fft_to_bars(fft)

                   ^^^^^^^^^^^^^^^^^^^^^^^^



tests\test_spotify_visualizer_widget.py:126: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

widgets\spotify_visualizer_widget.py:796: in _fft_to_bars

    self._apply_targeted_bar_mapping(arr, freq_values, np, center)

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.spotify_visualizer_widget.SpotifyVisualizerAudioWorker(0x1fa429bcc90) at 0x000001FA72DA4040>

arr = array([0.47619048, 0.47619048, 0.47619048, 0.47619048, 0.47619048,
       0.47619048, 0.39483634, 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ],
      dtype=float32)


freq_values = array([1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171,
       1.0866234, 0.       , 0.       , 0.       , 0.       , 0.       ,
       0.       , 0.       , 0.       ], dtype=float32)


np_mod = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>, center = 7



    def _apply_targeted_bar_mapping(self, arr, freq_values, np_mod, center: int) -> None:

        """Overlay targeted feature envelopes while keeping the sculpted shape."""

        if (

            arr.size == 0

            or freq_values is None

            or freq_values.size == 0

            or np_mod is None

        ):

            return

    

        peak = float(freq_values.max())

        if peak <= 1e-6:

            return

    

        base_shape = arr.copy()

        overlay = np_mod.zeros_like(arr)

    

        total_bands = freq_values.size

        bass_slice = freq_values[: max(2, total_bands // 7)]

        vocal_slice = freq_values[total_bands // 7 : max(total_bands // 2, total_bands // 7 + 1)]

        percussion_slice = freq_values[-max(2, total_bands // 5) :]

    

        bass_norm = self._normalize_feature_slice(np_mod, bass_slice, peak, percentile=85, exponent=0.7)

        vocal_norm = self._normalize_feature_slice(np_mod, vocal_slice, peak, percentile=75, exponent=0.85)

        percussion_norm = self._normalize_feature_slice(np_mod, percussion_slice, peak, percentile=92, exponent=0.6)

    

        bass_env = self._update_feature_env("_feature_env_bass", bass_norm, attack=0.65, release=0.25)

        vocal_env = self._update_feature_env("_feature_env_vocal", vocal_norm, attack=0.7, release=0.2)

        percussion_env = self._update_feature_env("_feature_env_percussion", percussion_norm, attack=0.55, release=0.3)

    

        bass_profile = [(-2, 0.7), (-1, 1.2), (0, 0.4), (1, 1.2), (2, 0.7)]

        vocal_profile = [(-2, 0.65), (-1, 1.25), (0, 0.55), (1, 1.25), (2, 0.65)]

    

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=bass_profile,

            energy=bass_env,

            drop_floor=0.05,

            peak_boost=1.3,

        )

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=vocal_profile,

            energy=vocal_env,

            drop_floor=0.04,

            peak_boost=1.2,

        )

        self._write_edge_overlay(

            overlay,

            energy=percussion_env,

            drop_floor=0.06,

            peak_boost=1.05,

        )

    

        base_mix = 0.25

>       arr[:] = np.clip(base_shape * base_mix + overlay, 0.0, 0.98)

                 ^^

E       NameError: name 'np' is not defined



widgets\spotify_visualizer_widget.py:879: NameError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic - NameError: name 'np' is not defined

FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor - NameError: name 'np' is not defined

==================================================================================== 2 failed, 10 deselected in 0.61s =====================================================================================


===== pytest run 2025-12-28 18:25:28 args=['tests/test_spotify_visualizer_widget.py', '-k', 'manual_floor or sensitivity', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 12 items / 10 deselected / 2 selected



tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic 
FAILED                                                                                                [ 50%]


tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor 
FAILED                                                                                                          [100%]




================================================================================================ FAILURES =================================================================================================

__________________________________________________________________________ test_manual_floor_produces_higher_energy_than_dynamic __________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_manual_floor_produces_higher_energy_than_dynamic(np_module):

        worker = _make_audio_worker(np_module)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_floor_config(dynamic_enabled=True, manual_floor=2.1)

>       bars_dynamic = worker._fft_to_bars(fft)

                       ^^^^^^^^^^^^^^^^^^^^^^^^



tests\test_spotify_visualizer_widget.py:110: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

widgets\spotify_visualizer_widget.py:796: in _fft_to_bars

    self._apply_targeted_bar_mapping(arr, freq_values, np, center)

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.spotify_visualizer_widget.SpotifyVisualizerAudioWorker(0x2518317e620) at 0x00000251B2207B40>

arr = array([0.5049429 , 0.5049429 , 0.5049429 , 0.5049429 , 0.5049429 ,
       0.5049429 , 0.41867658, 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ],
      dtype=float32)


freq_values = array([1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171,
       1.0866234, 0.       , 0.       , 0.       , 0.       , 0.       ,
       0.       , 0.       , 0.       ], dtype=float32)


np_mod = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>, center = 7



    def _apply_targeted_bar_mapping(self, arr, freq_values, np_mod, center: int) -> None:

        """Overlay targeted feature envelopes while keeping the sculpted shape."""

        if (

            arr.size == 0

            or freq_values is None

            or freq_values.size == 0

            or np_mod is None

        ):

            return

    

        peak = float(freq_values.max())

        if peak <= 1e-6:

            return

    

        base_shape = arr.copy()

        overlay = np_mod.zeros_like(arr)

    

        total_bands = freq_values.size

        bass_slice = freq_values[: max(2, total_bands // 8)]

        vocal_slice = freq_values[total_bands // 8 : max(total_bands // 2, total_bands // 8 + 2)]

        percussion_slice = freq_values[-max(2, total_bands // 4) :]

    

        bass_norm = self._normalize_feature_slice(np_mod, bass_slice, peak, percentile=90, exponent=0.65)

        vocal_norm = self._normalize_feature_slice(np_mod, vocal_slice, peak, percentile=78, exponent=0.8)

        percussion_norm = self._normalize_feature_slice(np_mod, percussion_slice, peak, percentile=92, exponent=0.6)

    

        bass_env = self._update_feature_env("_feature_env_bass", bass_norm, attack=0.75, release=0.22)

        vocal_env = self._update_feature_env("_feature_env_vocal", vocal_norm, attack=0.72, release=0.18)

        percussion_env = self._update_feature_env("_feature_env_percussion", percussion_norm, attack=0.55, release=0.28)

    

        bass_profile = [(-1, 0.9), (0, 0.45), (1, 0.9)]

        vocal_profile = [(-2, 0.9), (-1, 1.4), (0, 0.3), (1, 1.4), (2, 0.9)]

    

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=bass_profile,

            energy=bass_env,

            drop_floor=0.05,

            peak_boost=1.35,

        )

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=vocal_profile,

            energy=vocal_env,

            drop_floor=0.04,

            peak_boost=1.25,

        )

        self._write_edge_overlay(

            overlay,

            energy=percussion_env,

            drop_floor=0.06,

            peak_boost=1.1,

        )

    

        base_mix = 0.4

        base_component = base_shape * base_mix

>       arr[:] = np_mod.clip(np.maximum(base_component, overlay), 0.0, 0.98)

                             ^^

E       NameError: name 'np' is not defined



widgets\spotify_visualizer_widget.py:880: NameError

_______________________________________________________________________________ test_sensitivity_config_affects_noise_floor _______________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_sensitivity_config_affects_noise_floor(np_module):

        worker = _make_audio_worker(np_module)

        worker.set_floor_config(dynamic_enabled=False, manual_floor=2.1)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_sensitivity_config(recommended=True, sensitivity=1.0)

>       bars_rec = worker._fft_to_bars(fft)

                   ^^^^^^^^^^^^^^^^^^^^^^^^



tests\test_spotify_visualizer_widget.py:126: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

widgets\spotify_visualizer_widget.py:796: in _fft_to_bars

    self._apply_targeted_bar_mapping(arr, freq_values, np, center)

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.spotify_visualizer_widget.SpotifyVisualizerAudioWorker(0x2518317ec60) at 0x00000251B23C2740>

arr = array([0.47619048, 0.47619048, 0.47619048, 0.47619048, 0.47619048,
       0.47619048, 0.39483634, 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ],
      dtype=float32)


freq_values = array([1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171,
       1.0866234, 0.       , 0.       , 0.       , 0.       , 0.       ,
       0.       , 0.       , 0.       ], dtype=float32)


np_mod = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>, center = 7



    def _apply_targeted_bar_mapping(self, arr, freq_values, np_mod, center: int) -> None:

        """Overlay targeted feature envelopes while keeping the sculpted shape."""

        if (

            arr.size == 0

            or freq_values is None

            or freq_values.size == 0

            or np_mod is None

        ):

            return

    

        peak = float(freq_values.max())

        if peak <= 1e-6:

            return

    

        base_shape = arr.copy()

        overlay = np_mod.zeros_like(arr)

    

        total_bands = freq_values.size

        bass_slice = freq_values[: max(2, total_bands // 8)]

        vocal_slice = freq_values[total_bands // 8 : max(total_bands // 2, total_bands // 8 + 2)]

        percussion_slice = freq_values[-max(2, total_bands // 4) :]

    

        bass_norm = self._normalize_feature_slice(np_mod, bass_slice, peak, percentile=90, exponent=0.65)

        vocal_norm = self._normalize_feature_slice(np_mod, vocal_slice, peak, percentile=78, exponent=0.8)

        percussion_norm = self._normalize_feature_slice(np_mod, percussion_slice, peak, percentile=92, exponent=0.6)

    

        bass_env = self._update_feature_env("_feature_env_bass", bass_norm, attack=0.75, release=0.22)

        vocal_env = self._update_feature_env("_feature_env_vocal", vocal_norm, attack=0.72, release=0.18)

        percussion_env = self._update_feature_env("_feature_env_percussion", percussion_norm, attack=0.55, release=0.28)

    

        bass_profile = [(-1, 0.9), (0, 0.45), (1, 0.9)]

        vocal_profile = [(-2, 0.9), (-1, 1.4), (0, 0.3), (1, 1.4), (2, 0.9)]

    

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=bass_profile,

            energy=bass_env,

            drop_floor=0.05,

            peak_boost=1.35,

        )

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=vocal_profile,

            energy=vocal_env,

            drop_floor=0.04,

            peak_boost=1.25,

        )

        self._write_edge_overlay(

            overlay,

            energy=percussion_env,

            drop_floor=0.06,

            peak_boost=1.1,

        )

    

        base_mix = 0.4

        base_component = base_shape * base_mix

>       arr[:] = np_mod.clip(np.maximum(base_component, overlay), 0.0, 0.98)

                             ^^

E       NameError: name 'np' is not defined



widgets\spotify_visualizer_widget.py:880: NameError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic - NameError: name 'np' is not defined

FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor - NameError: name 'np' is not defined

==================================================================================== 2 failed, 10 deselected in 0.64s =====================================================================================


===== pytest run 2025-12-28 18:26:27 args=['tests/test_spotify_visualizer_widget.py', '-k', 'manual_floor or sensitivity', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 12 items / 10 deselected / 2 selected



tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic 
FAILED                                                                                                [ 50%]


tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor 
FAILED                                                                                                          [100%]




================================================================================================ FAILURES =================================================================================================

__________________________________________________________________________ test_manual_floor_produces_higher_energy_than_dynamic __________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_manual_floor_produces_higher_energy_than_dynamic(np_module):

        worker = _make_audio_worker(np_module)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_floor_config(dynamic_enabled=True, manual_floor=2.1)

>       bars_dynamic = worker._fft_to_bars(fft)

                       ^^^^^^^^^^^^^^^^^^^^^^^^



tests\test_spotify_visualizer_widget.py:110: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

widgets\spotify_visualizer_widget.py:796: in _fft_to_bars

    self._apply_targeted_bar_mapping(arr, freq_values, np, center)

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.spotify_visualizer_widget.SpotifyVisualizerAudioWorker(0x257d4145ae0) at 0x00000257D4519A00>

arr = array([0.5049429 , 0.5049429 , 0.5049429 , 0.5049429 , 0.5049429 ,
       0.5049429 , 0.41867658, 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ],
      dtype=float32)


freq_values = array([1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171,
       1.0866234, 0.       , 0.       , 0.       , 0.       , 0.       ,
       0.       , 0.       , 0.       ], dtype=float32)


np_mod = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>, center = 7



    def _apply_targeted_bar_mapping(self, arr, freq_values, np_mod, center: int) -> None:

        """Overlay targeted feature envelopes while keeping the sculpted shape."""

        if (

            arr.size == 0

            or freq_values is None

            or freq_values.size == 0

            or np_mod is None

        ):

            return

    

        peak = float(freq_values.max())

        if peak <= 1e-6:

            return

    

        base_shape = arr.copy()

        overlay = np_mod.zeros_like(arr)

    

        total_bands = freq_values.size

        bass_slice = freq_values[: max(2, total_bands // 8)]

        vocal_slice = freq_values[total_bands // 8 : max(total_bands // 2, total_bands // 8 + 2)]

        percussion_slice = freq_values[-max(2, total_bands // 4) :]

    

        bass_norm = self._normalize_feature_slice(np_mod, bass_slice, peak, percentile=90, exponent=0.65)

        vocal_norm = self._normalize_feature_slice(np_mod, vocal_slice, peak, percentile=78, exponent=0.8)

        percussion_norm = self._normalize_feature_slice(np_mod, percussion_slice, peak, percentile=92, exponent=0.6)

    

        bass_env = self._update_feature_env("_feature_env_bass", bass_norm, attack=0.75, release=0.22)

        vocal_env = self._update_feature_env("_feature_env_vocal", vocal_norm, attack=0.72, release=0.18)

        percussion_env = self._update_feature_env("_feature_env_percussion", percussion_norm, attack=0.55, release=0.28)

    

        bass_profile = [(-1, 0.9), (0, 0.45), (1, 0.9)]

        vocal_profile = [(-2, 0.9), (-1, 1.4), (0, 0.3), (1, 1.4), (2, 0.9)]

    

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=bass_profile,

            energy=bass_env,

            drop_floor=0.05,

            peak_boost=1.35,

        )

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=vocal_profile,

            energy=vocal_env,

            drop_floor=0.04,

            peak_boost=1.25,

        )

        self._write_edge_overlay(

            overlay,

            energy=percussion_env,

            drop_floor=0.06,

            peak_boost=1.1,

        )

    

        base_mix = 0.4

        base_component = base_shape * base_mix

>       arr[:] = np_mod.clip(np.maximum(base_component, overlay), 0.0, 0.98)

                             ^^

E       NameError: name 'np' is not defined



widgets\spotify_visualizer_widget.py:880: NameError

_______________________________________________________________________________ test_sensitivity_config_affects_noise_floor _______________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_sensitivity_config_affects_noise_floor(np_module):

        worker = _make_audio_worker(np_module)

        worker.set_floor_config(dynamic_enabled=False, manual_floor=2.1)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_sensitivity_config(recommended=True, sensitivity=1.0)

>       bars_rec = worker._fft_to_bars(fft)

                   ^^^^^^^^^^^^^^^^^^^^^^^^



tests\test_spotify_visualizer_widget.py:126: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

widgets\spotify_visualizer_widget.py:796: in _fft_to_bars

    self._apply_targeted_bar_mapping(arr, freq_values, np, center)

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.spotify_visualizer_widget.SpotifyVisualizerAudioWorker(0x257d3fb0330) at 0x00000257D4D8F380>

arr = array([0.47619048, 0.47619048, 0.47619048, 0.47619048, 0.47619048,
       0.47619048, 0.39483634, 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ],
      dtype=float32)


freq_values = array([1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171,
       1.0866234, 0.       , 0.       , 0.       , 0.       , 0.       ,
       0.       , 0.       , 0.       ], dtype=float32)


np_mod = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>, center = 7



    def _apply_targeted_bar_mapping(self, arr, freq_values, np_mod, center: int) -> None:

        """Overlay targeted feature envelopes while keeping the sculpted shape."""

        if (

            arr.size == 0

            or freq_values is None

            or freq_values.size == 0

            or np_mod is None

        ):

            return

    

        peak = float(freq_values.max())

        if peak <= 1e-6:

            return

    

        base_shape = arr.copy()

        overlay = np_mod.zeros_like(arr)

    

        total_bands = freq_values.size

        bass_slice = freq_values[: max(2, total_bands // 8)]

        vocal_slice = freq_values[total_bands // 8 : max(total_bands // 2, total_bands // 8 + 2)]

        percussion_slice = freq_values[-max(2, total_bands // 4) :]

    

        bass_norm = self._normalize_feature_slice(np_mod, bass_slice, peak, percentile=90, exponent=0.65)

        vocal_norm = self._normalize_feature_slice(np_mod, vocal_slice, peak, percentile=78, exponent=0.8)

        percussion_norm = self._normalize_feature_slice(np_mod, percussion_slice, peak, percentile=92, exponent=0.6)

    

        bass_env = self._update_feature_env("_feature_env_bass", bass_norm, attack=0.75, release=0.22)

        vocal_env = self._update_feature_env("_feature_env_vocal", vocal_norm, attack=0.72, release=0.18)

        percussion_env = self._update_feature_env("_feature_env_percussion", percussion_norm, attack=0.55, release=0.28)

    

        bass_profile = [(-1, 0.9), (0, 0.45), (1, 0.9)]

        vocal_profile = [(-2, 0.9), (-1, 1.4), (0, 0.3), (1, 1.4), (2, 0.9)]

    

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=bass_profile,

            energy=bass_env,

            drop_floor=0.05,

            peak_boost=1.35,

        )

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=vocal_profile,

            energy=vocal_env,

            drop_floor=0.04,

            peak_boost=1.25,

        )

        self._write_edge_overlay(

            overlay,

            energy=percussion_env,

            drop_floor=0.06,

            peak_boost=1.1,

        )

    

        base_mix = 0.4

        base_component = base_shape * base_mix

>       arr[:] = np_mod.clip(np.maximum(base_component, overlay), 0.0, 0.98)

                             ^^

E       NameError: name 'np' is not defined



widgets\spotify_visualizer_widget.py:880: NameError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic - NameError: name 'np' is not defined

FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor - NameError: name 'np' is not defined

==================================================================================== 2 failed, 10 deselected in 0.63s =====================================================================================


===== pytest run 2025-12-28 18:26:54 args=['tests/test_spotify_visualizer_widget.py', '-k', 'manual_floor or sensitivity', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 12 items / 10 deselected / 2 selected



tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic 
FAILED                                                                                                [ 50%]


tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor 
FAILED                                                                                                          [100%]




================================================================================================ FAILURES =================================================================================================

__________________________________________________________________________ test_manual_floor_produces_higher_energy_than_dynamic __________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_manual_floor_produces_higher_energy_than_dynamic(np_module):

        worker = _make_audio_worker(np_module)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_floor_config(dynamic_enabled=True, manual_floor=2.1)

>       bars_dynamic = worker._fft_to_bars(fft)

                       ^^^^^^^^^^^^^^^^^^^^^^^^



tests\test_spotify_visualizer_widget.py:110: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

widgets\spotify_visualizer_widget.py:796: in _fft_to_bars

    self._apply_targeted_bar_mapping(arr, freq_values, np, center)

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.spotify_visualizer_widget.SpotifyVisualizerAudioWorker(0x2aa3b0ae9a0) at 0x000002AA69D29700>

arr = array([0.5049429 , 0.5049429 , 0.5049429 , 0.5049429 , 0.5049429 ,
       0.5049429 , 0.41867658, 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ],
      dtype=float32)


freq_values = array([1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171,
       1.0866234, 0.       , 0.       , 0.       , 0.       , 0.       ,
       0.       , 0.       , 0.       ], dtype=float32)


np_mod = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>, center = 7



    def _apply_targeted_bar_mapping(self, arr, freq_values, np_mod, center: int) -> None:

        """Overlay targeted feature envelopes while keeping the sculpted shape."""

        if (

            arr.size == 0

            or freq_values is None

            or freq_values.size == 0

            or np_mod is None

        ):

            return

    

        peak = float(freq_values.max())

        if peak <= 1e-6:

            return

    

        base_shape = arr.copy()

        overlay = np_mod.zeros_like(arr)

    

        total_bands = freq_values.size

        bass_slice = freq_values[: max(2, total_bands // 8)]

        vocal_slice = freq_values[total_bands // 8 : max(total_bands // 2, total_bands // 8 + 2)]

        percussion_slice = freq_values[-max(2, total_bands // 4) :]

    

        bass_norm = self._normalize_feature_slice(np_mod, bass_slice, peak, percentile=90, exponent=0.65)

        vocal_norm = self._normalize_feature_slice(np_mod, vocal_slice, peak, percentile=78, exponent=0.8)

        percussion_norm = self._normalize_feature_slice(np_mod, percussion_slice, peak, percentile=92, exponent=0.6)

    

        bass_env = self._update_feature_env("_feature_env_bass", bass_norm, attack=0.75, release=0.22)

        vocal_env = self._update_feature_env("_feature_env_vocal", vocal_norm, attack=0.72, release=0.18)

        percussion_env = self._update_feature_env("_feature_env_percussion", percussion_norm, attack=0.55, release=0.28)

    

        bass_profile = [(-1, 0.9), (0, 0.45), (1, 0.9)]

        vocal_profile = [(-2, 0.9), (-1, 1.4), (0, 0.3), (1, 1.4), (2, 0.9)]

    

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=bass_profile,

            energy=bass_env,

            drop_floor=0.05,

            peak_boost=1.35,

        )

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=vocal_profile,

            energy=vocal_env,

            drop_floor=0.04,

            peak_boost=1.25,

        )

        self._write_edge_overlay(

            overlay,

            energy=percussion_env,

            drop_floor=0.06,

            peak_boost=1.1,

        )

    

        base_mix = 0.4

        base_component = base_shape * base_mix

>       arr[:] = np_mod.clip(np.maximum(base_component, overlay), 0.0, 0.98)

                             ^^

E       NameError: name 'np' is not defined



widgets\spotify_visualizer_widget.py:880: NameError

_______________________________________________________________________________ test_sensitivity_config_affects_noise_floor _______________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_sensitivity_config_affects_noise_floor(np_module):

        worker = _make_audio_worker(np_module)

        worker.set_floor_config(dynamic_enabled=False, manual_floor=2.1)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_sensitivity_config(recommended=True, sensitivity=1.0)

>       bars_rec = worker._fft_to_bars(fft)

                   ^^^^^^^^^^^^^^^^^^^^^^^^



tests\test_spotify_visualizer_widget.py:126: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

widgets\spotify_visualizer_widget.py:796: in _fft_to_bars

    self._apply_targeted_bar_mapping(arr, freq_values, np, center)

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.spotify_visualizer_widget.SpotifyVisualizerAudioWorker(0x2aa3b034310) at 0x000002AA6ADB43C0>

arr = array([0.47619048, 0.47619048, 0.47619048, 0.47619048, 0.47619048,
       0.47619048, 0.39483634, 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ],
      dtype=float32)


freq_values = array([1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171,
       1.0866234, 0.       , 0.       , 0.       , 0.       , 0.       ,
       0.       , 0.       , 0.       ], dtype=float32)


np_mod = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>, center = 7



    def _apply_targeted_bar_mapping(self, arr, freq_values, np_mod, center: int) -> None:

        """Overlay targeted feature envelopes while keeping the sculpted shape."""

        if (

            arr.size == 0

            or freq_values is None

            or freq_values.size == 0

            or np_mod is None

        ):

            return

    

        peak = float(freq_values.max())

        if peak <= 1e-6:

            return

    

        base_shape = arr.copy()

        overlay = np_mod.zeros_like(arr)

    

        total_bands = freq_values.size

        bass_slice = freq_values[: max(2, total_bands // 8)]

        vocal_slice = freq_values[total_bands // 8 : max(total_bands // 2, total_bands // 8 + 2)]

        percussion_slice = freq_values[-max(2, total_bands // 4) :]

    

        bass_norm = self._normalize_feature_slice(np_mod, bass_slice, peak, percentile=90, exponent=0.65)

        vocal_norm = self._normalize_feature_slice(np_mod, vocal_slice, peak, percentile=78, exponent=0.8)

        percussion_norm = self._normalize_feature_slice(np_mod, percussion_slice, peak, percentile=92, exponent=0.6)

    

        bass_env = self._update_feature_env("_feature_env_bass", bass_norm, attack=0.75, release=0.22)

        vocal_env = self._update_feature_env("_feature_env_vocal", vocal_norm, attack=0.72, release=0.18)

        percussion_env = self._update_feature_env("_feature_env_percussion", percussion_norm, attack=0.55, release=0.28)

    

        bass_profile = [(-1, 0.9), (0, 0.45), (1, 0.9)]

        vocal_profile = [(-2, 0.9), (-1, 1.4), (0, 0.3), (1, 1.4), (2, 0.9)]

    

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=bass_profile,

            energy=bass_env,

            drop_floor=0.05,

            peak_boost=1.35,

        )

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=vocal_profile,

            energy=vocal_env,

            drop_floor=0.04,

            peak_boost=1.25,

        )

        self._write_edge_overlay(

            overlay,

            energy=percussion_env,

            drop_floor=0.06,

            peak_boost=1.1,

        )

    

        base_mix = 0.4

        base_component = base_shape * base_mix

>       arr[:] = np_mod.clip(np.maximum(base_component, overlay), 0.0, 0.98)

                             ^^

E       NameError: name 'np' is not defined



widgets\spotify_visualizer_widget.py:880: NameError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic - NameError: name 'np' is not defined

FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor - NameError: name 'np' is not defined

==================================================================================== 2 failed, 10 deselected in 0.57s =====================================================================================


===== pytest run 2025-12-28 18:30:57 args=['tests/test_spotify_visualizer_widget.py', '-k', 'manual_floor or sensitivity', '-vv'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 12 items / 10 deselected / 2 selected



tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic 
FAILED                                                                                                [ 50%]


tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor 
FAILED                                                                                                          [100%]




================================================================================================ FAILURES =================================================================================================

__________________________________________________________________________ test_manual_floor_produces_higher_energy_than_dynamic __________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_manual_floor_produces_higher_energy_than_dynamic(np_module):

        worker = _make_audio_worker(np_module)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_floor_config(dynamic_enabled=True, manual_floor=2.1)

>       bars_dynamic = worker._fft_to_bars(fft)

                       ^^^^^^^^^^^^^^^^^^^^^^^^



tests\test_spotify_visualizer_widget.py:110: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

widgets\spotify_visualizer_widget.py:796: in _fft_to_bars

    self._apply_targeted_bar_mapping(arr, freq_values, np, center)

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.spotify_visualizer_widget.SpotifyVisualizerAudioWorker(0x1ea0afae340) at 0x000001EA39C79740>

arr = array([0.5049429 , 0.5049429 , 0.5049429 , 0.5049429 , 0.5049429 ,
       0.5049429 , 0.41867658, 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ],
      dtype=float32)


freq_values = array([1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171,
       1.0866234, 0.       , 0.       , 0.       , 0.       , 0.       ,
       0.       , 0.       , 0.       ], dtype=float32)


np_mod = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>, center = 7



    def _apply_targeted_bar_mapping(self, arr, freq_values, np_mod, center: int) -> None:

        """Overlay targeted feature envelopes while keeping the sculpted shape."""

        if (

            arr.size == 0

            or freq_values is None

            or freq_values.size == 0

            or np_mod is None

        ):

            return

    

        peak = float(freq_values.max())

        if peak <= 1e-6:

            return

    

        base_shape = arr.copy()

        overlay = np_mod.zeros_like(arr)

    

        total_bands = freq_values.size

        bass_slice = freq_values[: max(2, total_bands // 8)]

        vocal_slice = freq_values[total_bands // 8 : max(total_bands // 2, total_bands // 8 + 2)]

        percussion_slice = freq_values[-max(2, total_bands // 4) :]

    

        bass_norm = self._normalize_feature_slice(np_mod, bass_slice, peak, percentile=90, exponent=0.65)

        vocal_norm = self._normalize_feature_slice(np_mod, vocal_slice, peak, percentile=78, exponent=0.8)

        percussion_norm = self._normalize_feature_slice(np_mod, percussion_slice, peak, percentile=92, exponent=0.6)

    

        bass_env = self._update_feature_env("_feature_env_bass", bass_norm, attack=0.75, release=0.22)

        vocal_env = self._update_feature_env("_feature_env_vocal", vocal_norm, attack=0.72, release=0.18)

        percussion_env = self._update_feature_env("_feature_env_percussion", percussion_norm, attack=0.55, release=0.28)

    

        bass_profile = [(-1, 0.9), (0, 0.45), (1, 0.9)]

        vocal_profile = [(-2, 0.9), (-1, 1.4), (0, 0.3), (1, 1.4), (2, 0.9)]

    

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=bass_profile,

            energy=bass_env,

            drop_floor=0.05,

            peak_boost=1.35,

        )

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=vocal_profile,

            energy=vocal_env,

            drop_floor=0.04,

            peak_boost=1.25,

        )

        self._write_edge_overlay(

            overlay,

            energy=percussion_env,

            drop_floor=0.06,

            peak_boost=1.1,

        )

    

        base_mix = 0.4

        base_component = base_shape * base_mix

>       arr[:] = np_mod.clip(np.maximum(base_component, overlay), 0.0, 0.98)

                             ^^

E       NameError: name 'np' is not defined



widgets\spotify_visualizer_widget.py:880: NameError

_______________________________________________________________________________ test_sensitivity_config_affects_noise_floor _______________________________________________________________________________



np_module = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>



    def test_sensitivity_config_affects_noise_floor(np_module):

        worker = _make_audio_worker(np_module)

        worker.set_floor_config(dynamic_enabled=False, manual_floor=2.1)

        fft = _synth_fft(np_module, magnitude=2.5)

    

        worker.set_sensitivity_config(recommended=True, sensitivity=1.0)

>       bars_rec = worker._fft_to_bars(fft)

                   ^^^^^^^^^^^^^^^^^^^^^^^^



tests\test_spotify_visualizer_widget.py:126: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

widgets\spotify_visualizer_widget.py:796: in _fft_to_bars

    self._apply_targeted_bar_mapping(arr, freq_values, np, center)

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



self = <widgets.spotify_visualizer_widget.SpotifyVisualizerAudioWorker(0x1ea0afaa8e0) at 0x000001EA3AD148C0>

arr = array([0.47619048, 0.47619048, 0.47619048, 0.47619048, 0.47619048,
       0.47619048, 0.39483634, 0.        , 0.        , 0.        ,
       0.        , 0.        , 0.        , 0.        , 0.        ],
      dtype=float32)


freq_values = array([1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171, 1.3105171,
       1.0866234, 0.       , 0.       , 0.       , 0.       , 0.       ,
       0.       , 0.       , 0.       ], dtype=float32)


np_mod = <module 'numpy' from 'C:\\Python311\\Lib\\site-packages\\numpy\\__init__.py'>, center = 7



    def _apply_targeted_bar_mapping(self, arr, freq_values, np_mod, center: int) -> None:

        """Overlay targeted feature envelopes while keeping the sculpted shape."""

        if (

            arr.size == 0

            or freq_values is None

            or freq_values.size == 0

            or np_mod is None

        ):

            return

    

        peak = float(freq_values.max())

        if peak <= 1e-6:

            return

    

        base_shape = arr.copy()

        overlay = np_mod.zeros_like(arr)

    

        total_bands = freq_values.size

        bass_slice = freq_values[: max(2, total_bands // 8)]

        vocal_slice = freq_values[total_bands // 8 : max(total_bands // 2, total_bands // 8 + 2)]

        percussion_slice = freq_values[-max(2, total_bands // 4) :]

    

        bass_norm = self._normalize_feature_slice(np_mod, bass_slice, peak, percentile=90, exponent=0.65)

        vocal_norm = self._normalize_feature_slice(np_mod, vocal_slice, peak, percentile=78, exponent=0.8)

        percussion_norm = self._normalize_feature_slice(np_mod, percussion_slice, peak, percentile=92, exponent=0.6)

    

        bass_env = self._update_feature_env("_feature_env_bass", bass_norm, attack=0.75, release=0.22)

        vocal_env = self._update_feature_env("_feature_env_vocal", vocal_norm, attack=0.72, release=0.18)

        percussion_env = self._update_feature_env("_feature_env_percussion", percussion_norm, attack=0.55, release=0.28)

    

        bass_profile = [(-1, 0.9), (0, 0.45), (1, 0.9)]

        vocal_profile = [(-2, 0.9), (-1, 1.4), (0, 0.3), (1, 1.4), (2, 0.9)]

    

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=bass_profile,

            energy=bass_env,

            drop_floor=0.05,

            peak_boost=1.35,

        )

        self._write_centered_overlay(

            overlay,

            center=center,

            profile=vocal_profile,

            energy=vocal_env,

            drop_floor=0.04,

            peak_boost=1.25,

        )

        self._write_edge_overlay(

            overlay,

            energy=percussion_env,

            drop_floor=0.06,

            peak_boost=1.1,

        )

    

        base_mix = 0.4

        base_component = base_shape * base_mix

>       arr[:] = np_mod.clip(np.maximum(base_component, overlay), 0.0, 0.98)

                             ^^

E       NameError: name 'np' is not defined



widgets\spotify_visualizer_widget.py:880: NameError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic - NameError: name 'np' is not defined

FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor - NameError: name 'np' is not defined

==================================================================================== 2 failed, 10 deselected in 0.49s =====================================================================================


===== pytest run 2025-12-28 21:10:55 args=['tests/test_visualizer_distribution.py', '-v', '--tb=short'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 0 items



============================ no tests ran in 0.33s ============================


===== pytest run 2025-12-28 21:28:31 args=['tests/test_visualizer_modes.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 17 items



tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_enum_exists 
PASSED                                                                                                      [  5%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_spectrum 
PASSED                                                                                                     [ 11%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_waveform 
PASSED                                                                                                     [ 17%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_abstract 
PASSED                                                                                                     [ 23%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_count 
PASSED                                                                                                            [ 29%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_widget_default_mode_is_spectrum 
PASSED                                                                                               [ 35%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_to_waveform 
PASSED                                                                                            [ 41%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_to_abstract 
PASSED                                                                                            [ 47%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_waveform_history 
PASSED                                                                                [ 52%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_particles 
FAILED                                                                                       [ 58%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_cycle_visualization_mode 
PASSED                                                                                                      [ 64%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_same_mode_is_noop 
PASSED                                                                                                         [ 70%]


tests/test_visualizer_modes.py::TestWaveformModeState::test_waveform_history_initialized_empty 
PASSED                                                                                                [ 76%]


tests/test_visualizer_modes.py::TestWaveformModeState::test_waveform_max_samples_default 
PASSED                                                                                                      [ 82%]


tests/test_visualizer_modes.py::TestAbstractModeState::test_abstract_particles_initialized_empty 
PASSED                                                                                              [ 88%]


tests/test_visualizer_modes.py::TestAbstractModeState::test_abstract_max_particles_default 
PASSED                                                                                                    [ 94%]


tests/test_visualizer_modes.py::TestAbstractModeState::test_abstract_spawn_timestamp_initialized 
PASSED                                                                                              [100%]




================================================================================================ FAILURES =================================================================================================

_________________________________________________________________ TestVisualizerWidgetModes.test_set_visualization_mode_clears_particles __________________________________________________________________

tests\test_visualizer_modes.py:101: in test_set_visualization_mode_clears_particles

    assert len(widget._abstract_particles) == 0

E   AssertionError: assert 1 == 0

E    +  where 1 = len([{'x': 0, 'y': 0}])

E    +    where [{'x': 0, 'y': 0}] = <widgets.spotify_visualizer_widget.SpotifyVisualizerWidget(0x245f159ac40) at 0x00000245F350D580>._abstract_particles

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_particles - AssertionError: assert 1 == 0

====================================================================================== 1 failed, 16 passed in 0.38s =======================================================================================


===== pytest run 2025-12-28 21:28:38 args=['tests/test_visualizer_modes.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 17 items



tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_enum_exists 
PASSED                                                                                                      [  5%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_spectrum 
PASSED                                                                                                     [ 11%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_waveform 
PASSED                                                                                                     [ 17%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_abstract 
PASSED                                                                                                     [ 23%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_count 
PASSED                                                                                                            [ 29%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_widget_default_mode_is_spectrum 
PASSED                                                                                               [ 35%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_to_waveform 
PASSED                                                                                            [ 41%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_to_abstract 
PASSED                                                                                            [ 47%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_waveform_history 
PASSED                                                                                [ 52%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_particles 
FAILED                                                                                       [ 58%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_cycle_visualization_mode 
PASSED                                                                                                      [ 64%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_same_mode_is_noop 
PASSED                                                                                                         [ 70%]


tests/test_visualizer_modes.py::TestWaveformModeState::test_waveform_history_initialized_empty 
PASSED                                                                                                [ 76%]


tests/test_visualizer_modes.py::TestWaveformModeState::test_waveform_max_samples_default 
PASSED                                                                                                      [ 82%]


tests/test_visualizer_modes.py::TestAbstractModeState::test_abstract_particles_initialized_empty 
PASSED                                                                                              [ 88%]


tests/test_visualizer_modes.py::TestAbstractModeState::test_abstract_max_particles_default 
PASSED                                                                                                    [ 94%]


tests/test_visualizer_modes.py::TestAbstractModeState::test_abstract_spawn_timestamp_initialized 
PASSED                                                                                              [100%]




================================================================================================ FAILURES =================================================================================================

_________________________________________________________________ TestVisualizerWidgetModes.test_set_visualization_mode_clears_particles __________________________________________________________________

tests\test_visualizer_modes.py:101: in test_set_visualization_mode_clears_particles

    assert len(widget._abstract_particles) == 0

E   AssertionError: assert 1 == 0

E    +  where 1 = len([{'x': 0, 'y': 0}])

E    +    where [{'x': 0, 'y': 0}] = <widgets.spotify_visualizer_widget.SpotifyVisualizerWidget(0x15786302840) at 0x0000015787AE5700>._abstract_particles

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_particles - AssertionError: assert 1 == 0

====================================================================================== 1 failed, 16 passed in 0.31s =======================================================================================


===== pytest run 2025-12-28 21:29:41 args=['tests/test_visualizer_modes.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 17 items



tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_enum_exists 
PASSED                                                                                                      [  5%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_spectrum 
PASSED                                                                                                     [ 11%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_waveform 
PASSED                                                                                                     [ 17%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_abstract 
PASSED                                                                                                     [ 23%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_count 
PASSED                                                                                                            [ 29%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_widget_default_mode_is_spectrum 
PASSED                                                                                               [ 35%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_to_waveform 
PASSED                                                                                            [ 41%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_to_abstract 
PASSED                                                                                            [ 47%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_waveform_history 
PASSED                                                                                [ 52%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_particles 
FAILED                                                                                       [ 58%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_cycle_visualization_mode 
PASSED                                                                                                      [ 64%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_same_mode_is_noop 
PASSED                                                                                                         [ 70%]


tests/test_visualizer_modes.py::TestWaveformModeState::test_waveform_history_initialized_empty 
PASSED                                                                                                [ 76%]


tests/test_visualizer_modes.py::TestWaveformModeState::test_waveform_max_samples_default 
PASSED                                                                                                      [ 82%]


tests/test_visualizer_modes.py::TestAbstractModeState::test_abstract_particles_initialized_empty 
PASSED                                                                                              [ 88%]


tests/test_visualizer_modes.py::TestAbstractModeState::test_abstract_max_particles_default 
PASSED                                                                                                    [ 94%]


tests/test_visualizer_modes.py::TestAbstractModeState::test_abstract_spawn_timestamp_initialized 
PASSED                                                                                              [100%]




================================================================================================ FAILURES =================================================================================================

_________________________________________________________________ TestVisualizerWidgetModes.test_set_visualization_mode_clears_particles __________________________________________________________________

tests\test_visualizer_modes.py:94: in test_set_visualization_mode_clears_particles

    assert len(widget._abstract_particles) == 0

E   AssertionError: assert 1 == 0

E    +  where 1 = len([{'x': 0, 'y': 0}])

E    +    where [{'x': 0, 'y': 0}] = <widgets.spotify_visualizer_widget.SpotifyVisualizerWidget(0x2a851676230) at 0x000002A85253C680>._abstract_particles

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_particles - AssertionError: assert 1 == 0

====================================================================================== 1 failed, 16 passed in 0.35s =======================================================================================


===== pytest run 2025-12-28 21:29:47 args=['tests/test_visualizer_modes.py::TestVisualizerModeEnum', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 5 items



tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_enum_exists 
PASSED                                                                                                      [ 20%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_spectrum 
PASSED                                                                                                     [ 40%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_waveform 
PASSED                                                                                                     [ 60%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_abstract 
PASSED                                                                                                     [ 80%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_count 
PASSED                                                                                                            [100%]




============================================================================================ 5 passed in 0.16s ============================================================================================


===== pytest run 2025-12-28 21:33:52 args=['tests/', '-v', '--tb=short', '--ignore=tests/test_visualizer_distribution.py'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 612 items / 4 skipped



tests/test_animation.py::test_animation_manager_initialization 
PASSED    [  0%]


tests/test_animation.py::test_property_animation 
PASSED                  [  0%]


tests/test_animation.py::test_custom_animation 
PASSED                    [  0%]


tests/test_animation.py::test_animation_pause_resume 
PASSED              [  0%]


tests/test_animation.py::test_animation_cancel 
PASSED                    [  0%]


tests/test_animation.py::test_easing_curves 
PASSED                       [  0%]


tests/test_animation.py::test_animation_with_delay 
PASSED                [  1%]


tests/test_animation.py::test_multiple_animations 
PASSED                 [  1%]


tests/test_animation.py::test_cancel_all_animations 
PASSED               [  1%]


tests/test_animation.py::test_animation_manager_auto_stop 
PASSED         [  1%]


tests/test_animation.py::test_animation_manager_emits_perf_metrics 
PASSED [  1%]


tests/test_animation_set_target_fps.py::test_set_target_fps_updates_timer_interval 
PASSED [  1%]


tests/test_block_puzzle_flip.py::test_block_puzzle_creation 
PASSED       [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_runs_and_labels 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_cleanup 
PASSED        [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_invalid_pixmap 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_set_flip_duration 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_randomization 
PASSED  [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_small_widget 
PASSED   [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug1_clock_widget_created 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug2_set_text_color_method_exists 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug3_color_array_to_qcolor_conversion 
FAILED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug4_z_order_clock_on_top 
FAILED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug5_settings_retrieval_no_crash 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug6_boolean_type_conversion 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug7_position_string_to_enum 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug8_format_string_to_enum 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug9_missing_raise_call 
FAILED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_visibility_after_setup 
FAILED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_size_and_position 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_settings_complete_integration 
FAILED [  5%]


tests/test_clock_widget.py::test_time_format_enum 
PASSED                 [  5%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED              [  5%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                   [  5%]


tests/test_clock_widget.py::test_clock_start_stop 
FAILED                 [  5%]


tests/test_clock_widget.py::test_clock_signals 
FAILED                    [  5%]


tests/test_clock_widget.py::test_clock_12h_format 
FAILED                 [  6%]


tests/test_clock_widget.py::test_clock_24h_format 
FAILED                 [  6%]


tests/test_clock_widget.py::test_clock_without_seconds 
FAILED            [  6%]


tests/test_clock_widget.py::test_clock_with_seconds 
FAILED               [  6%]


tests/test_clock_widget.py::test_clock_set_time_format 
FAILED            [  6%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
FAILED           [  6%]


tests/test_clock_widget.py::test_clock_all_positions 
FAILED              [  7%]


tests/test_clock_widget.py::test_clock_set_position 
FAILED               [  7%]


tests/test_clock_widget.py::test_clock_set_font_size 
PASSED              [  7%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED             [  7%]


tests/test_clock_widget.py::test_clock_set_margin 
PASSED                 [  7%]


tests/test_clock_widget.py::test_clock_cleanup 
FAILED                    [  7%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
FAILED [  8%]


tests/test_clock_widget.py::test_clock_updates_over_time 
FAILED          [  8%]


tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup 
PASSED [  8%]


tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget 
PASSED [  8%]


tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets 
PASSED [  8%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344] 
PASSED [  8%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777349] 
PASSED [  8%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777347] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777346] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777330] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777328] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777329] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_shows_without_slack_attr 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_context_menu_active 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_hides_when_cursor_leaves_display 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_inactivity_timeout 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active 
FAILED [ 10%]


tests/test_diffuse_transition.py::test_diffuse_creation 
PASSED           [ 11%]


tests/test_diffuse_transition.py::test_diffuse_start_no_old_image 
PASSED [ 11%]


tests/test_diffuse_transition.py::test_diffuse_start_with_images 
PASSED  [ 11%]


tests/test_diffuse_transition.py::test_diffuse_signals 
PASSED            [ 11%]


tests/test_diffuse_transition.py::test_diffuse_progress_range 
PASSED     [ 11%]


tests/test_diffuse_transition.py::test_diffuse_stop 
PASSED               [ 11%]


tests/test_diffuse_transition.py::test_diffuse_grid_creation 
PASSED      [ 12%]


tests/test_diffuse_transition.py::test_diffuse_cleanup 
PASSED            [ 12%]


tests/test_diffuse_transition.py::test_diffuse_invalid_pixmap 
PASSED     [ 12%]


tests/test_diffuse_transition.py::test_diffuse_already_running 
PASSED    [ 12%]


tests/test_diffuse_transition.py::test_diffuse_block_size 
PASSED         [ 12%]


tests/test_diffuse_transition.py::test_diffuse_small_widget 
PASSED       [ 12%]


tests/test_diffuse_transition.py::test_diffuse_randomization 
PASSED      [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayAttributes::test_dimming_overlay_uses_translucent_background 
PASSED [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayAttributes::test_dimming_overlay_opacity_calculation 
PASSED [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayAttributes::test_dimming_overlay_opacity_clamping 
PASSED [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestCtrlHaloAttributes::test_halo_code_uses_translucent_background 
PASSED [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestMediaWidgetClickDetection::test_click_detection_checks_y_coordinate 
PASSED [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestMediaWidgetClickDetection::test_controls_row_height_is_reasonable 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestCrumbleShaderPerformance::test_crumble_search_range_is_reduced 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestSettingsDotNotation::test_dimming_settings_use_dot_notation 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestSettingsDotNotation::test_pixel_shift_settings_use_dot_notation 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestSettingsDotNotation::test_context_menu_dimming_uses_dot_notation 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayZOrder::test_raise_overlay_includes_dimming 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayZOrder::test_raise_overlay_zorder_documented 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_creation 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_loads_settings 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_saves_monitor_selection 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_saves_display_mode 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_saves_timing 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_boolean_conversion 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_lanczos_setting 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_sharpen_setting 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_same_image_monitors 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_all_settings_persist 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_default_values 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_invalid_mode_handling 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_invalid_interval_handling 
PASSED [ 17%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_ui_elements_exist 
PASSED [ 17%]


tests/test_engine_lifecycle.py::TestEngineState::test_engine_state_enum_values 
PASSED [ 17%]


tests/test_engine_lifecycle.py::TestEngineState::test_initial_state_is_uninitialized 
PASSED [ 17%]


tests/test_engine_lifecycle.py::TestEngineState::test_running_property_false_when_not_running 
PASSED [ 17%]


tests/test_engine_lifecycle.py::TestEngineState::test_running_property_true_when_running 
PASSED [ 17%]


tests/test_engine_lifecycle.py::TestEngineState::test_initialized_property 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_false_in_running 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_false_in_reinitializing 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_true_in_stopping 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_true_in_shutting_down 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_false_in_other_states 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_transition_state_success 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_transition_state_invalid_source 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_transition_from_shutting_down_blocked 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_transition_without_expected_from 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_is_state_check 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestStateTransitionThreadSafety::test_concurrent_state_reads 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestStateTransitionThreadSafety::test_concurrent_state_transitions 
PASSED [ 20%]


tests/test_engine_lifecycle.py::TestRSSReloadBugScenario::test_settings_change_does_not_abort_rss 
PASSED [ 20%]


tests/test_engine_lifecycle.py::TestRSSReloadBugScenario::test_actual_shutdown_aborts_rss 
PASSED [ 20%]


tests/test_engine_lifecycle.py::TestGetStats::test_get_stats_includes_state 
PASSED [ 20%]


tests/test_events.py::test_event_system_initialization 
PASSED            [ 20%]


tests/test_events.py::test_subscribe_and_publish 
PASSED                  [ 20%]


tests/test_events.py::test_unsubscribe 
PASSED                            [ 21%]


tests/test_events.py::test_priority_ordering 
PASSED                      [ 21%]


tests/test_events.py::test_event_filter 
PASSED                           [ 21%]


tests/test_events.py::test_event_history 
PASSED                          [ 21%]


tests/test_flicker_fix_integration.py::TestQtAllocationLimit::test_allocation_limit_increased 
PASSED [ 21%]


tests/test_flicker_fix_integration.py::TestQtAllocationLimit::test_large_image_can_be_allocated 
PASSED [ 21%]


tests/test_flicker_fix_integration.py::TestTransitionTelemetryFlow::test_transition_tracks_timing 
FAILED [ 22%]


tests/test_flicker_fix_integration.py::TestMultiDisplaySyncFlow::test_sync_queue_lifecycle 
PASSED [ 22%]


tests/test_flicker_fix_integration.py::TestMultiDisplaySyncFlow::test_sync_timeout_handling 
PASSED [ 22%]


tests/test_flicker_fix_integration.py::TestRegressionPrevention::test_no_process_events_in_transitions 
PASSED [ 22%]


tests/test_flicker_fix_integration.py::TestRegressionPrevention::test_showfullscreen_not_deferred 
PASSED [ 22%]


tests/test_frame_timing_workload.py::TestFrameTimingWorkload::test_slide_with_visualizer_load 
PASSED [ 22%]


tests/test_frame_timing_workload.py::TestFrameTimingWorkload::test_sustained_workload 
PASSED [ 23%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary] 
PASSED [ 23%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin] 
PASSED [ 23%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[4k_125pct] 
PASSED [ 23%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct] 
PASSED [ 23%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct] 
PASSED [ 23%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct] 
PASSED [ 24%]


tests/test_gl_compositor_blinds.py::test_gl_compositor_blinds_no_underlay_and_no_black 
PASSED [ 24%]


tests/test_gl_compositor_blockflip.py::test_gl_compositor_blockflip_no_underlay_and_no_black 
PASSED [ 24%]


tests/test_gl_compositor_blockspin.py::test_gl_compositor_blockspin_no_underlay_and_no_black 
FAILED [ 24%]


tests/test_gl_compositor_cleanup.py::test_gl_compositor_cleanup_idempotent_without_context 
PASSED [ 24%]


tests/test_gl_compositor_cleanup.py::test_gl_compositor_cleanup_releases_pipeline_when_gl_available 
PASSED [ 24%]


tests/test_gl_compositor_crossfade.py::test_gl_compositor_crossfade_no_underlay_and_no_black 
PASSED [ 25%]


tests/test_gl_compositor_diffuse.py::test_gl_compositor_diffuse_no_underlay_and_no_black 
PASSED [ 25%]


tests/test_gl_compositor_peel.py::test_gl_compositor_peel_no_underlay_and_no_black 
PASSED [ 25%]


tests/test_gl_compositor_raindrops.py::test_gl_compositor_raindrops_no_underlay_and_no_black 
PASSED [ 25%]


tests/test_gl_compositor_slide.py::test_gl_compositor_slide_no_underlay_and_no_black 
PASSED [ 25%]


tests/test_gl_compositor_transition_lifecycle.py::test_clear_all_transitions_cancels_active_animation 
PASSED [ 25%]


tests/test_gl_compositor_transition_lifecycle.py::test_cancel_current_transition_snaps_to_new_pixmap 
PASSED [ 25%]


tests/test_gl_compositor_wipe.py::test_gl_compositor_wipe_no_underlay_and_no_black[WipeDirection.LEFT_TO_RIGHT] 
PASSED [ 26%]


tests/test_gl_compositor_wipe.py::test_gl_compositor_wipe_no_underlay_and_no_black[WipeDirection.RIGHT_TO_LEFT] 
PASSED [ 26%]


tests/test_gl_compositor_wipe.py::test_gl_compositor_wipe_no_underlay_and_no_black[WipeDirection.TOP_TO_BOTTOM] 
PASSED [ 26%]


tests/test_gl_compositor_wipe.py::test_gl_compositor_wipe_no_underlay_and_no_black[WipeDirection.BOTTOM_TO_TOP] 
PASSED [ 26%]


tests/test_gl_compositor_wipe.py::test_gl_compositor_wipe_no_underlay_and_no_black[WipeDirection.DIAG_TL_BR] 
PASSED [ 26%]


tests/test_gl_compositor_wipe.py::test_gl_compositor_wipe_no_underlay_and_no_black[WipeDirection.DIAG_TR_BL] 
PASSED [ 26%]


tests/test_gl_prewarm.py::test_gl_prewarm_overlays_ready 
PASSED          [ 27%]


tests/test_hotkeys_no_text.py::test_hotkeys_work_with_empty_event_text 
PASSED [ 27%]


tests/test_image_processor.py::test_fill_mode_wider_image 
PASSED         [ 27%]


tests/test_image_processor.py::test_fill_mode_taller_image 
PASSED        [ 27%]


tests/test_image_processor.py::test_fill_mode_small_image 
PASSED         [ 27%]


tests/test_image_processor.py::test_fit_mode_landscape 
PASSED            [ 27%]


tests/test_image_processor.py::test_fit_mode_portrait 
PASSED             [ 28%]


tests/test_image_processor.py::test_shrink_mode_large_image 
PASSED       [ 28%]


tests/test_image_processor.py::test_shrink_mode_small_image 
PASSED       [ 28%]


tests/test_image_processor.py::test_null_image_fallback 
PASSED           [ 28%]


tests/test_image_processor.py::test_square_image_fill 
PASSED             [ 28%]


tests/test_image_processor.py::test_aspect_ratio_preservation_fit 
PASSED [ 28%]


tests/test_image_processor.py::test_calculate_scale_factors_fill 
PASSED  [ 29%]


tests/test_image_processor.py::test_calculate_scale_factors_fit 
PASSED   [ 29%]


tests/test_image_processor.py::test_calculate_scale_factors_shrink_no_scaling 
PASSED [ 29%]


tests/test_image_processor.py::test_calculate_scale_factors_shrink_with_scaling 
PASSED [ 29%]


tests/test_image_processor.py::test_get_crop_rect 
PASSED                 [ 29%]


tests/test_image_processor.py::test_display_mode_from_string 
PASSED      [ 29%]


tests/test_image_processor.py::test_display_mode_from_string_invalid 
PASSED [ 30%]


tests/test_image_processor.py::test_display_mode_str 
PASSED              [ 30%]


tests/test_image_processor.py::test_qimage_sync_matches_pixmap[fill] 
PASSED [ 30%]


tests/test_image_processor.py::test_qimage_sync_matches_pixmap[fit] 
PASSED [ 30%]


tests/test_image_processor.py::test_qimage_sync_matches_pixmap[shrink] 
PASSED [ 30%]


tests/test_image_processor.py::test_qimage_async_matches_sync[fill] 
PASSED [ 30%]


tests/test_image_processor.py::test_qimage_async_matches_sync[fit] 
PASSED [ 31%]


tests/test_image_processor.py::test_qimage_async_matches_sync[shrink] 
PASSED [ 31%]


tests/test_image_queue.py::test_image_queue_initialization 
PASSED        [ 31%]


tests/test_image_queue.py::test_add_images_no_shuffle 
PASSED             [ 31%]


tests/test_image_queue.py::test_add_images_with_shuffle 
PASSED           [ 31%]


tests/test_image_queue.py::test_next_image 
PASSED                        [ 31%]


tests/test_image_queue.py::test_next_multiple_images 
PASSED              [ 32%]


tests/test_image_queue.py::test_queue_wraparound 
PASSED                  [ 32%]


tests/test_image_queue.py::test_current_image 
PASSED                     [ 32%]


tests/test_image_queue.py::test_peek_next_image 
PASSED                   [ 32%]


tests/test_image_queue.py::test_history_tracking 
PASSED                  [ 32%]


tests/test_image_queue.py::test_history_max_size 
PASSED                  [ 32%]


tests/test_image_queue.py::test_is_in_recent_history 
PASSED              [ 33%]


tests/test_image_queue.py::test_shuffle_method 
PASSED                    [ 33%]


tests/test_image_queue.py::test_set_shuffle_enabled 
PASSED               [ 33%]


tests/test_image_queue.py::test_clear_queue 
PASSED                       [ 33%]


tests/test_image_queue.py::test_set_images_replaces_all 
PASSED           [ 33%]


tests/test_image_queue.py::test_remove_image 
PASSED                      [ 33%]


tests/test_image_queue.py::test_remove_nonexistent_image 
PASSED          [ 33%]


tests/test_image_queue.py::test_get_stats 
PASSED                         [ 34%]


tests/test_image_queue.py::test_empty_queue_behavior 
PASSED              [ 34%]


tests/test_image_queue.py::test_queue_len_and_bool 
PASSED                [ 34%]


tests/test_image_queue.py::test_queue_repr 
PASSED                        [ 34%]


tests/test_image_queue.py::test_previous_image 
PASSED                    [ 34%]


tests/test_image_queue.py::test_previous_with_no_history 
PASSED          [ 34%]


tests/test_image_queue.py::test_wraparound_preserves_shuffle 
PASSED      [ 35%]


tests/test_integration.py::test_engine_creation 
PASSED                   [ 35%]


tests/test_integration.py::test_engine_initialization 
PASSED             [ 35%]


tests/test_integration.py::test_engine_core_systems 
PASSED               [ 35%]


tests/test_integration.py::test_engine_image_queue_initialization 
PASSED [ 35%]


tests/test_integration.py::test_engine_display_initialization 
PASSED     [ 35%]


tests/test_integration.py::test_engine_start_stop 
PASSED                 [ 36%]


tests/test_integration.py::test_engine_signals 
PASSED                    [ 36%]


tests/test_integration.py::test_engine_rotation_timer 
FAILED             [ 36%]


tests/test_integration.py::test_engine_get_stats 
PASSED                  [ 36%]


tests/test_integration.py::test_engine_cleanup 
PASSED                    [ 36%]


tests/test_integration.py::test_engine_without_initialization 
PASSED     [ 36%]


tests/test_integration.py::test_engine_default_rss_sources 
PASSED        [ 37%]


tests/test_integration.py::test_engine_settings_integration 
PASSED       [ 37%]


tests/test_integration.py::test_engine_multiple_start_calls 
PASSED       [ 37%]


tests/test_integration.py::test_engine_stop_without_start 
PASSED         [ 37%]


tests/test_integration_settings.py::test_sources_tab_folder_persistence 
PASSED [ 37%]


tests/test_integration_settings.py::test_sources_tab_rss_persistence 
PASSED [ 37%]


tests/test_integration_settings.py::test_settings_dialog_full_workflow 
PASSED [ 38%]


tests/test_integration_settings.py::test_nested_dict_does_not_work 
PASSED [ 38%]


tests/test_integration_settings.py::test_settings_load_on_startup 
PASSED [ 38%]


tests/test_integration_settings.py::TestEngineSettingsIntegration::test_sources_changed_triggers_reinitialize 
PASSED [ 38%]


tests/test_integration_settings.py::TestEngineSettingsIntegration::test_engine_state_during_settings_change 
PASSED [ 38%]


tests/test_integration_settings.py::TestEngineSettingsIntegration::test_just_make_it_work_clears_cache 
PASSED [ 38%]


tests/test_integration_settings.py::TestEngineSettingsIntegration::test_add_rss_feed_triggers_source_reinit 
PASSED [ 39%]


tests/test_integration_settings.py::TestEngineSettingsIntegration::test_remove_folder_triggers_queue_rebuild 
PASSED [ 39%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_downscaling 
PASSED [ 39%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_bug10_no_image_tripling 
PASSED [ 39%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_with_alpha_channel 
PASSED [ 39%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_with_sharpening 
PASSED [ 39%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_fallback_when_lanczos_disabled 
PASSED [ 40%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_fallback_when_pil_unavailable 
SKIPPED [ 40%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_fill_mode 
PASSED [ 40%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_fit_mode 
PASSED [ 40%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_shrink_mode_downscale 
PASSED [ 40%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_shrink_mode_no_upscale 
PASSED [ 40%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_lanczos_aspect_ratio_preserved 
PASSED [ 41%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_null_image_handling 
PASSED [ 41%]


tests/test_lanczos_scaling.py::TestLanczosScaling::test_aggressive_downscale 
PASSED [ 41%]


tests/test_logging_console_encoding.py::test_console_handler_replaces_unencodable_characters_narrow_encodings[cp1252] 
PASSED [ 41%]


tests/test_logging_console_encoding.py::test_console_handler_replaces_unencodable_characters_narrow_encodings[latin-1] 
PASSED [ 41%]


tests/test_logging_console_encoding.py::test_console_handler_preserves_unicode_on_utf8_console 
PASSED [ 41%]


tests/test_mc_keyboard_input.py::test_mc_display_widget_receives_hotkeys 
PASSED [ 41%]


tests/test_mc_window_flags.py::test_mc_window_uses_tool_flag 
PASSED      [ 42%]


tests/test_mc_window_flags.py::test_main_build_does_not_use_tool_flag 
PASSED [ 42%]


tests/test_media_widget.py::test_noop_media_controller_safe_calls 
PASSED [ 42%]


tests/test_media_widget.py::test_create_media_controller_falls_back_to_noop 
PASSED [ 42%]


tests/test_media_widget.py::test_windows_media_controller_selects_spotify_session 
PASSED [ 42%]


tests/test_media_widget.py::test_windows_media_controller_returns_none_when_no_spotify 
PASSED [ 42%]


tests/test_media_widget.py::test_windows_media_controller_live_spotify_track 
PASSED [ 43%]


tests/test_media_widget.py::test_media_widget_placeholder_when_no_media 
PASSED [ 43%]


tests/test_media_widget.py::test_media_widget_displays_metadata 
PASSED   [ 43%]


tests/test_media_widget.py::test_media_widget_hides_again_when_media_disappears 
PASSED [ 43%]


tests/test_media_widget.py::test_media_widget_decodes_artwork_and_adjusts_margins 
PASSED [ 43%]


tests/test_media_widget.py::test_media_widget_warns_when_thread_manager_missing 
PASSED [ 43%]


tests/test_media_widget.py::test_media_widget_starts_fade_in_when_artwork_appears 
PASSED [ 44%]


tests/test_media_widget.py::test_media_widget_transport_delegates_to_controller 
PASSED [ 44%]


tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget 
PASSED [ 44%]


tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget 
PASSED [ 44%]


tests/test_multidisplay_sync.py::TestDisplayManagerSync::test_sync_disabled_by_default 
PASSED [ 44%]


tests/test_multidisplay_sync.py::TestDisplayManagerSync::test_enable_sync_creates_queue 
PASSED [ 44%]


tests/test_multidisplay_sync.py::TestDisplayManagerSync::test_disable_sync_clears_queue 
PASSED [ 45%]


tests/test_multidisplay_sync.py::TestDisplayManagerSync::test_sync_not_enabled_for_single_display 
PASSED [ 45%]


tests/test_multidisplay_sync.py::TestSPSCQueueSync::test_ready_signal_queuing 
PASSED [ 45%]


tests/test_multidisplay_sync.py::TestSPSCQueueSync::test_wait_for_all_displays_success 
PASSED [ 45%]


tests/test_multidisplay_sync.py::TestSPSCQueueSync::test_wait_for_all_displays_timeout 
PASSED [ 45%]


tests/test_multidisplay_sync.py::TestSPSCQueueSync::test_wait_returns_true_when_sync_disabled 
PASSED [ 45%]


tests/test_multidisplay_sync.py::TestSPSCQueueSync::test_wait_returns_true_for_single_display 
PASSED [ 46%]


tests/test_multidisplay_sync.py::TestSynchronizedTransition::test_show_image_synchronized_falls_back_when_disabled 
PASSED [ 46%]


tests/test_multidisplay_sync.py::TestSynchronizedTransition::test_show_image_synchronized_clears_queue 
PASSED [ 46%]


tests/test_multidisplay_sync.py::TestQueueOverflow::test_queue_rejects_when_full 
PASSED [ 46%]


tests/test_multidisplay_sync.py::TestQueueOverflow::test_display_manager_logs_queue_full 
PASSED [ 46%]


tests/test_multidisplay_sync.py::TestConcurrentReadySignals::test_no_duplicate_ready_signals 
PASSED [ 46%]


tests/test_multidisplay_sync.py::TestPerformanceMetrics::test_sync_overhead_minimal 
PASSED [ 47%]


tests/test_overlay_ready_state.py::TestSWCrossfadeOverlayReady::test_sw_overlay_not_ready_before_paint 
PASSED [ 47%]


tests/test_overlay_ready_state.py::TestSWCrossfadeOverlayReady::test_sw_overlay_ready_after_paint 
PASSED [ 47%]


tests/test_overlay_ready_state.py::TestOverlayManagerReady::test_any_overlay_ready_returns_false_when_none_visible 
PASSED [ 47%]


tests/test_overlay_ready_state.py::TestOverlayManagerReady::test_display_widget_retains_previous_pixmap_on_clear 
PASSED [ 47%]


tests/test_overlay_ready_state.py::TestDisplayWidgetOverlayDiagnostics::test_notify_overlay_ready_tracks_counts 
PASSED [ 47%]


tests/test_overlay_ready_state.py::TestDisplayWidgetOverlayDiagnostics::test_handle_screen_change_updates_geometry_and_dpi 
FAILED [ 48%]


tests/test_overlay_timers.py::test_overlay_timer_uses_thread_manager_when_available 
PASSED [ 48%]


tests/test_overlay_timers.py::test_overlay_timer_raises_without_thread_manager 
PASSED [ 48%]


tests/test_painter_shadow.py::TestShadowConfig::test_default_values 
PASSED [ 48%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_empty 
PASSED [ 48%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_none 
PASSED [ 48%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_disabled 
PASSED [ 49%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string 
FAILED [ 49%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_blur_radius 
PASSED [ 49%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_offset 
PASSED [ 49%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_color_list 
PASSED [ 49%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_color_qcolor 
PASSED [ 49%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_opacity 
PASSED [ 50%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_miss_on_empty 
PASSED [ 50%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_hit_after_set 
PASSED [ 50%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_miss_on_size_change 
PASSED [ 50%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_miss_on_config_change 
PASSED [ 50%]


tests/test_painter_shadow.py::TestShadowCache::test_invalidate_clears_cache 
PASSED [ 50%]


tests/test_painter_shadow.py::TestGlobalShadowCache::test_get_shadow_cache_creates_new 
PASSED [ 50%]


tests/test_painter_shadow.py::TestGlobalShadowCache::test_get_shadow_cache_returns_same 
PASSED [ 51%]


tests/test_painter_shadow.py::TestGlobalShadowCache::test_clear_shadow_cache_removes 
PASSED [ 51%]


tests/test_painter_shadow.py::TestPainterShadow::test_render_shadow_pixmap_creates_image 
PASSED [ 51%]


tests/test_painter_shadow.py::TestPainterShadow::test_render_shadow_pixmap_with_corner_radius 
PASSED [ 51%]


tests/test_painter_shadow.py::TestPainterShadow::test_render_shadow_pixmap_empty_size 
PASSED [ 51%]


tests/test_painter_shadow.py::TestPainterShadow::test_apply_blur_returns_image 
PASSED [ 51%]


tests/test_painter_shadow.py::TestPainterShadow::test_apply_blur_zero_radius 
PASSED [ 52%]


tests/test_painter_shadow.py::TestShadowConfigHash::test_same_config_same_hash 
PASSED [ 52%]


tests/test_painter_shadow.py::TestShadowConfigHash::test_different_blur_different_hash 
PASSED [ 52%]


tests/test_painter_shadow.py::TestShadowConfigHash::test_different_offset_different_hash 
PASSED [ 52%]


tests/test_pan_scan_integration.py::test_pan_scan_stopped_before_transition 
SKIPPED [ 52%]


tests/test_pan_scan_integration.py::test_diffuse_with_pan_scan 
SKIPPED   [ 52%]


tests/test_pan_scan_integration.py::test_block_puzzle_with_pan_scan 
SKIPPED [ 53%]


tests/test_pan_scan_integration.py::test_transition_uses_pan_preview_frame 
SKIPPED [ 53%]


tests/test_pan_scan_integration.py::test_wipe_with_pan_scan 
SKIPPED      [ 53%]


tests/test_pan_scan_integration.py::test_crossfade_duration 
PASSED       [ 53%]


tests/test_pan_scan_integration.py::test_pan_scan_cleanup_between_images 
SKIPPED [ 53%]


tests/test_pan_scan_integration.py::test_all_transitions_with_pan_scan 
SKIPPED [ 53%]


tests/test_particle_transition.py::TestParticleProgram::test_particle_program_import 
PASSED [ 54%]


tests/test_particle_transition.py::TestParticleProgram::test_particle_program_instantiation 
PASSED [ 54%]


tests/test_particle_transition.py::TestParticleProgram::test_particle_program_has_vertex_source 
PASSED [ 54%]


tests/test_particle_transition.py::TestParticleProgram::test_particle_program_has_fragment_source 
PASSED [ 54%]


tests/test_particle_transition.py::TestParticleProgram::test_particle_program_uniform_names 
PASSED [ 54%]


tests/test_particle_transition.py::TestParticleState::test_particle_state_import 
PASSED [ 54%]


tests/test_particle_transition.py::TestParticleState::test_particle_state_creation 
PASSED [ 55%]


tests/test_particle_transition.py::TestParticleState::test_particle_state_with_values 
PASSED [ 55%]


tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_import 
PASSED [ 55%]


tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_creation 
FAILED [ 55%]


tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_modes 
FAILED [ 55%]


tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_directions 
FAILED [ 55%]


tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_swirl_orders 
FAILED [ 56%]


tests/test_particle_transition.py::TestTransitionFactory::test_factory_import 
PASSED [ 56%]


tests/test_particle_transition.py::TestSettingsDefaults::test_settings_manager_has_particle_defaults 
FAILED [ 56%]


tests/test_particle_transition.py::TestSettingsDefaults::test_settings_manager_has_particle_in_pool 
PASSED [ 56%]


tests/test_perf_dt_max.py::TestPerfDtMax::test_visualizer_dt_max_with_transitions 
FAILED [ 56%]


tests/test_perf_dt_max.py::TestPerfDtMax::test_sustained_visualizer_load 
FAILED [ 56%]


tests/test_phase_e_effect_corruption.py::TestPhaseEEffectCorruption::test_effect_state_before_menu_open 
PASSED [ 57%]


tests/test_phase_e_effect_corruption.py::TestPhaseEEffectCorruption::test_effect_state_after_menu_open_same_display 
PASSED [ 57%]


tests/test_phase_e_effect_corruption.py::TestPhaseEEffectCorruption::test_cross_display_activation_cascade 
PASSED [ 57%]


tests/test_phase_e_effect_corruption.py::TestPhaseEEffectCorruption::test_wm_mouseactivate_handler_exists 
PASSED [ 57%]


tests/test_phase_e_effect_corruption.py::TestPhaseEEffectCorruption::test_single_focus_window_policy 
PASSED [ 57%]


tests/test_phase_e_effect_corruption.py::TestPhaseEEffectCorruption::test_effect_invalidation_on_menu_close 
PASSED [ 57%]


tests/test_phase_e_effect_corruption.py::TestPhaseEReproductionSequence::test_reddit_click_display_0_sequence 
PASSED [ 58%]


tests/test_phase_e_effect_corruption.py::TestPhaseEReproductionSequence::test_reddit_click_display_1_sequence 
PASSED [ 58%]


tests/test_phase_e_effect_corruption.py::TestPhaseEReproductionSequence::test_context_menu_display_1_corrupts_display_0 
PASSED [ 58%]


tests/test_phase_e_effect_corruption.py::TestPhaseEReproductionSequence::test_context_menu_display_0_is_safe 
PASSED [ 58%]


tests/test_phase_e_effect_corruption.py::TestPhaseEMitigation::test_effect_recreation_clears_corruption 
PASSED [ 58%]


tests/test_phase_e_effect_corruption.py::TestPhaseEMitigation::test_ma_noactivate_prevents_activation 
PASSED [ 58%]


tests/test_phase_e_effect_corruption.py::TestPhaseEMitigation::test_swp_noactivate_in_windowpos 
PASSED [ 58%]


tests/test_phase_e_effect_corruption.py::TestPhaseEDiagnostics::test_log_effect_state_changes 
PASSED [ 59%]


tests/test_phase_e_effect_corruption.py::TestPhaseEDiagnostics::test_log_native_events 
PASSED [ 59%]


tests/test_phase_e_effect_corruption.py::TestPhaseEDiagnostics::test_detect_effect_corruption 
PASSED [ 59%]


tests/test_phase_e_effect_corruption.py::TestPhaseEIntegration::test_qgraphicsdropshadoweffect_creation 
PASSED [ 59%]


tests/test_phase_e_effect_corruption.py::TestPhaseEIntegration::test_effect_toggle_invalidation 
PASSED [ 59%]


tests/test_phase_e_effect_corruption.py::TestPhaseEIntegration::test_effect_recreation 
PASSED [ 59%]


tests/test_qt_timer_threading.py::test_overlay_timer_stop_is_safe_from_other_threads 
FAILED [ 60%]


tests/test_reddit_exit_logic.py::TestRedditExitLogic::test_primary_covered_detection_same_screen 
PASSED [ 60%]


tests/test_reddit_exit_logic.py::TestRedditExitLogic::test_primary_covered_detection_different_screen 
PASSED [ 60%]


tests/test_reddit_exit_logic.py::TestRedditExitLogic::test_mc_mode_detection 
PASSED [ 60%]


tests/test_reddit_exit_logic.py::TestRedditClickRouting::test_reddit_click_returns_handled_tuple 
PASSED [ 60%]


tests/test_reddit_exit_logic.py::TestRedditClickRouting::test_reddit_click_returns_deferred_url 
PASSED [ 60%]


tests/test_reddit_exit_logic.py::TestCacheInvalidationMitigation::test_no_setforegroundwindow_before_exit 
PASSED [ 61%]


tests/test_reddit_exit_logic.py::TestDisplayManagerDeferredUrls::test_cleanup_defers_urls_for_helper_flush 
PASSED [ 61%]


tests/test_reddit_exit_logic.py::TestDeferredRedditFlow::test_primary_covered_click_defers_until_cleanup 
PASSED [ 61%]


tests/test_reddit_exit_logic.py::TestDeferredRedditFlow::test_cleanup_waits_for_window_teardown_before_helper_launch 
PASSED [ 61%]


tests/test_reddit_exit_logic.py::TestRedditHelperLauncher::test_flush_prefers_helper_when_available 
PASSED [ 61%]


tests/test_reddit_exit_logic.py::TestRedditHelperLauncher::test_flush_falls_back_when_helper_rejects 
PASSED [ 61%]


tests/test_reddit_exit_logic.py::TestRedditHelperLauncher::test_flush_queues_when_bridge_available 
PASSED [ 62%]


tests/test_reddit_exit_logic.py::TestRedditExitIntegration::test_case_a_hard_exit_primary_covered 
SKIPPED [ 62%]


tests/test_reddit_exit_logic.py::TestRedditExitIntegration::test_case_b_ctrl_held_primary_covered 
SKIPPED [ 62%]


tests/test_reddit_exit_logic.py::TestRedditExitIntegration::test_case_c_mc_mode_stay_open 
SKIPPED [ 62%]


tests/test_reddit_helper_installer.py::TestRedditHelperInstallerFlow::test_trigger_prefers_scheduler_first 
PASSED [ 62%]


tests/test_reddit_widget.py::test_reddit_filters_daily_weekly_question_threads 
PASSED [ 62%]


tests/test_reddit_widget.py::test_reddit_format_age_variants 
PASSED      [ 63%]


tests/test_reddit_widget.py::test_reddit_error_hides_before_first_success 
PASSED [ 63%]


tests/test_reddit_widget.py::test_reddit_handle_click_row_opens_url 
PASSED [ 63%]


tests/test_reddit_widget.py::test_reddit_handle_click_header_opens_subreddit 
PASSED [ 63%]


tests/test_rendering_backends.py::test_opengl_backend_falls_back_to_software 
PASSED [ 63%]


tests/test_rendering_backends.py::test_explicit_software_backend_selection 
PASSED [ 63%]


tests/test_rendering_backends.py::test_backend_diagnostics_counters 
PASSED [ 64%]


tests/test_rendering_backends.py::test_unknown_backend_normalizes_to_opengl 
PASSED [ 64%]


tests/test_resource_pooling.py::TestPixmapPooling::test_acquire_returns_none_when_empty 
PASSED [ 64%]


tests/test_resource_pooling.py::TestPixmapPooling::test_release_and_acquire 
PASSED [ 64%]


tests/test_resource_pooling.py::TestPixmapPooling::test_pool_size_limit 
PASSED [ 64%]


tests/test_resource_pooling.py::TestPixmapPooling::test_pool_stats_tracking 
PASSED [ 64%]


tests/test_resource_pooling.py::TestPixmapPooling::test_different_sizes_separate_buckets 
PASSED [ 65%]


tests/test_resource_pooling.py::TestImagePooling::test_acquire_returns_none_when_empty 
PASSED [ 65%]


tests/test_resource_pooling.py::TestImagePooling::test_release_and_acquire 
PASSED [ 65%]


tests/test_resource_pooling.py::TestPoolCleanup::test_clear_pools 
PASSED [ 65%]


tests/test_resource_pooling.py::TestPoolCleanup::test_shutdown_clears_pools 
PASSED [ 65%]


tests/test_resources.py::test_resource_manager_initialization 
PASSED     [ 65%]


tests/test_resources.py::test_register_resource 
PASSED                   [ 66%]


tests/test_resources.py::test_unregister_resource 
PASSED                 [ 66%]


tests/test_resources.py::test_register_temp_file 
PASSED                  [ 66%]


tests/test_resources.py::test_get_all_resources 
PASSED                   [ 66%]


tests/test_resources.py::test_get_stats 
PASSED                           [ 66%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_source_fetches_from_multiple_feeds 
PASSED [ 66%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_source_tracks_cached_urls 
PASSED [ 66%]


tests/test_rss_behavior.py::TestRSSBehavior::test_image_queue_rotates_rss_images 
PASSED [ 67%]


tests/test_rss_behavior.py::TestRSSBehavior::test_image_queue_history_prevents_duplicates 
PASSED [ 67%]


tests/test_rss_behavior.py::TestRSSBehavior::test_rss_refresh_adds_new_images_only 
PASSED [ 67%]


tests/test_rss_behavior.py::TestRSSIntegration::test_real_reddit_feed 
SKIPPED [ 67%]


tests/test_rss_behavior.py::TestRSSIntegration::test_rate_limiting_behavior 
SKIPPED [ 67%]


tests/test_s_hotkey_workflow.py::test_s_hotkey_opens_settings_without_crash 
PASSED [ 67%]


tests/test_s_hotkey_workflow.py::test_display_initialized_flag_lifecycle 
PASSED [ 68%]


tests/test_s_hotkey_workflow.py::test_engine_has_required_attributes 
PASSED [ 68%]


tests/test_s_hotkey_workflow.py::test_settings_requested_handler_doesnt_crash_on_stop 
PASSED [ 68%]


tests/test_s_hotkey_workflow.py::test_settings_dialog_import_exists 
PASSED [ 68%]


tests/test_scrollwheel_volume.py::test_spotify_volume_widget_handle_wheel_clamps_and_schedules 
PASSED [ 68%]


tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_uses_local_coordinates 
PASSED [ 68%]


tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_ignores_hidden_volume 
PASSED [ 69%]


tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_propagates_widget_rejection 
PASSED [ 69%]


tests/test_scrollwheel_volume.py::test_ctrl_mode_wheel_adjusts_spotify_volume_widget 
PASSED [ 69%]


tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume 
PASSED [ 69%]


tests/test_settings.py::test_settings_manager_initialization 
PASSED      [ 69%]


tests/test_settings.py::test_get_set_setting 
PASSED                      [ 69%]


tests/test_settings.py::test_default_values 
PASSED                       [ 70%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED [ 70%]


tests/test_settings.py::test_on_changed_handler 
PASSED                   [ 70%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                    [ 70%]


tests/test_settings.py::test_get_all_keys 
PASSED                         [ 70%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED              [ 70%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED [ 71%]


tests/test_settings_dialog.py::test_custom_title_bar_creation 
PASSED     [ 71%]


tests/test_settings_dialog.py::test_custom_title_bar_signals 
PASSED      [ 71%]


tests/test_settings_dialog.py::test_tab_button_creation 
PASSED           [ 71%]


tests/test_settings_dialog.py::test_settings_dialog_creation 
PASSED      [ 71%]


tests/test_settings_dialog.py::test_settings_dialog_has_title_bar 
PASSED [ 71%]


tests/test_settings_dialog.py::test_settings_dialog_has_tabs 
FAILED      [ 72%]


tests/test_settings_dialog.py::test_settings_dialog_has_content_stack 
FAILED [ 72%]


tests/test_settings_dialog.py::test_settings_dialog_default_tab 
PASSED   [ 72%]


tests/test_settings_dialog.py::test_settings_dialog_tab_switching 
FAILED [ 72%]


tests/test_settings_dialog.py::test_settings_dialog_has_size_grip 
PASSED [ 72%]


tests/test_settings_dialog.py::test_settings_dialog_toggle_maximize 
PASSED [ 72%]


tests/test_settings_dialog.py::test_settings_dialog_has_drop_shadow 
PASSED [ 73%]


tests/test_settings_dialog.py::test_settings_dialog_theme_loaded 
PASSED  [ 73%]


tests/test_settings_dialog.py::test_settings_dialog_tab_button_clicks 
PASSED [ 73%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_transitions_key_triggers_sync 
PASSED [ 73%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_widgets_key_triggers_sync 
PASSED [ 73%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_sources_folders_triggers_sync 
PASSED [ 73%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_display_key_triggers_sync 
PASSED [ 74%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_non_critical_key_no_sync 
PASSED [ 74%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_critical_keys_list_complete 
PASSED [ 74%]


tests/test_settings_sync.py::TestSettingsCriticalSync::test_nested_critical_key_triggers_sync 
PASSED [ 74%]


tests/test_slide_jitter.py::TestSlideJitter::test_slide_dt_max_under_threshold 
PASSED [ 74%]


tests/test_slide_jitter.py::TestSlideJitter::test_slide_frame_count_reasonable 
PASSED [ 74%]


tests/test_slide_transition.py::test_slide_direction_enum 
PASSED         [ 75%]


tests/test_slide_transition.py::test_slide_creation 
PASSED               [ 75%]


tests/test_slide_transition.py::test_slide_all_directions 
PASSED         [ 75%]


tests/test_slide_transition.py::test_slide_start_no_old_image 
PASSED     [ 75%]


tests/test_slide_transition.py::test_slide_signals 
PASSED                [ 75%]


tests/test_slide_transition.py::test_slide_progress_range 
PASSED         [ 75%]


tests/test_slide_transition.py::test_slide_stop 
PASSED                   [ 75%]


tests/test_slide_transition.py::test_slide_cleanup 
PASSED                [ 76%]


tests/test_slide_transition.py::test_slide_invalid_pixmap 
PASSED         [ 76%]


tests/test_slide_transition.py::test_slide_already_running 
PASSED        [ 76%]


tests/test_slide_transition.py::test_slide_set_direction 
PASSED          [ 76%]


tests/test_slide_transition.py::test_slide_easing_curves 
PASSED          [ 76%]


tests/test_slide_transition.py::test_slide_position_calculation 
PASSED   [ 76%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_compute_bars_reasonable_runtime 
PASSED [ 77%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_set_floor_config_clamps_and_snaps 
PASSED [ 77%]


tests/test_spotify_visualizer_widget.py::test_dynamic_floor_updates_running_average 
PASSED [ 77%]


tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic 
FAILED [ 77%]


tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor 
FAILED [ 77%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_widgets_share_audio_engine 
PASSED [ 77%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_emits_perf_metrics 
PASSED [ 78%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top 
FAILED [ 78%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals 
FAILED [ 78%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_media_update_requires_visible_anchor 
PASSED [ 78%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_start_requests_fade_sync 
PASSED [ 78%]


tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_media_update_zeroes_bars_when_not_playing 
FAILED [ 78%]


tests/test_startup_black_flash.py::test_startup_no_base_black_fallback_software 
PASSED [ 79%]


tests/test_startup_black_flash.py::test_startup_no_base_black_fallback_opengl 
PASSED [ 79%]


tests/test_threading.py::test_thread_manager_initialization 
PASSED       [ 79%]


tests/test_threading.py::test_submit_io_task 
PASSED                      [ 79%]


tests/test_threading.py::test_submit_compute_task 
PASSED                 [ 79%]


tests/test_threading.py::test_get_pool_stats 
PASSED                      [ 79%]


tests/test_threading.py::test_thread_manager_shutdown 
PASSED             [ 80%]


tests/test_threading.py::test_run_on_ui_thread_from_ui_thread 
PASSED     [ 80%]


tests/test_threading.py::test_run_on_ui_thread_from_worker_thread 
PASSED [ 80%]


tests/test_threading.py::test_schedule_recurring_invokes_callback 
PASSED [ 80%]


tests/test_threading.py::test_schedule_recurring_with_description 
PASSED [ 80%]


tests/test_timezone_support.py::TestTimezoneUtils::test_get_local_timezone 
PASSED [ 80%]


tests/test_timezone_support.py::TestTimezoneUtils::test_get_common_timezones 
PASSED [ 81%]


tests/test_timezone_support.py::TestTimezoneUtils::test_get_all_pytz_timezones 
PASSED [ 81%]


tests/test_timezone_support.py::TestTimezoneUtils::test_validate_timezone_local 
PASSED [ 81%]


tests/test_timezone_support.py::TestTimezoneUtils::test_validate_timezone_utc_offsets 
PASSED [ 81%]


tests/test_timezone_support.py::TestTimezoneUtils::test_validate_timezone_pytz 
PASSED [ 81%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_creation_default_timezone 
PASSED [ 81%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_creation_with_timezone 
PASSED [ 82%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_parse_utc_offset_positive 
PASSED [ 82%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_parse_utc_offset_negative 
PASSED [ 82%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_parse_utc_offset_with_minutes 
PASSED [ 82%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_parse_pytz_timezone 
PASSED [ 82%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_timezone_abbrev_local 
PASSED [ 82%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_timezone_abbrev_utc 
PASSED [ 83%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_timezone_abbrev_offset 
PASSED [ 83%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_set_timezone 
PASSED [ 83%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_set_show_timezone 
PASSED [ 83%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_time_update_with_timezone 
FAILED [ 83%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_local_vs_utc_time_difference 
FAILED [ 83%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_invalid_timezone_fallback 
PASSED [ 83%]


tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_timezone_display_formats 
FAILED [ 84%]


tests/test_timezone_support.py::TestTimezoneEdgeCases::test_timezone_negative_half_hour 
PASSED [ 84%]


tests/test_timezone_support.py::TestTimezoneEdgeCases::test_timezone_45_minute_offset 
PASSED [ 84%]


tests/test_timezone_support.py::TestTimezoneEdgeCases::test_timezone_extreme_positive 
PASSED [ 84%]


tests/test_timezone_support.py::TestTimezoneEdgeCases::test_timezone_extreme_negative 
PASSED [ 84%]


tests/test_timezone_support.py::TestTimezoneEdgeCases::test_empty_timezone_string 
PASSED [ 84%]


tests/test_timezone_support.py::TestTimezoneEdgeCases::test_case_insensitive_utc 
PASSED [ 85%]


tests/test_transition_integration.py::TestTransitionIntegration::test_crossfade_transition_runs 
FAILED [ 85%]


tests/test_transition_integration.py::TestTransitionIntegration::test_slide_transition_runs 
FAILED [ 85%]


tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_runs 
FAILED [ 85%]


tests/test_transition_integration.py::TestTransitionIntegration::test_block_puzzle_flip_transition_runs 
FAILED [ 85%]


tests/test_transition_integration.py::TestTransitionIntegration::test_wipe_transition_runs 
FAILED [ 85%]


tests/test_transition_integration.py::TestTransitionIntegration::test_transition_cleanup_on_stop 
PASSED [ 86%]


tests/test_transition_integration.py::TestTransitionIntegration::test_transition_settings_respected 
FAILED [ 86%]


tests/test_transition_integration.py::TestTransitionIntegration::test_transition_fallback_on_error 
PASSED [ 86%]


tests/test_transition_integration.py::TestTransitionIntegration::test_random_slide_direction 
PASSED [ 86%]


tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_software_backend_no_watchdog 
FAILED [ 86%]


tests/test_transition_integration.py::TestTransitionIntegration::test_block_flip_transition_software_backend_no_watchdog 
FAILED [ 86%]


tests/test_transition_telemetry.py::TestBaseTelemetry::test_transition_has_telemetry_fields 
PASSED [ 87%]


tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_start_sets_time 
FAILED [ 87%]


tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_end_sets_time 
FAILED [ 87%]


tests/test_transition_telemetry.py::TestBaseTelemetry::test_get_elapsed_ms_returns_none_without_start 
PASSED [ 87%]


tests/test_transition_telemetry.py::TestBaseTelemetry::test_get_elapsed_ms_returns_time_after_start 
FAILED [ 87%]


tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_start_logs_debug 
FAILED [ 87%]


tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_logs_performance 
FAILED [ 88%]


tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_warns_on_timing_drift 
FAILED [ 88%]


tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_start 
FAILED [ 88%]


tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_end_on_complete 
FAILED [ 88%]


tests/test_transition_telemetry.py::TestSWTransitionTelemetry::test_sw_crossfade_has_telemetry 
PASSED [ 88%]


tests/test_transition_telemetry.py::TestPerformanceMetrics::test_elapsed_time_accuracy 
FAILED [ 88%]


tests/test_transition_telemetry.py::TestPerformanceMetrics::test_delta_calculation 
FAILED [ 89%]


tests/test_transition_telemetry.py::TestTelemetryThreadSafety::test_elapsed_time_thread_safe 
PASSED [ 89%]


tests/test_transitions.py::test_transition_state_enum 
PASSED             [ 89%]


tests/test_transitions.py::test_crossfade_creation 
PASSED                [ 89%]


tests/test_transitions.py::test_crossfade_duration 
PASSED                [ 89%]


tests/test_transitions.py::test_crossfade_start_with_no_old_image 
PASSED [ 89%]


tests/test_transitions.py::test_crossfade_start_with_images 
PASSED       [ 90%]


tests/test_transitions.py::test_crossfade_signals 
PASSED                 [ 90%]


tests/test_transitions.py::test_crossfade_progress_range 
PASSED          [ 90%]


tests/test_transitions.py::test_crossfade_stop 
PASSED                    [ 90%]


tests/test_transitions.py::test_crossfade_cleanup 
PASSED                 [ 90%]


tests/test_transitions.py::test_crossfade_invalid_pixmap 
PASSED          [ 90%]


tests/test_transitions.py::test_crossfade_already_running 
PASSED         [ 91%]


tests/test_transitions.py::test_crossfade_easing_curves 
PASSED           [ 91%]


tests/test_transitions.py::test_crossfade_set_easing 
PASSED              [ 91%]


tests/test_transitions.py::test_crossfade_repr 
PASSED                    [ 91%]


tests/test_transitions.py::test_crossfade_state_transitions 
PASSED       [ 91%]


tests/test_transitions.py::test_crossfade_multiple_transitions 
PASSED    [ 91%]


tests/test_transitions_integration.py::test_crossfade_with_pan_and_scan 
SKIPPED [ 91%]


tests/test_transitions_integration.py::test_diffuse_with_pan_and_scan 
SKIPPED [ 92%]


tests/test_transitions_integration.py::test_pan_and_scan_no_zoom_after_transition 
SKIPPED [ 92%]


tests/test_transitions_tab.py::test_slide_and_wipe_directions_are_independent 
PASSED [ 92%]


tests/test_transitions_tab.py::test_default_transition_type_and_direction 
PASSED [ 92%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_enum_exists 
PASSED [ 92%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_spectrum 
PASSED [ 92%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_waveform 
PASSED [ 93%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_has_abstract 
PASSED [ 93%]


tests/test_visualizer_modes.py::TestVisualizerModeEnum::test_visualizer_mode_count 
PASSED [ 93%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_widget_default_mode_is_spectrum 
PASSED [ 93%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_to_waveform 
PASSED [ 93%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_to_abstract 
PASSED [ 93%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_waveform_history 
PASSED [ 94%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_particles 
FAILED [ 94%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_cycle_visualization_mode 
PASSED [ 94%]


tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_same_mode_is_noop 
PASSED [ 94%]


tests/test_visualizer_modes.py::TestWaveformModeState::test_waveform_history_initialized_empty 
PASSED [ 94%]


tests/test_visualizer_modes.py::TestWaveformModeState::test_waveform_max_samples_default 
PASSED [ 94%]


tests/test_visualizer_modes.py::TestAbstractModeState::test_abstract_particles_initialized_empty 
PASSED [ 95%]


tests/test_visualizer_modes.py::TestAbstractModeState::test_abstract_max_particles_default 
PASSED [ 95%]


tests/test_visualizer_modes.py::TestAbstractModeState::test_abstract_spawn_timestamp_initialized 
PASSED [ 95%]


tests/test_weather_widget.py::test_weather_position_enum 
PASSED          [ 95%]


tests/test_weather_widget.py::test_weather_creation 
PASSED               [ 95%]


tests/test_weather_widget.py::test_weather_no_api_key 
FAILED             [ 95%]


tests/test_weather_widget.py::test_weather_stop 
FAILED                   [ 96%]


tests/test_weather_widget.py::test_weather_signals 
PASSED                [ 96%]


tests/test_weather_widget.py::test_weather_display_update 
PASSED         [ 96%]


tests/test_weather_widget.py::test_weather_cache 
PASSED                  [ 96%]


tests/test_weather_widget.py::test_weather_all_positions 
PASSED          [ 96%]


tests/test_weather_widget.py::test_weather_set_position 
PASSED           [ 96%]


tests/test_weather_widget.py::test_weather_set_api_key 
PASSED            [ 97%]


tests/test_weather_widget.py::test_weather_set_location 
PASSED           [ 97%]


tests/test_weather_widget.py::test_weather_set_font_size 
PASSED          [ 97%]


tests/test_weather_widget.py::test_weather_set_text_color 
PASSED         [ 97%]


tests/test_weather_widget.py::test_weather_cleanup 
FAILED                [ 97%]


tests/test_weather_widget.py::test_weather_error_handling 
PASSED         [ 97%]


tests/test_weather_widget.py::test_weather_error_with_cache 
PASSED       [ 98%]


tests/test_weather_widget.py::test_weather_fetcher_creation 
PASSED       [ 98%]


tests/test_weather_widget.py::test_weather_fetcher_success 
PASSED        [ 98%]


tests/test_weather_widget.py::test_weather_fetcher_error 
PASSED          [ 98%]


tests/test_weather_widget.py::test_weather_display_no_data 
PASSED        [ 98%]


tests/test_weather_widget.py::test_weather_concurrent_start_prevention 
FAILED [ 98%]


tests/test_widgets_media_integration.py::test_widgets_tab_media_roundtrip 
PASSED [ 99%]


tests/test_widgets_media_integration.py::test_media_widget_created_after_config_roundtrip 
PASSED [ 99%]


tests/test_widgets_persistence_integration.py::test_widgets_tab_changes_reflected_in_display_widget 
FAILED [ 99%]


tests/test_widgets_persistence_integration.py::test_display_widget_respects_widget_monitor_selection 
PASSED [ 99%]


tests/test_widgets_tab.py::TestWidgetsTab::test_widgets_tab_creation 
PASSED [ 99%]


tests/test_widgets_tab.py::TestWidgetsTab::test_widgets_tab_default_values 
FAILED [ 99%]


tests/test_widgets_tab.py::TestWidgetsTab::test_widgets_tab_saves_and_roundtrips 
PASSED [100%]




================================== FAILURES ===================================

__ TestClockIntegrationRegression.test_bug3_color_array_to_qcolor_conversion __

tests\test_clock_integration_regression.py:97: in test_bug3_color_array_to_qcolor_conversion

    assert display_widget.clock_widget._enabled  # Clock should be running

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x16019f06de0, name="clock_main") at 0x00000160499D2500>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x16019f06de0, name="clock_main") at 0x00000160499D2500> = <rendering.display_widget.DisplayWidget(0x16017b1c5b0) at 0x0000016049BAB040>.clock_widget

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

________ TestClockIntegrationRegression.test_bug4_z_order_clock_on_top ________

tests\test_clock_integration_regression.py:123: in test_bug4_z_order_clock_on_top

    assert display_widget.clock_widget._enabled  # Clock should be running

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x16017b49f90, name="clock_main") at 0x0000016049B06A00>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x16017b49f90, name="clock_main") at 0x0000016049B06A00> = <rendering.display_widget.DisplayWidget(0x16019f066c0) at 0x0000016049BA9940>.clock_widget

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_________ TestClockIntegrationRegression.test_bug9_missing_raise_call _________

tests\test_clock_integration_regression.py:228: in test_bug9_missing_raise_call

    assert display_widget.clock_widget._enabled  # Clock should be running

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x1601a0d60a0, name="clock_main") at 0x0000016049D0AA80>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x1601a0d60a0, name="clock_main") at 0x0000016049D0AA80> = <rendering.display_widget.DisplayWidget(0x1601a0d6460) at 0x0000016049E8D940>.clock_widget

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

___ TestClockIntegrationRegression.test_clock_widget_visibility_after_setup ___

tests\test_clock_integration_regression.py:245: in test_clock_widget_visibility_after_setup

    assert display_widget.clock_widget._enabled, "Clock should be running after setup"

E   AssertionError: Clock should be running after setup

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x16019ddc170, name="clock_main") at 0x0000016049D6A100>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x16019ddc170, name="clock_main") at 0x0000016049D6A100> = <rendering.display_widget.DisplayWidget(0x1601a0d5d40) at 0x0000016049ED8980>.clock_widget

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

___ TestClockIntegrationRegression.test_clock_settings_complete_integration ___

tests\test_clock_integration_regression.py:297: in test_clock_settings_complete_integration

    assert display_widget.clock_widget._enabled, "Clock should be running"

E   AssertionError: Clock should be running

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x16019de01f0, name="clock_main") at 0x0000016049BB9B40>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x16019de01f0, name="clock_main") at 0x0000016049BB9B40> = <rendering.display_widget.DisplayWidget(0x16019ddd7f0) at 0x0000016049CF9E00>.clock_widget

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

____________________________ test_clock_start_stop ____________________________

tests\test_clock_widget.py:67: in test_clock_start_stop

    assert clock.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.clock_widget.ClockWidget(0x16019ddfe30, name="clock_main") at 0x0000016049E2D6C0>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_____________________________ test_clock_signals ______________________________

tests\test_clock_widget.py:87: in test_clock_signals

    assert len(time_updates) >= 1

E   assert 0 >= 1

E    +  where 0 = len([])

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

____________________________ test_clock_12h_format ____________________________

tests\test_clock_widget.py:104: in test_clock_12h_format

    assert 'AM' in text or 'PM' in text

E   AssertionError: assert ('AM' in '' or 'PM' in '')

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

____________________________ test_clock_24h_format ____________________________

tests\test_clock_widget.py:126: in test_clock_24h_format

    assert ':' in text

E   AssertionError: assert ':' in ''

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_________________________ test_clock_without_seconds __________________________

tests\test_clock_widget.py:142: in test_clock_without_seconds

    assert text.count(':') == 1

E   AssertionError: assert 0 == 1

E    +  where 0 = <built-in method count of str object at 0x00007FFFCD91C6E0>(':')

E    +    where <built-in method count of str object at 0x00007FFFCD91C6E0> = ''.count

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

___________________________ test_clock_with_seconds ___________________________

tests\test_clock_widget.py:158: in test_clock_with_seconds

    assert text.count(':') == 2

E   AssertionError: assert 0 == 2

E    +  where 0 = <built-in method count of str object at 0x00007FFFCD91C6E0>(':')

E    +    where <built-in method count of str object at 0x00007FFFCD91C6E0> = ''.count

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_________________________ test_clock_set_time_format __________________________

tests\test_clock_widget.py:177: in test_clock_set_time_format

    assert 'AM' in text or 'PM' in text

E   AssertionError: assert ('AM' in '' or 'PM' in '')

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_________________________ test_clock_set_show_seconds _________________________

tests\test_clock_widget.py:187: in test_clock_set_show_seconds

    assert clock.text().count(':') == 2

E   assert 0 == 2

E    +  where 0 = <built-in method count of str object at 0x00007FFFCD91C6E0>(':')

E    +    where <built-in method count of str object at 0x00007FFFCD91C6E0> = ''.count

E    +      where '' = <built-in method text of ClockWidget object at 0x0000016049CCC1C0>()

E    +        where <built-in method text of ClockWidget object at 0x0000016049CCC1C0> = <widgets.clock_widget.ClockWidget(0x16019dd9ad0, name="clock_main") at 0x0000016049CCC1C0>.text

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

__________________________ test_clock_all_positions ___________________________

tests\test_clock_widget.py:220: in test_clock_all_positions

    assert clock.isVisible() is True

E   assert False is True

E    +  where False = <built-in method isVisible of ClockWidget object at 0x0000016049E1C780>()

E    +    where <built-in method isVisible of ClockWidget object at 0x0000016049E1C780> = <widgets.clock_widget.ClockWidget(0x16019dda9d0, name="clock_main") at 0x0000016049E1C780>.isVisible

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

___________________________ test_clock_set_position ___________________________

tests\test_clock_widget.py:236: in test_clock_set_position

    assert (new_x, new_y) != (old_x, old_y)

E   assert (0, 0) != (0, 0)

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_____________________________ test_clock_cleanup ______________________________

tests\test_clock_widget.py:280: in test_clock_cleanup

    assert clock.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.clock_widget.ClockWidget(0x16019dde2d0, name="clock_main") at 0x0000016049CEE3C0>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

___________________ test_clock_concurrent_start_prevention ____________________

tests\test_clock_widget.py:292: in test_clock_concurrent_start_prevention

    assert clock.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.clock_widget.ClockWidget(0x16019ddddf0, name="clock_main") at 0x0000016049A8F880>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

________________________ test_clock_updates_over_time _________________________

tests\test_clock_widget.py:314: in test_clock_updates_over_time

    assert len(time_updates) >= 2

E   assert 0 >= 2

E    +  where 0 = len([])

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

___________ test_ctrl_halo_suppressed_while_settings_dialog_active ____________

tests\test_ctrl_interaction_mode.py:510: in test_ctrl_halo_suppressed_while_settings_dialog_active

    _wait_for_halo_visible(qtbot, widget)

tests\test_ctrl_interaction_mode.py:63: in _wait_for_halo_visible

    qtbot.waitUntil(_is_visible, timeout=timeout)

E   pytestqt.exceptions.TimeoutError: waitUntil timed out in 2000 milliseconds

__________ TestTransitionTelemetryFlow.test_transition_tracks_timing __________

tests\test_flicker_fix_integration.py:84: in test_transition_tracks_timing

    assert trans._start_time is not None

E   assert None is not None

E    +  where None = GLCompositorCrossfadeTransition(duration=100ms, state=finished)._start_time

------------------------------ Captured log call ------------------------------

WARNING  transitions.gl_compositor_crossfade_transition:gl_compositor_crossfade_transition.py:62 [GL COMPOSITOR] No compositor attached to widget; falling back to immediate display

____________ test_gl_compositor_blockspin_no_underlay_and_no_black ____________

tests\test_gl_compositor_blockspin.py:98: in test_gl_compositor_blockspin_no_underlay_and_no_black

    assert (

E   AssertionError: GL compositor block spins produced blank/very dark frame (84.92%)

E   assert 0.8491950757575758 < 0.7

_________________________ test_engine_rotation_timer __________________________

tests\test_integration.py:136: in test_engine_rotation_timer

    assert engine._rotation_timer.isActive() is False

E   assert True is False

E    +  where True = <built-in method isActive of PySide6.QtCore.QTimer object at 0x000001604C3DA340>()

E    +    where <built-in method isActive of PySide6.QtCore.QTimer object at 0x000001604C3DA340> = <PySide6.QtCore.QTimer(0x1604a981510) at 0x000001604C3DA340>.isActive

E    +      where <PySide6.QtCore.QTimer(0x1604a981510) at 0x000001604C3DA340> = <engine.screensaver_engine.ScreensaverEngine(0x16063756320) at 0x000001601409CF80>._rotation_timer

---------------------------- Captured log teardown ----------------------------

WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 298.64ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 63.64ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 64.14ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 65.64ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 65.64ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28433.74ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28433.23ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28432.44ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28432.44ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28721.07ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28736.58ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28736.08ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28738.07ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28737.56ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28737.06ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28737.57ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28737.07ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28737.07ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28737.07ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


_ TestDisplayWidgetOverlayDiagnostics.test_handle_screen_change_updates_geometry_and_dpi _

tests\test_overlay_ready_state.py:127: in test_handle_screen_change_updates_geometry_and_dpi

    assert widget.width() == 640 and widget.height() == 360

E   assert (640 == 640 and 359 == 360)

E    +  where 640 = <built-in method width of DisplayWidget object at 0x000001600249C240>()

E    +    where <built-in method width of DisplayWidget object at 0x000001600249C240> = <rendering.display_widget.DisplayWidget(0x160db4e7e70) at 0x000001600249C240>.width

E    +  and   359 = <built-in method height of DisplayWidget object at 0x000001600249C240>()

E    +    where <built-in method height of DisplayWidget object at 0x000001600249C240> = <rendering.display_widget.DisplayWidget(0x160db4e7e70) at 0x000001600249C240>.height

_____________ TestShadowConfig.test_from_settings_enabled_string ______________

tests\test_painter_shadow.py:62: in test_from_settings_enabled_string

    assert config.enabled is False

E   assert True is False

E    +  where True = ShadowConfig(enabled=True, blur_radius=18, offset_x=4, offset_y=4, color=PySide6.QtGui.QColor.fromRgbF(0.000000, 0.000000, 0.000000, 0.705882), opacity=1.0).enabled

__________ TestParticleTransition.test_particle_transition_creation ___________

tests\test_particle_transition.py:134: in test_particle_transition_creation

    transition = GLCompositorParticleTransition(

E   TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

____________ TestParticleTransition.test_particle_transition_modes ____________

tests\test_particle_transition.py:148: in test_particle_transition_modes

    transition = GLCompositorParticleTransition(

E   TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

_________ TestParticleTransition.test_particle_transition_directions __________

tests\test_particle_transition.py:162: in test_particle_transition_directions

    transition = GLCompositorParticleTransition(

E   TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

________ TestParticleTransition.test_particle_transition_swirl_orders _________

tests\test_particle_transition.py:176: in test_particle_transition_swirl_orders

    transition = GLCompositorParticleTransition(

E   TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

______ TestSettingsDefaults.test_settings_manager_has_particle_defaults _______

tests\test_particle_transition.py:207: in test_settings_manager_has_particle_defaults

    assert particle.get('swirl_order') == 2  # Edges Inward

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   AssertionError: assert 0 == 2

E    +  where 0 = <built-in method get of dict object at 0x000001605A384200>('swirl_order')

E    +    where <built-in method get of dict object at 0x000001605A384200> = {'direction': 'Left to Right', 'gloss_size': 72.0, 'light_direction': 0, 'mode': 'Converge', ...}.get

____________ TestPerfDtMax.test_visualizer_dt_max_with_transitions ____________

tests\test_perf_dt_max.py:243: in test_visualizer_dt_max_with_transitions

    assert vis_dt_max < self.VISUALIZER_DT_MAX_THRESHOLD_MS, (

E   AssertionError: Visualizer dt_max 134.95ms exceeds threshold 75.0ms

E   assert 134.9548999860417 < 75.0

E    +  where 75.0 = <tests.test_perf_dt_max.TestPerfDtMax object at 0x0000016049A54C90>.VISUALIZER_DT_MAX_THRESHOLD_MS

---------------------------- Captured stdout call -----------------------------


============================================================
VISUALIZER DT_MAX TEST RESULTS
============================================================

Visualizer: frames=313, avg_fps=38.2, dt_min=11.62ms, dt_max=134.95ms

Transition metrics:
  Slide_1: frames=60, avg_fps=40.2, dt_min=12.67ms, dt_max=31.86ms
  Slide_2: frames=59, avg_fps=39.9, dt_min=16.28ms, dt_max=31.68ms
  Slide_3: frames=58, avg_fps=37.3, dt_min=4.38ms, dt_max=119.79ms
  Slide_4: frames=55, avg_fps=37.1, dt_min=16.41ms, dt_max=134.44ms
  Slide_5: frames=59, avg_fps=40.0, dt_min=18.88ms, dt_max=31.72ms

--- SUMMARY ---
Visualizer dt_max: 134.95ms (threshold: 75.0ms)
Transition dt_max: 134.44ms (threshold: 100.0ms)


------------------------------ Captured log call ------------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


________________ TestPerfDtMax.test_sustained_visualizer_load _________________

tests\test_perf_dt_max.py:349: in test_sustained_visualizer_load

    assert median_dt_max < self.VISUALIZER_DT_MAX_THRESHOLD_MS, (

E   AssertionError: Median dt_max 247.26ms exceeds threshold 75.0ms

E   assert 247.26110001211055 < 75.0

E    +  where 75.0 = <tests.test_perf_dt_max.TestPerfDtMax object at 0x0000016049A554D0>.VISUALIZER_DT_MAX_THRESHOLD_MS

---------------------------- Captured stdout call -----------------------------


============================================================
SUSTAINED LOAD TEST RESULTS
============================================================
  Window_1: frames=163, avg_fps=62.5, dt_min=11.13ms, dt_max=21.19ms
  Window_2: frames=135, avg_fps=52.7, dt_min=11.79ms, dt_max=307.76ms
  Window_3: frames=155, avg_fps=59.1, dt_min=14.98ms, dt_max=152.63ms
  Window_4: frames=148, avg_fps=56.7, dt_min=14.95ms, dt_max=247.26ms
  Window_5: frames=126, avg_fps=48.6, dt_min=11.44ms, dt_max=291.92ms
  Window_6: frames=165, avg_fps=62.5, dt_min=15.00ms, dt_max=17.05ms

--- DEGRADATION CHECK ---
First half avg dt_max: 160.53ms
Second half avg dt_max: 185.41ms
Degradation: +24.88ms
Max dt_max: 307.76ms
Median dt_max: 247.26ms


------------------------------ Captured log call ------------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


_____________ test_overlay_timer_stop_is_safe_from_other_threads ______________

tests\test_qt_timer_threading.py:45: in test_overlay_timer_stop_is_safe_from_other_threads

    handle = create_overlay_timer(widget, 10, _cb, description="cross-thread-stop-test")

             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

widgets\overlay_timers.py:137: in create_overlay_timer

    raise RuntimeError(

E   RuntimeError: [OVERLAY_TIMER] ThreadManager unavailable for widget <tests.test_qt_timer_threading._DummyWidget(0x1604ff06530) at 0x000001605A3A6DC0>. All overlay timers must be scheduled via ThreadManager.

________________________ test_settings_dialog_has_tabs ________________________

tests\test_settings_dialog.py:102: in test_settings_dialog_has_tabs

    assert len(dialog.tab_buttons) == 5

E   assert 6 == 5

E    +  where 6 = len([<ui.settings_dialog.TabButton(0x1604b4579c0, name="tabButton") at 0x0000016053CF8540>, <ui.settings_dialog.TabButton(0x1604b457cd0, name="tabButton") at 0x0000016053CF8140>, <ui.settings_dialog.TabButton(0x1604b458c90, name="tabButton") at 0x0000016053CF8080>, <ui.settings_dialog.TabButton(0x1604b457a30, name="tabButton") at 0x0000016053CF8EC0>, <ui.settings_dialog.TabButton(0x1604b458b40, name="tabButton") at 0x0000016053CF8E80>, <ui.settings_dialog.TabButton(0x1604b457b10, name="tabButton") at 0x0000016053CF8E40>])

E    +    where [<ui.settings_dialog.TabButton(0x1604b4579c0, name="tabButton") at 0x0000016053CF8540>, <ui.settings_dialog.TabButton(0x1604b457cd0, name="tabButton") at 0x0000016053CF8140>, <ui.settings_dialog.TabButton(0x1604b458c90, name="tabButton") at 0x0000016053CF8080>, <ui.settings_dialog.TabButton(0x1604b457a30, name="tabButton") at 0x0000016053CF8EC0>, <ui.settings_dialog.TabButton(0x1604b458b40, name="tabButton") at 0x0000016053CF8E80>, <ui.settings_dialog.TabButton(0x1604b457b10, name="tabButton") at 0x0000016053CF8E40>] = <ui.settings_dialog.SettingsDialog(0x160632f0620) at 0x000001605085A580>.tab_buttons

---------------------------- Captured log teardown ----------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down

___________________ test_settings_dialog_has_content_stack ____________________

tests\test_settings_dialog.py:110: in test_settings_dialog_has_content_stack

    assert dialog.content_stack.count() == 5

E   assert 6 == 5

E    +  where 6 = <built-in method count of PySide6.QtWidgets.QStackedWidget object at 0x0000016050733B40>()

E    +    where <built-in method count of PySide6.QtWidgets.QStackedWidget object at 0x0000016050733B40> = <PySide6.QtWidgets.QStackedWidget(0x1612bda60e0, name="contentArea") at 0x0000016050733B40>.count

E    +      where <PySide6.QtWidgets.QStackedWidget(0x1612bda60e0, name="contentArea") at 0x0000016050733B40> = <ui.settings_dialog.SettingsDialog(0x1612b961730) at 0x000001605A384600>.content_stack

---------------------------- Captured log teardown ----------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


_____________________ test_settings_dialog_tab_switching ______________________

tests\test_settings_dialog.py:142: in test_settings_dialog_tab_switching

    assert dialog.about_tab_btn.isChecked() is True

E   assert False is True

E    +  where False = <built-in method isChecked of TabButton object at 0x0000016057F45C80>()

E    +    where <built-in method isChecked of TabButton object at 0x0000016057F45C80> = <ui.settings_dialog.TabButton(0x16093ede710, name="tabButton") at 0x0000016057F45C80>.isChecked

E    +      where <ui.settings_dialog.TabButton(0x16093ede710, name="tabButton") at 0x0000016057F45C80> = <ui.settings_dialog.SettingsDialog(0x16093537290) at 0x0000016050859DC0>.about_tab_btn

____________ test_manual_floor_produces_higher_energy_than_dynamic ____________

tests\test_spotify_visualizer_widget.py:117: in test_manual_floor_produces_higher_energy_than_dynamic

    assert max(bars_manual) > max(bars_dynamic)

E   assert 0.0 > 0.0

E    +  where 0.0 = max([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...])

E    +  and   0.0 = max([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...])

_________________ test_sensitivity_config_affects_noise_floor _________________

tests\test_spotify_visualizer_widget.py:133: in test_sensitivity_config_affects_noise_floor

    assert max(bars_manual) > max(bars_rec)

E   assert 0.0 > 0.0

E    +  where 0.0 = max([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...])

E    +  and   0.0 = max([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...])

________________ test_spotify_visualizer_bars_not_stuck_at_top ________________

tests\test_spotify_visualizer_widget.py:209: in test_spotify_visualizer_bars_not_stuck_at_top

    assert cmax >= 0.25

E   assert 0.006115675903856754 >= 0.25

_______ test_spotify_visualizer_kick_emphasizes_center_more_than_vocals _______

tests\test_spotify_visualizer_widget.py:255: in test_spotify_visualizer_kick_emphasizes_center_more_than_vocals

    assert (center_kick - shoulder_kick) > (center_vocal - shoulder_vocal)

E   assert (0.03425298809694747 - 0.15720587968826294) > (0.005342443939298391 - 0.0235808826982975)

______ test_spotify_visualizer_media_update_zeroes_bars_when_not_playing ______

tests\test_spotify_visualizer_widget.py:348: in test_spotify_visualizer_media_update_zeroes_bars_when_not_playing

    assert all(value == 0.0 for value in vis._target_bars)  # type: ignore[attr-defined]

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   assert False

E    +  where False = all(<generator object test_spotify_visualizer_media_update_zeroes_bars_when_not_playing.<locals>.<genexpr> at 0x0000016059D79490>)

________ TestClockWidgetTimezone.test_clock_time_update_with_timezone _________

tests\test_timezone_support.py:220: in test_clock_time_update_with_timezone

    assert len(text) > 0

E   AssertionError: assert 0 > 0

E    +  where 0 = len('')

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_______ TestClockWidgetTimezone.test_clock_local_vs_utc_time_difference _______

tests\test_timezone_support.py:247: in test_clock_local_vs_utc_time_difference

    assert len(local_text) > 0

E   AssertionError: assert 0 > 0

E    +  where 0 = len('')

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.
ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.


_________ TestClockWidgetTimezone.test_clock_timezone_display_formats _________

tests\test_timezone_support.py:276: in test_clock_timezone_display_formats

    assert 'AM' in text_12h or 'PM' in text_12h

E   AssertionError: assert ('AM' in '' or 'PM' in '')

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

__________ TestTransitionIntegration.test_crossfade_transition_runs ___________

tests\test_transition_integration.py:135: in test_crossfade_transition_runs

    assert transition_finished['value'], "Crossfade transition should finish"

E   AssertionError: Crossfade transition should finish

E   assert False

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'


____________ TestTransitionIntegration.test_slide_transition_runs _____________

tests\test_transition_integration.py:171: in test_slide_transition_runs

    assert transition_finished['value'], "Slide transition should finish"

E   AssertionError: Slide transition should finish

E   assert False

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


___________ TestTransitionIntegration.test_diffuse_transition_runs ____________

tests\test_transition_integration.py:197: in test_diffuse_transition_runs

    assert transition_finished['value'], "Diffuse transition should finish"

E   AssertionError: Diffuse transition should finish

E   assert False

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'


______ TestTransitionIntegration.test_block_puzzle_flip_transition_runs _______

tests\test_transition_integration.py:224: in test_block_puzzle_flip_transition_runs

    assert transition_finished['value'], "Block puzzle flip transition should finish"

E   AssertionError: Block puzzle flip transition should finish

E   assert False

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'


_____________ TestTransitionIntegration.test_wipe_transition_runs _____________

tests\test_transition_integration.py:249: in test_wipe_transition_runs

    assert transition_finished['value'], "Wipe transition should finish"

E   AssertionError: Wipe transition should finish

E   assert False

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


________ TestTransitionIntegration.test_transition_settings_respected _________

tests\test_transition_integration.py:290: in test_transition_settings_respected

    assert current.duration_ms == 750

E   assert 5032 == 750

E    +  where 5032 = GLCompositorSlideTransition(duration=5032ms, state=running).duration_ms

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'


_ TestTransitionIntegration.test_diffuse_transition_software_backend_no_watchdog _

tests\test_transition_integration.py:350: in test_diffuse_transition_software_backend_no_watchdog

    original_timeout = widget._on_transition_watchdog_timeout

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   AttributeError: 'DisplayWidget' object has no attribute '_on_transition_watchdog_timeout'

_ TestTransitionIntegration.test_block_flip_transition_software_backend_no_watchdog _

tests\test_transition_integration.py:396: in test_block_flip_transition_software_backend_no_watchdog

    original_timeout = widget._on_transition_watchdog_timeout

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   AttributeError: 'DisplayWidget' object has no attribute '_on_transition_watchdog_timeout'

_________________ TestBaseTelemetry.test_mark_start_sets_time _________________

tests\test_transition_telemetry.py:62: in test_mark_start_sets_time

    assert trans._start_time is not None

E   assert None is not None

E    +  where None = CrossfadeTransition(duration=1000ms, state=idle)._start_time

__________________ TestBaseTelemetry.test_mark_end_sets_time __________________

tests\test_transition_telemetry.py:75: in test_mark_end_sets_time

    assert trans._end_time is not None

E   assert None is not None

E    +  where None = CrossfadeTransition(duration=1000ms, state=idle)._end_time

_______ TestBaseTelemetry.test_get_elapsed_ms_returns_time_after_start ________

tests\test_transition_telemetry.py:99: in test_get_elapsed_ms_returns_time_after_start

    assert elapsed is not None

E   assert None is not None

_______________ TestTelemetryLogging.test_mark_start_logs_debug _______________

tests\test_transition_telemetry.py:117: in test_mark_start_logs_debug

    assert len(perf_logs) > 0

E   assert 0 > 0

E    +  where 0 = len([])

_____________ TestTelemetryLogging.test_mark_end_logs_performance _____________

tests\test_transition_telemetry.py:132: in test_mark_end_logs_performance

    assert len(perf_logs) > 0

E   assert 0 > 0

E    +  where 0 = len([])

__________ TestTelemetryLogging.test_mark_end_warns_on_timing_drift ___________

tests\test_transition_telemetry.py:147: in test_mark_end_warns_on_timing_drift

    assert len(drift_logs) > 0

E   assert 0 > 0

E    +  where 0 = len([])

________ TestGLTransitionTelemetry.test_gl_crossfade_calls_mark_start _________

tests\test_transition_telemetry.py:164: in test_gl_crossfade_calls_mark_start

    assert trans._start_time is not None

E   assert None is not None

E    +  where None = GLCompositorCrossfadeTransition(duration=1000ms, state=finished)._start_time

------------------------------ Captured log call ------------------------------

WARNING  transitions.gl_compositor_crossfade_transition:gl_compositor_crossfade_transition.py:62 [GL COMPOSITOR] No compositor attached to widget; falling back to immediate display

___ TestGLTransitionTelemetry.test_gl_crossfade_calls_mark_end_on_complete ____

tests\test_transition_telemetry.py:179: in test_gl_crossfade_calls_mark_end_on_complete

    assert trans._end_time is not None

E   assert None is not None

E    +  where None = GLCompositorCrossfadeTransition(duration=100ms, state=finished)._end_time

------------------------------ Captured log call ------------------------------

WARNING  transitions.gl_compositor_crossfade_transition:gl_compositor_crossfade_transition.py:62 [GL COMPOSITOR] No compositor attached to widget; falling back to immediate display

______________ TestPerformanceMetrics.test_elapsed_time_accuracy ______________

tests\test_transition_telemetry.py:212: in test_elapsed_time_accuracy

    assert abs(elapsed - (sleep_time * 1000)) < 20

               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   TypeError: unsupported operand type(s) for -: 'NoneType' and 'float'

________________ TestPerformanceMetrics.test_delta_calculation ________________

tests\test_transition_telemetry.py:224: in test_delta_calculation

    delta = (trans._end_time - trans._start_time) * 1000 - trans.duration_ms

             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   TypeError: unsupported operand type(s) for -: 'NoneType' and 'NoneType'

___ TestVisualizerWidgetModes.test_set_visualization_mode_clears_particles ____

tests\test_visualizer_modes.py:94: in test_set_visualization_mode_clears_particles

    assert len(widget._abstract_particles) == 0

E   AssertionError: assert 1 == 0

E    +  where 1 = len([{'x': 0, 'y': 0}])

E    +    where [{'x': 0, 'y': 0}] = <widgets.spotify_visualizer_widget.SpotifyVisualizerWidget(0x160a9a86d00) at 0x0000016059D46B00>._abstract_particles

___________________________ test_weather_no_api_key ___________________________

tests\test_weather_widget.py:87: in test_weather_no_api_key

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x160a9a884a0) at 0x0000016050D57A00>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

______________________________ test_weather_stop ______________________________

tests\test_weather_widget.py:97: in test_weather_stop

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x160a9a86580) at 0x0000016050D54080>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

____________________________ test_weather_cleanup _____________________________

tests\test_weather_widget.py:236: in test_weather_cleanup

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x160a9a2b4e0) at 0x0000016050D4F4C0>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

__________________ test_weather_concurrent_start_prevention ___________________

tests\test_weather_widget.py:337: in test_weather_concurrent_start_prevention

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x160a9a241c0) at 0x0000016050D9AF00>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

____________ test_widgets_tab_changes_reflected_in_display_widget _____________

tests\test_widgets_persistence_integration.py:73: in test_widgets_tab_changes_reflected_in_display_widget

    assert widget.clock_widget._enabled is True

E   assert False is True

E    +  where False = <widgets.clock_widget.ClockWidget(0x160ba2a0460, name="clock_main") at 0x0000016050D27B00>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x160ba2a0460, name="clock_main") at 0x0000016050D27B00> = <rendering.display_widget.DisplayWidget(0x160ba2a0760) at 0x0000016050A2E380>.clock_widget

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.
ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.
ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for reddit during RedditWidget.start; timer-driven features disabled.


_______________ TestWidgetsTab.test_widgets_tab_default_values ________________

tests\test_widgets_tab.py:59: in test_widgets_tab_default_values

    assert tab.weather_show_forecast.isChecked() is False

E   assert True is False

E    +  where True = <built-in method isChecked of PySide6.QtWidgets.QCheckBox object at 0x0000016050ADE9C0>()

E    +    where <built-in method isChecked of PySide6.QtWidgets.QCheckBox object at 0x0000016050ADE9C0> = <PySide6.QtWidgets.QCheckBox(0x160ecea5df0) at 0x0000016050ADE9C0>.isChecked

E    +      where <PySide6.QtWidgets.QCheckBox(0x160ecea5df0) at 0x0000016050ADE9C0> = <ui.tabs.widgets_tab.WidgetsTab(0x160baa68430) at 0x0000016050AC6840>.weather_show_forecast

============================== warnings summary ===============================

core\windows\reddit_helper_installer.py:1

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\core\windows\reddit_helper_installer.py:1: DeprecationWarning: invalid escape sequence '\S'
    """




tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets
tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\input_handler.py:631: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    pos = event.pos()




tests/test_ctrl_interaction_mode.py: 3 warnings
tests/test_integration.py: 31 warnings
tests/test_media_widget.py: 20 warnings
tests/test_s_hotkey_workflow.py: 4 warnings


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2600: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    event.pos(), getattr(self, "spotify_volume_widget", None)




tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2580: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    logger.info(f"Mouse clicked at ({event.pos().x()}, {event.pos().y()}), requesting exit")




tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_scrollwheel_volume.py::test_input_handler_route_wheel_uses_local_coordinates
tests/test_startup_black_flash.py::test_startup_no_base_black_fallback_software
tests/test_startup_black_flash.py::test_startup_no_base_black_fallback_opengl


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2609: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    self._initial_mouse_pos = event.pos()




tests/test_ctrl_interaction_mode.py: 5 warnings
tests/test_scrollwheel_volume.py: 3 warnings
tests/test_startup_black_flash.py: 468 warnings


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2614: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dx = event.pos().x() - self._initial_mouse_pos.x()




tests/test_ctrl_interaction_mode.py: 5 warnings
tests/test_scrollwheel_volume.py: 3 warnings
tests/test_startup_black_flash.py: 468 warnings


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2615: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dy = event.pos().y() - self._initial_mouse_pos.y()




tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_ctrl_interaction_mode.py:346: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_media_widget.py:469: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_media_widget.py:539: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

=========================== short test summary info ===========================

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug3_color_array_to_qcolor_conversion

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug4_z_order_clock_on_top

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug9_missing_raise_call

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_visibility_after_setup

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_settings_complete_integration

FAILED tests/test_clock_widget.py::test_clock_start_stop - assert False is True

FAILED tests/test_clock_widget.py::test_clock_signals - assert 0 >= 1

FAILED tests/test_clock_widget.py::test_clock_12h_format - AssertionError: as...

FAILED tests/test_clock_widget.py::test_clock_24h_format - AssertionError: as...

FAILED tests/test_clock_widget.py::test_clock_without_seconds - AssertionErro...

FAILED tests/test_clock_widget.py::test_clock_with_seconds - AssertionError: ...

FAILED tests/test_clock_widget.py::test_clock_set_time_format - AssertionErro...

FAILED tests/test_clock_widget.py::test_clock_set_show_seconds - assert 0 == 2

FAILED tests/test_clock_widget.py::test_clock_all_positions - assert False is...

FAILED tests/test_clock_widget.py::test_clock_set_position - assert (0, 0) !=...

FAILED tests/test_clock_widget.py::test_clock_cleanup - assert False is True

FAILED tests/test_clock_widget.py::test_clock_concurrent_start_prevention - a...

FAILED tests/test_clock_widget.py::test_clock_updates_over_time - assert 0 >= 2

FAILED tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active

FAILED tests/test_flicker_fix_integration.py::TestTransitionTelemetryFlow::test_transition_tracks_timing

FAILED tests/test_gl_compositor_blockspin.py::test_gl_compositor_blockspin_no_underlay_and_no_black

FAILED tests/test_integration.py::test_engine_rotation_timer - assert True is...

FAILED tests/test_overlay_ready_state.py::TestDisplayWidgetOverlayDiagnostics::test_handle_screen_change_updates_geometry_and_dpi

FAILED tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_creation

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_modes

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_directions

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_swirl_orders

FAILED tests/test_particle_transition.py::TestSettingsDefaults::test_settings_manager_has_particle_defaults

FAILED tests/test_perf_dt_max.py::TestPerfDtMax::test_visualizer_dt_max_with_transitions

FAILED tests/test_perf_dt_max.py::TestPerfDtMax::test_sustained_visualizer_load

FAILED tests/test_qt_timer_threading.py::test_overlay_timer_stop_is_safe_from_other_threads

FAILED tests/test_settings_dialog.py::test_settings_dialog_has_tabs - assert ...

FAILED tests/test_settings_dialog.py::test_settings_dialog_has_content_stack

FAILED tests/test_settings_dialog.py::test_settings_dialog_tab_switching - as...

FAILED tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic

FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_media_update_zeroes_bars_when_not_playing

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_time_update_with_timezone

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_local_vs_utc_time_difference

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_timezone_display_formats

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_crossfade_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_slide_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_block_puzzle_flip_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_wipe_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_transition_settings_respected

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_software_backend_no_watchdog

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_block_flip_transition_software_backend_no_watchdog

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_start_sets_time

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_end_sets_time

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_get_elapsed_ms_returns_time_after_start

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_start_logs_debug

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_logs_performance

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_warns_on_timing_drift

FAILED tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_start

FAILED tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_end_on_complete

FAILED tests/test_transition_telemetry.py::TestPerformanceMetrics::test_elapsed_time_accuracy

FAILED tests/test_transition_telemetry.py::TestPerformanceMetrics::test_delta_calculation

FAILED tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_particles

FAILED tests/test_weather_widget.py::test_weather_no_api_key - assert False i...

FAILED tests/test_weather_widget.py::test_weather_stop - assert False is True

FAILED tests/test_weather_widget.py::test_weather_cleanup - assert False is True

FAILED tests/test_weather_widget.py::test_weather_concurrent_start_prevention

FAILED tests/test_widgets_persistence_integration.py::test_widgets_tab_changes_reflected_in_display_widget

FAILED tests/test_widgets_tab.py::TestWidgetsTab::test_widgets_tab_default_values

==== 68 failed, 528 passed, 20 skipped, 1026 warnings in 460.93s (0:07:40) ====


===== pytest run 2025-12-28 21:41:41 args=['tests/', '--tb=short', '--ignore=tests/test_visualizer_distribution.py', '-q'] =====

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
F
.
.
.
.
F
F
.
F
.
.
.
F
F
F
F
F
F
F
F
F
F
.
.
.
F
F
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 32%]

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
s
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
s
s
s
s
s
.
s
s
.
.
.
.
.
.
.
.
.
F
F
F
F
.
F
.
F
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
s
s
s
.
.
.
.
.
.
.
.
. [ 64%]

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
s
s
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
F
.
F
.
.
.
.
.
.
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
F
.
.
F
F
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
F
.
F
.
.
.
.
.
.
F
F
F
F
F
.
F
.
.
F
F
.
F
F
.
F
F
F
F
F
F
.
F
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
s
s
s
.
.
.
.
.
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
F
F [ 96%]

.
.
.
.
.
.
.
.
.
F
.
.
.
.
.
.
F
.
.
F
.
.
F
.
                                                                                                                                                                             [100%]


================================================================================================ FAILURES =================================================================================================

________________________________________________________________ TestClockIntegrationRegression.test_bug3_color_array_to_qcolor_conversion ________________________________________________________________

tests\test_clock_integration_regression.py:97: in test_bug3_color_array_to_qcolor_conversion

    assert display_widget.clock_widget._enabled  # Clock should be running

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x21398da2350, name="clock_main") at 0x00000213CB80A340>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x21398da2350, name="clock_main") at 0x00000213CB80A340> = <rendering.display_widget.DisplayWidget(0x21398da62f0) at 0x00000213CB8D3240>.clock_widget

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

______________________________________________________________________ TestClockIntegrationRegression.test_bug4_z_order_clock_on_top ______________________________________________________________________

tests\test_clock_integration_regression.py:123: in test_bug4_z_order_clock_on_top

    assert display_widget.clock_widget._enabled  # Clock should be running

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x213ca211260, name="clock_main") at 0x00000213CB6B6440>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x213ca211260, name="clock_main") at 0x00000213CB6B6440> = <rendering.display_widget.DisplayWidget(0x21398600d40) at 0x00000213CB6A7E80>.clock_widget

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_______________________________________________________________________ TestClockIntegrationRegression.test_bug9_missing_raise_call _______________________________________________________________________

tests\test_clock_integration_regression.py:228: in test_bug9_missing_raise_call

    assert display_widget.clock_widget._enabled  # Clock should be running

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x2139a963720, name="clock_main") at 0x00000213CB7E1BC0>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x2139a963720, name="clock_main") at 0x00000213CB7E1BC0> = <rendering.display_widget.DisplayWidget(0x2139a966000) at 0x00000213CB44DF40>.clock_widget

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_________________________________________________________________ TestClockIntegrationRegression.test_clock_widget_visibility_after_setup _________________________________________________________________

tests\test_clock_integration_regression.py:245: in test_clock_widget_visibility_after_setup

    assert display_widget.clock_widget._enabled, "Clock should be running after setup"

E   AssertionError: Clock should be running after setup

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x2139a965640, name="clock_main") at 0x00000213CB8085C0>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x2139a965640, name="clock_main") at 0x00000213CB8085C0> = <rendering.display_widget.DisplayWidget(0x2139a963ba0) at 0x00000213CB2736C0>.clock_widget

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_________________________________________________________________ TestClockIntegrationRegression.test_clock_settings_complete_integration _________________________________________________________________

tests\test_clock_integration_regression.py:297: in test_clock_settings_complete_integration

    assert display_widget.clock_widget._enabled, "Clock should be running"

E   AssertionError: Clock should be running

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x2139a980320, name="clock_main") at 0x00000213CB879DC0>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x2139a980320, name="clock_main") at 0x00000213CB879DC0> = <rendering.display_widget.DisplayWidget(0x2139a97fba0) at 0x00000213CB7F33C0>.clock_widget

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

__________________________________________________________________________________________ test_clock_start_stop __________________________________________________________________________________________

tests\test_clock_widget.py:67: in test_clock_start_stop

    assert clock.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.clock_widget.ClockWidget(0x2139a981400, name="clock_main") at 0x00000213CB6C0AC0>.is_running

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

___________________________________________________________________________________________ test_clock_signals ____________________________________________________________________________________________

tests\test_clock_widget.py:87: in test_clock_signals

    assert len(time_updates) >= 1

E   assert 0 >= 1

E    +  where 0 = len([])

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

__________________________________________________________________________________________ test_clock_12h_format __________________________________________________________________________________________

tests\test_clock_widget.py:104: in test_clock_12h_format

    assert 'AM' in text or 'PM' in text

E   AssertionError: assert ('AM' in '' or 'PM' in '')

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

__________________________________________________________________________________________ test_clock_24h_format __________________________________________________________________________________________

tests\test_clock_widget.py:126: in test_clock_24h_format

    assert ':' in text

E   AssertionError: assert ':' in ''

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_______________________________________________________________________________________ test_clock_without_seconds ________________________________________________________________________________________

tests\test_clock_widget.py:142: in test_clock_without_seconds

    assert text.count(':') == 1

E   AssertionError: assert 0 == 1

E    +  where 0 = <built-in method count of str object at 0x00007FFFCD91C6E0>(':')

E    +    where <built-in method count of str object at 0x00007FFFCD91C6E0> = ''.count

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_________________________________________________________________________________________ test_clock_with_seconds _________________________________________________________________________________________

tests\test_clock_widget.py:158: in test_clock_with_seconds

    assert text.count(':') == 2

E   AssertionError: assert 0 == 2

E    +  where 0 = <built-in method count of str object at 0x00007FFFCD91C6E0>(':')

E    +    where <built-in method count of str object at 0x00007FFFCD91C6E0> = ''.count

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_______________________________________________________________________________________ test_clock_set_time_format ________________________________________________________________________________________

tests\test_clock_widget.py:177: in test_clock_set_time_format

    assert 'AM' in text or 'PM' in text

E   AssertionError: assert ('AM' in '' or 'PM' in '')

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_______________________________________________________________________________________ test_clock_set_show_seconds _______________________________________________________________________________________

tests\test_clock_widget.py:187: in test_clock_set_show_seconds

    assert clock.text().count(':') == 2

E   assert 0 == 2

E    +  where 0 = <built-in method count of str object at 0x00007FFFCD91C6E0>(':')

E    +    where <built-in method count of str object at 0x00007FFFCD91C6E0> = ''.count

E    +      where '' = <built-in method text of ClockWidget object at 0x00000213CB1A0B00>()

E    +        where <built-in method text of ClockWidget object at 0x00000213CB1A0B00> = <widgets.clock_widget.ClockWidget(0x2139a97c540, name="clock_main") at 0x00000213CB1A0B00>.text

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

________________________________________________________________________________________ test_clock_all_positions _________________________________________________________________________________________

tests\test_clock_widget.py:220: in test_clock_all_positions

    assert clock.isVisible() is True

E   assert False is True

E    +  where False = <built-in method isVisible of ClockWidget object at 0x00000213CB80A8C0>()

E    +    where <built-in method isVisible of ClockWidget object at 0x00000213CB80A8C0> = <widgets.clock_widget.ClockWidget(0x2139a97d920, name="clock_main") at 0x00000213CB80A8C0>.isVisible

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_________________________________________________________________________________________ test_clock_set_position _________________________________________________________________________________________

tests\test_clock_widget.py:236: in test_clock_set_position

    assert (new_x, new_y) != (old_x, old_y)

E   assert (0, 0) != (0, 0)

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

___________________________________________________________________________________________ test_clock_cleanup ____________________________________________________________________________________________

tests\test_clock_widget.py:280: in test_clock_cleanup

    assert clock.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.clock_widget.ClockWidget(0x2139a9804a0, name="clock_main") at 0x00000213CB84EB40>.is_running

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_________________________________________________________________________________ test_clock_concurrent_start_prevention __________________________________________________________________________________

tests\test_clock_widget.py:292: in test_clock_concurrent_start_prevention

    assert clock.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.clock_widget.ClockWidget(0x2139a9800e0, name="clock_main") at 0x00000213CB6CECC0>.is_running

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

______________________________________________________________________________________ test_clock_updates_over_time _______________________________________________________________________________________

tests\test_clock_widget.py:314: in test_clock_updates_over_time

    assert len(time_updates) >= 2

E   assert 0 >= 2

E    +  where 0 = len([])

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

________________________________________________________________________ TestTransitionTelemetryFlow.test_transition_tracks_timing ________________________________________________________________________

tests\test_flicker_fix_integration.py:84: in test_transition_tracks_timing

    assert trans._start_time is not None

E   assert None is not None

E    +  where None = GLCompositorCrossfadeTransition(duration=100ms, state=finished)._start_time

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

WARNING  transitions.gl_compositor_crossfade_transition:gl_compositor_crossfade_transition.py:62 [GL COMPOSITOR] No compositor attached to widget; falling back to immediate display

__________________________________________________________________________ test_gl_compositor_blockspin_no_underlay_and_no_black __________________________________________________________________________

tests\test_gl_compositor_blockspin.py:98: in test_gl_compositor_blockspin_no_underlay_and_no_black

    assert (

E   AssertionError: GL compositor block spins produced blank/very dark frame (76.96%)

E   assert 0.7696496212121212 < 0.7

_______________________________________________________________________________________ test_engine_rotation_timer ________________________________________________________________________________________

tests\test_integration.py:136: in test_engine_rotation_timer

    assert engine._rotation_timer.isActive() is False

E   assert True is False

E    +  where True = <built-in method isActive of PySide6.QtCore.QTimer object at 0x000002138ED07380>()

E    +    where <built-in method isActive of PySide6.QtCore.QTimer object at 0x000002138ED07380> = <PySide6.QtCore.QTimer(0x213cad174f0) at 0x000002138ED07380>.isActive

E    +      where <PySide6.QtCore.QTimer(0x213cad174f0) at 0x000002138ED07380> = <engine.screensaver_engine.ScreensaverEngine(0x213cfd520c0) at 0x0000021385F7A880>._rotation_timer

------------------------------------------------------------------------------------------ Captured log teardown ------------------------------------------------------------------------------------------

WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 294.74ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32633.75ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32632.22ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32634.75ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32636.77ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32733.33ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32733.83ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32732.80ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32733.30ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32733.30ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32733.30ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32733.80ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32733.24ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32733.74ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 32733.74ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


_________________________________________________________ TestDisplayWidgetOverlayDiagnostics.test_handle_screen_change_updates_geometry_and_dpi __________________________________________________________

tests\test_overlay_ready_state.py:127: in test_handle_screen_change_updates_geometry_and_dpi

    assert widget.width() == 640 and widget.height() == 360

E   assert (640 == 640 and 359 == 360)

E    +  where 640 = <built-in method width of DisplayWidget object at 0x00000213DA9FEC40>()

E    +    where <built-in method width of DisplayWidget object at 0x00000213DA9FEC40> = <rendering.display_widget.DisplayWidget(0x214587f5bf0) at 0x00000213DA9FEC40>.width

E    +  and   359 = <built-in method height of DisplayWidget object at 0x00000213DA9FEC40>()

E    +    where <built-in method height of DisplayWidget object at 0x00000213DA9FEC40> = <rendering.display_widget.DisplayWidget(0x214587f5bf0) at 0x00000213DA9FEC40>.height

___________________________________________________________________________ TestShadowConfig.test_from_settings_enabled_string ____________________________________________________________________________

tests\test_painter_shadow.py:62: in test_from_settings_enabled_string

    assert config.enabled is False

E   assert True is False

E    +  where True = ShadowConfig(enabled=True, blur_radius=18, offset_x=4, offset_y=4, color=PySide6.QtGui.QColor.fromRgbF(0.000000, 0.000000, 0.000000, 0.705882), opacity=1.0).enabled

________________________________________________________________________ TestParticleTransition.test_particle_transition_creation _________________________________________________________________________

tests\test_particle_transition.py:134: in test_particle_transition_creation

    transition = GLCompositorParticleTransition(

E   TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

__________________________________________________________________________ TestParticleTransition.test_particle_transition_modes __________________________________________________________________________

tests\test_particle_transition.py:148: in test_particle_transition_modes

    transition = GLCompositorParticleTransition(

E   TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

_______________________________________________________________________ TestParticleTransition.test_particle_transition_directions ________________________________________________________________________

tests\test_particle_transition.py:162: in test_particle_transition_directions

    transition = GLCompositorParticleTransition(

E   TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

______________________________________________________________________ TestParticleTransition.test_particle_transition_swirl_orders _______________________________________________________________________

tests\test_particle_transition.py:176: in test_particle_transition_swirl_orders

    transition = GLCompositorParticleTransition(

E   TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

____________________________________________________________________ TestSettingsDefaults.test_settings_manager_has_particle_defaults _____________________________________________________________________

tests\test_particle_transition.py:207: in test_settings_manager_has_particle_defaults

    assert particle.get('swirl_order') == 2  # Edges Inward

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   AssertionError: assert 0 == 2

E    +  where 0 = <built-in method get of dict object at 0x00000213DD01CDC0>('swirl_order')

E    +    where <built-in method get of dict object at 0x00000213DD01CDC0> = {'direction': 'Left to Right', 'gloss_size': 72.0, 'light_direction': 0, 'mode': 'Converge', ...}.get

__________________________________________________________________________ TestPerfDtMax.test_visualizer_dt_max_with_transitions __________________________________________________________________________

tests\test_perf_dt_max.py:243: in test_visualizer_dt_max_with_transitions

    assert vis_dt_max < self.VISUALIZER_DT_MAX_THRESHOLD_MS, (

E   AssertionError: Visualizer dt_max 490.31ms exceeds threshold 75.0ms

E   assert 490.30959999072365 < 75.0

E    +  where 75.0 = <tests.test_perf_dt_max.TestPerfDtMax object at 0x00000213CB1F6910>.VISUALIZER_DT_MAX_THRESHOLD_MS

------------------------------------------------------------------------------------------ Captured stdout call -------------------------------------------------------------------------------------------


============================================================
VISUALIZER DT_MAX TEST RESULTS
============================================================

Visualizer: frames=439, avg_fps=54.4, dt_min=11.24ms, dt_max=490.31ms

Transition metrics:
  Slide_1: frames=54, avg_fps=36.6, dt_min=4.60ms, dt_max=111.26ms
  Slide_2: frames=41, avg_fps=27.9, dt_min=15.87ms, dt_max=479.85ms
  Slide_3: frames=59, avg_fps=39.7, dt_min=5.31ms, dt_max=66.26ms
  Slide_4: frames=50, avg_fps=33.5, dt_min=8.57ms, dt_max=197.69ms
  Slide_5: frames=59, avg_fps=39.7, dt_min=14.61ms, dt_max=46.00ms

--- SUMMARY ---
Visualizer dt_max: 490.31ms (threshold: 75.0ms)
Transition dt_max: 479.85ms (threshold: 100.0ms)


-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


______________________________________________________________________________ TestPerfDtMax.test_sustained_visualizer_load _______________________________________________________________________________

tests\test_perf_dt_max.py:349: in test_sustained_visualizer_load

    assert median_dt_max < self.VISUALIZER_DT_MAX_THRESHOLD_MS, (

E   AssertionError: Median dt_max 218.27ms exceeds threshold 75.0ms

E   assert 218.26590001001023 < 75.0

E    +  where 75.0 = <tests.test_perf_dt_max.TestPerfDtMax object at 0x00000213CB1F50D0>.VISUALIZER_DT_MAX_THRESHOLD_MS

------------------------------------------------------------------------------------------ Captured stdout call -------------------------------------------------------------------------------------------


============================================================
SUSTAINED LOAD TEST RESULTS
============================================================
  Window_1: frames=99, avg_fps=45.5, dt_min=14.97ms, dt_max=461.75ms
  Window_2: frames=146, avg_fps=56.7, dt_min=15.05ms, dt_max=154.96ms
  Window_3: frames=148, avg_fps=56.7, dt_min=14.14ms, dt_max=139.29ms
  Window_4: frames=139, avg_fps=53.6, dt_min=13.75ms, dt_max=218.27ms
  Window_5: frames=148, avg_fps=50.3, dt_min=15.01ms, dt_max=424.35ms
  Window_6: frames=156, avg_fps=58.7, dt_min=14.94ms, dt_max=166.02ms

--- DEGRADATION CHECK ---
First half avg dt_max: 252.00ms
Second half avg dt_max: 269.55ms
Degradation: +17.55ms
Max dt_max: 461.75ms
Median dt_max: 218.27ms


-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


___________________________________________________________________________ test_overlay_timer_stop_is_safe_from_other_threads ____________________________________________________________________________

tests\test_qt_timer_threading.py:45: in test_overlay_timer_stop_is_safe_from_other_threads

    handle = create_overlay_timer(widget, 10, _cb, description="cross-thread-stop-test")

             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

widgets\overlay_timers.py:137: in create_overlay_timer

    raise RuntimeError(

E   RuntimeError: [OVERLAY_TIMER] ThreadManager unavailable for widget <tests.test_qt_timer_threading._DummyWidget(0x214289805f0) at 0x00000213DD080380>. All overlay timers must be scheduled via ThreadManager.

______________________________________________________________________________________ test_settings_dialog_has_tabs ______________________________________________________________________________________

tests\test_settings_dialog.py:102: in test_settings_dialog_has_tabs

    assert len(dialog.tab_buttons) == 5

E   assert 6 == 5

E    +  where 6 = len([<ui.settings_dialog.TabButton(0x213f0384cb0, name="tabButton") at 0x00000213D135D200>, <ui.settings_dialog.TabButton(...Button") at 0x00000213D99E9100>, <ui.settings_dialog.TabButton(0x213f0384b60, name="tabButton") at 0x00000213D99EB980>])

E    +    where [<ui.settings_dialog.TabButton(0x213f0384cb0, name="tabButton") at 0x00000213D135D200>, <ui.settings_dialog.TabButton(...Button") at 0x00000213D99E9100>, <ui.settings_dialog.TabButton(0x213f0384b60, name="tabButton") at 0x00000213D99EB980>] = <ui.settings_dialog.SettingsDialog(0x213f0371ae0) at 0x00000213D99DFD00>.tab_buttons

------------------------------------------------------------------------------------------ Captured log teardown ------------------------------------------------------------------------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


_________________________________________________________________________________ test_settings_dialog_has_content_stack __________________________________________________________________________________

tests\test_settings_dialog.py:110: in test_settings_dialog_has_content_stack

    assert dialog.content_stack.count() == 5

E   assert 6 == 5

E    +  where 6 = <built-in method count of PySide6.QtWidgets.QStackedWidget object at 0x00000213D995D680>()

E    +    where <built-in method count of PySide6.QtWidgets.QStackedWidget object at 0x00000213D995D680> = <PySide6.QtWidgets.QStackedWidget(0x21498f13950, name="contentArea") at 0x00000213D995D680>.count

E    +      where <PySide6.QtWidgets.QStackedWidget(0x21498f13950, name="contentArea") at 0x00000213D995D680> = <ui.settings_dialog.SettingsDialog(0x2142907be80) at 0x00000213D9A1C6C0>.content_stack

------------------------------------------------------------------------------------------ Captured log teardown ------------------------------------------------------------------------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down

___________________________________________________________________________________ test_settings_dialog_tab_switching ____________________________________________________________________________________

tests\test_settings_dialog.py:142: in test_settings_dialog_tab_switching

    assert dialog.about_tab_btn.isChecked() is True

E   assert False is True

E    +  where False = <built-in method isChecked of TabButton object at 0x00000213D0978F80>()

E    +    where <built-in method isChecked of TabButton object at 0x00000213D0978F80> = <ui.settings_dialog.TabButton(0x213f834d6d0, name="tabButton") at 0x00000213D0978F80>.isChecked

E    +      where <ui.settings_dialog.TabButton(0x213f834d6d0, name="tabButton") at 0x00000213D0978F80> = <ui.settings_dialog.SettingsDialog(0x213f82b8cf0) at 0x00000213D094A1C0>.about_tab_btn

------------------------------------------------------------------------------------------ Captured log teardown ------------------------------------------------------------------------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


____________________________________________________________________________ TestSlideJitter.test_slide_dt_max_under_threshold ____________________________________________________________________________

tests\test_slide_jitter.py:119: in test_slide_dt_max_under_threshold

    assert stats['max'] < 50.0, f"dt_max {stats['max']:.2f}ms exceeds 50ms threshold - UI thread blocking detected"

E   AssertionError: dt_max 180.17ms exceeds 50ms threshold - UI thread blocking detected

E   assert 180.17219999455847 < 50.0

------------------------------------------------------------------------------------------ Captured stdout call -------------------------------------------------------------------------------------------


Slide transition frame timing:
  Frames: 43
  dt_min: 17.14ms
  dt_max: 180.17ms
  dt_mean: 21.77ms


-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down

__________________________________________________________________________ test_manual_floor_produces_higher_energy_than_dynamic __________________________________________________________________________

tests\test_spotify_visualizer_widget.py:117: in test_manual_floor_produces_higher_energy_than_dynamic

    assert max(bars_manual) > max(bars_dynamic)

E   assert 0.0 > 0.0

E    +  where 0.0 = max([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...])

E    +  and   0.0 = max([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...])

_______________________________________________________________________________ test_sensitivity_config_affects_noise_floor _______________________________________________________________________________

tests\test_spotify_visualizer_widget.py:133: in test_sensitivity_config_affects_noise_floor

    assert max(bars_manual) > max(bars_rec)

E   assert 0.0 > 0.0

E    +  where 0.0 = max([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...])

E    +  and   0.0 = max([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...])

______________________________________________________________________________ test_spotify_visualizer_bars_not_stuck_at_top ______________________________________________________________________________

tests\test_spotify_visualizer_widget.py:209: in test_spotify_visualizer_bars_not_stuck_at_top

    assert cmax >= 0.25

E   assert 0.006115675903856754 >= 0.25

_____________________________________________________________________ test_spotify_visualizer_kick_emphasizes_center_more_than_vocals _____________________________________________________________________

tests\test_spotify_visualizer_widget.py:255: in test_spotify_visualizer_kick_emphasizes_center_more_than_vocals

    assert (center_kick - shoulder_kick) > (center_vocal - shoulder_vocal)

E   assert (0.03425298809694747 - 0.15720587968826294) > (0.005342443939298391 - 0.0235808826982975)

____________________________________________________________________ test_spotify_visualizer_media_update_zeroes_bars_when_not_playing ____________________________________________________________________

tests\test_spotify_visualizer_widget.py:348: in test_spotify_visualizer_media_update_zeroes_bars_when_not_playing

    assert all(value == 0.0 for value in vis._target_bars)  # type: ignore[attr-defined]

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   assert False

E    +  where False = all(<generator object test_spotify_visualizer_media_update_zeroes_bars_when_not_playing.<locals>.<genexpr> at 0x00000213D144B440>)

______________________________________________________________________ TestClockWidgetTimezone.test_clock_time_update_with_timezone _______________________________________________________________________

tests\test_timezone_support.py:220: in test_clock_time_update_with_timezone

    assert len(text) > 0

E   AssertionError: assert 0 > 0

E    +  where 0 = len('')

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_____________________________________________________________________ TestClockWidgetTimezone.test_clock_local_vs_utc_time_difference _____________________________________________________________________

tests\test_timezone_support.py:247: in test_clock_local_vs_utc_time_difference

    assert len(local_text) > 0

E   AssertionError: assert 0 > 0

E    +  where 0 = len('')

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.
ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.


_______________________________________________________________________ TestClockWidgetTimezone.test_clock_timezone_display_formats _______________________________________________________________________

tests\test_timezone_support.py:276: in test_clock_timezone_display_formats

    assert 'AM' in text_12h or 'PM' in text_12h

E   AssertionError: assert ('AM' in '' or 'PM' in '')

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

________________________________________________________________________ TestTransitionIntegration.test_crossfade_transition_runs _________________________________________________________________________

tests\test_transition_integration.py:135: in test_crossfade_transition_runs

    assert transition_finished['value'], "Crossfade transition should finish"

E   AssertionError: Crossfade transition should finish

E   assert False

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


__________________________________________________________________________ TestTransitionIntegration.test_slide_transition_runs ___________________________________________________________________________

tests\test_transition_integration.py:171: in test_slide_transition_runs

    assert transition_finished['value'], "Slide transition should finish"

E   AssertionError: Slide transition should finish

E   assert False

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


_________________________________________________________________________ TestTransitionIntegration.test_diffuse_transition_runs __________________________________________________________________________

tests\test_transition_integration.py:197: in test_diffuse_transition_runs

    assert transition_finished['value'], "Diffuse transition should finish"

E   AssertionError: Diffuse transition should finish

E   assert False

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


____________________________________________________________________ TestTransitionIntegration.test_block_puzzle_flip_transition_runs _____________________________________________________________________

tests\test_transition_integration.py:224: in test_block_puzzle_flip_transition_runs

    assert transition_finished['value'], "Block puzzle flip transition should finish"

E   AssertionError: Block puzzle flip transition should finish

E   assert False

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


___________________________________________________________________________ TestTransitionIntegration.test_wipe_transition_runs ___________________________________________________________________________

tests\test_transition_integration.py:249: in test_wipe_transition_runs

    assert transition_finished['value'], "Wipe transition should finish"

E   AssertionError: Wipe transition should finish

E   assert False

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


______________________________________________________________________ TestTransitionIntegration.test_transition_settings_respected _______________________________________________________________________

tests\test_transition_integration.py:290: in test_transition_settings_respected

    assert current.duration_ms == 750

E   assert 5032 == 750

E    +  where 5032 = GLCompositorSlideTransition(duration=5032ms, state=running).duration_ms

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'


_____________________________________________________________ TestTransitionIntegration.test_diffuse_transition_software_backend_no_watchdog ______________________________________________________________

tests\test_transition_integration.py:350: in test_diffuse_transition_software_backend_no_watchdog

    original_timeout = widget._on_transition_watchdog_timeout

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   AttributeError: 'DisplayWidget' object has no attribute '_on_transition_watchdog_timeout'

____________________________________________________________ TestTransitionIntegration.test_block_flip_transition_software_backend_no_watchdog ____________________________________________________________

tests\test_transition_integration.py:396: in test_block_flip_transition_software_backend_no_watchdog

    original_timeout = widget._on_transition_watchdog_timeout

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   AttributeError: 'DisplayWidget' object has no attribute '_on_transition_watchdog_timeout'

_______________________________________________________________________________ TestBaseTelemetry.test_mark_start_sets_time _______________________________________________________________________________

tests\test_transition_telemetry.py:62: in test_mark_start_sets_time

    assert trans._start_time is not None

E   assert None is not None

E    +  where None = CrossfadeTransition(duration=1000ms, state=idle)._start_time

________________________________________________________________________________ TestBaseTelemetry.test_mark_end_sets_time ________________________________________________________________________________

tests\test_transition_telemetry.py:75: in test_mark_end_sets_time

    assert trans._end_time is not None

E   assert None is not None

E    +  where None = CrossfadeTransition(duration=1000ms, state=idle)._end_time

_____________________________________________________________________ TestBaseTelemetry.test_get_elapsed_ms_returns_time_after_start ______________________________________________________________________

tests\test_transition_telemetry.py:99: in test_get_elapsed_ms_returns_time_after_start

    assert elapsed is not None

E   assert None is not None

_____________________________________________________________________________ TestTelemetryLogging.test_mark_start_logs_debug _____________________________________________________________________________

tests\test_transition_telemetry.py:117: in test_mark_start_logs_debug

    assert len(perf_logs) > 0

E   assert 0 > 0

E    +  where 0 = len([])

___________________________________________________________________________ TestTelemetryLogging.test_mark_end_logs_performance ___________________________________________________________________________

tests\test_transition_telemetry.py:132: in test_mark_end_logs_performance

    assert len(perf_logs) > 0

E   assert 0 > 0

E    +  where 0 = len([])

________________________________________________________________________ TestTelemetryLogging.test_mark_end_warns_on_timing_drift _________________________________________________________________________

tests\test_transition_telemetry.py:147: in test_mark_end_warns_on_timing_drift

    assert len(drift_logs) > 0

E   assert 0 > 0

E    +  where 0 = len([])

______________________________________________________________________ TestGLTransitionTelemetry.test_gl_crossfade_calls_mark_start _______________________________________________________________________

tests\test_transition_telemetry.py:164: in test_gl_crossfade_calls_mark_start

    assert trans._start_time is not None

E   assert None is not None

E    +  where None = GLCompositorCrossfadeTransition(duration=1000ms, state=finished)._start_time

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

WARNING  transitions.gl_compositor_crossfade_transition:gl_compositor_crossfade_transition.py:62 [GL COMPOSITOR] No compositor attached to widget; falling back to immediate display

_________________________________________________________________ TestGLTransitionTelemetry.test_gl_crossfade_calls_mark_end_on_complete __________________________________________________________________

tests\test_transition_telemetry.py:179: in test_gl_crossfade_calls_mark_end_on_complete

    assert trans._end_time is not None

E   assert None is not None

E    +  where None = GLCompositorCrossfadeTransition(duration=100ms, state=finished)._end_time

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

WARNING  transitions.gl_compositor_crossfade_transition:gl_compositor_crossfade_transition.py:62 [GL COMPOSITOR] No compositor attached to widget; falling back to immediate display

____________________________________________________________________________ TestPerformanceMetrics.test_elapsed_time_accuracy ____________________________________________________________________________

tests\test_transition_telemetry.py:212: in test_elapsed_time_accuracy

    assert abs(elapsed - (sleep_time * 1000)) < 20

               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   TypeError: unsupported operand type(s) for -: 'NoneType' and 'float'

______________________________________________________________________________ TestPerformanceMetrics.test_delta_calculation ______________________________________________________________________________

tests\test_transition_telemetry.py:224: in test_delta_calculation

    delta = (trans._end_time - trans._start_time) * 1000 - trans.duration_ms

             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   TypeError: unsupported operand type(s) for -: 'NoneType' and 'NoneType'

_________________________________________________________________ TestVisualizerWidgetModes.test_set_visualization_mode_clears_particles __________________________________________________________________

tests\test_visualizer_modes.py:94: in test_set_visualization_mode_clears_particles

    assert len(widget._abstract_particles) == 0

E   AssertionError: assert 1 == 0

E    +  where 1 = len([{'x': 0, 'y': 0}])

E    +    where [{'x': 0, 'y': 0}] = <widgets.spotify_visualizer_widget.SpotifyVisualizerWidget(0x213cfdfcdc0) at 0x00000213D07F7500>._abstract_particles

_________________________________________________________________________________________ test_weather_no_api_key _________________________________________________________________________________________

tests\test_weather_widget.py:87: in test_weather_no_api_key

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x213cfdfcfa0) at 0x00000213D0800DC0>.is_running

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

____________________________________________________________________________________________ test_weather_stop ____________________________________________________________________________________________

tests\test_weather_widget.py:97: in test_weather_stop

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x213cfdfeec0) at 0x00000213D0805D40>.is_running

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

__________________________________________________________________________________________ test_weather_cleanup ___________________________________________________________________________________________

tests\test_weather_widget.py:236: in test_weather_cleanup

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x213cfe15840) at 0x00000213D0859040>.is_running

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

________________________________________________________________________________ test_weather_concurrent_start_prevention _________________________________________________________________________________

tests\test_weather_widget.py:337: in test_weather_concurrent_start_prevention

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x213cfe19d40) at 0x00000213D08505C0>.is_running

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

__________________________________________________________________________ test_widgets_tab_changes_reflected_in_display_widget ___________________________________________________________________________

tests\test_widgets_persistence_integration.py:73: in test_widgets_tab_changes_reflected_in_display_widget

    assert widget.clock_widget._enabled is True

E   assert False is True

E    +  where False = <widgets.clock_widget.ClockWidget(0x2143510c9f0, name="clock_main") at 0x00000213CD313440>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x2143510c9f0, name="clock_main") at 0x00000213CD313440> = <rendering.display_widget.DisplayWidget(0x2143510a410) at 0x00000213D07FD200>.clock_widget

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.
ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.
ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for reddit during RedditWidget.start; timer-driven features disabled.


_____________________________________________________________________________ TestWidgetsTab.test_widgets_tab_default_values ______________________________________________________________________________

tests\test_widgets_tab.py:59: in test_widgets_tab_default_values

    assert tab.weather_show_forecast.isChecked() is False

E   assert True is False

E    +  where True = <built-in method isChecked of PySide6.QtWidgets.QCheckBox object at 0x00000213D05FA280>()

E    +    where <built-in method isChecked of PySide6.QtWidgets.QCheckBox object at 0x00000213D05FA280> = <PySide6.QtWidgets.QCheckBox(0x21435c79580) at 0x00000213D05FA280>.isChecked

E    +      where <PySide6.QtWidgets.QCheckBox(0x21435c79580) at 0x00000213D05FA280> = <ui.tabs.widgets_tab.WidgetsTab(0x21435858490) at 0x00000213D05EEE80>.weather_show_forecast

============================================================================================ warnings summary =============================================================================================

core\windows\reddit_helper_installer.py:1

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\core\windows\reddit_helper_installer.py:1: DeprecationWarning: invalid escape sequence '\S'
    """




tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets
tests/test_integration.py::test_engine_initialization
tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\input_handler.py:631: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    pos = event.pos()




tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2580: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    logger.info(f"Mouse clicked at ({event.pos().x()}, {event.pos().y()}), requesting exit")




tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_ctrl_interaction_mode.py:346: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




tests/test_ctrl_interaction_mode.py: 2 warnings
tests/test_integration.py: 7 warnings
tests/test_s_hotkey_workflow.py: 7 warnings


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2600: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    event.pos(), getattr(self, "spotify_volume_widget", None)




tests/test_gl_prewarm.py::test_gl_prewarm_overlays_ready

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2609: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    self._initial_mouse_pos = event.pos()




tests/test_gl_prewarm.py: 277 warnings

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2614: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dx = event.pos().x() - self._initial_mouse_pos.x()




tests/test_gl_prewarm.py: 277 warnings

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2615: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dy = event.pos().y() - self._initial_mouse_pos.y()




tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_media_widget.py:469: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_media_widget.py:539: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug3_color_array_to_qcolor_conversion - assert False

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug4_z_order_clock_on_top - assert False

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug9_missing_raise_call - assert False

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_visibility_after_setup - AssertionError: Clock should be running after setup

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_settings_complete_integration - AssertionError: Clock should be running

FAILED tests/test_clock_widget.py::test_clock_start_stop - assert False is True

FAILED tests/test_clock_widget.py::test_clock_signals - assert 0 >= 1

FAILED tests/test_clock_widget.py::test_clock_12h_format - AssertionError: assert ('AM' in '' or 'PM' in '')

FAILED tests/test_clock_widget.py::test_clock_24h_format - AssertionError: assert ':' in ''

FAILED tests/test_clock_widget.py::test_clock_without_seconds - AssertionError: assert 0 == 1

FAILED tests/test_clock_widget.py::test_clock_with_seconds - AssertionError: assert 0 == 2

FAILED tests/test_clock_widget.py::test_clock_set_time_format - AssertionError: assert ('AM' in '' or 'PM' in '')

FAILED tests/test_clock_widget.py::test_clock_set_show_seconds - assert 0 == 2

FAILED tests/test_clock_widget.py::test_clock_all_positions - assert False is True

FAILED tests/test_clock_widget.py::test_clock_set_position - assert (0, 0) != (0, 0)

FAILED tests/test_clock_widget.py::test_clock_cleanup - assert False is True

FAILED tests/test_clock_widget.py::test_clock_concurrent_start_prevention - assert False is True

FAILED tests/test_clock_widget.py::test_clock_updates_over_time - assert 0 >= 2

FAILED tests/test_flicker_fix_integration.py::TestTransitionTelemetryFlow::test_transition_tracks_timing - assert None is not None

FAILED tests/test_gl_compositor_blockspin.py::test_gl_compositor_blockspin_no_underlay_and_no_black - AssertionError: GL compositor block spins produced blank/very dark frame (76.96%)

FAILED tests/test_integration.py::test_engine_rotation_timer - assert True is False

FAILED tests/test_overlay_ready_state.py::TestDisplayWidgetOverlayDiagnostics::test_handle_screen_change_updates_geometry_and_dpi - assert (640 == 640 and 359 == 360)

FAILED tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string - assert True is False

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_creation - TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_modes - TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_directions - TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_swirl_orders - TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compos...

FAILED tests/test_particle_transition.py::TestSettingsDefaults::test_settings_manager_has_particle_defaults - AssertionError: assert 0 == 2

FAILED tests/test_perf_dt_max.py::TestPerfDtMax::test_visualizer_dt_max_with_transitions - AssertionError: Visualizer dt_max 490.31ms exceeds threshold 75.0ms

FAILED tests/test_perf_dt_max.py::TestPerfDtMax::test_sustained_visualizer_load - AssertionError: Median dt_max 218.27ms exceeds threshold 75.0ms

FAILED tests/test_qt_timer_threading.py::test_overlay_timer_stop_is_safe_from_other_threads - RuntimeError: [OVERLAY_TIMER] ThreadManager unavailable for widget <tests.test_qt_timer_threading._DummyWid...

FAILED tests/test_settings_dialog.py::test_settings_dialog_has_tabs - assert 6 == 5

FAILED tests/test_settings_dialog.py::test_settings_dialog_has_content_stack - assert 6 == 5

FAILED tests/test_settings_dialog.py::test_settings_dialog_tab_switching - assert False is True

FAILED tests/test_slide_jitter.py::TestSlideJitter::test_slide_dt_max_under_threshold - AssertionError: dt_max 180.17ms exceeds 50ms threshold - UI thread blocking detected

FAILED tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic - assert 0.0 > 0.0

FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor - assert 0.0 > 0.0

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top - assert 0.006115675903856754 >= 0.25

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals - assert (0.03425298809694747 - 0.15720587968826294) > (0.005342443939298391 - 0.02358088...

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_media_update_zeroes_bars_when_not_playing - assert False

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_time_update_with_timezone - AssertionError: assert 0 > 0

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_local_vs_utc_time_difference - AssertionError: assert 0 > 0

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_timezone_display_formats - AssertionError: assert ('AM' in '' or 'PM' in '')

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_crossfade_transition_runs - AssertionError: Crossfade transition should finish

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_slide_transition_runs - AssertionError: Slide transition should finish

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_runs - AssertionError: Diffuse transition should finish

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_block_puzzle_flip_transition_runs - AssertionError: Block puzzle flip transition should finish

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_wipe_transition_runs - AssertionError: Wipe transition should finish

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_transition_settings_respected - assert 5032 == 750

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_software_backend_no_watchdog - AttributeError: 'DisplayWidget' object has no attribute '_on_transition_wa...

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_block_flip_transition_software_backend_no_watchdog - AttributeError: 'DisplayWidget' object has no attribute '_on_transition...

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_start_sets_time - assert None is not None

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_end_sets_time - assert None is not None

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_get_elapsed_ms_returns_time_after_start - assert None is not None

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_start_logs_debug - assert 0 > 0

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_logs_performance - assert 0 > 0

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_warns_on_timing_drift - assert 0 > 0

FAILED tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_start - assert None is not None

FAILED tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_end_on_complete - assert None is not None

FAILED tests/test_transition_telemetry.py::TestPerformanceMetrics::test_elapsed_time_accuracy - TypeError: unsupported operand type(s) for -: 'NoneType' and 'float'

FAILED tests/test_transition_telemetry.py::TestPerformanceMetrics::test_delta_calculation - TypeError: unsupported operand type(s) for -: 'NoneType' and 'NoneType'

FAILED tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_particles - AssertionError: assert 1 == 0

FAILED tests/test_weather_widget.py::test_weather_no_api_key - assert False is True

FAILED tests/test_weather_widget.py::test_weather_stop - assert False is True

FAILED tests/test_weather_widget.py::test_weather_cleanup - assert False is True

FAILED tests/test_weather_widget.py::test_weather_concurrent_start_prevention - assert False is True

FAILED tests/test_widgets_persistence_integration.py::test_widgets_tab_changes_reflected_in_display_widget - assert False is True

FAILED tests/test_widgets_tab.py::TestWidgetsTab::test_widgets_tab_default_values - assert True is False

68 failed, 528 passed, 20 skipped, 584 warnings in 489.20s (0:08:09)


===== pytest run 2025-12-28 21:49:59 args=['tests/', '--tb=short', '--ignore=tests/test_visualizer_distribution.py', '-q'] =====

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
F
.
.
.
.
F
F
.
F
.
.
.
F
F
F
F
F
F
F
F
F
F
.
.
.
F
F
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 11%]

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
. [ 23%]

.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 35%]

.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
s
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 47%]

.
.
.
.
.
F
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
s
s
s
s
s
.
s
s
.
.
.
.
.
.
.
.
.
F
F
F
F
.
F
.
F
F
.
.
.
.
.
.
.
.
.
.
.
. [ 58%]

.
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
s
s
s
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
s
s
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 70%]

.
.
.
.
.
.
.
.
F
F
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
F
.
.
F
F
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 82%]

.
.
.
.
.
.
.
F
F
.
F
.
.
.
.
.
.
F
F
F
F
F
.
F
.
.
F
F
.
F
F
.
F
F
F
F
F
F
.
F
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
s
s
s
.
.
.
.
.
.
.
.
.
.
. [ 94%]

F
.
.
.
.
.
.
.
.
.
F
F
.
.
.
.
.
.
.
.
.
F
.
.
.
.
.
.
F
.
.
F
.
.
F
.
                                     [100%]


================================== FAILURES ===================================

__ TestClockIntegrationRegression.test_bug3_color_array_to_qcolor_conversion __

tests\test_clock_integration_regression.py:97: in test_bug3_color_array_to_qcolor_conversion

    assert display_widget.clock_widget._enabled  # Clock should be running

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x1a791b3cfe0, name="clock_main") at 0x000001A7C1A59B40>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x1a791b3cfe0, name="clock_main") at 0x000001A7C1A59B40> = <rendering.display_widget.DisplayWidget(0x1a78f870b70) at 0x000001A7C1A59840>.clock_widget

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

________ TestClockIntegrationRegression.test_bug4_z_order_clock_on_top ________

tests\test_clock_integration_regression.py:123: in test_bug4_z_order_clock_on_top

    assert display_widget.clock_widget._enabled  # Clock should be running

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x1a791b3df40, name="clock_main") at 0x000001A7C15BE480>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x1a791b3df40, name="clock_main") at 0x000001A7C15BE480> = <rendering.display_widget.DisplayWidget(0x1a791b3e9c0) at 0x000001A7C1A931C0>.clock_widget

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_________ TestClockIntegrationRegression.test_bug9_missing_raise_call _________

tests\test_clock_integration_regression.py:228: in test_bug9_missing_raise_call

    assert display_widget.clock_widget._enabled  # Clock should be running

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x1a791d08170, name="clock_main") at 0x000001A7C15E1340>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x1a791d08170, name="clock_main") at 0x000001A7C15E1340> = <rendering.display_widget.DisplayWidget(0x1a791d0b3b0) at 0x000001A7C1974A80>.clock_widget

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

___ TestClockIntegrationRegression.test_clock_widget_visibility_after_setup ___

tests\test_clock_integration_regression.py:245: in test_clock_widget_visibility_after_setup

    assert display_widget.clock_widget._enabled, "Clock should be running after setup"

E   AssertionError: Clock should be running after setup

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x1a791d0a5d0, name="clock_main") at 0x000001A7C19C0080>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x1a791d0a5d0, name="clock_main") at 0x000001A7C19C0080> = <rendering.display_widget.DisplayWidget(0x1a791d08710) at 0x000001A7C1515240>.clock_widget

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

___ TestClockIntegrationRegression.test_clock_settings_complete_integration ___

tests\test_clock_integration_regression.py:297: in test_clock_settings_complete_integration

    assert display_widget.clock_widget._enabled, "Clock should be running"

E   AssertionError: Clock should be running

E   assert False

E    +  where False = <widgets.clock_widget.ClockWidget(0x1a7919cef20, name="clock_main") at 0x000001A7C1882BC0>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x1a7919cef20, name="clock_main") at 0x000001A7C1882BC0> = <rendering.display_widget.DisplayWidget(0x1a7919cf4c0) at 0x000001A7C14BAA00>.clock_widget

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

____________________________ test_clock_start_stop ____________________________

tests\test_clock_widget.py:67: in test_clock_start_stop

    assert clock.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.clock_widget.ClockWidget(0x1a7919d0720, name="clock_main") at 0x000001A7C18BF980>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_____________________________ test_clock_signals ______________________________

tests\test_clock_widget.py:87: in test_clock_signals

    assert len(time_updates) >= 1

E   assert 0 >= 1

E    +  where 0 = len([])

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

____________________________ test_clock_12h_format ____________________________

tests\test_clock_widget.py:104: in test_clock_12h_format

    assert 'AM' in text or 'PM' in text

E   AssertionError: assert ('AM' in '' or 'PM' in '')

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

____________________________ test_clock_24h_format ____________________________

tests\test_clock_widget.py:126: in test_clock_24h_format

    assert ':' in text

E   AssertionError: assert ':' in ''

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_________________________ test_clock_without_seconds __________________________

tests\test_clock_widget.py:142: in test_clock_without_seconds

    assert text.count(':') == 1

E   AssertionError: assert 0 == 1

E    +  where 0 = <built-in method count of str object at 0x00007FFFCD91C6E0>(':')

E    +    where <built-in method count of str object at 0x00007FFFCD91C6E0> = ''.count

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

___________________________ test_clock_with_seconds ___________________________

tests\test_clock_widget.py:158: in test_clock_with_seconds

    assert text.count(':') == 2

E   AssertionError: assert 0 == 2

E    +  where 0 = <built-in method count of str object at 0x00007FFFCD91C6E0>(':')

E    +    where <built-in method count of str object at 0x00007FFFCD91C6E0> = ''.count

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_________________________ test_clock_set_time_format __________________________

tests\test_clock_widget.py:177: in test_clock_set_time_format

    assert 'AM' in text or 'PM' in text

E   AssertionError: assert ('AM' in '' or 'PM' in '')

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_________________________ test_clock_set_show_seconds _________________________

tests\test_clock_widget.py:187: in test_clock_set_show_seconds

    assert clock.text().count(':') == 2

E   assert 0 == 2

E    +  where 0 = <built-in method count of str object at 0x00007FFFCD91C6E0>(':')

E    +    where <built-in method count of str object at 0x00007FFFCD91C6E0> = ''.count

E    +      where '' = <built-in method text of ClockWidget object at 0x000001A7C1A2F8C0>()

E    +        where <built-in method text of ClockWidget object at 0x000001A7C1A2F8C0> = <widgets.clock_widget.ClockWidget(0x1a7919d1e00, name="clock_main") at 0x000001A7C1A2F8C0>.text

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

__________________________ test_clock_all_positions ___________________________

tests\test_clock_widget.py:220: in test_clock_all_positions

    assert clock.isVisible() is True

E   assert False is True

E    +  where False = <built-in method isVisible of ClockWidget object at 0x000001A7C1AA3E00>()

E    +    where <built-in method isVisible of ClockWidget object at 0x000001A7C1AA3E00> = <widgets.clock_widget.ClockWidget(0x1a7919d38a0, name="clock_main") at 0x000001A7C1AA3E00>.isVisible

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

___________________________ test_clock_set_position ___________________________

tests\test_clock_widget.py:236: in test_clock_set_position

    assert (new_x, new_y) != (old_x, old_y)

E   assert (0, 0) != (0, 0)

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_____________________________ test_clock_cleanup ______________________________

tests\test_clock_widget.py:280: in test_clock_cleanup

    assert clock.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.clock_widget.ClockWidget(0x1a7919d5e80, name="clock_main") at 0x000001A7C1AC0AC0>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

___________________ test_clock_concurrent_start_prevention ____________________

tests\test_clock_widget.py:292: in test_clock_concurrent_start_prevention

    assert clock.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.clock_widget.ClockWidget(0x1a7919cf220, name="clock_main") at 0x000001A7C155A340>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

________________________ test_clock_updates_over_time _________________________

tests\test_clock_widget.py:314: in test_clock_updates_over_time

    assert len(time_updates) >= 2

E   assert 0 >= 2

E    +  where 0 = len([])

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

__________ TestTransitionTelemetryFlow.test_transition_tracks_timing __________

tests\test_flicker_fix_integration.py:84: in test_transition_tracks_timing

    assert trans._start_time is not None

E   assert None is not None

E    +  where None = GLCompositorCrossfadeTransition(duration=100ms, state=finished)._start_time

------------------------------ Captured log call ------------------------------

WARNING  transitions.gl_compositor_crossfade_transition:gl_compositor_crossfade_transition.py:62 [GL COMPOSITOR] No compositor attached to widget; falling back to immediate display

____________ test_gl_compositor_blockspin_no_underlay_and_no_black ____________

tests\test_gl_compositor_blockspin.py:98: in test_gl_compositor_blockspin_no_underlay_and_no_black

    assert (

E   AssertionError: GL compositor block spins produced blank/very dark frame (84.92%)

E   assert 0.8491950757575758 < 0.7

_________________________ test_engine_rotation_timer __________________________

tests\test_integration.py:136: in test_engine_rotation_timer

    assert engine._rotation_timer.isActive() is False

E   assert True is False

E    +  where True = <built-in method isActive of PySide6.QtCore.QTimer object at 0x000001A78048B3C0>()

E    +    where <built-in method isActive of PySide6.QtCore.QTimer object at 0x000001A78048B3C0> = <PySide6.QtCore.QTimer(0x1a78a543f40) at 0x000001A78048B3C0>.isActive

E    +      where <PySide6.QtCore.QTimer(0x1a78a543f40) at 0x000001A78048B3C0> = <engine.screensaver_engine.ScreensaverEngine(0x1a78a5a19d0) at 0x000001A7833FE680>._rotation_timer

------------------------------ Captured log call ------------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down

-------------------------- Captured stderr teardown ---------------------------

qt.gui.imageio: QImageIOHandler: Rejecting image as it exceeds the current allocation limit of 256 megabytes

---------------------------- Captured log teardown ----------------------------

WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 487.27ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 487.27ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 487.81ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 488.31ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 341.30ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 352.82ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 351.71ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 351.19ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 352.21ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 352.72ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 350.93ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 350.93ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 350.43ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34519.54ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34522.11ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34520.57ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34520.04ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34673.25ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34672.74ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34672.74ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34671.72ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34672.21ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34674.47ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34674.47ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34674.47ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34667.93ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 34677.73ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1579 Image load failed for: C:\Users\Basjohn\AppData\Local\Temp\screensaver_rss_cache\f6b5cc78fa3d39d6dd35bc0246c53a73.jpeg
WARNING  engine.screensaver:screensaver_engine.py:1873 [FALLBACK] Image load failed, attempting next image (retry 1/10)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1579 Image load failed for: C:\Users\Basjohn\Documents\[4] WALLPAPERS\PERSONALSET\789452.jpg
WARNING  engine.screensaver:screensaver_engine.py:1873 [FALLBACK] Image load failed, attempting next image (retry 1/10)


_ TestDisplayWidgetOverlayDiagnostics.test_handle_screen_change_updates_geometry_and_dpi _

tests\test_overlay_ready_state.py:127: in test_handle_screen_change_updates_geometry_and_dpi

    assert widget.width() == 640 and widget.height() == 360

E   assert (640 == 640 and 359 == 360)

E    +  where 640 = <built-in method width of DisplayWidget object at 0x000001A7C46B2B80>()

E    +    where <built-in method width of DisplayWidget object at 0x000001A7C46B2B80> = <rendering.display_widget.DisplayWidget(0x1a7c75e7bc0) at 0x000001A7C46B2B80>.width

E    +  and   359 = <built-in method height of DisplayWidget object at 0x000001A7C46B2B80>()

E    +    where <built-in method height of DisplayWidget object at 0x000001A7C46B2B80> = <rendering.display_widget.DisplayWidget(0x1a7c75e7bc0) at 0x000001A7C46B2B80>.height

_____________ TestShadowConfig.test_from_settings_enabled_string ______________

tests\test_painter_shadow.py:62: in test_from_settings_enabled_string

    assert config.enabled is False

E   assert True is False

E    +  where True = ShadowConfig(enabled=True, blur_radius=18, offset_x=4, offset_y=4, color=PySide6.QtGui.QColor.fromRgbF(0.000000, 0.000000, 0.000000, 0.705882), opacity=1.0).enabled

__________ TestParticleTransition.test_particle_transition_creation ___________

tests\test_particle_transition.py:134: in test_particle_transition_creation

    transition = GLCompositorParticleTransition(

E   TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

____________ TestParticleTransition.test_particle_transition_modes ____________

tests\test_particle_transition.py:148: in test_particle_transition_modes

    transition = GLCompositorParticleTransition(

E   TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

_________ TestParticleTransition.test_particle_transition_directions __________

tests\test_particle_transition.py:162: in test_particle_transition_directions

    transition = GLCompositorParticleTransition(

E   TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

________ TestParticleTransition.test_particle_transition_swirl_orders _________

tests\test_particle_transition.py:176: in test_particle_transition_swirl_orders

    transition = GLCompositorParticleTransition(

E   TypeError: GLCompositorParticleTransition.__init__() got an unexpected keyword argument 'compositor'

______ TestSettingsDefaults.test_settings_manager_has_particle_defaults _______

tests\test_particle_transition.py:207: in test_settings_manager_has_particle_defaults

    assert particle.get('swirl_order') == 2  # Edges Inward

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   AssertionError: assert 0 == 2

E    +  where 0 = <built-in method get of dict object at 0x000001A7D2276100>('swirl_order')

E    +    where <built-in method get of dict object at 0x000001A7D2276100> = {'direction': 'Left to Right', 'gloss_size': 72.0, 'light_direction': 0, 'mode': 'Converge', ...}.get

____________ TestPerfDtMax.test_visualizer_dt_max_with_transitions ____________

tests\test_perf_dt_max.py:243: in test_visualizer_dt_max_with_transitions

    assert vis_dt_max < self.VISUALIZER_DT_MAX_THRESHOLD_MS, (

E   AssertionError: Visualizer dt_max 177.35ms exceeds threshold 75.0ms

E   assert 177.3549999925308 < 75.0

E    +  where 75.0 = <tests.test_perf_dt_max.TestPerfDtMax object at 0x000001A7C1456450>.VISUALIZER_DT_MAX_THRESHOLD_MS

---------------------------- Captured stdout call -----------------------------


============================================================
VISUALIZER DT_MAX TEST RESULTS
============================================================

Visualizer: frames=470, avg_fps=58.2, dt_min=11.80ms, dt_max=177.35ms

Transition metrics:
  Slide_1: frames=54, avg_fps=36.8, dt_min=2.08ms, dt_max=170.60ms
  Slide_2: frames=55, avg_fps=37.0, dt_min=13.53ms, dt_max=155.38ms
  Slide_3: frames=54, avg_fps=34.2, dt_min=7.86ms, dt_max=164.69ms
  Slide_4: frames=59, avg_fps=40.2, dt_min=4.12ms, dt_max=32.15ms
  Slide_5: frames=59, avg_fps=40.4, dt_min=9.56ms, dt_max=32.63ms

--- SUMMARY ---
Visualizer dt_max: 177.35ms (threshold: 75.0ms)
Transition dt_max: 170.60ms (threshold: 100.0ms)


------------------------------ Captured log call ------------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1579 Image load failed for: C:\Users\Basjohn\AppData\Local\Temp\screensaver_rss_cache\b5b06cdfc134ac7aa94d4fee919bee28.jpeg
WARNING  engine.screensaver:screensaver_engine.py:1873 [FALLBACK] Image load failed, attempting next image (retry 1/10)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


________________ TestPerfDtMax.test_sustained_visualizer_load _________________

tests\test_perf_dt_max.py:349: in test_sustained_visualizer_load

    assert median_dt_max < self.VISUALIZER_DT_MAX_THRESHOLD_MS, (

E   AssertionError: Median dt_max 206.82ms exceeds threshold 75.0ms

E   assert 206.81999999214895 < 75.0

E    +  where 75.0 = <tests.test_perf_dt_max.TestPerfDtMax object at 0x000001A7C1455C10>.VISUALIZER_DT_MAX_THRESHOLD_MS

---------------------------- Captured stdout call -----------------------------


============================================================
SUSTAINED LOAD TEST RESULTS
============================================================
  Window_1: frames=138, avg_fps=51.6, dt_min=13.53ms, dt_max=206.82ms
  Window_2: frames=143, avg_fps=54.2, dt_min=13.56ms, dt_max=325.41ms
  Window_3: frames=154, avg_fps=59.1, dt_min=15.11ms, dt_max=148.92ms
  Window_4: frames=152, avg_fps=58.3, dt_min=11.46ms, dt_max=151.63ms
  Window_5: frames=113, avg_fps=42.5, dt_min=13.91ms, dt_max=513.34ms
  Window_6: frames=161, avg_fps=60.6, dt_min=11.81ms, dt_max=65.89ms

--- DEGRADATION CHECK ---
First half avg dt_max: 227.05ms
Second half avg dt_max: 243.62ms
Degradation: +16.57ms
Max dt_max: 513.34ms
Median dt_max: 206.82ms


------------------------------ Captured log call ------------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


---------------------------- Captured log teardown ----------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down

_____________ test_overlay_timer_stop_is_safe_from_other_threads ______________

tests\test_qt_timer_threading.py:45: in test_overlay_timer_stop_is_safe_from_other_threads

    handle = create_overlay_timer(widget, 10, _cb, description="cross-thread-stop-test")

             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

widgets\overlay_timers.py:137: in create_overlay_timer

    raise RuntimeError(

E   RuntimeError: [OVERLAY_TIMER] ThreadManager unavailable for widget <tests.test_qt_timer_threading._DummyWidget(0x1a7c2f2d2b0) at 0x000001A7C3854F00>. All overlay timers must be scheduled via ThreadManager.

________________________ test_settings_dialog_has_tabs ________________________

tests\test_settings_dialog.py:102: in test_settings_dialog_has_tabs

    assert len(dialog.tab_buttons) == 5

E   assert 6 == 5

E    +  where 6 = len([<ui.settings_dialog.TabButton(0x1a80915b560, name="tabButton") at 0x000001A7CE1BD6C0>, <ui.settings_dialog.TabButton(...Button") at 0x000001A7CE1BD540>, <ui.settings_dialog.TabButton(0x1a80915d9b0, name="tabButton") at 0x000001A7CE1BD500>])

E    +    where [<ui.settings_dialog.TabButton(0x1a80915b560, name="tabButton") at 0x000001A7CE1BD6C0>, <ui.settings_dialog.TabButton(...Button") at 0x000001A7CE1BD540>, <ui.settings_dialog.TabButton(0x1a80915d9b0, name="tabButton") at 0x000001A7CE1BD500>] = <ui.settings_dialog.SettingsDialog(0x1a7c2f885e0) at 0x000001A7CFD1C340>.tab_buttons

---------------------------- Captured log teardown ----------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down

___________________ test_settings_dialog_has_content_stack ____________________

tests\test_settings_dialog.py:110: in test_settings_dialog_has_content_stack

    assert dialog.content_stack.count() == 5

E   assert 6 == 5

E    +  where 6 = <built-in method count of PySide6.QtWidgets.QStackedWidget object at 0x000001A7D228C2C0>()

E    +    where <built-in method count of PySide6.QtWidgets.QStackedWidget object at 0x000001A7D228C2C0> = <PySide6.QtWidgets.QStackedWidget(0x1a809c47860, name="contentArea") at 0x000001A7D228C2C0>.count

E    +      where <PySide6.QtWidgets.QStackedWidget(0x1a809c47860, name="contentArea") at 0x000001A7D228C2C0> = <ui.settings_dialog.SettingsDialog(0x1a809847f40) at 0x000001A7CE1F62C0>.content_stack

---------------------------- Captured log teardown ----------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down

_____________________ test_settings_dialog_tab_switching ______________________

tests\test_settings_dialog.py:142: in test_settings_dialog_tab_switching

    assert dialog.about_tab_btn.isChecked() is True

E   assert False is True

E    +  where False = <built-in method isChecked of TabButton object at 0x000001A7CFD38E80>()

E    +    where <built-in method isChecked of TabButton object at 0x000001A7CFD38E80> = <ui.settings_dialog.TabButton(0x1a81baa5ac0, name="tabButton") at 0x000001A7CFD38E80>.isChecked

E    +      where <ui.settings_dialog.TabButton(0x1a81baa5ac0, name="tabButton") at 0x000001A7CFD38E80> = <ui.settings_dialog.SettingsDialog(0x1a81bce3930) at 0x000001A7C76B11C0>.about_tab_btn

____________ test_manual_floor_produces_higher_energy_than_dynamic ____________

tests\test_spotify_visualizer_widget.py:117: in test_manual_floor_produces_higher_energy_than_dynamic

    assert max(bars_manual) > max(bars_dynamic)

E   assert 0.0 > 0.0

E    +  where 0.0 = max([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...])

E    +  and   0.0 = max([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...])

_________________ test_sensitivity_config_affects_noise_floor _________________

tests\test_spotify_visualizer_widget.py:133: in test_sensitivity_config_affects_noise_floor

    assert max(bars_manual) > max(bars_rec)

E   assert 0.0 > 0.0

E    +  where 0.0 = max([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...])

E    +  and   0.0 = max([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...])

________________ test_spotify_visualizer_bars_not_stuck_at_top ________________

tests\test_spotify_visualizer_widget.py:209: in test_spotify_visualizer_bars_not_stuck_at_top

    assert cmax >= 0.25

E   assert 0.006115675903856754 >= 0.25

_______ test_spotify_visualizer_kick_emphasizes_center_more_than_vocals _______

tests\test_spotify_visualizer_widget.py:255: in test_spotify_visualizer_kick_emphasizes_center_more_than_vocals

    assert (center_kick - shoulder_kick) > (center_vocal - shoulder_vocal)

E   assert (0.03425298809694747 - 0.15720587968826294) > (0.005342443939298391 - 0.0235808826982975)

______ test_spotify_visualizer_media_update_zeroes_bars_when_not_playing ______

tests\test_spotify_visualizer_widget.py:348: in test_spotify_visualizer_media_update_zeroes_bars_when_not_playing

    assert all(value == 0.0 for value in vis._target_bars)  # type: ignore[attr-defined]

    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   assert False

E    +  where False = all(<generator object test_spotify_visualizer_media_update_zeroes_bars_when_not_playing.<locals>.<genexpr> at 0x000001A7C77AD150>)

________ TestClockWidgetTimezone.test_clock_time_update_with_timezone _________

tests\test_timezone_support.py:220: in test_clock_time_update_with_timezone

    assert len(text) > 0

E   AssertionError: assert 0 > 0

E    +  where 0 = len('')

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

_______ TestClockWidgetTimezone.test_clock_local_vs_utc_time_difference _______

tests\test_timezone_support.py:247: in test_clock_local_vs_utc_time_difference

    assert len(local_text) > 0

E   AssertionError: assert 0 > 0

E    +  where 0 = len('')

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.
ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.


_________ TestClockWidgetTimezone.test_clock_timezone_display_formats _________

tests\test_timezone_support.py:276: in test_clock_timezone_display_formats

    assert 'AM' in text_12h or 'PM' in text_12h

E   AssertionError: assert ('AM' in '' or 'PM' in '')

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.

__________ TestTransitionIntegration.test_crossfade_transition_runs ___________

tests\test_transition_integration.py:135: in test_crossfade_transition_runs

    assert transition_finished['value'], "Crossfade transition should finish"

E   AssertionError: Crossfade transition should finish

E   assert False

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


____________ TestTransitionIntegration.test_slide_transition_runs _____________

tests\test_transition_integration.py:171: in test_slide_transition_runs

    assert transition_finished['value'], "Slide transition should finish"

E   AssertionError: Slide transition should finish

E   assert False

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


___________ TestTransitionIntegration.test_diffuse_transition_runs ____________

tests\test_transition_integration.py:197: in test_diffuse_transition_runs

    assert transition_finished['value'], "Diffuse transition should finish"

E   AssertionError: Diffuse transition should finish

E   assert False

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


______ TestTransitionIntegration.test_block_puzzle_flip_transition_runs _______

tests\test_transition_integration.py:224: in test_block_puzzle_flip_transition_runs

    assert transition_finished['value'], "Block puzzle flip transition should finish"

E   AssertionError: Block puzzle flip transition should finish

E   assert False

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


_____________ TestTransitionIntegration.test_wipe_transition_runs _____________

tests\test_transition_integration.py:249: in test_wipe_transition_runs

    assert transition_finished['value'], "Wipe transition should finish"

E   AssertionError: Wipe transition should finish

E   assert False

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


________ TestTransitionIntegration.test_transition_settings_respected _________

tests\test_transition_integration.py:290: in test_transition_settings_respected

    assert current.duration_ms == 750

E   assert 5032 == 750

E    +  where 5032 = GLCompositorSlideTransition(duration=5032ms, state=running).duration_ms

------------------------------ Captured log call ------------------------------

ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'
ERROR    rendering.image_presenter:image_presenter.py:194 [IMAGE_PRESENTER] Processing failed: 'ImageProcessor' object has no attribute 'process'
Traceback (most recent call last):
  File "F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\image_presenter.py", line 169, in process_image
    processed = self._processor.process(
                ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ImageProcessor' object has no attribute 'process'


_ TestTransitionIntegration.test_diffuse_transition_software_backend_no_watchdog _

tests\test_transition_integration.py:350: in test_diffuse_transition_software_backend_no_watchdog

    original_timeout = widget._on_transition_watchdog_timeout

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   AttributeError: 'DisplayWidget' object has no attribute '_on_transition_watchdog_timeout'

_ TestTransitionIntegration.test_block_flip_transition_software_backend_no_watchdog _

tests\test_transition_integration.py:396: in test_block_flip_transition_software_backend_no_watchdog

    original_timeout = widget._on_transition_watchdog_timeout

                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   AttributeError: 'DisplayWidget' object has no attribute '_on_transition_watchdog_timeout'

_________________ TestBaseTelemetry.test_mark_start_sets_time _________________

tests\test_transition_telemetry.py:62: in test_mark_start_sets_time

    assert trans._start_time is not None

E   assert None is not None

E    +  where None = CrossfadeTransition(duration=1000ms, state=idle)._start_time

__________________ TestBaseTelemetry.test_mark_end_sets_time __________________

tests\test_transition_telemetry.py:75: in test_mark_end_sets_time

    assert trans._end_time is not None

E   assert None is not None

E    +  where None = CrossfadeTransition(duration=1000ms, state=idle)._end_time

_______ TestBaseTelemetry.test_get_elapsed_ms_returns_time_after_start ________

tests\test_transition_telemetry.py:99: in test_get_elapsed_ms_returns_time_after_start

    assert elapsed is not None

E   assert None is not None

_______________ TestTelemetryLogging.test_mark_start_logs_debug _______________

tests\test_transition_telemetry.py:117: in test_mark_start_logs_debug

    assert len(perf_logs) > 0

E   assert 0 > 0

E    +  where 0 = len([])

_____________ TestTelemetryLogging.test_mark_end_logs_performance _____________

tests\test_transition_telemetry.py:132: in test_mark_end_logs_performance

    assert len(perf_logs) > 0

E   assert 0 > 0

E    +  where 0 = len([])

__________ TestTelemetryLogging.test_mark_end_warns_on_timing_drift ___________

tests\test_transition_telemetry.py:147: in test_mark_end_warns_on_timing_drift

    assert len(drift_logs) > 0

E   assert 0 > 0

E    +  where 0 = len([])

________ TestGLTransitionTelemetry.test_gl_crossfade_calls_mark_start _________

tests\test_transition_telemetry.py:164: in test_gl_crossfade_calls_mark_start

    assert trans._start_time is not None

E   assert None is not None

E    +  where None = GLCompositorCrossfadeTransition(duration=1000ms, state=finished)._start_time

------------------------------ Captured log call ------------------------------

WARNING  transitions.gl_compositor_crossfade_transition:gl_compositor_crossfade_transition.py:62 [GL COMPOSITOR] No compositor attached to widget; falling back to immediate display

___ TestGLTransitionTelemetry.test_gl_crossfade_calls_mark_end_on_complete ____

tests\test_transition_telemetry.py:179: in test_gl_crossfade_calls_mark_end_on_complete

    assert trans._end_time is not None

E   assert None is not None

E    +  where None = GLCompositorCrossfadeTransition(duration=100ms, state=finished)._end_time

------------------------------ Captured log call ------------------------------

WARNING  transitions.gl_compositor_crossfade_transition:gl_compositor_crossfade_transition.py:62 [GL COMPOSITOR] No compositor attached to widget; falling back to immediate display

______________ TestPerformanceMetrics.test_elapsed_time_accuracy ______________

tests\test_transition_telemetry.py:212: in test_elapsed_time_accuracy

    assert abs(elapsed - (sleep_time * 1000)) < 20

               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   TypeError: unsupported operand type(s) for -: 'NoneType' and 'float'

________________ TestPerformanceMetrics.test_delta_calculation ________________

tests\test_transition_telemetry.py:224: in test_delta_calculation

    delta = (trans._end_time - trans._start_time) * 1000 - trans.duration_ms

             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

E   TypeError: unsupported operand type(s) for -: 'NoneType' and 'NoneType'

___ TestVisualizerWidgetModes.test_set_visualization_mode_clears_particles ____

tests\test_visualizer_modes.py:94: in test_set_visualization_mode_clears_particles

    assert len(widget._abstract_particles) == 0

E   AssertionError: assert 1 == 0

E    +  where 1 = len([{'x': 0, 'y': 0}])

E    +    where [{'x': 0, 'y': 0}] = <widgets.spotify_visualizer_widget.SpotifyVisualizerWidget(0x1a84b57aab0) at 0x000001A7C7824F00>._abstract_particles

___________________________ test_weather_no_api_key ___________________________

tests\test_weather_widget.py:87: in test_weather_no_api_key

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x1a84b57c5b0) at 0x000001A7C782EDC0>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

______________________________ test_weather_stop ______________________________

tests\test_weather_widget.py:97: in test_weather_stop

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x1a84b57a930) at 0x000001A7C7849380>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

____________________________ test_weather_cleanup _____________________________

tests\test_weather_widget.py:236: in test_weather_cleanup

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x1a84b582130) at 0x000001A7C78687C0>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

__________________ test_weather_concurrent_start_prevention ___________________

tests\test_weather_widget.py:337: in test_weather_concurrent_start_prevention

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x1a84b584e90) at 0x000001A7C787B900>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

____________ test_widgets_tab_changes_reflected_in_display_widget _____________

tests\test_widgets_persistence_integration.py:73: in test_widgets_tab_changes_reflected_in_display_widget

    assert widget.clock_widget._enabled is True

E   assert False is True

E    +  where False = <widgets.clock_widget.ClockWidget(0x1a85369d240, name="clock_main") at 0x000001A7D000B140>._enabled

E    +    where <widgets.clock_widget.ClockWidget(0x1a85369d240, name="clock_main") at 0x000001A7D000B140> = <rendering.display_widget.DisplayWidget(0x1a85369cf40) at 0x000001A7C78842C0>.clock_widget

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for clock during ClockWidget.start; timer-driven features disabled.
ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for media during MediaWidget.start; timer-driven features disabled.
ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for reddit during RedditWidget.start; timer-driven features disabled.


---------------------------- Captured log teardown ----------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down

_______________ TestWidgetsTab.test_widgets_tab_default_values ________________

tests\test_widgets_tab.py:59: in test_widgets_tab_default_values

    assert tab.weather_show_forecast.isChecked() is False

E   assert True is False

E    +  where True = <built-in method isChecked of PySide6.QtWidgets.QCheckBox object at 0x000001A7C796C8C0>()

E    +    where <built-in method isChecked of PySide6.QtWidgets.QCheckBox object at 0x000001A7C796C8C0> = <PySide6.QtWidgets.QCheckBox(0x1a8542c3d90) at 0x000001A7C796C8C0>.isChecked

E    +      where <PySide6.QtWidgets.QCheckBox(0x1a8542c3d90) at 0x000001A7C796C8C0> = <ui.tabs.widgets_tab.WidgetsTab(0x1a853e70a50) at 0x000001A7C78EC500>.weather_show_forecast

---------------------------- Captured log teardown ----------------------------

WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down

============================== warnings summary ===============================

core\windows\reddit_helper_installer.py:1

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\core\windows\reddit_helper_installer.py:1: DeprecationWarning: invalid escape sequence '\S'
    """




tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets
tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\input_handler.py:631: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    pos = event.pos()




tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2580: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    logger.info(f"Mouse clicked at ({event.pos().x()}, {event.pos().y()}), requesting exit")




tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_ctrl_interaction_mode.py:346: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




tests/test_ctrl_interaction_mode.py: 10 warnings
tests/test_integration.py: 57 warnings


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2600: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    event.pos(), getattr(self, "spotify_volume_widget", None)




tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_media_widget.py:469: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_media_widget.py:539: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

=========================== short test summary info ===========================

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug3_color_array_to_qcolor_conversion

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug4_z_order_clock_on_top

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug9_missing_raise_call

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_visibility_after_setup

FAILED tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_settings_complete_integration

FAILED tests/test_clock_widget.py::test_clock_start_stop - assert False is True

FAILED tests/test_clock_widget.py::test_clock_signals - assert 0 >= 1

FAILED tests/test_clock_widget.py::test_clock_12h_format - AssertionError: as...

FAILED tests/test_clock_widget.py::test_clock_24h_format - AssertionError: as...

FAILED tests/test_clock_widget.py::test_clock_without_seconds - AssertionErro...

FAILED tests/test_clock_widget.py::test_clock_with_seconds - AssertionError: ...

FAILED tests/test_clock_widget.py::test_clock_set_time_format - AssertionErro...

FAILED tests/test_clock_widget.py::test_clock_set_show_seconds - assert 0 == 2

FAILED tests/test_clock_widget.py::test_clock_all_positions - assert False is...

FAILED tests/test_clock_widget.py::test_clock_set_position - assert (0, 0) !=...

FAILED tests/test_clock_widget.py::test_clock_cleanup - assert False is True

FAILED tests/test_clock_widget.py::test_clock_concurrent_start_prevention - a...

FAILED tests/test_clock_widget.py::test_clock_updates_over_time - assert 0 >= 2

FAILED tests/test_flicker_fix_integration.py::TestTransitionTelemetryFlow::test_transition_tracks_timing

FAILED tests/test_gl_compositor_blockspin.py::test_gl_compositor_blockspin_no_underlay_and_no_black

FAILED tests/test_integration.py::test_engine_rotation_timer - assert True is...

FAILED tests/test_overlay_ready_state.py::TestDisplayWidgetOverlayDiagnostics::test_handle_screen_change_updates_geometry_and_dpi

FAILED tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_creation

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_modes

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_directions

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_swirl_orders

FAILED tests/test_particle_transition.py::TestSettingsDefaults::test_settings_manager_has_particle_defaults

FAILED tests/test_perf_dt_max.py::TestPerfDtMax::test_visualizer_dt_max_with_transitions

FAILED tests/test_perf_dt_max.py::TestPerfDtMax::test_sustained_visualizer_load

FAILED tests/test_qt_timer_threading.py::test_overlay_timer_stop_is_safe_from_other_threads

FAILED tests/test_settings_dialog.py::test_settings_dialog_has_tabs - assert ...

FAILED tests/test_settings_dialog.py::test_settings_dialog_has_content_stack

FAILED tests/test_settings_dialog.py::test_settings_dialog_tab_switching - as...

FAILED tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic

FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_media_update_zeroes_bars_when_not_playing

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_time_update_with_timezone

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_local_vs_utc_time_difference

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_timezone_display_formats

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_crossfade_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_slide_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_block_puzzle_flip_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_wipe_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_transition_settings_respected

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_software_backend_no_watchdog

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_block_flip_transition_software_backend_no_watchdog

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_start_sets_time

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_end_sets_time

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_get_elapsed_ms_returns_time_after_start

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_start_logs_debug

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_logs_performance

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_warns_on_timing_drift

FAILED tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_start

FAILED tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_end_on_complete

FAILED tests/test_transition_telemetry.py::TestPerformanceMetrics::test_elapsed_time_accuracy

FAILED tests/test_transition_telemetry.py::TestPerformanceMetrics::test_delta_calculation

FAILED tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_particles

FAILED tests/test_weather_widget.py::test_weather_no_api_key - assert False i...

FAILED tests/test_weather_widget.py::test_weather_stop - assert False is True

FAILED tests/test_weather_widget.py::test_weather_cleanup - assert False is True

FAILED tests/test_weather_widget.py::test_weather_concurrent_start_prevention

FAILED tests/test_widgets_persistence_integration.py::test_widgets_tab_changes_reflected_in_display_widget

FAILED tests/test_widgets_tab.py::TestWidgetsTab::test_widgets_tab_default_values

67 failed, 529 passed, 20 skipped, 79 warnings in 544.68s (0:09:04)


===== pytest run 2025-12-28 21:59:15 args=['tests/test_events.py', 'tests/test_resources.py', 'tests/test_settings.py', 'tests/test_threading.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 30 items



tests/test_events.py::test_event_system_initialization 
PASSED                                                                                                                                        [  3%]


tests/test_events.py::test_subscribe_and_publish 
PASSED                                                                                                                                              [  6%]


tests/test_events.py::test_unsubscribe 
PASSED                                                                                                                                                        [ 10%]


tests/test_events.py::test_priority_ordering 
PASSED                                                                                                                                                  [ 13%]


tests/test_events.py::test_event_filter 
PASSED                                                                                                                                                       [ 16%]


tests/test_events.py::test_event_history 
PASSED                                                                                                                                                      [ 20%]


tests/test_resources.py::test_resource_manager_initialization 
PASSED                                                                                                                                 [ 23%]


tests/test_resources.py::test_register_resource 
PASSED                                                                                                                                               [ 26%]


tests/test_resources.py::test_unregister_resource 
PASSED                                                                                                                                             [ 30%]


tests/test_resources.py::test_register_temp_file 
PASSED                                                                                                                                              [ 33%]


tests/test_resources.py::test_get_all_resources 
PASSED                                                                                                                                               [ 36%]


tests/test_resources.py::test_get_stats 
PASSED                                                                                                                                                       [ 40%]


tests/test_settings.py::test_settings_manager_initialization 
PASSED                                                                                                                                  [ 43%]


tests/test_settings.py::test_get_set_setting 
PASSED                                                                                                                                                  [ 46%]


tests/test_settings.py::test_default_values 
PASSED                                                                                                                                                   [ 50%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED                                                                                                                            [ 53%]


tests/test_settings.py::test_on_changed_handler 
PASSED                                                                                                                                               [ 56%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                                                                                                                                                [ 60%]


tests/test_settings.py::test_get_all_keys 
PASSED                                                                                                                                                     [ 63%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED                                                                                                                                          [ 66%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED                                                                                                                          [ 70%]


tests/test_threading.py::test_thread_manager_initialization 
PASSED                                                                                                                                   [ 73%]


tests/test_threading.py::test_submit_io_task 
PASSED                                                                                                                                                  [ 76%]


tests/test_threading.py::test_submit_compute_task 
PASSED                                                                                                                                             [ 80%]


tests/test_threading.py::test_get_pool_stats 
PASSED                                                                                                                                                  [ 83%]


tests/test_threading.py::test_thread_manager_shutdown 
PASSED                                                                                                                                         [ 86%]


tests/test_threading.py::test_run_on_ui_thread_from_ui_thread 
PASSED                                                                                                                                 [ 90%]


tests/test_threading.py::test_run_on_ui_thread_from_worker_thread 
PASSED                                                                                                                             [ 93%]


tests/test_threading.py::test_schedule_recurring_invokes_callback 
PASSED                                                                                                                             [ 96%]


tests/test_threading.py::test_schedule_recurring_with_description 
PASSED                                                                                                                             [100%]




=========================================================================================== 30 passed in 0.82s ============================================================================================


===== pytest run 2025-12-28 22:07:59 args=['tests/', '--ignore=tests/test_rss_source.py', '--ignore=tests/test_visualizer_distribution.py', '-q', '--tb=no'] =====

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
.
.
.
.
. [ 11%]

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
. [ 23%]

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 35%]

.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
s
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 47%]

.
.
.
.
.
F
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
s
s
s
s
s
.
s
s
.
.
.
.
.
.
.
.
.
F
F
F
F
.
F
.
F
F
.
.
.
.
.
.
.
.
.
.
.
. [ 58%]

.
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
s
s
s
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
s
s
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 70%]

.
.
.
.
.
.
.
.
F
F
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
F
.
.
F
F
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 82%]

.
.
.
.
.
.
.
F
F
.
F
.
.
.
.
.
.
F
F
F
F
F
.
F
.
.
F
F
.
F
F
.
F
F
F
F
F
F
.
F
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
s
s
s
.
.
.
.
.
.
.
.
.
.
. [ 94%]

F
.
.
.
.
.
.
.
.
.
F
F
.
.
.
.
.
.
.
.
.
F
.
.
.
.
.
.
F
.
.
F
.
.
F
.
                                     [100%]


============================== warnings summary ===============================

tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets
tests/test_integration.py::test_engine_image_queue_initialization
tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\input_handler.py:631: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    pos = event.pos()




tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets
tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2580: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    logger.info(f"Mouse clicked at ({event.pos().x()}, {event.pos().y()}), requesting exit")




tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_ctrl_interaction_mode.py:346: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




tests/test_gl_prewarm.py::test_gl_prewarm_overlays_ready
tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume
tests/test_startup_black_flash.py::test_startup_no_base_black_fallback_opengl


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2609: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    self._initial_mouse_pos = event.pos()




tests/test_gl_prewarm.py::test_gl_prewarm_overlays_ready
tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume
tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume
tests/test_startup_black_flash.py::test_startup_no_base_black_fallback_opengl
tests/test_startup_black_flash.py::test_startup_no_base_black_fallback_opengl


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2614: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dx = event.pos().x() - self._initial_mouse_pos.x()




tests/test_gl_prewarm.py::test_gl_prewarm_overlays_ready
tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume
tests/test_scrollwheel_volume.py::test_cursor_halo_forwarded_wheel_adjusts_volume
tests/test_startup_black_flash.py::test_startup_no_base_black_fallback_opengl
tests/test_startup_black_flash.py::test_startup_no_base_black_fallback_opengl


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2615: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    dy = event.pos().y() - self._initial_mouse_pos.y()




tests/test_integration.py: 29 warnings
tests/test_scrollwheel_volume.py: 4 warnings


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2600: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    event.pos(), getattr(self, "spotify_volume_widget", None)




tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_media_widget.py:469: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_media_widget.py:539: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

=========================== short test summary info ===========================

FAILED tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active

FAILED tests/test_flicker_fix_integration.py::TestTransitionTelemetryFlow::test_transition_tracks_timing

FAILED tests/test_integration.py::test_engine_rotation_timer - assert True is...

FAILED tests/test_overlay_ready_state.py::TestDisplayWidgetOverlayDiagnostics::test_handle_screen_change_updates_geometry_and_dpi

FAILED tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_creation

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_modes

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_directions

FAILED tests/test_particle_transition.py::TestParticleTransition::test_particle_transition_swirl_orders

FAILED tests/test_particle_transition.py::TestSettingsDefaults::test_settings_manager_has_particle_defaults

FAILED tests/test_perf_dt_max.py::TestPerfDtMax::test_visualizer_dt_max_with_transitions

FAILED tests/test_perf_dt_max.py::TestPerfDtMax::test_sustained_visualizer_load

FAILED tests/test_qt_timer_threading.py::test_overlay_timer_stop_is_safe_from_other_threads

FAILED tests/test_settings_dialog.py::test_settings_dialog_has_tabs - assert ...

FAILED tests/test_settings_dialog.py::test_settings_dialog_has_content_stack

FAILED tests/test_settings_dialog.py::test_settings_dialog_tab_switching - as...

FAILED tests/test_spotify_visualizer_widget.py::test_manual_floor_produces_higher_energy_than_dynamic

FAILED tests/test_spotify_visualizer_widget.py::test_sensitivity_config_affects_noise_floor

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_bars_not_stuck_at_top

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_kick_emphasizes_center_more_than_vocals

FAILED tests/test_spotify_visualizer_widget.py::test_spotify_visualizer_media_update_zeroes_bars_when_not_playing

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_time_update_with_timezone

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_local_vs_utc_time_difference

FAILED tests/test_timezone_support.py::TestClockWidgetTimezone::test_clock_timezone_display_formats

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_crossfade_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_slide_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_block_puzzle_flip_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_wipe_transition_runs

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_transition_settings_respected

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_diffuse_transition_software_backend_no_watchdog

FAILED tests/test_transition_integration.py::TestTransitionIntegration::test_block_flip_transition_software_backend_no_watchdog

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_start_sets_time

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_mark_end_sets_time

FAILED tests/test_transition_telemetry.py::TestBaseTelemetry::test_get_elapsed_ms_returns_time_after_start

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_start_logs_debug

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_logs_performance

FAILED tests/test_transition_telemetry.py::TestTelemetryLogging::test_mark_end_warns_on_timing_drift

FAILED tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_start

FAILED tests/test_transition_telemetry.py::TestGLTransitionTelemetry::test_gl_crossfade_calls_mark_end_on_complete

FAILED tests/test_transition_telemetry.py::TestPerformanceMetrics::test_elapsed_time_accuracy

FAILED tests/test_transition_telemetry.py::TestPerformanceMetrics::test_delta_calculation

FAILED tests/test_visualizer_modes.py::TestVisualizerWidgetModes::test_set_visualization_mode_clears_particles

FAILED tests/test_weather_widget.py::test_weather_no_api_key - assert False i...

FAILED tests/test_weather_widget.py::test_weather_stop - assert False is True

FAILED tests/test_weather_widget.py::test_weather_cleanup - assert False is True

FAILED tests/test_weather_widget.py::test_weather_concurrent_start_prevention

FAILED tests/test_widgets_persistence_integration.py::test_widgets_tab_changes_reflected_in_display_widget

FAILED tests/test_widgets_tab.py::TestWidgetsTab::test_widgets_tab_default_values

49 failed, 547 passed, 20 skipped, 58 warnings in 530.59s (0:08:50)


===== pytest run 2025-12-28 22:16:58 args=['tests/', '--ignore=tests/test_rss_source.py', '--ignore=tests/test_visualizer_distribution.py', '-q', '--tb=no'] =====

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 11%]

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
.
.
.
.
.
.
.
.
. [ 23%]

.
.
.
.
.
F
.
.

===== pytest run 2025-12-28 22:17:42 args=['tests/', '--ignore=tests/test_rss_source.py', '--ignore=tests/test_visualizer_distribution.py', '--ignore=tests/test_gl_compositor_crossfade.py', '-q', '--tb=line', '--timeout=30'] =====

ERROR: usage: pytest.py [options] [file_or_dir] [file_or_dir] [...]
pytest.py: error: unrecognized arguments: --timeout=30
  inifile: F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.ini
  rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver




===== pytest run 2025-12-28 22:17:59 args=['--ignore=tests/test_rss_source.py', '--ignore=tests/test_visualizer_distribution.py', '-x', '--timeout=60'] =====

ERROR: usage: pytest.py [options] [file_or_dir] [file_or_dir] [...]
pytest.py: error: unrecognized arguments: --timeout=60
  inifile: F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.ini
  rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver




===== pytest run 2025-12-28 22:20:38 args=['tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string', 'tests/test_overlay_ready_state.py::TestDisplayWidgetOverlayDiagnostics::test_handle_screen_change_updates_geometry_and_dpi', 'tests/test_gl_compositor_blockspin.py', 'tests/test_flicker_fix_integration.py::TestTransitionTelemetryFlow::test_transition_tracks_timing', 'tests/test_integration.py::test_engine_rotation_timer', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 5 items



tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string 
PASSED                                                                                                             [ 20%]


tests/test_overlay_ready_state.py::TestDisplayWidgetOverlayDiagnostics::test_handle_screen_change_updates_geometry_and_dpi 
PASSED                                                                    [ 40%]


tests/test_gl_compositor_blockspin.py::test_gl_compositor_blockspin_no_underlay_and_no_black 
FAILED                                                                                                  [ 60%]


tests/test_flicker_fix_integration.py::TestTransitionTelemetryFlow::test_transition_tracks_timing 
SKIPPED (GL transition could not start in this environment (no GL context))                        [ 80%]


tests/test_integration.py::test_engine_rotation_timer 
FAILED                                                                                                                                         [100%]




================================================================================================ FAILURES =================================================================================================

__________________________________________________________________________ test_gl_compositor_blockspin_no_underlay_and_no_black __________________________________________________________________________

tests\test_gl_compositor_blockspin.py:99: in test_gl_compositor_blockspin_no_underlay_and_no_black

    assert (

E   AssertionError: GL compositor block spins produced blank/very dark frame (84.35%)

E   assert 0.8435132575757576 < 0.75

_______________________________________________________________________________________ test_engine_rotation_timer ________________________________________________________________________________________

tests\test_integration.py:136: in test_engine_rotation_timer

    assert engine._rotation_timer.isActive() is False

E   assert True is False

E    +  where True = <built-in method isActive of PySide6.QtCore.QTimer object at 0x00000134238B6EC0>()

E    +    where <built-in method isActive of PySide6.QtCore.QTimer object at 0x00000134238B6EC0> = <PySide6.QtCore.QTimer(0x134279c6850) at 0x00000134238B6EC0>.isActive

E    +      where <PySide6.QtCore.QTimer(0x134279c6850) at 0x00000134238B6EC0> = <engine.screensaver_engine.ScreensaverEngine(0x1345d2ee450) at 0x00000134181F7A40>._rotation_timer

------------------------------------------------------------------------------------------ Captured log teardown ------------------------------------------------------------------------------------------

WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 31352.26ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 31354.29ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


============================================================================================ warnings summary =============================================================================================

core\windows\reddit_helper_installer.py:1

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\core\windows\reddit_helper_installer.py:1: DeprecationWarning: invalid escape sequence '\S'
    """




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_gl_compositor_blockspin.py::test_gl_compositor_blockspin_no_underlay_and_no_black - AssertionError: GL compositor block spins produced blank/very dark frame (84.35%)

FAILED tests/test_integration.py::test_engine_rotation_timer - assert True is False

=========================================================================== 2 failed, 2 passed, 1 skipped, 1 warning in 35.36s ============================================================================


===== pytest run 2025-12-28 22:21:19 args=['tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string', 'tests/test_overlay_ready_state.py::TestDisplayWidgetOverlayDiagnostics::test_handle_screen_change_updates_geometry_and_dpi', '-v', '--tb=short'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 2 items



tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string 
PASSED [ 50%]


tests/test_overlay_ready_state.py::TestDisplayWidgetOverlayDiagnostics::test_handle_screen_change_updates_geometry_and_dpi 
PASSED [100%]




============================== 2 passed in 0.50s ==============================


===== pytest run 2025-12-28 22:21:37 args=['tests/test_painter_shadow.py', 'tests/test_overlay_ready_state.py', 'tests/test_integration.py::test_engine_rotation_timer', '-v', '--tb=short'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 33 items



tests/test_painter_shadow.py::TestShadowConfig::test_default_values 
PASSED [  3%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_empty 
PASSED [  6%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_none 
PASSED [  9%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_disabled 
PASSED [ 12%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string 
PASSED [ 15%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_blur_radius 
PASSED [ 18%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_offset 
PASSED [ 21%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_color_list 
PASSED [ 24%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_color_qcolor 
PASSED [ 27%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_opacity 
PASSED [ 30%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_miss_on_empty 
PASSED [ 33%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_hit_after_set 

===== pytest run 2025-12-28 22:21:51 args=['tests/test_painter_shadow.py', 'tests/test_overlay_ready_state.py', '-v', '--maxfail=3'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 32 items



tests/test_painter_shadow.py::TestShadowConfig::test_default_values 
PASSED                                                                                                                           [  3%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_empty 
PASSED                                                                                                                      [  6%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_none 
PASSED                                                                                                                       [  9%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_disabled 
PASSED                                                                                                                   [ 12%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string 
PASSED                                                                                                             [ 15%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_blur_radius 
PASSED                                                                                                                [ 18%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_offset 
PASSED                                                                                                                     [ 21%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_color_list 
PASSED                                                                                                                 [ 25%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_color_qcolor 
PASSED                                                                                                               [ 28%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_opacity 
PASSED                                                                                                                    [ 31%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_miss_on_empty 
PASSED                                                                                                                       [ 34%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_hit_after_set 

===== pytest run 2025-12-28 22:22:17 args=['tests/', '--ignore=tests/test_rss_source.py', '--ignore=tests/test_visualizer_distribution.py', '-q', '--tb=line', '--maxfail=10'] =====

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
F
.
.
.
.
. [ 11%]

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
s
.
.
.
.
.
.
.
.
. [ 23%]

.
.
.
.
.
F
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 35%]

.
.
.
.
.
.
F
.
.
.
.

===== pytest run 2025-12-28 22:27:28 args=['tests/test_painter_shadow.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 26 items



tests/test_painter_shadow.py::TestShadowConfig::test_default_values 
PASSED                                                                                                                           [  3%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_empty 
PASSED                                                                                                                      [  7%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_none 
PASSED                                                                                                                       [ 11%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_disabled 
PASSED                                                                                                                   [ 15%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_enabled_string 
PASSED                                                                                                             [ 19%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_blur_radius 
PASSED                                                                                                                [ 23%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_offset 
PASSED                                                                                                                     [ 26%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_color_list 
PASSED                                                                                                                 [ 30%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_color_qcolor 
PASSED                                                                                                               [ 34%]


tests/test_painter_shadow.py::TestShadowConfig::test_from_settings_opacity 
PASSED                                                                                                                    [ 38%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_miss_on_empty 
PASSED                                                                                                                       [ 42%]


tests/test_painter_shadow.py::TestShadowCache::test_cache_hit_after_set 

===== pytest run 2025-12-28 22:27:34 args=['tests/test_painter_shadow.py', '--timeout=30', '-v'] =====

ERROR: usage: pytest.py [options] [file_or_dir] [file_or_dir] [...]
pytest.py: error: unrecognized arguments: --timeout=30
  inifile: F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.ini
  rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver




===== pytest run 2025-12-28 22:37:08 args=['tests/test_integration.py::test_engine_rotation_timer', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_integration.py::test_engine_rotation_timer 
FAILED                                                                                                                                         [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________________ test_engine_rotation_timer ________________________________________________________________________________________

tests\test_integration.py:136: in test_engine_rotation_timer

    assert engine._rotation_timer.isActive() is False

E   assert True is False

E    +  where True = <built-in method isActive of PySide6.QtCore.QTimer object at 0x000001CE3CBFF140>()

E    +    where <built-in method isActive of PySide6.QtCore.QTimer object at 0x000001CE3CBFF140> = <PySide6.QtCore.QTimer(0x1ce36a86db0) at 0x000001CE3CBFF140>.isActive

E    +      where <PySide6.QtCore.QTimer(0x1ce36a86db0) at 0x000001CE3CBFF140> = <engine.screensaver_engine.ScreensaverEngine(0x1ce765aef40) at 0x000001CE26190A40>._rotation_timer

------------------------------------------------------------------------------------------ Captured log teardown ------------------------------------------------------------------------------------------

WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 45.49ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28971.48ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 28972.47ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


============================================================================================ warnings summary =============================================================================================

tests/test_integration.py::test_engine_rotation_timer

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2600: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    event.pos(), getattr(self, "spotify_volume_widget", None)




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_integration.py::test_engine_rotation_timer - assert True is False

====================================================================================== 1 failed, 1 warning in 31.12s ======================================================================================


===== pytest run 2025-12-28 22:37:46 args=['tests/test_integration.py::test_engine_rotation_timer', '-v', '--tb=long'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_integration.py::test_engine_rotation_timer 
FAILED             [100%]




================================== FAILURES ===================================

_________________________ test_engine_rotation_timer __________________________



engine = <engine.screensaver_engine.ScreensaverEngine(0x1d1c93a36b0) at 0x000001D1F904A040>

qapp = <PySide6.QtWidgets.QApplication(0x1d1c93a1710) at 0x000001D1F90405C0>



    def test_engine_rotation_timer(engine, qapp):

        """Test rotation timer is configured."""

        engine.initialize()

    

        assert engine._rotation_timer is not None

    

        # Timer should be configured but not started

>       assert engine._rotation_timer.isActive() is False

E       assert True is False

E        +  where True = <built-in method isActive of PySide6.QtCore.QTimer object at 0x000001D18C42BE00>()

E        +    where <built-in method isActive of PySide6.QtCore.QTimer object at 0x000001D18C42BE00> = <PySide6.QtCore.QTimer(0x1d184f5fa60) at 0x000001D18C42BE00>.isActive

E        +      where <PySide6.QtCore.QTimer(0x1d184f5fa60) at 0x000001D18C42BE00> = <engine.screensaver_engine.ScreensaverEngine(0x1d1c93a36b0) at 0x000001D1F904A040>._rotation_timer



tests\test_integration.py:136: AssertionError

---------------------------- Captured log teardown ----------------------------

WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 44.54ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
ERROR    core.threading.manager:manager.py:234 Task task_1999512666512 failed: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/All/hot.json?limit=25
ERROR    core.threading.manager:manager.py:234 Task task_1999549063056 failed: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/Games/hot.json?limit=25
ERROR    core.threading.manager:manager.py:234 Task task_1999549061904 failed: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/All/hot.json?limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/EarthPorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/EarthPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/EarthPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/EarthPorn/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/CityPorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/CityPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/CityPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/CityPorn/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 24449.56ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 24449.56ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


============================== warnings summary ===============================

tests/test_integration.py::test_engine_rotation_timer
tests/test_integration.py::test_engine_rotation_timer
tests/test_integration.py::test_engine_rotation_timer


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2600: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    event.pos(), getattr(self, "spotify_volume_widget", None)




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

=========================== short test summary info ===========================

FAILED tests/test_integration.py::test_engine_rotation_timer - assert True is...

======================= 1 failed, 3 warnings in 26.61s ========================


===== pytest run 2025-12-28 22:38:23 args=['tests/test_integration.py::test_engine_rotation_timer', '-v', '--timeout=30'] =====

ERROR: usage: pytest.py [options] [file_or_dir] [file_or_dir] [...]
pytest.py: error: unrecognized arguments: --timeout=30
  inifile: F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.ini
  rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver




===== pytest run 2025-12-28 22:39:40 args=['tests/test_integration.py::test_engine_rotation_timer', '-v', '--timeout=30'] =====

ERROR: usage: pytest.py [options] [file_or_dir] [file_or_dir] [...]
pytest.py: error: unrecognized arguments: --timeout=30
  inifile: F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.ini
  rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver




===== pytest run 2025-12-28 22:39:47 args=['tests/test_integration.py', '-v', '--timeout=60', '--maxfail=3'] =====

ERROR: usage: pytest.py [options] [file_or_dir] [file_or_dir] [...]
pytest.py: error: unrecognized arguments: --timeout=60
  inifile: F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.ini
  rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver




===== pytest run 2025-12-28 22:46:31 args=['tests/test_integration.py::test_engine_rotation_timer', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_integration.py::test_engine_rotation_timer 
FAILED                                                                                                                                         [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________________ test_engine_rotation_timer ________________________________________________________________________________________

tests\test_integration.py:135: in test_engine_rotation_timer

    assert engine._rotation_timer.isActive() is False

E   assert True is False

E    +  where True = <built-in method isActive of PySide6.QtCore.QTimer object at 0x0000020854DAFD40>()

E    +    where <built-in method isActive of PySide6.QtCore.QTimer object at 0x0000020854DAFD40> = <PySide6.QtCore.QTimer(0x2084df8c850) at 0x0000020854DAFD40>.isActive

E    +      where <PySide6.QtCore.QTimer(0x2084df8c850) at 0x0000020854DAFD40> = <engine.screensaver_engine.ScreensaverEngine(0x2080ab503c0) at 0x000002083A88B5C0>._rotation_timer

------------------------------------------------------------------------------------------ Captured log teardown ------------------------------------------------------------------------------------------

WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 36142.58ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 36142.58ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


========================================================================================= short test summary info =========================================================================================

FAILED tests/test_integration.py::test_engine_rotation_timer - assert True is False

=========================================================================================== 1 failed in 38.16s ============================================================================================


===== pytest run 2025-12-28 22:47:34 args=['tests/test_integration.py', '-v', '--tb=short', '--cache-clear'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 15 items



tests/test_integration.py::test_engine_creation 
PASSED                   [  6%]


tests/test_integration.py::test_engine_initialization 
PASSED             [ 13%]


tests/test_integration.py::test_engine_core_systems 
PASSED               [ 20%]


tests/test_integration.py::test_engine_image_queue_initialization 
PASSED [ 26%]


tests/test_integration.py::test_engine_display_initialization 
PASSED     [ 33%]


tests/test_integration.py::test_engine_start_stop 
PASSED                 [ 40%]


tests/test_integration.py::test_engine_signals 
PASSED                    [ 46%]


tests/test_integration.py::test_engine_rotation_timer 
FAILED             [ 53%]


tests/test_integration.py::test_engine_get_stats 
PASSED                  [ 60%]


tests/test_integration.py::test_engine_cleanup 
PASSED                    [ 66%]


tests/test_integration.py::test_engine_without_initialization 
PASSED     [ 73%]


tests/test_integration.py::test_engine_default_rss_sources 
PASSED        [ 80%]


tests/test_integration.py::test_engine_settings_integration 
PASSED       [ 86%]


tests/test_integration.py::test_engine_multiple_start_calls 
PASSED       [ 93%]


tests/test_integration.py::test_engine_stop_without_start 
PASSED         [100%]




================================== FAILURES ===================================

_________________________ test_engine_rotation_timer __________________________

tests\test_integration.py:135: in test_engine_rotation_timer

    assert engine._rotation_timer.isActive() is False

E   assert True is False

E    +  where True = <built-in method isActive of PySide6.QtCore.QTimer object at 0x0000018930A1F3C0>()

E    +    where <built-in method isActive of PySide6.QtCore.QTimer object at 0x0000018930A1F3C0> = <PySide6.QtCore.QTimer(0x189229c7560) at 0x0000018930A1F3C0>.isActive

E    +      where <PySide6.QtCore.QTimer(0x189229c7560) at 0x0000018930A1F3C0> = <engine.screensaver_engine.ScreensaverEngine(0x1894eb897a0) at 0x0000018928F02800>._rotation_timer

------------------------------ Captured log call ------------------------------

WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 309.77ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


-------------------------- Captured stderr teardown ---------------------------

qt.gui.imageio.jpeg: Corrupt JPEG data: premature end of data segment

---------------------------- Captured log teardown ----------------------------

WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 437.32ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 478.65ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 478.65ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 477.66ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 479.20ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 479.20ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 479.20ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 480.23ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 62.90ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 63.93ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 65.45ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 65.45ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
ERROR    core.threading.manager:manager.py:234 Task task_1688738056592 failed: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/All/hot.json?limit=25
ERROR    core.threading.manager:manager.py:234 Task task_1688738102992 failed: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/Games/hot.json?limit=25
ERROR    core.threading.manager:manager.py:234 Task task_1688738102224 failed: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/All/hot.json?limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/EarthPorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/EarthPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/EarthPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/EarthPorn/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/SpacePorn/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/CityPorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/CityPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/CityPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/CityPorn/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/ArchitecturePorn/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WaterPorn/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/WQHD_Wallpaper/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/4kwallpaper/top/.json?t=day&limit=25
ERROR    sources.rss_source:rss_source.py:558 Failed to fetch JSON feed https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25: 429 Client Error: Too Many Requests for url: https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25
WARNING  sources.rss_source:rss_source.py:180 [FEED_HEALTH] Feed https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25 failed 1 times, backoff 60s
WARNING  sources.rss_source:rss_source.py:380 [RATE_LIMIT] Reddit feed returned 0 images: https://www.reddit.com/r/AbandonedPorn/top/.json?t=day&limit=25
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26568.09ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26567.07ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26567.07ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26567.07ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26611.31ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26612.81ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26612.81ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26612.81ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26612.81ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26614.35ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26614.35ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26614.35ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26615.87ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  widgets.spotify_visualizer_widget:spotify_visualizer_widget.py:1957 [PERF] [SPOTIFY_VIS] Tick dt spike 26614.37ms (running=False name=<none> elapsed=<n/a> idle_age=<n/a>)
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down
WARNING  engine.screensaver:screensaver_engine.py:1851 [ASYNC] Failed to submit task, falling back to sync: Thread manager is shut down


=========================== short test summary info ===========================

FAILED tests/test_integration.py::test_engine_rotation_timer - assert True is...

================== 1 failed, 14 passed in 325.19s (0:05:25) ===================


===== pytest run 2025-12-28 22:53:10 args=['tests/test_integration.py', '-v', '--cache-clear', '--maxfail=3'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 15 items



tests/test_integration.py::test_engine_creation 
PASSED                                                                                                                                               [  6%]


tests/test_integration.py::test_engine_initialization 
PASSED                                                                                                                                         [ 13%]


tests/test_integration.py::test_engine_core_systems 
PASSED                                                                                                                                           [ 20%]


tests/test_integration.py::test_engine_image_queue_initialization 
PASSED                                                                                                                             [ 26%]


tests/test_integration.py::test_engine_display_initialization 
PASSED                                                                                                                                 [ 33%]

===== pytest run 2025-12-28 22:56:03 args=['tests/test_integration.py::test_engine_rotation_timer', '-v', '--tb=short'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_integration.py::test_engine_rotation_timer 
PASSED             [100%]




============================== 1 passed in 3.27s ==============================


===== pytest run 2025-12-28 22:56:19 args=['tests/', '--ignore=tests/test_rss_source.py', '-v', '--maxfail=10', '--timeout=120'] =====

ERROR: usage: pytest.py [options] [file_or_dir] [file_or_dir] [...]
pytest.py: error: unrecognized arguments: --timeout=120
  inifile: F:\Programming\Apps\ShittyRandomPhotoScreenSaver\pytest.ini
  rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver




===== pytest run 2025-12-28 22:57:13 args=['tests/test_integration.py::test_engine_rotation_timer', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_integration.py::test_engine_rotation_timer 
PASSED                                                                                                                                         [100%]




============================================================================================ 1 passed in 2.90s ============================================================================================


===== pytest run 2025-12-28 22:57:32 args=['tests/test_integration.py::test_engine_rotation_timer', '-v', '--tb=long'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_integration.py::test_engine_rotation_timer 
PASSED             [100%]




============================== 1 passed in 2.87s ==============================


===== pytest run 2025-12-28 22:57:48 args=['tests/test_integration.py::test_engine_rotation_timer', '-v', '--tb=short'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_integration.py::test_engine_rotation_timer 
PASSED             [100%]




============================== warnings summary ===============================

tests/test_integration.py::test_engine_rotation_timer
tests/test_integration.py::test_engine_rotation_timer
tests/test_integration.py::test_engine_rotation_timer


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\display_widget.py:2600: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    event.pos(), getattr(self, "spotify_volume_widget", None)




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

======================== 1 passed, 3 warnings in 3.29s ========================


===== pytest run 2025-12-28 22:57:59 args=['tests/', '--ignore=tests/test_rss_source.py', '-v', '--tb=line', '--maxfail=10'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 612 items / 4 skipped



tests/test_animation.py::test_animation_manager_initialization 
PASSED    [  0%]


tests/test_animation.py::test_property_animation 
PASSED                  [  0%]


tests/test_animation.py::test_custom_animation 
PASSED                    [  0%]


tests/test_animation.py::test_animation_pause_resume 
PASSED              [  0%]


tests/test_animation.py::test_animation_cancel 
PASSED                    [  0%]


tests/test_animation.py::test_easing_curves 
PASSED                       [  0%]


tests/test_animation.py::test_animation_with_delay 
PASSED                [  1%]


tests/test_animation.py::test_multiple_animations 
PASSED                 [  1%]


tests/test_animation.py::test_cancel_all_animations 
PASSED               [  1%]


tests/test_animation.py::test_animation_manager_auto_stop 
PASSED         [  1%]


tests/test_animation.py::test_animation_manager_emits_perf_metrics 
PASSED [  1%]


tests/test_animation_set_target_fps.py::test_set_target_fps_updates_timer_interval 
PASSED [  1%]


tests/test_block_puzzle_flip.py::test_block_puzzle_creation 
PASSED       [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_runs_and_labels 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_cleanup 
PASSED        [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_invalid_pixmap 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_set_flip_duration 
PASSED [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_randomization 
PASSED  [  2%]


tests/test_block_puzzle_flip.py::test_block_puzzle_small_widget 
PASSED   [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug1_clock_widget_created 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug2_set_text_color_method_exists 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug3_color_array_to_qcolor_conversion 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug4_z_order_clock_on_top 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug5_settings_retrieval_no_crash 
PASSED [  3%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug6_boolean_type_conversion 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug7_position_string_to_enum 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug8_format_string_to_enum 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_bug9_missing_raise_call 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_visibility_after_setup 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_widget_size_and_position 
PASSED [  4%]


tests/test_clock_integration_regression.py::TestClockIntegrationRegression::test_clock_settings_complete_integration 
PASSED [  5%]


tests/test_clock_widget.py::test_time_format_enum 
PASSED                 [  5%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED              [  5%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                   [  5%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                 [  5%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                    [  5%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                 [  6%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                 [  6%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED            [  6%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED               [  6%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED            [  6%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED           [  6%]


tests/test_clock_widget.py::test_clock_all_positions 
PASSED              [  7%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED               [  7%]


tests/test_clock_widget.py::test_clock_set_font_size 
PASSED              [  7%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED             [  7%]


tests/test_clock_widget.py::test_clock_set_margin 
PASSED                 [  7%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                    [  7%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED [  8%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED          [  8%]


tests/test_context_menu_effect_invalidation.py::test_context_menu_invalidates_effects_before_popup 
PASSED [  8%]


tests/test_ctrl_interaction_mode.py::test_ctrl_held_suppresses_mouse_exit_single_widget 
PASSED [  8%]


tests/test_ctrl_interaction_mode.py::test_ctrl_held_global_across_multiple_widgets 
PASSED [  8%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777344] 
PASSED [  8%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777349] 
PASSED [  8%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777347] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777346] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777330] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777328] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_media_keys_do_not_exit_screensaver[16777329] 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_fades_in_and_out 
PASSED [  9%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_owner_migrates_between_screens 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_shows_without_slack_attr 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_context_menu_active 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_hides_when_cursor_leaves_display 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_inactivity_timeout 
PASSED [ 10%]


tests/test_ctrl_interaction_mode.py::test_ctrl_halo_suppressed_while_settings_dialog_active 
FAILED [ 10%]


tests/test_diffuse_transition.py::test_diffuse_creation 
PASSED           [ 11%]


tests/test_diffuse_transition.py::test_diffuse_start_no_old_image 
PASSED [ 11%]


tests/test_diffuse_transition.py::test_diffuse_start_with_images 
PASSED  [ 11%]


tests/test_diffuse_transition.py::test_diffuse_signals 
PASSED            [ 11%]


tests/test_diffuse_transition.py::test_diffuse_progress_range 
PASSED     [ 11%]


tests/test_diffuse_transition.py::test_diffuse_stop 
PASSED               [ 11%]


tests/test_diffuse_transition.py::test_diffuse_grid_creation 
PASSED      [ 12%]


tests/test_diffuse_transition.py::test_diffuse_cleanup 
PASSED            [ 12%]


tests/test_diffuse_transition.py::test_diffuse_invalid_pixmap 
PASSED     [ 12%]


tests/test_diffuse_transition.py::test_diffuse_already_running 
PASSED    [ 12%]


tests/test_diffuse_transition.py::test_diffuse_block_size 
PASSED         [ 12%]


tests/test_diffuse_transition.py::test_diffuse_small_widget 
PASSED       [ 12%]


tests/test_diffuse_transition.py::test_diffuse_randomization 
PASSED      [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayAttributes::test_dimming_overlay_uses_translucent_background 
PASSED [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayAttributes::test_dimming_overlay_opacity_calculation 
PASSED [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayAttributes::test_dimming_overlay_opacity_clamping 
PASSED [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestCtrlHaloAttributes::test_halo_code_uses_translucent_background 
PASSED [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestMediaWidgetClickDetection::test_click_detection_checks_y_coordinate 
PASSED [ 13%]


tests/test_dimming_and_interaction_fixes.py::TestMediaWidgetClickDetection::test_controls_row_height_is_reasonable 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestCrumbleShaderPerformance::test_crumble_search_range_is_reduced 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestSettingsDotNotation::test_dimming_settings_use_dot_notation 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestSettingsDotNotation::test_pixel_shift_settings_use_dot_notation 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestSettingsDotNotation::test_context_menu_dimming_uses_dot_notation 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayZOrder::test_raise_overlay_includes_dimming 
PASSED [ 14%]


tests/test_dimming_and_interaction_fixes.py::TestDimmingOverlayZOrder::test_raise_overlay_zorder_documented 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_creation 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_loads_settings 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_saves_monitor_selection 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_saves_display_mode 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_saves_timing 
PASSED [ 15%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_boolean_conversion 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_lanczos_setting 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_sharpen_setting 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_same_image_monitors 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_all_settings_persist 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_default_values 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_invalid_mode_handling 
PASSED [ 16%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_invalid_interval_handling 
PASSED [ 17%]


tests/test_display_tab.py::TestDisplayTab::test_display_tab_ui_elements_exist 
PASSED [ 17%]


tests/test_engine_lifecycle.py::TestEngineState::test_engine_state_enum_values 
PASSED [ 17%]


tests/test_engine_lifecycle.py::TestEngineState::test_initial_state_is_uninitialized 
PASSED [ 17%]


tests/test_engine_lifecycle.py::TestEngineState::test_running_property_false_when_not_running 
PASSED [ 17%]


tests/test_engine_lifecycle.py::TestEngineState::test_running_property_true_when_running 
PASSED [ 17%]


tests/test_engine_lifecycle.py::TestEngineState::test_initialized_property 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_false_in_running 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_false_in_reinitializing 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_true_in_stopping 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_true_in_shutting_down 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestShuttingDownProperty::test_shutting_down_false_in_other_states 
PASSED [ 18%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_transition_state_success 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_transition_state_invalid_source 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_transition_from_shutting_down_blocked 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_transition_without_expected_from 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestStateTransitions::test_is_state_check 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestStateTransitionThreadSafety::test_concurrent_state_reads 
PASSED [ 19%]


tests/test_engine_lifecycle.py::TestStateTransitionThreadSafety::test_concurrent_state_transitions 
PASSED [ 20%]


tests/test_engine_lifecycle.py::TestRSSReloadBugScenario::test_settings_change_does_not_abort_rss 
PASSED [ 20%]


tests/test_engine_lifecycle.py::TestRSSReloadBugScenario::test_actual_shutdown_aborts_rss 
PASSED [ 20%]


tests/test_engine_lifecycle.py::TestGetStats::test_get_stats_includes_state 
PASSED [ 20%]


tests/test_events.py::test_event_system_initialization 
PASSED            [ 20%]


tests/test_events.py::test_subscribe_and_publish 
PASSED                  [ 20%]


tests/test_events.py::test_unsubscribe 
PASSED                            [ 21%]


tests/test_events.py::test_priority_ordering 
PASSED                      [ 21%]


tests/test_events.py::test_event_filter 
PASSED                           [ 21%]


tests/test_events.py::test_event_history 
PASSED                          [ 21%]


tests/test_flicker_fix_integration.py::TestQtAllocationLimit::test_allocation_limit_increased 
PASSED [ 21%]


tests/test_flicker_fix_integration.py::TestQtAllocationLimit::test_large_image_can_be_allocated 
PASSED [ 21%]


tests/test_flicker_fix_integration.py::TestTransitionTelemetryFlow::test_transition_tracks_timing 
SKIPPED [ 22%]


tests/test_flicker_fix_integration.py::TestMultiDisplaySyncFlow::test_sync_queue_lifecycle 
PASSED [ 22%]


tests/test_flicker_fix_integration.py::TestMultiDisplaySyncFlow::test_sync_timeout_handling 
PASSED [ 22%]


tests/test_flicker_fix_integration.py::TestRegressionPrevention::test_no_process_events_in_transitions 
PASSED [ 22%]


tests/test_flicker_fix_integration.py::TestRegressionPrevention::test_showfullscreen_not_deferred 
PASSED [ 22%]


tests/test_frame_timing_workload.py::TestFrameTimingWorkload::test_slide_with_visualizer_load 
PASSED [ 22%]


tests/test_frame_timing_workload.py::TestFrameTimingWorkload::test_sustained_workload 
FAILED [ 23%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[1080p_dpr1_primary] 
PASSED [ 23%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[left_negative_origin] 
PASSED [ 23%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[4k_125pct] 
PASSED [ 23%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[right_4k_150pct] 
PASSED [ 23%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[portrait_above_200pct] 
PASSED [ 23%]


tests/test_geometry_dpi_matrix.py::test_handle_screen_change_applies_geometry_and_dpr[laptop_175pct] 
PASSED [ 24%]


tests/test_gl_compositor_blinds.py::test_gl_compositor_blinds_no_underlay_and_no_black 
PASSED [ 24%]


tests/test_gl_compositor_blockflip.py::test_gl_compositor_blockflip_no_underlay_and_no_black 
PASSED [ 24%]


tests/test_gl_compositor_blockspin.py::test_gl_compositor_blockspin_no_underlay_and_no_black 
FAILED [ 24%]


tests/test_gl_compositor_cleanup.py::test_gl_compositor_cleanup_idempotent_without_context 
PASSED [ 24%]


tests/test_gl_compositor_cleanup.py::test_gl_compositor_cleanup_releases_pipeline_when_gl_available 
PASSED [ 24%]


tests/test_gl_compositor_crossfade.py::test_gl_compositor_crossfade_no_underlay_and_no_black 

===== pytest run 2025-12-28 22:58:45 args=['tests/test_integration.py', 'tests/test_events.py', 'tests/test_settings.py', 'tests/test_threading.py', 'tests/test_clock_widget.py', '-v', '--tb=line'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 58 items



tests/test_integration.py::test_engine_creation 
PASSED                   [  1%]


tests/test_integration.py::test_engine_initialization 
PASSED             [  3%]


tests/test_integration.py::test_engine_core_systems 
PASSED               [  5%]


tests/test_integration.py::test_engine_image_queue_initialization 
PASSED [  6%]


tests/test_integration.py::test_engine_display_initialization 
PASSED     [  8%]


tests/test_integration.py::test_engine_start_stop 
PASSED                 [ 10%]


tests/test_integration.py::test_engine_signals 
PASSED                    [ 12%]


tests/test_integration.py::test_engine_rotation_timer 
PASSED             [ 13%]


tests/test_integration.py::test_engine_get_stats 
PASSED                  [ 15%]


tests/test_integration.py::test_engine_cleanup 
PASSED                    [ 17%]


tests/test_integration.py::test_engine_without_initialization 
PASSED     [ 18%]


tests/test_integration.py::test_engine_default_rss_sources 
PASSED        [ 20%]


tests/test_integration.py::test_engine_settings_integration 
PASSED       [ 22%]


tests/test_integration.py::test_engine_multiple_start_calls 
PASSED       [ 24%]


tests/test_integration.py::test_engine_stop_without_start 
PASSED         [ 25%]


tests/test_events.py::test_event_system_initialization 
PASSED            [ 27%]


tests/test_events.py::test_subscribe_and_publish 
PASSED                  [ 29%]


tests/test_events.py::test_unsubscribe 
PASSED                            [ 31%]


tests/test_events.py::test_priority_ordering 
PASSED                      [ 32%]


tests/test_events.py::test_event_filter 
PASSED                           [ 34%]


tests/test_events.py::test_event_history 
PASSED                          [ 36%]


tests/test_settings.py::test_settings_manager_initialization 
PASSED      [ 37%]


tests/test_settings.py::test_get_set_setting 
PASSED                      [ 39%]


tests/test_settings.py::test_default_values 
PASSED                       [ 41%]


tests/test_settings.py::test_widget_defaults_helper_matches_schema 
PASSED [ 43%]


tests/test_settings.py::test_on_changed_handler 
PASSED                   [ 44%]


tests/test_settings.py::test_reset_to_defaults 
PASSED                    [ 46%]


tests/test_settings.py::test_get_all_keys 
PASSED                         [ 48%]


tests/test_settings.py::test_sst_round_trip_defaults 
PASSED              [ 50%]


tests/test_settings.py::test_sst_merge_and_type_coercion_and_preview 
PASSED [ 51%]


tests/test_threading.py::test_thread_manager_initialization 
PASSED       [ 53%]


tests/test_threading.py::test_submit_io_task 
PASSED                      [ 55%]


tests/test_threading.py::test_submit_compute_task 
PASSED                 [ 56%]


tests/test_threading.py::test_get_pool_stats 
PASSED                      [ 58%]


tests/test_threading.py::test_thread_manager_shutdown 
PASSED             [ 60%]


tests/test_threading.py::test_run_on_ui_thread_from_ui_thread 
PASSED     [ 62%]


tests/test_threading.py::test_run_on_ui_thread_from_worker_thread 
PASSED [ 63%]


tests/test_threading.py::test_schedule_recurring_invokes_callback 
PASSED [ 65%]


tests/test_threading.py::test_schedule_recurring_with_description 
PASSED [ 67%]


tests/test_clock_widget.py::test_time_format_enum 
PASSED                 [ 68%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED              [ 70%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                   [ 72%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                 [ 74%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                    [ 75%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                 [ 77%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                 [ 79%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED            [ 81%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED               [ 82%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED            [ 84%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED           [ 86%]


tests/test_clock_widget.py::test_clock_all_positions 
PASSED              [ 87%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED               [ 89%]


tests/test_clock_widget.py::test_clock_set_font_size 
PASSED              [ 91%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED             [ 93%]


tests/test_clock_widget.py::test_clock_set_margin 
PASSED                 [ 94%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                    [ 96%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED [ 98%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED          [100%]




======================= 58 passed in 326.17s (0:05:26) ========================


===== pytest run 2025-12-28 23:17:50 args=['tests/test_clock_widget.py', 'tests/test_integration.py', '-v', '--tb=line', '-x'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 34 items



tests/test_clock_widget.py::test_time_format_enum 
PASSED                 [  2%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED              [  5%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                   [  8%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                 [ 11%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                    [ 14%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                 [ 17%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                 [ 20%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED            [ 23%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED               [ 26%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED            [ 29%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED           [ 32%]


tests/test_clock_widget.py::test_clock_all_positions 
PASSED              [ 35%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED               [ 38%]


tests/test_clock_widget.py::test_clock_set_font_size 
PASSED              [ 41%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED             [ 44%]


tests/test_clock_widget.py::test_clock_set_margin 
PASSED                 [ 47%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                    [ 50%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED [ 52%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED          [ 55%]


tests/test_integration.py::test_engine_creation 
PASSED                   [ 58%]


tests/test_integration.py::test_engine_initialization 
PASSED             [ 61%]


tests/test_integration.py::test_engine_core_systems 
PASSED               [ 64%]


tests/test_integration.py::test_engine_image_queue_initialization 
PASSED [ 67%]


tests/test_integration.py::test_engine_display_initialization 
PASSED     [ 70%]


tests/test_integration.py::test_engine_start_stop 
PASSED                 [ 73%]


tests/test_integration.py::test_engine_signals 
PASSED                    [ 76%]


tests/test_integration.py::test_engine_rotation_timer 
PASSED             [ 79%]


tests/test_integration.py::test_engine_get_stats 
PASSED                  [ 82%]


tests/test_integration.py::test_engine_cleanup 
PASSED                    [ 85%]


tests/test_integration.py::test_engine_without_initialization 
PASSED     [ 88%]


tests/test_integration.py::test_engine_default_rss_sources 
PASSED        [ 91%]


tests/test_integration.py::test_engine_settings_integration 
PASSED       [ 94%]


tests/test_integration.py::test_engine_multiple_start_calls 
PASSED       [ 97%]


tests/test_integration.py::test_engine_stop_without_start 
PASSED         [100%]




============================== warnings summary ===============================

core\windows\reddit_helper_installer.py:1

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\core\windows\reddit_helper_installer.py:1: DeprecationWarning: invalid escape sequence '\S'
    """




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

================== 34 passed, 1 warning in 361.26s (0:06:01) ==================


===== pytest run 2025-12-28 23:24:00 args=['tests/test_clock_widget.py', 'tests/test_integration.py', '-v', '--tb=short'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 34 items



tests/test_clock_widget.py::test_time_format_enum 
PASSED                 [  2%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED              [  5%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                   [  8%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                 [ 11%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                    [ 14%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                 [ 17%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                 [ 20%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED            [ 23%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED               [ 26%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED            [ 29%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED           [ 32%]


tests/test_clock_widget.py::test_clock_all_positions 
PASSED              [ 35%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED               [ 38%]


tests/test_clock_widget.py::test_clock_set_font_size 
PASSED              [ 41%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED             [ 44%]


tests/test_clock_widget.py::test_clock_set_margin 
PASSED                 [ 47%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                    [ 50%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED [ 52%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED          [ 55%]


tests/test_integration.py::test_engine_creation 
PASSED                   [ 58%]


tests/test_integration.py::test_engine_initialization 
PASSED             [ 61%]


tests/test_integration.py::test_engine_core_systems 
PASSED               [ 64%]


tests/test_integration.py::test_engine_image_queue_initialization 
PASSED [ 67%]


tests/test_integration.py::test_engine_display_initialization 
PASSED     [ 70%]


tests/test_integration.py::test_engine_start_stop 
PASSED                 [ 73%]


tests/test_integration.py::test_engine_signals 
PASSED                    [ 76%]


tests/test_integration.py::test_engine_rotation_timer 
PASSED             [ 79%]


tests/test_integration.py::test_engine_get_stats 
PASSED                  [ 82%]


tests/test_integration.py::test_engine_cleanup 
PASSED                    [ 85%]


tests/test_integration.py::test_engine_without_initialization 
PASSED     [ 88%]


tests/test_integration.py::test_engine_default_rss_sources 
PASSED        [ 91%]


tests/test_integration.py::test_engine_settings_integration 
PASSED       [ 94%]


tests/test_integration.py::test_engine_multiple_start_calls 
PASSED       [ 97%]


tests/test_integration.py::test_engine_stop_without_start 
PASSED         [100%]




============================== warnings summary ===============================

core\windows\reddit_helper_installer.py:1

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\core\windows\reddit_helper_installer.py:1: DeprecationWarning: invalid escape sequence '\S'
    """




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

================== 34 passed, 1 warning in 305.89s (0:05:05) ==================


===== pytest run 2025-12-28 23:29:18 args=['tests/test_clock_widget.py', 'tests/test_integration.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 34 items



tests/test_clock_widget.py::test_time_format_enum 
PASSED                                                                                                                                             [  2%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED                                                                                                                                          [  5%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                                                                                                                                               [  8%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                                                                                                                                             [ 11%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                                                                                                                                                [ 14%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                                                                                                                                             [ 17%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                                                                                                                                             [ 20%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED                                                                                                                                        [ 23%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED                                                                                                                                           [ 26%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED                                                                                                                                        [ 29%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED                                                                                                                                       [ 32%]


tests/test_clock_widget.py::test_clock_all_positions 
PASSED                                                                                                                                          [ 35%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED                                                                                                                                           [ 38%]


tests/test_clock_widget.py::test_clock_set_font_size 
PASSED                                                                                                                                          [ 41%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED                                                                                                                                         [ 44%]


tests/test_clock_widget.py::test_clock_set_margin 
PASSED                                                                                                                                             [ 47%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                                                                                                                                                [ 50%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED                                                                                                                            [ 52%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED                                                                                                                                      [ 55%]


tests/test_integration.py::test_engine_creation 
PASSED                                                                                                                                               [ 58%]


tests/test_integration.py::test_engine_initialization 
PASSED                                                                                                                                         [ 61%]


tests/test_integration.py::test_engine_core_systems 
PASSED                                                                                                                                           [ 64%]


tests/test_integration.py::test_engine_image_queue_initialization 
PASSED                                                                                                                             [ 67%]


tests/test_integration.py::test_engine_display_initialization 
PASSED                                                                                                                                 [ 70%]


tests/test_integration.py::test_engine_start_stop 
PASSED                                                                                                                                             [ 73%]


tests/test_integration.py::test_engine_signals 
PASSED                                                                                                                                                [ 76%]


tests/test_integration.py::test_engine_rotation_timer 
PASSED                                                                                                                                         [ 79%]


tests/test_integration.py::test_engine_get_stats 
PASSED                                                                                                                                              [ 82%]


tests/test_integration.py::test_engine_cleanup 
PASSED                                                                                                                                                [ 85%]


tests/test_integration.py::test_engine_without_initialization 
PASSED                                                                                                                                 [ 88%]


tests/test_integration.py::test_engine_default_rss_sources 
PASSED                                                                                                                                    [ 91%]


tests/test_integration.py::test_engine_settings_integration 
PASSED                                                                                                                                   [ 94%]


tests/test_integration.py::test_engine_multiple_start_calls 
PASSED                                                                                                                                   [ 97%]


tests/test_integration.py::test_engine_stop_without_start 
PASSED                                                                                                                                     [100%]




============================================================================================ warnings summary =============================================================================================

core\windows\reddit_helper_installer.py:1

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\core\windows\reddit_helper_installer.py:1: DeprecationWarning: invalid escape sequence '\S'
    """




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

================================================================================ 34 passed, 1 warning in 300.63s (0:05:00) ================================================================================


===== pytest run 2025-12-28 23:34:25 args=['tests/test_clock_widget.py', 'tests/test_integration.py', '--tb=line', '-q'] =====

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                                   [100%]


============================================================================================ warnings summary =============================================================================================

core\windows\reddit_helper_installer.py:1

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\core\windows\reddit_helper_installer.py:1: DeprecationWarning: invalid escape sequence '\S'
    """




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

34 passed, 1 warning in 258.21s (0:04:18)


===== pytest run 2025-12-28 23:38:50 args=['tests/test_clock_widget.py', 'tests/test_integration.py', '-q'] =====

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                                   [100%]


============================================================================================ warnings summary =============================================================================================

core\windows\reddit_helper_installer.py:1

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\core\windows\reddit_helper_installer.py:1: DeprecationWarning: invalid escape sequence '\S'
    """




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

34 passed, 1 warning in 329.66s (0:05:29)


===== pytest run 2025-12-28 23:44:26 args=['tests/test_clock_widget.py', 'tests/test_integration.py'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 34 items



tests\test_clock_widget.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                       [ 55%]


tests\test_integration.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                            [100%]




============================================================================================ warnings summary =============================================================================================

core\windows\reddit_helper_installer.py:1

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\core\windows\reddit_helper_installer.py:1: DeprecationWarning: invalid escape sequence '\S'
    """




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

================================================================================ 34 passed, 1 warning in 287.29s (0:04:47) ================================================================================


===== pytest run 2025-12-28 23:56:04 args=['tests/test_clock_widget.py', 'tests/test_weather_widget.py', '-v', '-x', '--tb=short'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 40 items



tests/test_clock_widget.py::test_time_format_enum 
PASSED                 [  2%]


tests/test_clock_widget.py::test_clock_position_enum 
PASSED              [  5%]


tests/test_clock_widget.py::test_clock_creation 
PASSED                   [  7%]


tests/test_clock_widget.py::test_clock_start_stop 
PASSED                 [ 10%]


tests/test_clock_widget.py::test_clock_signals 
PASSED                    [ 12%]


tests/test_clock_widget.py::test_clock_12h_format 
PASSED                 [ 15%]


tests/test_clock_widget.py::test_clock_24h_format 
PASSED                 [ 17%]


tests/test_clock_widget.py::test_clock_without_seconds 
PASSED            [ 20%]


tests/test_clock_widget.py::test_clock_with_seconds 
PASSED               [ 22%]


tests/test_clock_widget.py::test_clock_set_time_format 
PASSED            [ 25%]


tests/test_clock_widget.py::test_clock_set_show_seconds 
PASSED           [ 27%]


tests/test_clock_widget.py::test_clock_all_positions 
PASSED              [ 30%]


tests/test_clock_widget.py::test_clock_set_position 
PASSED               [ 32%]


tests/test_clock_widget.py::test_clock_set_font_size 
PASSED              [ 35%]


tests/test_clock_widget.py::test_clock_set_text_color 
PASSED             [ 37%]


tests/test_clock_widget.py::test_clock_set_margin 
PASSED                 [ 40%]


tests/test_clock_widget.py::test_clock_cleanup 
PASSED                    [ 42%]


tests/test_clock_widget.py::test_clock_concurrent_start_prevention 
PASSED [ 45%]


tests/test_clock_widget.py::test_clock_updates_over_time 
PASSED          [ 47%]


tests/test_weather_widget.py::test_weather_position_enum 
PASSED          [ 50%]


tests/test_weather_widget.py::test_weather_creation 
PASSED               [ 52%]


tests/test_weather_widget.py::test_weather_no_api_key 
FAILED             [ 55%]




================================== FAILURES ===================================

___________________________ test_weather_no_api_key ___________________________

tests\test_weather_widget.py:87: in test_weather_no_api_key

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x1defd729a70) at 0x000001DEFE134540>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

=========================== short test summary info ===========================

FAILED tests/test_weather_widget.py::test_weather_no_api_key - assert False i...

!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!

======================== 1 failed, 21 passed in 4.58s =========================


===== pytest run 2025-12-28 23:56:16 args=['tests/test_clock_widget.py'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 19 items



tests\test_clock_widget.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                       [100%]




=========================================================================================== 19 passed in 4.41s ============================================================================================


===== pytest run 2025-12-29 04:24:27 args=['tests/test_weather_widget.py', 'tests/test_media_widget.py'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collected 35 items



tests\test_weather_widget.py 
.
.
F
F
.
F
.
.
.
.
.
.
.
F
.
F
.
.
.
.
F
                                                                                                                                                   [ 60%]


tests\test_media_widget.py 
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                                                                                                                                            [100%]




================================================================================================ FAILURES =================================================================================================

_________________________________________________________________________________________ test_weather_no_api_key _________________________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x23662700d80) at 0x000002367FB5A6C0>, parent_widget = <PySide6.QtWidgets.QWidget(0x236603dce90) at 0x000002367FB5A400>



    def test_weather_no_api_key(qapp, parent_widget):

        """Test weather widget can start without API key (Open-Meteo doesn't need one)."""

        weather = WeatherWidget(parent=parent_widget)

    

        # Should work fine without API key

        with patch.object(weather, '_fetch_weather'):

            weather.start()

>           assert weather.is_running() is True

E           assert False is True

E            +  where False = is_running()

E            +    where is_running = <widgets.weather_widget.WeatherWidget(0x236603dd370) at 0x000002367FB5A540>.is_running



tests\test_weather_widget.py:87: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

____________________________________________________________________________________________ test_weather_stop ____________________________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x23662700d80) at 0x000002367FB5A6C0>, parent_widget = <PySide6.QtWidgets.QWidget(0x236627631a0) at 0x000002367FA80C80>



    def test_weather_stop(qapp, parent_widget):

        """Test stopping weather widget."""

        weather = WeatherWidget(parent=parent_widget)

    

        # Mock the fetch to avoid actual API call

        with patch.object(weather, '_fetch_weather'):

            weather.start()

>           assert weather.is_running() is True

E           assert False is True

E            +  where False = is_running()

E            +    where is_running = <widgets.weather_widget.WeatherWidget(0x23662762ae0) at 0x000002367FA80EC0>.is_running



tests\test_weather_widget.py:97: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

_______________________________________________________________________________________ test_weather_display_update _______________________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x23662700d80) at 0x000002367FB5A6C0>, parent_widget = <PySide6.QtWidgets.QWidget(0x23662762f60) at 0x000002367FB6B780>

mock_weather_data = {'main': {'humidity': 65, 'temp': 20.5}, 'name': 'London', 'weather': [{'description': 'scattered clouds', 'main': 'Clouds'}]}



    def test_weather_display_update(qapp, parent_widget, mock_weather_data):

        """Test weather display update."""

        weather = WeatherWidget(parent=parent_widget)

    

        weather._update_display(mock_weather_data)

        text = weather.text()

    

        # Should contain location and temperature

>       assert "LONDON" in text

E       assert 'LONDON' in "<div style='line-height:1.0'><div style='font-size:26pt; font-weight:700;'>London</div><div style='font-size:22pt;'><span style='font-weight:700;'>20C</span> - <span style='font-weight:600;'>Clouds</span></div></div>"



tests\test_weather_widget.py:125: AssertionError

__________________________________________________________________________________________ test_weather_cleanup ___________________________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x23662700d80) at 0x000002367FB5A6C0>, parent_widget = <PySide6.QtWidgets.QWidget(0x23662a1fc80) at 0x000002367F5998C0>



    def test_weather_cleanup(qapp, parent_widget):

        """Test weather cleanup."""

        weather = WeatherWidget(parent=parent_widget)

    

        with patch.object(weather, '_fetch_weather'):

            weather.start()

>           assert weather.is_running() is True

E           assert False is True

E            +  where False = is_running()

E            +    where is_running = <widgets.weather_widget.WeatherWidget(0x23662a20220) at 0x000002367F4EA940>.is_running



tests\test_weather_widget.py:236: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

______________________________________________________________________________________ test_weather_error_with_cache ______________________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x23662700d80) at 0x000002367FB5A6C0>, parent_widget = <PySide6.QtWidgets.QWidget(0x23662a20760) at 0x000002367FB4E340>

mock_weather_data = {'main': {'humidity': 65, 'temp': 20.5}, 'name': 'London', 'weather': [{'description': 'scattered clouds', 'main': 'Clouds'}]}



    def test_weather_error_with_cache(qapp, parent_widget, mock_weather_data):

        """Test error handling with valid cache."""

        weather = WeatherWidget(parent=parent_widget)

    

        # Set cache first

        weather._on_weather_fetched(mock_weather_data)

    

        # Simulate error

        weather._on_fetch_error("Network error")

    

        # Should fall back to cache

        text = weather.text()

>       assert "LONDON" in text

E       assert 'LONDON' in "<div style='line-height:1.0'><div style='font-size:26pt; font-weight:700;'>London</div><div style='font-size:22pt;'><span style='font-weight:700;'>20C</span> - <span style='font-weight:600;'>Clouds</span></div></div>"



tests\test_weather_widget.py:269: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

WARNING  widgets.weather_widget:weather_widget.py:412 Fetch failed, using cached data: Network error

________________________________________________________________________________ test_weather_concurrent_start_prevention _________________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x23662700d80) at 0x000002367FB5A6C0>, parent_widget = <PySide6.QtWidgets.QWidget(0x23662a21900) at 0x000002361223B5C0>



    def test_weather_concurrent_start_prevention(qapp, parent_widget):

        """Test that starting when already running is handled."""

        weather = WeatherWidget(parent=parent_widget)

    

        with patch.object(weather, '_fetch_weather'):

            weather.start()

>           assert weather.is_running() is True

E           assert False is True

E            +  where False = is_running()

E            +    where is_running = <widgets.weather_widget.WeatherWidget(0x23662a21120) at 0x000002361223A180>.is_running



tests\test_weather_widget.py:337: AssertionError

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

============================================================================================ warnings summary =============================================================================================

tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_media_widget.py:469: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




tests/test_media_widget.py::test_display_widget_ctrl_click_routes_to_media_widget
tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget


  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\rendering\input_handler.py:631: DeprecationWarning: Function: 'QMouseEvent.pos() const' is marked as deprecated, please check the documentation for more information.
    pos = event.pos()




tests/test_media_widget.py::test_display_widget_hard_exit_click_routes_to_media_widget

  F:\Programming\Apps\ShittyRandomPhotoScreenSaver\tests\test_media_widget.py:539: DeprecationWarning: Function: 'QMouseEvent.QMouseEvent(QEvent.Type type, const QPointF &localPos, Qt.MouseButton button, QFlags<Qt.MouseButton> buttons, QFlags<Qt.KeyboardModifier> modifiers, const QPointingDevice *device)' is marked as deprecated, please check the documentation for more information.
    event = QMouseEvent(




-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_weather_widget.py::test_weather_no_api_key - assert False is True

FAILED tests/test_weather_widget.py::test_weather_stop - assert False is True

FAILED tests/test_weather_widget.py::test_weather_display_update - assert 'LONDON' in "<div style='line-height:1.0'><div style='font-size:26pt; font-weight:700;'>London</div><div style='font-size:22pt;...

FAILED tests/test_weather_widget.py::test_weather_cleanup - assert False is True

FAILED tests/test_weather_widget.py::test_weather_error_with_cache - assert 'LONDON' in "<div style='line-height:1.0'><div style='font-size:26pt; font-weight:700;'>London</div><div style='font-size:22p...

FAILED tests/test_weather_widget.py::test_weather_concurrent_start_prevention - assert False is True

================================================================================ 6 failed, 29 passed, 4 warnings in 2.31s =================================================================================


===== pytest run 2025-12-29 04:24:46 args=['tests/test_weather_widget.py', '-v', '--tb=short'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 21 items



tests/test_weather_widget.py::test_weather_position_enum 
PASSED          [  4%]


tests/test_weather_widget.py::test_weather_creation 
PASSED               [  9%]


tests/test_weather_widget.py::test_weather_no_api_key 
FAILED             [ 14%]


tests/test_weather_widget.py::test_weather_stop 
FAILED                   [ 19%]


tests/test_weather_widget.py::test_weather_signals 
PASSED                [ 23%]


tests/test_weather_widget.py::test_weather_display_update 
FAILED         [ 28%]


tests/test_weather_widget.py::test_weather_cache 
PASSED                  [ 33%]


tests/test_weather_widget.py::test_weather_all_positions 
PASSED          [ 38%]


tests/test_weather_widget.py::test_weather_set_position 
PASSED           [ 42%]


tests/test_weather_widget.py::test_weather_set_api_key 
PASSED            [ 47%]


tests/test_weather_widget.py::test_weather_set_location 
PASSED           [ 52%]


tests/test_weather_widget.py::test_weather_set_font_size 
PASSED          [ 57%]


tests/test_weather_widget.py::test_weather_set_text_color 
PASSED         [ 61%]


tests/test_weather_widget.py::test_weather_cleanup 
FAILED                [ 66%]


tests/test_weather_widget.py::test_weather_error_handling 
PASSED         [ 71%]


tests/test_weather_widget.py::test_weather_error_with_cache 
FAILED       [ 76%]


tests/test_weather_widget.py::test_weather_fetcher_creation 
PASSED       [ 80%]


tests/test_weather_widget.py::test_weather_fetcher_success 
PASSED        [ 85%]


tests/test_weather_widget.py::test_weather_fetcher_error 
PASSED          [ 90%]


tests/test_weather_widget.py::test_weather_display_no_data 
PASSED        [ 95%]


tests/test_weather_widget.py::test_weather_concurrent_start_prevention 
FAILED [100%]




================================== FAILURES ===================================

___________________________ test_weather_no_api_key ___________________________

tests\test_weather_widget.py:87: in test_weather_no_api_key

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x286c8b445a0) at 0x00000286CB063A40>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

______________________________ test_weather_stop ______________________________

tests\test_weather_widget.py:97: in test_weather_stop

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x286ca4abed0) at 0x00000286CB090480>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

_________________________ test_weather_display_update _________________________

tests\test_weather_widget.py:125: in test_weather_display_update

    assert "LONDON" in text

E   assert 'LONDON' in "<div style='line-height:1.0'><div style='font-size:26pt; font-weight:700;'>London</div><div style='font-size:22pt;'><span style='font-weight:700;'>20C</span> - <span style='font-weight:600;'>Clouds</span></div></div>"

____________________________ test_weather_cleanup _____________________________

tests\test_weather_widget.py:236: in test_weather_cleanup

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x286ca2a7ea0) at 0x00000286CB721700>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

________________________ test_weather_error_with_cache ________________________

tests\test_weather_widget.py:269: in test_weather_error_with_cache

    assert "LONDON" in text

E   assert 'LONDON' in "<div style='line-height:1.0'><div style='font-size:26pt; font-weight:700;'>London</div><div style='font-size:22pt;'><span style='font-weight:700;'>20C</span> - <span style='font-weight:600;'>Clouds</span></div></div>"

------------------------------ Captured log call ------------------------------

WARNING  widgets.weather_widget:weather_widget.py:412 Fetch failed, using cached data: Network error

__________________ test_weather_concurrent_start_prevention ___________________

tests\test_weather_widget.py:337: in test_weather_concurrent_start_prevention

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x286ca460b80) at 0x00000286CB70BC80>.is_running

------------------------------ Captured log call ------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

=========================== short test summary info ===========================

FAILED tests/test_weather_widget.py::test_weather_no_api_key - assert False i...

FAILED tests/test_weather_widget.py::test_weather_stop - assert False is True

FAILED tests/test_weather_widget.py::test_weather_display_update - assert 'LO...

FAILED tests/test_weather_widget.py::test_weather_cleanup - assert False is True

FAILED tests/test_weather_widget.py::test_weather_error_with_cache - assert '...

FAILED tests/test_weather_widget.py::test_weather_concurrent_start_prevention

======================== 6 failed, 15 passed in 0.42s =========================


===== pytest run 2025-12-29 04:24:56 args=['tests/test_weather_widget.py', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 21 items



tests/test_weather_widget.py::test_weather_position_enum 
PASSED                                                                                                                                      [  4%]


tests/test_weather_widget.py::test_weather_creation 
PASSED                                                                                                                                           [  9%]


tests/test_weather_widget.py::test_weather_no_api_key 
FAILED                                                                                                                                         [ 14%]


tests/test_weather_widget.py::test_weather_stop 
FAILED                                                                                                                                               [ 19%]


tests/test_weather_widget.py::test_weather_signals 
PASSED                                                                                                                                            [ 23%]


tests/test_weather_widget.py::test_weather_display_update 
FAILED                                                                                                                                     [ 28%]


tests/test_weather_widget.py::test_weather_cache 
PASSED                                                                                                                                              [ 33%]


tests/test_weather_widget.py::test_weather_all_positions 
PASSED                                                                                                                                      [ 38%]


tests/test_weather_widget.py::test_weather_set_position 
PASSED                                                                                                                                       [ 42%]


tests/test_weather_widget.py::test_weather_set_api_key 
PASSED                                                                                                                                        [ 47%]


tests/test_weather_widget.py::test_weather_set_location 
PASSED                                                                                                                                       [ 52%]


tests/test_weather_widget.py::test_weather_set_font_size 
PASSED                                                                                                                                      [ 57%]


tests/test_weather_widget.py::test_weather_set_text_color 
PASSED                                                                                                                                     [ 61%]


tests/test_weather_widget.py::test_weather_cleanup 
FAILED                                                                                                                                            [ 66%]


tests/test_weather_widget.py::test_weather_error_handling 
PASSED                                                                                                                                     [ 71%]


tests/test_weather_widget.py::test_weather_error_with_cache 
FAILED                                                                                                                                   [ 76%]


tests/test_weather_widget.py::test_weather_fetcher_creation 
PASSED                                                                                                                                   [ 80%]


tests/test_weather_widget.py::test_weather_fetcher_success 
PASSED                                                                                                                                    [ 85%]


tests/test_weather_widget.py::test_weather_fetcher_error 
PASSED                                                                                                                                      [ 90%]


tests/test_weather_widget.py::test_weather_display_no_data 
PASSED                                                                                                                                    [ 95%]


tests/test_weather_widget.py::test_weather_concurrent_start_prevention 
FAILED                                                                                                                        [100%]




================================================================================================ FAILURES =================================================================================================

_________________________________________________________________________________________ test_weather_no_api_key _________________________________________________________________________________________

tests\test_weather_widget.py:87: in test_weather_no_api_key

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x17eccc400b0) at 0x0000017ECE5DBB80>.is_running

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

____________________________________________________________________________________________ test_weather_stop ____________________________________________________________________________________________

tests\test_weather_widget.py:97: in test_weather_stop

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x17ecda1dd00) at 0x0000017ECE5ECD00>.is_running

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

_______________________________________________________________________________________ test_weather_display_update _______________________________________________________________________________________

tests\test_weather_widget.py:125: in test_weather_display_update

    assert "LONDON" in text

E   assert 'LONDON' in "<div style='line-height:1.0'><div style='font-size:26pt; font-weight:700;'>London</div><div style='font-size:22pt;'><span style='font-weight:700;'>20C</span> - <span style='font-weight:600;'>Clouds</span></div></div>"

__________________________________________________________________________________________ test_weather_cleanup ___________________________________________________________________________________________

tests\test_weather_widget.py:236: in test_weather_cleanup

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x17ed0e1d900) at 0x0000017ECEC9C540>.is_running

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

______________________________________________________________________________________ test_weather_error_with_cache ______________________________________________________________________________________

tests\test_weather_widget.py:269: in test_weather_error_with_cache

    assert "LONDON" in text

E   assert 'LONDON' in "<div style='line-height:1.0'><div style='font-size:26pt; font-weight:700;'>London</div><div style='font-size:22pt;'><span style='font-weight:700;'>20C</span> - <span style='font-weight:600;'>Clouds</span></div></div>"

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

WARNING  widgets.weather_widget:weather_widget.py:412 Fetch failed, using cached data: Network error

________________________________________________________________________________ test_weather_concurrent_start_prevention _________________________________________________________________________________

tests\test_weather_widget.py:337: in test_weather_concurrent_start_prevention

    assert weather.is_running() is True

E   assert False is True

E    +  where False = is_running()

E    +    where is_running = <widgets.weather_widget.WeatherWidget(0x17ecdbdbf50) at 0x0000017ECEC980C0>.is_running

-------------------------------------------------------------------------------------------- Captured log call --------------------------------------------------------------------------------------------

ERROR    widgets.base_overlay_widget:base_overlay_widget.py:351 [THREAD_MANAGER] Missing ThreadManager for weather during WeatherWidget.start; timer-driven features disabled.

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_weather_widget.py::test_weather_no_api_key - assert False is True

FAILED tests/test_weather_widget.py::test_weather_stop - assert False is True

FAILED tests/test_weather_widget.py::test_weather_display_update - assert 'LONDON' in "<div style='line-height:1.0'><div style='font-size:26pt; font-weight:700;'>London</div><div style='font-size:22pt;...

FAILED tests/test_weather_widget.py::test_weather_cleanup - assert False is True

FAILED tests/test_weather_widget.py::test_weather_error_with_cache - assert 'LONDON' in "<div style='line-height:1.0'><div style='font-size:26pt; font-weight:700;'>London</div><div style='font-size:22p...

FAILED tests/test_weather_widget.py::test_weather_concurrent_start_prevention - assert False is True

====================================================================================== 6 failed, 15 passed in 0.42s =======================================================================================


===== pytest run 2025-12-29 05:19:39 args=['tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation', 'tests/test_clock_widget.py::test_analog_clock_visual_offset_zero_with_background', 'tests/test_clock_widget.py::test_digital_clock_visual_offset_zero', 'tests/test_clock_widget.py::test_analog_clock_margin_alignment', '-v'] =====

============================= test session starts =============================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 4 items



tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation 
FAILED [ 25%]


tests/test_clock_widget.py::test_analog_clock_visual_offset_zero_with_background 
FAILED [ 50%]


tests/test_clock_widget.py::test_digital_clock_visual_offset_zero 
FAILED [ 75%]


tests/test_clock_widget.py::test_analog_clock_margin_alignment 
FAILED    [100%]




================================== FAILURES ===================================

_________________ test_analog_clock_visual_offset_calculation _________________



qapp = <PySide6.QtWidgets.QApplication(0x205546f6d70) at 0x0000020555A60280>

parent_widget = <PySide6.QtWidgets.QWidget(0x20554418390) at 0x0000020555A60140>



    def test_analog_clock_visual_offset_calculation(qapp, parent_widget):

        """Test that analogue clock without background calculates visual offset correctly."""

>       clock = ClockWidget(

            parent=parent_widget,

            position=ClockPosition.TOP_RIGHT,

            display_mode="analog",

        )

E       TypeError: ClockWidget.__init__() got an unexpected keyword argument 'display_mode'



tests\test_clock_widget.py:334: TypeError

____________ test_analog_clock_visual_offset_zero_with_background _____________



qapp = <PySide6.QtWidgets.QApplication(0x205546f6d70) at 0x0000020555A60280>

parent_widget = <PySide6.QtWidgets.QWidget(0x20554418870) at 0x0000020555F3CB00>



    def test_analog_clock_visual_offset_zero_with_background(qapp, parent_widget):

        """Test that analogue clock with background has zero visual offset."""

>       clock = ClockWidget(

            parent=parent_widget,

            position=ClockPosition.TOP_RIGHT,

            display_mode="analog",

        )

E       TypeError: ClockWidget.__init__() got an unexpected keyword argument 'display_mode'



tests\test_clock_widget.py:360: TypeError

____________________ test_digital_clock_visual_offset_zero ____________________



qapp = <PySide6.QtWidgets.QApplication(0x205546f6d70) at 0x0000020555A60280>

parent_widget = <PySide6.QtWidgets.QWidget(0x20554419b90) at 0x000002055605E9C0>



    def test_digital_clock_visual_offset_zero(qapp, parent_widget):

        """Test that digital clock has zero visual offset."""

>       clock = ClockWidget(

            parent=parent_widget,

            position=ClockPosition.TOP_RIGHT,

            display_mode="digital",

        )

E       TypeError: ClockWidget.__init__() got an unexpected keyword argument 'display_mode'



tests\test_clock_widget.py:380: TypeError

_____________________ test_analog_clock_margin_alignment ______________________



qapp = <PySide6.QtWidgets.QApplication(0x205546f6d70) at 0x0000020555A60280>

parent_widget = <PySide6.QtWidgets.QWidget(0x20554419470) at 0x0000020556600180>



    def test_analog_clock_margin_alignment(qapp, parent_widget):

        """Test that analogue clock without background aligns correctly with margin.

    

        When positioned at TOP_RIGHT with margin=20, the visual top of the clock

        (XII numeral) should be at y=20, not the widget bounds.

        """

        margin = 20

>       clock = ClockWidget(

            parent=parent_widget,

            position=ClockPosition.TOP_RIGHT,

            display_mode="analog",

            margin=margin,

        )

E       TypeError: ClockWidget.__init__() got an unexpected keyword argument 'display_mode'



tests\test_clock_widget.py:405: TypeError

=========================== short test summary info ===========================

FAILED tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation

FAILED tests/test_clock_widget.py::test_analog_clock_visual_offset_zero_with_background

FAILED tests/test_clock_widget.py::test_digital_clock_visual_offset_zero - Ty...

FAILED tests/test_clock_widget.py::test_analog_clock_margin_alignment - TypeE...

============================== 4 failed in 0.43s ==============================


===== pytest run 2025-12-29 05:19:50 args=['tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation 
FAILED                                                                                                                       [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________ test_analog_clock_visual_offset_calculation _______________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x200668b4d90) at 0x00000200675C8F00>, parent_widget = <PySide6.QtWidgets.QWidget(0x200665dbd30) at 0x00000200675C8EC0>



    def test_analog_clock_visual_offset_calculation(qapp, parent_widget):

        """Test that analogue clock without background calculates visual offset correctly."""

>       clock = ClockWidget(

            parent=parent_widget,

            position=ClockPosition.TOP_RIGHT,

            display_mode="analog",

        )

E       TypeError: ClockWidget.__init__() got an unexpected keyword argument 'display_mode'



tests\test_clock_widget.py:334: TypeError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation - TypeError: ClockWidget.__init__() got an unexpected keyword argument 'display_mode'

============================================================================================ 1 failed in 0.31s ============================================================================================


===== pytest run 2025-12-29 05:20:04 args=['tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation', '-v', '--tb=short'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation 
FAILED                                                                                                                       [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________ test_analog_clock_visual_offset_calculation _______________________________________________________________________________

tests\test_clock_widget.py:334: in test_analog_clock_visual_offset_calculation

    clock = ClockWidget(

E   TypeError: ClockWidget.__init__() got an unexpected keyword argument 'display_mode'

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation - TypeError: ClockWidget.__init__() got an unexpected keyword argument 'display_mode'

============================================================================================ 1 failed in 0.27s ============================================================================================


===== pytest run 2025-12-29 05:20:15 args=['tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation 
FAILED                                                                                                                       [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________ test_analog_clock_visual_offset_calculation _______________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x27aa9763be0) at 0x0000027AAA3DCD40>, parent_widget = <PySide6.QtWidgets.QWidget(0x27aa98a1660) at 0x0000027AAA3DCC80>



    def test_analog_clock_visual_offset_calculation(qapp, parent_widget):

        """Test that analogue clock without background calculates visual offset correctly."""

>       clock = ClockWidget(

            parent=parent_widget,

            position=ClockPosition.TOP_RIGHT,

            display_mode="analog",

        )

E       TypeError: ClockWidget.__init__() got an unexpected keyword argument 'display_mode'



tests\test_clock_widget.py:334: TypeError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation - TypeError: ClockWidget.__init__() got an unexpected keyword argument 'display_mode'

============================================================================================ 1 failed in 0.27s ============================================================================================


===== pytest run 2025-12-29 05:20:26 args=['tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation 
FAILED                                                                                                                       [100%]




================================================================================================ FAILURES =================================================================================================

_______________________________________________________________________________ test_analog_clock_visual_offset_calculation _______________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x1b7041568f0) at 0x000001B704D9CD40>, parent_widget = <PySide6.QtWidgets.QWidget(0x1b7034276b0) at 0x000001B704D9CC80>



    def test_analog_clock_visual_offset_calculation(qapp, parent_widget):

        """Test that analogue clock without background calculates visual offset correctly."""

>       clock = ClockWidget(

            parent=parent_widget,

            position=ClockPosition.TOP_RIGHT,

            display_mode="analog",

        )

E       TypeError: ClockWidget.__init__() got an unexpected keyword argument 'display_mode'



tests\test_clock_widget.py:334: TypeError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation - TypeError: ClockWidget.__init__() got an unexpected keyword argument 'display_mode'

============================================================================================ 1 failed in 0.33s ============================================================================================


===== pytest run 2025-12-29 05:21:53 args=['tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation', 'tests/test_clock_widget.py::test_analog_clock_margin_alignment', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 2 items



tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation 
PASSED                                                                                                                       [ 50%]


tests/test_clock_widget.py::test_analog_clock_margin_alignment 
PASSED                                                                                                                                [100%]




============================================================================================ 2 passed in 0.38s ============================================================================================


===== pytest run 2025-12-29 05:22:10 args=['tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation', 'tests/test_clock_widget.py::test_analog_clock_visual_offset_zero_with_background', 'tests/test_clock_widget.py::test_digital_clock_visual_offset_zero', 'tests/test_clock_widget.py::test_analog_clock_margin_alignment', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 4 items



tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation 
PASSED                                                                                                                       [ 25%]


tests/test_clock_widget.py::test_analog_clock_visual_offset_zero_with_background 
PASSED                                                                                                              [ 50%]


tests/test_clock_widget.py::test_digital_clock_visual_offset_zero 
PASSED                                                                                                                             [ 75%]


tests/test_clock_widget.py::test_analog_clock_margin_alignment 
PASSED                                                                                                                                [100%]




============================================================================================ 4 passed in 0.41s ============================================================================================


===== pytest run 2025-12-29 05:24:39 args=['tests/test_scrollwheel_volume.py::test_spotify_volume_widget_uses_coordinated_fade_sync', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 1 item



tests/test_scrollwheel_volume.py::test_spotify_volume_widget_uses_coordinated_fade_sync 
PASSED                                                                                                       [100%]


tests/test_scrollwheel_volume.py::test_spotify_volume_widget_uses_coordinated_fade_sync ERROR                                                                                                        [100%]




================================================================================================= ERRORS ==================================================================================================

_______________________________________________________________ ERROR at teardown of test_spotify_volume_widget_uses_coordinated_fade_sync ________________________________________________________________



item = <Function test_spotify_volume_widget_uses_coordinated_fade_sync>



    @pytest.hookimpl(wrapper=True, trylast=True)

    def pytest_runtest_teardown(item):

        """

        Hook called after each test tear down, to process any pending events and

        avoiding leaking events to the next test. Also, if exceptions have

        been captured during fixtures teardown, fail the test.

        """

        _process_events()

>       _close_widgets(item)



C:\Python311\Lib\site-packages\pytestqt\plugin.py:203: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



item = <Function test_spotify_volume_widget_uses_coordinated_fade_sync>



    def _close_widgets(item: pytest.Item) -> None:

        """

        Close all widgets registered in the pytest item.

        """

        widgets = getattr(item, "qt_widgets", None)

        if widgets:

            for w, before_close_func in item.qt_widgets:  # type: ignore[attr-defined]

                w = w()

                if w is not None:

                    if before_close_func is not None:

                        before_close_func(w)

>                   w.close()

E                   RuntimeError: Internal C++ object (SpotifyVolumeWidget) already deleted.



C:\Python311\Lib\site-packages\pytestqt\qtbot.py:808: RuntimeError

========================================================================================= short test summary info =========================================================================================

ERROR tests/test_scrollwheel_volume.py::test_spotify_volume_widget_uses_coordinated_fade_sync - RuntimeError: Internal C++ object (SpotifyVolumeWidget) already deleted.

======================================================================================= 1 passed, 1 error in 0.60s ========================================================================================


===== pytest run 2025-12-29 05:26:59 args=['tests/test_pixel_shift.py', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 9 items



tests/test_pixel_shift.py::test_pixel_shift_manager_creation 
PASSED                                                                                                                                  [ 11%]


tests/test_pixel_shift.py::test_pixel_shift_max_drift_constant 
PASSED                                                                                                                                [ 22%]


tests/test_pixel_shift.py::test_pixel_shift_calculate_next_offset_from_center 
FAILED                                                                                                                 [ 33%]


tests/test_pixel_shift.py::test_pixel_shift_no_immediate_shift_back 
PASSED                                                                                                                           [ 44%]


tests/test_pixel_shift.py::test_pixel_shift_respects_max_drift 
PASSED                                                                                                                                [ 55%]


tests/test_pixel_shift.py::test_pixel_shift_drifts_back_at_max 
PASSED                                                                                                                                [ 66%]


tests/test_pixel_shift.py::test_pixel_shift_outward_bias_statistics 
PASSED                                                                                                                           [ 77%]


tests/test_pixel_shift.py::test_pixel_shift_widget_registration 
PASSED                                                                                                                               [ 88%]


tests/test_pixel_shift.py::test_pixel_shift_applies_offset_to_widgets 
PASSED                                                                                                                         [100%]




================================================================================================ FAILURES =================================================================================================

___________________________________________________________________________ test_pixel_shift_calculate_next_offset_from_center ____________________________________________________________________________



pixel_shift_manager = <widgets.pixel_shift_manager.PixelShiftManager object at 0x0000026517394310>



    def test_pixel_shift_calculate_next_offset_from_center(pixel_shift_manager):

        """Test that first shift moves away from center."""

        manager = pixel_shift_manager

        manager._offset_x = 0

        manager._offset_y = 0

    

        # Run multiple times to check statistical behavior

        outward_count = 0

        for _ in range(100):

            manager._offset_x = 0

            manager._offset_y = 0

            new_x, new_y = manager._calculate_next_offset()

            # From center, any movement is outward

            if abs(new_x) + abs(new_y) > 0:

                outward_count += 1

    

        # Should almost always move outward from center

>       assert outward_count >= 95, f"Expected mostly outward movement, got {outward_count}/100"

E       AssertionError: Expected mostly outward movement, got 77/100

E       assert 77 >= 95



tests\test_pixel_shift.py:49: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_pixel_shift.py::test_pixel_shift_calculate_next_offset_from_center - AssertionError: Expected mostly outward movement, got 77/100

======================================================================================= 1 failed, 8 passed in 0.78s =======================================================================================


===== pytest run 2025-12-29 05:27:40 args=['tests/test_pixel_shift.py', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 9 items



tests/test_pixel_shift.py::test_pixel_shift_manager_creation 
PASSED                                                                                                                                  [ 11%]


tests/test_pixel_shift.py::test_pixel_shift_max_drift_constant 
PASSED                                                                                                                                [ 22%]


tests/test_pixel_shift.py::test_pixel_shift_calculate_next_offset_from_center 
PASSED                                                                                                                 [ 33%]


tests/test_pixel_shift.py::test_pixel_shift_no_immediate_shift_back 
PASSED                                                                                                                           [ 44%]


tests/test_pixel_shift.py::test_pixel_shift_respects_max_drift 
PASSED                                                                                                                                [ 55%]


tests/test_pixel_shift.py::test_pixel_shift_drifts_back_at_max 
PASSED                                                                                                                                [ 66%]


tests/test_pixel_shift.py::test_pixel_shift_outward_bias_statistics 
PASSED                                                                                                                           [ 77%]


tests/test_pixel_shift.py::test_pixel_shift_widget_registration 
PASSED                                                                                                                               [ 88%]


tests/test_pixel_shift.py::test_pixel_shift_applies_offset_to_widgets 
PASSED                                                                                                                         [100%]




============================================================================================ 9 passed in 0.45s ============================================================================================


===== pytest run 2025-12-29 05:30:09 args=['tests/test_multi_monitor_focus.py', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 9 items



tests/test_multi_monitor_focus.py::test_first_display_claims_focus 
PASSED                                                                                                                            [ 11%]


tests/test_multi_monitor_focus.py::test_second_display_cannot_claim_focus_normally 
PASSED                                                                                                            [ 22%]


tests/test_multi_monitor_focus.py::test_display_can_reclaim_own_focus 
PASSED                                                                                                                         [ 33%]


tests/test_multi_monitor_focus.py::test_focus_reclaimed_when_owner_not_visible 
PASSED                                                                                                                [ 44%]


tests/test_multi_monitor_focus.py::test_focus_reclaimed_when_owner_screen_unavailable 
PASSED                                                                                                         [ 55%]


tests/test_multi_monitor_focus.py::test_focus_reclaimed_when_owner_screen_has_invalid_geometry 
PASSED                                                                                                [ 66%]


tests/test_multi_monitor_focus.py::test_release_focus 
PASSED                                                                                                                                         [ 77%]


tests/test_multi_monitor_focus.py::test_release_focus_only_affects_owner 
PASSED                                                                                                                      [ 88%]


tests/test_multi_monitor_focus.py::test_is_focus_owner 
PASSED                                                                                                                                        [100%]




============================================================================================ 9 passed in 0.15s ============================================================================================


===== pytest run 2025-12-29 05:30:56 args=['tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation', 'tests/test_clock_widget.py::test_analog_clock_margin_alignment', 'tests/test_scrollwheel_volume.py::test_spotify_volume_widget_uses_coordinated_fade_sync', 'tests/test_pixel_shift.py::test_pixel_shift_no_immediate_shift_back', 'tests/test_multi_monitor_focus.py::test_focus_reclaimed_when_owner_screen_unavailable', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 5 items



tests/test_clock_widget.py::test_analog_clock_visual_offset_calculation 
PASSED                                                                                                                       [ 20%]


tests/test_clock_widget.py::test_analog_clock_margin_alignment 
PASSED                                                                                                                                [ 40%]


tests/test_scrollwheel_volume.py::test_spotify_volume_widget_uses_coordinated_fade_sync 
PASSED                                                                                                       [ 60%]


tests/test_scrollwheel_volume.py::test_spotify_volume_widget_uses_coordinated_fade_sync ERROR                                                                                                        [ 60%]


tests/test_pixel_shift.py::test_pixel_shift_no_immediate_shift_back 
ERROR                                                                                                                            [ 80%]


tests/test_multi_monitor_focus.py::test_focus_reclaimed_when_owner_screen_unavailable 
PASSED                                                                                                         [100%]




================================================================================================= ERRORS ==================================================================================================

_______________________________________________________________ ERROR at teardown of test_spotify_volume_widget_uses_coordinated_fade_sync ________________________________________________________________



item = <Function test_spotify_volume_widget_uses_coordinated_fade_sync>



    @pytest.hookimpl(wrapper=True, trylast=True)

    def pytest_runtest_teardown(item):

        """

        Hook called after each test tear down, to process any pending events and

        avoiding leaking events to the next test. Also, if exceptions have

        been captured during fixtures teardown, fail the test.

        """

        _process_events()

>       _close_widgets(item)



C:\Python311\Lib\site-packages\pytestqt\plugin.py:203: 

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _



item = <Function test_spotify_volume_widget_uses_coordinated_fade_sync>



    def _close_widgets(item: pytest.Item) -> None:

        """

        Close all widgets registered in the pytest item.

        """

        widgets = getattr(item, "qt_widgets", None)

        if widgets:

            for w, before_close_func in item.qt_widgets:  # type: ignore[attr-defined]

                w = w()

                if w is not None:

                    if before_close_func is not None:

                        before_close_func(w)

>                   w.close()

E                   RuntimeError: Internal C++ object (SpotifyVolumeWidget) already deleted.



C:\Python311\Lib\site-packages\pytestqt\qtbot.py:808: RuntimeError

_______________________________________________________________________ ERROR at setup of test_pixel_shift_no_immediate_shift_back ________________________________________________________________________



item = <Function test_pixel_shift_no_immediate_shift_back>



    @pytest.hookimpl(wrapper=True, tryfirst=True)

    def pytest_runtest_setup(item):

        """

        Hook called after before test setup starts, to start capturing exceptions

        as early as possible.

        """

        capture_enabled = _is_exception_capture_enabled(item)

        if capture_enabled:

            item.qt_exception_capture_manager = _QtExceptionCaptureManager()

            item.qt_exception_capture_manager.start()

>       result = yield

                 ^^^^^

E       AssertionError: previous item was not torn down properly



C:\Python311\Lib\site-packages\pytestqt\plugin.py:178: AssertionError

========================================================================================= short test summary info =========================================================================================

ERROR tests/test_scrollwheel_volume.py::test_spotify_volume_widget_uses_coordinated_fade_sync - RuntimeError: Internal C++ object (SpotifyVolumeWidget) already deleted.

ERROR tests/test_pixel_shift.py::test_pixel_shift_no_immediate_shift_back - AssertionError: previous item was not torn down properly

======================================================================================= 4 passed, 2 errors in 0.76s =======================================================================================


===== pytest run 2025-12-29 05:47:16 args=['tests/test_clock_widget.py::test_analog_clock_without_numerals_visual_offset', 'tests/test_clock_widget.py::test_analog_clock_with_timezone_visual_offset', 'tests/test_clock_widget.py::test_analog_clock_all_scenarios_have_valid_offset', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 3 items



tests/test_clock_widget.py::test_analog_clock_without_numerals_visual_offset 
FAILED                                                                                                                  [ 33%]


tests/test_clock_widget.py::test_analog_clock_with_timezone_visual_offset 
FAILED                                                                                                                     [ 66%]


tests/test_clock_widget.py::test_analog_clock_all_scenarios_have_valid_offset 
FAILED                                                                                                                 [100%]




================================================================================================ FAILURES =================================================================================================

____________________________________________________________________________ test_analog_clock_without_numerals_visual_offset _____________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x23e7dc0a7e0) at 0x0000023E7E3E1000>, parent_widget = <PySide6.QtWidgets.QWidget(0x23e7d8e3270) at 0x0000023E7E1ED200>



    def test_analog_clock_without_numerals_visual_offset(qapp, parent_widget):

        """Test visual offset when numerals are hidden.

    

        Without numerals, the clock face edge is the visual boundary,

        so offset should be smaller than with numerals.

        """

        clock = ClockWidget(

            parent=parent_widget,

            position=ClockPosition.TOP_RIGHT,

        )

        clock.set_display_mode("analog")

        clock.set_show_background(False)

        clock.set_show_numerals(False)

        clock.resize(200, 200)

        parent_widget.show()

        clock.show()

    

        offset_x, offset_y = clock._compute_analog_visual_offset()

    

        # Without numerals, offset should be non-zero but smaller

        assert offset_x > 0, "Should have some X offset for clock face"

        assert offset_y > 0, "Should have some Y offset for clock face"

    

        # Now enable numerals and check offset is larger

        clock.set_show_numerals(True)

        offset_x_with_numerals, offset_y_with_numerals = clock._compute_analog_visual_offset()

    

        # With numerals, offset should be larger (numerals extend beyond face)

>       assert offset_x_with_numerals > offset_x, "Numeral offset should be larger in X"

E       AssertionError: Numeral offset should be larger in X

E       assert 13 > 15



tests\test_clock_widget.py:464: AssertionError

______________________________________________________________________________ test_analog_clock_with_timezone_visual_offset ______________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x23e7dc0a7e0) at 0x0000023E7E3E1000>, parent_widget = <PySide6.QtWidgets.QWidget(0x23e7df50f90) at 0x0000023E7E79A600>



    def test_analog_clock_with_timezone_visual_offset(qapp, parent_widget):

        """Test that timezone display doesn't affect visual offset calculation.

    

        Timezone is at the bottom, so it shouldn't affect top/left visual offset.

        """

        clock = ClockWidget(

            parent=parent_widget,

            position=ClockPosition.TOP_RIGHT,

        )

        clock.set_display_mode("analog")

        clock.set_show_background(False)

        clock.resize(200, 220)

        parent_widget.show()

        clock.show()

    

        # Get offset without timezone

        clock.set_show_timezone(False)

        offset_without_tz = clock._compute_analog_visual_offset()

    

        # Get offset with timezone

        clock.set_show_timezone(True)

        offset_with_tz = clock._compute_analog_visual_offset()

    

        # Timezone shouldn't affect top/left offset

>       assert offset_without_tz == offset_with_tz, (

            "Timezone should not affect visual offset calculation"

        )

E       AssertionError: Timezone should not affect visual offset calculation

E       assert (13, 41) == (13, 29)

E         

E         At index 1 diff: 41 != 29

E         

E         Full diff:

E           (

E               13,

E         -     29,

E         +     41,

E           )



tests\test_clock_widget.py:494: AssertionError

____________________________________________________________________________ test_analog_clock_all_scenarios_have_valid_offset ____________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x23e7dc0a7e0) at 0x0000023E7E3E1000>, parent_widget = <PySide6.QtWidgets.QWidget(0x23e7df4e8f0) at 0x0000023E7E813580>



    def test_analog_clock_all_scenarios_have_valid_offset(qapp, parent_widget):

        """Test all combinations of settings produce valid offsets.

    

        Scenarios:

        1. With background (should be 0,0)

        2. Without background + with numerals

        3. Without background + without numerals

        4. With/without timezone (shouldn't affect offset)

        """

        clock = ClockWidget(

            parent=parent_widget,

            position=ClockPosition.TOP_RIGHT,

        )

        clock.set_display_mode("analog")

        clock.resize(200, 220)

        parent_widget.show()

        clock.show()

    

        # Scenario 1: With background

        clock.set_show_background(True)

        offset = clock._compute_analog_visual_offset()

        assert offset == (0, 0), "With background should have zero offset"

    

        # Scenario 2: Without background + with numerals

        clock.set_show_background(False)

        clock.set_show_numerals(True)

        offset = clock._compute_analog_visual_offset()

        assert offset[0] > 0 and offset[1] > 0, "Should have positive offset with numerals"

    

        # Scenario 3: Without background + without numerals

        clock.set_show_background(False)

        clock.set_show_numerals(False)

        offset = clock._compute_analog_visual_offset()

        assert offset[0] > 0 and offset[1] > 0, "Should have positive offset without numerals"

    

        # Scenario 4: Timezone variations (test both with and without numerals)

        for show_numerals in [True, False]:

            clock.set_show_numerals(show_numerals)

            clock.set_show_timezone(False)

            offset_no_tz = clock._compute_analog_visual_offset()

    

            clock.set_show_timezone(True)

            offset_with_tz = clock._compute_analog_visual_offset()

    

>           assert offset_no_tz == offset_with_tz, (

                f"Timezone should not affect offset (numerals={show_numerals})"

            )

E           AssertionError: Timezone should not affect offset (numerals=True)

E           assert (13, 41) == (13, 29)

E             

E             At index 1 diff: 41 != 29

E             

E             Full diff:

E               (

E                   13,

E             -     29,

E             +     41,

E               )



tests\test_clock_widget.py:545: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_clock_widget.py::test_analog_clock_without_numerals_visual_offset - AssertionError: Numeral offset should be larger in X

FAILED tests/test_clock_widget.py::test_analog_clock_with_timezone_visual_offset - AssertionError: Timezone should not affect visual offset calculation

FAILED tests/test_clock_widget.py::test_analog_clock_all_scenarios_have_valid_offset - AssertionError: Timezone should not affect offset (numerals=True)

============================================================================================ 3 failed in 0.69s ============================================================================================


===== pytest run 2025-12-29 05:48:11 args=['tests/test_clock_widget.py::test_analog_clock_without_numerals_visual_offset', 'tests/test_clock_widget.py::test_analog_clock_with_timezone_visual_offset', 'tests/test_clock_widget.py::test_analog_clock_all_scenarios_have_valid_offset', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 3 items



tests/test_clock_widget.py::test_analog_clock_without_numerals_visual_offset 
PASSED                                                                                                                  [ 33%]


tests/test_clock_widget.py::test_analog_clock_with_timezone_visual_offset 
FAILED                                                                                                                     [ 66%]


tests/test_clock_widget.py::test_analog_clock_all_scenarios_have_valid_offset 
FAILED                                                                                                                 [100%]




================================================================================================ FAILURES =================================================================================================

______________________________________________________________________________ test_analog_clock_with_timezone_visual_offset ______________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x28fa7cfecc0) at 0x0000028FA8399680>, parent_widget = <PySide6.QtWidgets.QWidget(0x28fa8069d70) at 0x0000028FA8901540>



    def test_analog_clock_with_timezone_visual_offset(qapp, parent_widget):

        """Test that timezone display doesn't affect visual offset calculation.

    

        Timezone is at the bottom, so it shouldn't affect top/left visual offset.

        """

        clock = ClockWidget(

            parent=parent_widget,

            position=ClockPosition.TOP_RIGHT,

        )

        clock.set_display_mode("analog")

        clock.set_show_background(False)

        clock.resize(200, 220)

        parent_widget.show()

        clock.show()

    

        # Get offset without timezone

        clock.set_show_timezone(False)

        offset_without_tz = clock._compute_analog_visual_offset()

    

        # Get offset with timezone

        clock.set_show_timezone(True)

        offset_with_tz = clock._compute_analog_visual_offset()

    

        # Timezone shouldn't affect top/left offset

>       assert offset_without_tz == offset_with_tz, (

            "Timezone should not affect visual offset calculation"

        )

E       AssertionError: Timezone should not affect visual offset calculation

E       assert (13, 41) == (13, 29)

E         

E         At index 1 diff: 41 != 29

E         

E         Full diff:

E           (

E               13,

E         -     29,

E         +     41,

E           )



tests\test_clock_widget.py:497: AssertionError

____________________________________________________________________________ test_analog_clock_all_scenarios_have_valid_offset ____________________________________________________________________________



qapp = <PySide6.QtWidgets.QApplication(0x28fa7cfecc0) at 0x0000028FA8399680>, parent_widget = <PySide6.QtWidgets.QWidget(0x28fa806af70) at 0x0000028FA85A9540>



    def test_analog_clock_all_scenarios_have_valid_offset(qapp, parent_widget):

        """Test all combinations of settings produce valid offsets.

    

        Scenarios:

        1. With background (should be 0,0)

        2. Without background + with numerals

        3. Without background + without numerals

        4. With/without timezone (shouldn't affect offset)

        """

        clock = ClockWidget(

            parent=parent_widget,

            position=ClockPosition.TOP_RIGHT,

        )

        clock.set_display_mode("analog")

        clock.resize(200, 220)

        parent_widget.show()

        clock.show()

    

        # Scenario 1: With background

        clock.set_show_background(True)

        offset = clock._compute_analog_visual_offset()

        assert offset == (0, 0), "With background should have zero offset"

    

        # Scenario 2: Without background + with numerals

        clock.set_show_background(False)

        clock.set_show_numerals(True)

        offset = clock._compute_analog_visual_offset()

        assert offset[0] > 0 and offset[1] > 0, "Should have positive offset with numerals"

    

        # Scenario 3: Without background + without numerals

        clock.set_show_background(False)

        clock.set_show_numerals(False)

        offset = clock._compute_analog_visual_offset()

        assert offset[0] > 0 and offset[1] > 0, "Should have positive offset without numerals"

    

        # Scenario 4: Timezone variations (test both with and without numerals)

        for show_numerals in [True, False]:

            clock.set_show_numerals(show_numerals)

            clock.set_show_timezone(False)

            offset_no_tz = clock._compute_analog_visual_offset()

    

            clock.set_show_timezone(True)

            offset_with_tz = clock._compute_analog_visual_offset()

    

>           assert offset_no_tz == offset_with_tz, (

                f"Timezone should not affect offset (numerals={show_numerals})"

            )

E           AssertionError: Timezone should not affect offset (numerals=True)

E           assert (13, 41) == (13, 29)

E             

E             At index 1 diff: 41 != 29

E             

E             Full diff:

E               (

E                   13,

E             -     29,

E             +     41,

E               )



tests\test_clock_widget.py:548: AssertionError

========================================================================================= short test summary info =========================================================================================

FAILED tests/test_clock_widget.py::test_analog_clock_with_timezone_visual_offset - AssertionError: Timezone should not affect visual offset calculation

FAILED tests/test_clock_widget.py::test_analog_clock_all_scenarios_have_valid_offset - AssertionError: Timezone should not affect offset (numerals=True)

======================================================================================= 2 failed, 1 passed in 0.64s =======================================================================================


===== pytest run 2025-12-29 05:49:09 args=['tests/test_clock_widget.py::test_analog_clock_without_numerals_visual_offset', 'tests/test_clock_widget.py::test_analog_clock_with_timezone_visual_offset', 'tests/test_clock_widget.py::test_analog_clock_all_scenarios_have_valid_offset', '-v'] =====

=========================================================================================== test session starts ===========================================================================================

platform win32 -- Python 3.11.9, pytest-8.4.1, pluggy-1.6.0 -- C:\Python311\python.exe

cachedir: .pytest_cache

PySide6 6.9.1 -- Qt runtime 6.9.1 -- Qt compiled 6.9.1

rootdir: F:\Programming\Apps\ShittyRandomPhotoScreenSaver

configfile: pytest.ini

plugins: qt-4.5.0

collecting ... 
collected 3 items



tests/test_clock_widget.py::test_analog_clock_without_numerals_visual_offset 
PASSED                                                                                                                  [ 33%]


tests/test_clock_widget.py::test_analog_clock_with_timezone_visual_offset 
PASSED                                                                                                                     [ 66%]


tests/test_clock_widget.py::test_analog_clock_all_scenarios_have_valid_offset 
PASSED                                                                                                                 [100%]




============================================================================================ 3 passed in 0.44s ============================================================================================

